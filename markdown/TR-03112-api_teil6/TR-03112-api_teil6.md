![](_page_0_Picture_0.jpeg)

![](_page_0_Picture_2.jpeg)

# Technical Guideline TR-03112-6 eCard-API-Framework – IFD-Interface Version 1.1.5

7. April 2015

Bundesamt für Sicherheit in der Informationstechnik Postfach 20 03 63 53133 Bonn

E-Mail: ecard.api@bsi.bund.de Internet: https://www.bsi.bund.de © Bundesamt für Sicherheit in der Informationstechnik 2015

| 1            | Overview of the eCard-API-Framework4              |  |
|--------------|---------------------------------------------------|--|
| 1.1          | Key Words4                                        |  |
| 1.2          | XML-Schema5                                       |  |
| 2            | Overview of the IFD-Interface6                    |  |
| 2.1          | Objective6                                        |  |
| 2.2          | Functions6                                        |  |
| 2.2.1        | Card terminal functions6                          |  |
| 2.2.2        | Card functions7                                   |  |
| 2.2.3        | User interaction functions7                       |  |
| 2.2.4        | IFD callback interface for card terminal events7  |  |
| 3            | Specification of the IFD-Interface8               |  |
| 3.1          | Card terminal functions8                          |  |
| 3.1.1        | EstablishContext8                                 |  |
| 3.1.2        | ReleaseContext9                                   |  |
| 3.1.3        | ListIFDs11                                        |  |
| 3.1.4        | GetIFDCapabilities12                              |  |
| 3.1.5        | GetStatus17                                       |  |
| 3.1.6        | Wait20                                            |  |
| 3.1.7        | Cancel23                                          |  |
| 3.1.8<br>3.2 | ControlIFD25<br>Card functions26                  |  |
| 3.2.1        | Connect26                                         |  |
| 3.2.2        | Disconnect28                                      |  |
| 3.2.3        | BeginTransaction30                                |  |
| 3.2.4        | EndTransaction32                                  |  |
| 3.2.5        | Transmit33                                        |  |
| 3.3          | User interaction functions35                      |  |
| 3.3.1        | VerifyUser35                                      |  |
| 3.3.2        | ModifyVerificationData42                          |  |
| 3.3.3        | Output47                                          |  |
| 3.4          | IFD-Callback-Interface for card terminal events50 |  |
| 3.4.1        | SignalEvent50                                     |  |
|              |                                                   |  |

|  | Figure 1: Internal architecture of the IFD-Layer (informative)52 |  |
|--|------------------------------------------------------------------|--|
|--|------------------------------------------------------------------|--|

# <span id="page-3-0"></span>**1 Overview of the eCard-API-Framework**

The objective of the eCard-API-Framework is the provision of a simple and homogeneous interface to enable standardised use of the various smart cards (eCards) for different applications.

The eCard-API-Framework is sub-divided into the following layers:

- **•** Application-Layer
- **•** Identity-Layer
- **•** Service-Access-Layer
- **•** Terminal-Layer

The **Application-Layer** contains the various applications which use the eCard-API-Framework to access the eCards and their associated functions. Application-specific "convenience interfaces", in which the recurring invocation sequences may be encapsulated in application-specific calls, may also exist in this layer. However, these interfaces are currently *not* within the scope of the e-Card-API-framework.

The **Identity-Layer** comprises the eCard-Interface and the Management interface, and therefore functions for the use and management of electronic identities as well as for management of the eCard-API-Framework.

The *eCard-Interface* (refer to [TR-03112-2]) allows to request certificates as well as the encryption, signature and time-stamping of documents.

In the M*anagement-Interface* (refer to [TR-03112-3]), functions for updating the framework and the management of trusted identities, smart cards, card terminals, and default behaviour are available.

The **Service-Access-Layer** provides, in particular, functions for cryptographic primitives and biometric mechanisms in connection with cryptographic tokens, and comprises the ISO24727-3-Interface and the Support-Interface.

The *ISO24727-3-Interface* defined in the present document is a webservice-based implementation of the standard of the same name [ISO24727-3]. This interface contains functions to establish (cryptographically protected) connections to smart cards, to manage card applications, to read or write data, to perform cryptographic operations and to manage the respective key material (in the form of so-called "differential identities"). In the process, all functions which use or manage "differential identities" are parameterised by means of protocol-specific object identifiers so that the different protocols which are defined in the present document MAY be used with a standardised interface (refer to [TR-03112-7]).

The S*upport-Interface* (refer to [TR-03112-5]) contains a range of supporting functions.

The **Terminal-Layer** primarily contains the *IFD-Interface* (refer to [TR-03112-6]). This layer takes over the generalisation of specific card terminal types and various interfaces as well as communication with the smart card. For the user it is unimportant whether the card is addressed by PC/SC, a SICCT terminal or a proprietary interface, or whether it has contacts or is contact-less.

## **1.1 Key Words**

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in [RFC2119]. The key word "CONDITIONAL" is to be interpreted as follows:

CONDITIONAL: The usage of an item is dependent on the usage of other items. It is therefore further qualified under which conditions the item is REQUIRED or RECOMMENDED.

## **1.2 XML-Schema**

A XML-Schema is provided together with this Technical Guideline. In case of incongruencies, the specifications in this text take precedence. The graphical representations of the XML-Schema illustrate the schema. Note that the text of this Guideline might further restrict the presence or mulitplicity of elements as compared to the schema definition.

# <span id="page-5-0"></span>**2 Overview of the IFD-Interface**

# **2.1 Objective**

The IFD-Interface generalises the specific card terminal types and various interfaces and communicates with the smart card. For the user it is not relevant whether the card is addressed by PC/SC, CT-API, in a SICCT card terminal or via a proprietary interface, or whether it has contacts or is contactless.

### **2.2 Functions**

The IFD-Interface provides the following function groups:

- **•** Card terminal functions
- **•** Card functions
- **•** User interaction functions

In addition, there is an IFD-Callback-Interface for card terminal events and additional functions for the management of card terminals which are specified in the management interface [TR-03112-3]:

- **•** With the RegisterIFD function it is possible to add a card terminal with all configuration information.
- **•** The UnregisterIFD function deletes a card terminal.

#### **2.2.1 Card terminal functions**

- **•** The EstablishContext function opens a session with the Terminal-Layer and returns a ContextHandle which is used to address this session during subsequent function invocations.
- **•** The ReleaseContext terminates a session with the Terminal-Layer which had been addressed by a ContextHandle.
- **•** With the ListIFDs function a list of available card terminals is returned to the calling layer.
- **•** The GetIFDCapabilities function returns information on a specific card terminal and its functional units to the calling layer.
- **•** The GetStatus function determines the current status of the card terminal.
- **•** With the Wait function the invoking layer can be informed about card terminal events by the return of the wait function or by means of the SignalEvent callback function.
- **•** The Cancel function terminates waiting for card terminal events or attempts to terminate processing of the last command sent via the current handle to a specific card terminal. In this case the success of the operation depends on the type of command and the time at which Cancel was invoked.
- **•** The ControlIFD function sends a (proprietary) command to the card terminal. This serves to permit access to proprietary and application-specific functions for which there is no separate command in the IFD-Interface without changing the interface.

#### **2.2.2 Card functions**

- **•** The Connect function activates a card captured by the IFD and returns a SlotHandle with which the card can be addressed in the future.
- **•** The Disconnect function invalidates a SlotHandle and optionally performs an additional action (e.g. eCard ejection, if the IFD features the corresponding mechanical functionality).
- **•** The BeginTransaction function starts a transaction within the framework of which several commands can be sent to the eCard. If an error occurs, the transaction is terminated and any modifications are reset.
- **•** The EndTransaction function terminates an existing transaction.
- **•** The Transmit function sends APDUs to an eCard addressed via a SlotHandle.

#### **2.2.3 User interaction functions**

- **•** The VerifyUser function verifies the user by means of a PIN or a biometric characteristic.
- **•** The ModifyVerificationData modifies the identification data (PIN or biometric characteristic).
- **•** The Output function may be used to control the output units of a card terminal.

#### **2.2.4 IFD callback interface for card terminal events**

**•** With the SignalEvent function, layers above the Terminal-Layer can be informed of card terminal events. For this purpose the SignalEvent function must be offered as a webservice by these layers.

# <span id="page-7-0"></span>**3 Specification of the IFD-Interface**

## **3.1 Card terminal functions**

#### **3.1.1 EstablishContext**

| Name                     | EstablishContext                                                                                                                                                               |                                                                                                                                                                                                     |  |  |
|--------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|
| Description              | The EstablishContext function opens a session with the Terminal-Layer and<br>returns a ContextHandle which is used to address this session in further function<br>invocations. |                                                                                                                                                                                                     |  |  |
| Invocation<br>parameters |                                                                                                                                                                                |                                                                                                                                                                                                     |  |  |
|                          | Invocation of the EstablishContext function.                                                                                                                                   |                                                                                                                                                                                                     |  |  |
|                          | Name                                                                                                                                                                           | Description                                                                                                                                                                                         |  |  |
|                          | ChannelHandle                                                                                                                                                                  | Optional parameter with which a remote system can be<br>addressed (also refer to CardApplicationPath in<br>[TR-03112-4]). If the local system is to be addressed,<br>this parameter MAY be omitted. |  |  |
| Return                   |                                                                                                                                                                                |                                                                                                                                                                                                     |  |  |
|                          | Return of the EstablishContext function.                                                                                                                                       |                                                                                                                                                                                                     |  |  |
|                          | Name                                                                                                                                                                           | Description                                                                                                                                                                                         |  |  |
|                          | dss:Result                                                                                                                                                                     | Contains the status information and the errors of<br>an executed action. This element is described in<br>more detail below.                                                                         |  |  |
|                          | ContextHandle                                                                                                                                                                  | The session with the Terminal-Layer is<br>addressed via the returned ContextHandle.                                                                                                                 |  |  |

![](_page_8_Figure_0.jpeg)

#### **3.1.2 ReleaseContext**

| Name                     | ReleaseContext                                                            |             |  |
|--------------------------|---------------------------------------------------------------------------|-------------|--|
| Description              | The ReleaseContext function terminates a session with the Terminal-Layer. |             |  |
| Invocation<br>parameters |                                                                           |             |  |
|                          | Invocation of the ReleaseContext function.                                |             |  |
|                          | Name                                                                      | Description |  |

|                | ContextHandle                                                                                                                                                                                               |             | Handle with which the session with the Terminal-Layer<br>can be addressed.                                                  |  |
|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-----------------------------------------------------------------------------------------------------------------------------|--|
| Return         | Return of the ReleaseContext function.                                                                                                                                                                      |             |                                                                                                                             |  |
|                | Name                                                                                                                                                                                                        |             | Description                                                                                                                 |  |
|                | dss:Result                                                                                                                                                                                                  |             | Contains the status information and the errors of<br>an executed action. This element is described in<br>more detail below. |  |
|                |                                                                                                                                                                                                             |             |                                                                                                                             |  |
|                | Status information and errors in ReleaseContext                                                                                                                                                             |             |                                                                                                                             |  |
|                | Name                                                                                                                                                                                                        | Error codes |                                                                                                                             |  |
|                | ResultMajor                                                                                                                                                                                                 | •<br>•      | /resultmajor#ok<br>/resultmajor#error                                                                                       |  |
|                | ResultMinor                                                                                                                                                                                                 | •<br>•<br>• | /resultminor/ifdl/common#timeoutError<br>/resultminor/dp#invalidChannelHandle<br>/resultminor/al/common#unknownError        |  |
|                | ResultMessage                                                                                                                                                                                               |             | MAY contain more detailed information on the error<br>which occurred if required.                                           |  |
| Preconditions  | A context was established with EstablishContext.                                                                                                                                                            |             |                                                                                                                             |  |
| Postconditions | The ContextHandle loses its validity.                                                                                                                                                                       |             |                                                                                                                             |  |
| Notes          | A PC/SC handler in the IFD-Layer (also refer to Annex A) MAY implement this<br>function with the ReleaseContext function in the PC/SC resource manager<br>(also refer to [PC/SC], Part 5, Section 3.2.1.2). |             |                                                                                                                             |  |

#### **3.1.3 ListIFDs**

| Name                     | ListIFDs                                                                                                                             |             |                                                                                                                             |  |
|--------------------------|--------------------------------------------------------------------------------------------------------------------------------------|-------------|-----------------------------------------------------------------------------------------------------------------------------|--|
| Description              | Returns the list of the card terminals assigned to the eCard-API-Framework,<br>which at least contains the currently connected IFDs. |             |                                                                                                                             |  |
| Invocation<br>parameters |                                                                                                                                      |             |                                                                                                                             |  |
|                          | Invocation of the ListIFDs function.                                                                                                 |             |                                                                                                                             |  |
|                          | Name<br>ContextHandle                                                                                                                | Description | Handle with which the session with the Terminal-Layer<br>can be addressed.                                                  |  |
| Return                   | Return of the ListIFDs function.                                                                                                     |             |                                                                                                                             |  |
|                          | Name                                                                                                                                 |             | Description                                                                                                                 |  |
|                          | dss:Result                                                                                                                           |             | Contains the status information and the errors of<br>an executed action. This element is described in<br>more detail below. |  |
|                          | IFDName                                                                                                                              |             | Unique name of the card terminal.                                                                                           |  |
|                          |                                                                                                                                      |             |                                                                                                                             |  |
|                          | Status information and errors in ListIFDs                                                                                            |             |                                                                                                                             |  |
| Name<br>Error codes      |                                                                                                                                      |             |                                                                                                                             |  |

|                | ResultMajor                                                                                                                                                                                              | •<br>/resultmajor#ok<br>•<br>/resultmajor#error                                                                                     |
|----------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------|
|                | ResultMinor                                                                                                                                                                                              | •<br>/resultminor/ifdl/common#timeoutError<br>•<br>/resultminor/dp#invalidChannelHandle<br>•<br>/resultminor/al/common#unknownError |
|                | ResultMessage                                                                                                                                                                                            | MAY contain more detailed information on the error<br>which occurred if required.                                                   |
| Preconditions  | The potentially available card terminals were assigned to the<br>eCard-API-Framework in an administrative operation (also refer to<br>[TR-03112-3]).                                                     |                                                                                                                                     |
|                | A context was established with EstablishContext.                                                                                                                                                         |                                                                                                                                     |
| Postconditions | The status of the card terminals remains unchanged.                                                                                                                                                      |                                                                                                                                     |
| Notes          | A PC/SC handler in the IFD-Layer (also refer to Annex A) MAY implement this<br>function with the ListReaders function in the PC/SC resource manager (also<br>refer to [PC/SC], Part 5, Section 3.2.3.2). |                                                                                                                                     |
|                | Also refer to GetCardTerminals in [TR-03112-2].                                                                                                                                                          |                                                                                                                                     |

#### **3.1.4 GetIFDCapabilities**

| Name                     | GetIFDCapabilities                                                                               |                                                                        |
|--------------------------|--------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
| Description              | Returns information on the capabilities of a specific card terminal and its<br>functional units. |                                                                        |
| Invocation<br>parameters |                                                                                                  |                                                                        |
|                          | Invocation of the GetIFDCapabilities function.                                                   |                                                                        |
|                          | Name                                                                                             | Description                                                            |
|                          | ContextHandle                                                                                    | Handle with which the session with the Terminal-Layer<br>is addressed. |
|                          | IFDName                                                                                          | Unique name of the card terminal.                                      |

![](_page_12_Figure_0.jpeg)

| KeyPadCapability                           | Such an entry with the capabilities of the<br>keypad exists for each card terminal keypad.<br>The entry is of the<br>KeyPadCapabilityType.                                                                                                                                                                                                                                                                                                                           |
|--------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| BioSensorCapability                        | Such an entry of the<br>BioSensorCapabilityType with the<br>capabilities of the sensor exists for each<br>biometric sensor on the card terminal.                                                                                                                                                                                                                                                                                                                     |
| OpticalSignalUnit                          | Contains information on whether the card<br>terminal has an optical signal unit (e.g. LED).                                                                                                                                                                                                                                                                                                                                                                          |
| AcousticSignalUnit                         | Contains information on whether the card<br>terminal has a unit for acoustic signals (e.g.<br>beeping).                                                                                                                                                                                                                                                                                                                                                              |
| SlotCapability is part of IFDCapabilities. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Name                                       | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Index                                      | Specifies the index of the slot in the range of 0<br>to the number of slots minus 1.                                                                                                                                                                                                                                                                                                                                                                                 |
| Protocol                                   | MAY be present multiple times and indicate the<br>supported transport protocols (see<br>Interface-element in [TR-03112-4]) or the<br>supported DID-protocols (see<br>[TR-03112-7]).Support of the IFD for PACE<br>according to [TR-03119]/[PC/SC], Part 10<br>AMD1 is indicated by the URI<br>urn:oid:0.4.0.127.0.7.2.2.4:xx,<br>where xx is the decimal representation of the<br>capabilites bitmap returned by GetReader<br>PACECapabilites as defined in [PC/SC], |

![](_page_14_Figure_0.jpeg)

![](_page_15_Figure_0.jpeg)

| manager (also refer to [PC/SC], Part 5, Section 3.2.5.2). |
|-----------------------------------------------------------|
|                                                           |

#### **3.1.5 GetStatus**

| Name                     | GetStatus                                                                 |                                                                                                                                        |
|--------------------------|---------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------|
| Description              | Determines the current status of one specific or all connected terminals. |                                                                                                                                        |
| Invocation<br>parameters |                                                                           |                                                                                                                                        |
|                          | Invocation of the GetStatus function.                                     |                                                                                                                                        |
|                          | Name                                                                      | Description                                                                                                                            |
|                          | ContextHandle                                                             | Handle with which the session with the Terminal-Layer<br>is addressed.                                                                 |
|                          | IFDName                                                                   | MAY contain the unique name of the card terminal. If<br>this element is missing, the status of all connected<br>terminals is returned. |
| Return                   | Return of the GetStatus function.                                         |                                                                                                                                        |
|                          |                                                                           |                                                                                                                                        |
|                          | Name                                                                      | Description                                                                                                                            |
|                          | dss:Result                                                                | Contains the status information and the errors of an<br>executed action. This element is described in more detail<br>below.            |
|                          | IFDStatus                                                                 | Contains information on the status of the respective<br>terminal.                                                                      |

<span id="page-17-0"></span>![](_page_17_Figure_0.jpeg)

<span id="page-18-0"></span>![](_page_18_Figure_0.jpeg)

|                | Available                                                                                                                                                                                           | Specifies whether the functional unit is currently                                |
|----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
|                |                                                                                                                                                                                                     | available for the invoker or if it is already being used.                         |
|                |                                                                                                                                                                                                     |                                                                                   |
|                | Status information and errors in GetStatusResponse                                                                                                                                                  |                                                                                   |
|                | Name                                                                                                                                                                                                | Error codes                                                                       |
|                | ResultMajor                                                                                                                                                                                         | •<br>/resultmajor#ok                                                              |
|                |                                                                                                                                                                                                     | •<br>/resultmajor#error                                                           |
|                | ResultMinor                                                                                                                                                                                         | •<br>/resultminor/ifdl/common#timeoutError                                        |
|                |                                                                                                                                                                                                     | •<br>/resultminor/dp#invalidChannelHandle                                         |
|                |                                                                                                                                                                                                     | •<br>/resultminor/ifdl/terminal#unknownIFD                                        |
|                |                                                                                                                                                                                                     | •<br>/resultminor/al/common#unknownError                                          |
|                | ResultMessage                                                                                                                                                                                       | MAY contain more detailed information on the error<br>which occurred if required. |
| Preconditions  | A context was established with EstablishContext.                                                                                                                                                    |                                                                                   |
| Postconditions | The status of the card terminals remains unchanged.                                                                                                                                                 |                                                                                   |
| Notes          | A PC/SC handler in the IFD-Layer (also refer to Annex A) MAY implement this<br>function with the Status function in the PC/SC resource manager (also refer to<br>[PC/SC], Part 5, Section 3.2.5.2). |                                                                                   |

#### **3.1.6 Wait**

| Name        | Wait                                                                                                                                                                                                                                                                                |
|-------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Description | The Wait function informs the invoking layer about events on specific card<br>terminals. Information on which events have occurred can be returned by the<br>return of the Wait function or – if a corresponding callback address was<br>transmitted – by the SignalEvent function. |

![](_page_20_Figure_0.jpeg)

![](_page_21_Figure_0.jpeg)

|                | ResultMinor                                      | •<br>/resultminor/ifdl/common#timeoutError<br>•<br>/resultminor/dp#invalidChannelHandle<br>•<br>/resultminor/ifdl/terminal#unknownIFD<br>•<br>/resultminor/al/common#unknownError                            |
|----------------|--------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                | ResultMessage                                    | MAY contain more detailed information on the error<br>which occurred if required.                                                                                                                            |
| Preconditions  | A context was established with EstablishContext. |                                                                                                                                                                                                              |
| Postconditions |                                                  |                                                                                                                                                                                                              |
| Notes          |                                                  | A PC/SC handler in the IFD-Layer (also refer to Annex A) MAY implement this<br>function with the GetStatusChange function in the PC/SC resource manager<br>(also refer to [PC/SC], Part 5, Section 3.2.4.2). |

#### **3.1.7 Cancel**

| Name                     | Cancel                                                    |                                                                                                          |
|--------------------------|-----------------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| Description              | cancel processing of the last command sent to a terminal. | Terminates waiting for card terminal events started with Wait, or attempts to                            |
| Invocation<br>parameters | Invocation of the Cancel function.                        |                                                                                                          |
|                          | Name                                                      | Description                                                                                              |
|                          | ContextHandle                                             | Handle with which the session with the<br>Terminal-Layer is addressed.                                   |
|                          | IFDName                                                   | Unique name of the card terminal at which a<br>command currently being executed should be<br>terminated. |
|                          | SessionIdentifier                                         | Specifies which waiting process should be<br>terminated with Wait.                                       |

![](_page_23_Figure_0.jpeg)

#### **3.1.8 ControlIFD**

![](_page_24_Figure_1.jpeg)

![](_page_25_Figure_0.jpeg)

# **3.2 Card functions**

#### **3.2.1 Connect**

| Name        | Connect                                                                                                                               |
|-------------|---------------------------------------------------------------------------------------------------------------------------------------|
| Description | Establishes a connection to an eCard in a specific card terminal slot and returns a<br>corresponding SlotHandle to the calling layer. |

| Invocation<br>parameters |                                     |                                                                                                                                                                                                                                                        |
|--------------------------|-------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                          | Invocation of the Connect function. |                                                                                                                                                                                                                                                        |
|                          | Name                                | Description                                                                                                                                                                                                                                            |
|                          | ContextHandle                       | Handle with which the session with the Terminal-Layer<br>is addressed.                                                                                                                                                                                 |
|                          | IFDName                             | Unique name of the card terminal.                                                                                                                                                                                                                      |
|                          | Slot                                | Addresses the slot (ICC slot or PCD) of an IFD by which<br>a card is detected and with which a connection should be<br>established. Assignment of the slot indexes is explained<br>in the definition of the SlotStatusType (also refer<br>to page 19). |
|                          | Exclusive                           | Is TRUE if an exclusive connection should be established<br>to the eCard.                                                                                                                                                                              |
| Return                   |                                     |                                                                                                                                                                                                                                                        |
|                          | Return of the Connect function.     |                                                                                                                                                                                                                                                        |
|                          | Name                                | Description                                                                                                                                                                                                                                            |
|                          | dss:Result                          | Contains the status information and the errors of<br>an executed action. This element is described in<br>more detail below.                                                                                                                            |
|                          | SlotHandle                          | If successful, a SlotHandle is returned with<br>which the connection established with Connect<br>to the eCard is addressed in future.                                                                                                                  |

|                | Status information and errors in Connect                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                              |  |
|----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|                | Name                                                                                                                                                                                                                                                                                                                                  | Error codes                                                                                                                                                                                                                                                                                  |  |
|                | ResultMajor                                                                                                                                                                                                                                                                                                                           | •<br>/resultmajor#ok                                                                                                                                                                                                                                                                         |  |
|                | ResultMinor                                                                                                                                                                                                                                                                                                                           | •<br>/resultmajor#error<br>•<br>/resultminor/ifdl/common#timeoutError                                                                                                                                                                                                                        |  |
|                |                                                                                                                                                                                                                                                                                                                                       | •<br>/resultminor/ifdl/common#invalidContextHandle<br>•<br>/resultminor/ifdl/terminal#unknownIFD<br>•<br>/resultminor/ifdl/terminal#unknownSlot<br>•<br>/resultminor/ifdl/terminal#IFDSharingViolation<br>•<br>/resultminor/ifdl/terminal#noCard<br>•<br>/resultminor/al/common#unknownError |  |
|                | ResultMessage                                                                                                                                                                                                                                                                                                                         | MAY contain more detailed information on the error<br>which occurred if required.                                                                                                                                                                                                            |  |
| Preconditions  |                                                                                                                                                                                                                                                                                                                                       | A context was established with EstablishContext.                                                                                                                                                                                                                                             |  |
| Postconditions | A logical connection to the card was established. APDUs can then be sent to the<br>card via the returned SlotHandle with the Transmit function. As a result,<br>the path to a card application can also be determined with<br>CardApplicationPath and established by means of<br>CardApplicationConnect (also refer to [TR-03112-4]). |                                                                                                                                                                                                                                                                                              |  |
| Notes          | A PC/SC handler in the IFD-Layer (also refer to Annex A) MAY implement this<br>function with the Connect function in the PC/SC resource manager (also refer<br>to [PC/SC], Part 5, Section 3.2.5.2).                                                                                                                                  |                                                                                                                                                                                                                                                                                              |  |

#### **3.2.2 Disconnect**

| Name        | Disconnect                                                                                                                                                                                                      |
|-------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Description | The Disconnect function terminates the connection to a card and MAY<br>execute an additional action (e.g. ejection of the card), if the corresponding<br>mechanical functionality is supported by the terminal. |

![](_page_28_Figure_0.jpeg)

|                | Status information and errors in Disconnect                                                                                                                                                             |                                                                                   |  |
|----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|--|
|                | Name                                                                                                                                                                                                    | Error codes                                                                       |  |
|                | ResultMajor                                                                                                                                                                                             | •<br>/resultmajor#ok                                                              |  |
|                |                                                                                                                                                                                                         | •<br>/resultmajor#error                                                           |  |
|                | ResultMinor                                                                                                                                                                                             | •<br>/resultminor/ifdl/common#timeoutError                                        |  |
|                |                                                                                                                                                                                                         | •<br>/resultminor/ifdl/common#invalidSlotHandle                                   |  |
|                |                                                                                                                                                                                                         | •<br>/resultminor/ifdl/terminal#unknownAction                                     |  |
|                |                                                                                                                                                                                                         | •<br>/resultminor/al/common#unknownError                                          |  |
|                | ResultMessage                                                                                                                                                                                           | MAY contain more detailed information on the error<br>which occurred if required. |  |
| Preconditions  | A connection to an eCard was established with Connect.                                                                                                                                                  |                                                                                   |  |
| Postconditions | The SlotHandle loses its validity.                                                                                                                                                                      |                                                                                   |  |
| Notes          | A PC/SC handler in the IFD-Layer (also refer to Annex A) MAY implement this<br>function with the Disconnect function in the PC/SC resource manager (also<br>refer to [PC/SC], Part 5, Section 3.2.5.2). |                                                                                   |  |

#### **3.2.3 BeginTransaction**

| Name                     | BeginTransaction                                                                                                                                                                                                                                                        |
|--------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Description              | The BeginTransaction function starts a transaction within which a series of<br>commands can be sent to the eCard without permitting access of another process<br>to the eCard. If a command is not successful in the transaction, the complete<br>transaction is reset. |
| Invocation<br>parameters | Invocation of the BeginTransaction function.                                                                                                                                                                                                                            |

|                | Name                                                                                                                                                                                                          |                                                                                   | Description                                                                                                                 |  |
|----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|--|
|                | SlotHandle                                                                                                                                                                                                    |                                                                                   | With the SlotHandle the connection established with<br>Connect to the eCard is addressed.                                   |  |
| Return         |                                                                                                                                                                                                               |                                                                                   |                                                                                                                             |  |
|                | Return of the BeginTransaction function.<br>Name                                                                                                                                                              |                                                                                   | Description                                                                                                                 |  |
|                | dss:Result                                                                                                                                                                                                    |                                                                                   | Contains the status information and the errors of<br>an executed action. This element is described in<br>more detail below. |  |
|                |                                                                                                                                                                                                               |                                                                                   | Status information and errors in BeginTransaction                                                                           |  |
|                | Name                                                                                                                                                                                                          | Error codes                                                                       |                                                                                                                             |  |
|                | ResultMajor                                                                                                                                                                                                   | •<br>•                                                                            | /resultmajor#ok<br>/resultmajor#error                                                                                       |  |
|                | ResultMinor                                                                                                                                                                                                   | •<br>•<br>•                                                                       | /resultminor/ifdl/common#timeoutError<br>/resultminor/ifdl/common#invalidSlotHandle<br>/resultminor/al/common#unknownError  |  |
|                | ResultMessage                                                                                                                                                                                                 | MAY contain more detailed information on the error<br>which occurred if required. |                                                                                                                             |  |
| Preconditions  |                                                                                                                                                                                                               | A connection to an eCard was established with Connect.                            |                                                                                                                             |  |
| Postconditions | A transaction is started.                                                                                                                                                                                     |                                                                                   |                                                                                                                             |  |
| Notes          | A PC/SC handler in the IFD-Layer (also refer to Annex A) MAY implement this<br>function with the BeginTransaction function in the PC/SC resource<br>manager (also refer to [PC/SC], Part 5, Section 3.2.5.2). |                                                                                   |                                                                                                                             |  |

#### **3.2.4 EndTransaction**

| Name                     | EndTransaction                         |                                                                                                                             |  |  |
|--------------------------|----------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|--|--|
| Description              | selected eCard.                        | The EndTransaction function terminates an existing transaction with a                                                       |  |  |
| Invocation<br>parameters |                                        | Invocation of the EndTransaction function.                                                                                  |  |  |
|                          | Name                                   | Description                                                                                                                 |  |  |
|                          | SlotHandle                             | The SlotHandle addresses the connection to the<br>eCard.                                                                    |  |  |
| Return                   | Return of the EndTransaction function. |                                                                                                                             |  |  |
|                          | Name                                   | Description                                                                                                                 |  |  |
|                          | dss:Result                             | Contains the status information and the errors of an<br>executed action. This element is described in more detail<br>below. |  |  |
|                          |                                        |                                                                                                                             |  |  |
|                          | Name                                   | Status information and errors in EndTransaction<br>Error codes                                                              |  |  |
|                          |                                        |                                                                                                                             |  |  |
|                          | ResultMajor                            | •<br>/resultmajor#ok<br>•<br>/resultmajor#error                                                                             |  |  |
|                          |                                        | •<br>/resultmajor#warning                                                                                                   |  |  |

|                | ResultMinor                                                                                                                                                                                                 | •<br>/resultminor/ifdl/common#timeoutError<br>•<br>/resultminor/ifdl/common#invalidSlotHandle<br>•<br>/resultminor/ifdl/IO#noTransactionStarted<br>•<br>/resultminor/al/common#unknownError |  |
|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|                | ResultMessage                                                                                                                                                                                               | MAY contain more detailed information on the error<br>which occurred if required.                                                                                                           |  |
| Preconditions  | A connection to an eCard was established with Connect and a transaction<br>started for the thus-connected card with BeginTransaction.                                                                       |                                                                                                                                                                                             |  |
| Postconditions | The transaction is terminated.                                                                                                                                                                              |                                                                                                                                                                                             |  |
| Notes          | A PC/SC handler in the IFD-Layer (also refer to Annex A) MAY implement this<br>function with the EndTransaction function in the PC/SC resource manager<br>(also refer to [PC/SC], Part 5, Section 3.2.5.2). |                                                                                                                                                                                             |  |

#### **3.2.5 Transmit**

| Name                     | Transmit                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                     |
|--------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Description              | The Transmit function sends one or more APDU(s) to a connected eCard. In<br>order to support the batch processing a set of<br>AcceptableStatusCode-elements (9000 etc.) MAY be attached to each<br>InputAPDU. If the eCard returns some not expected status code it is – even in<br>case of secure messaging – clear that there is a serious error and it does not make<br>sense to feed the remaining InputAPDU-elements in the batch to the eCard. |                                                                                                                                                                                                     |
| Invocation<br>parameters | Invocation of the Transmit function.                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                     |
|                          | Name                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Description                                                                                                                                                                                         |
|                          | SlotHandle                                                                                                                                                                                                                                                                                                                                                                                                                                           | With the SlotHandle the connection established with<br>Connect to the eCard is addressed.                                                                                                           |
|                          | InputAPDUInfo                                                                                                                                                                                                                                                                                                                                                                                                                                        | MAY be present multiple times and contains the command<br>APDU, which is sent to the eCard and optionally<br>acceptable status codes. It is of type<br>InputAPDUInfoType, which is explained below. |

![](_page_33_Figure_0.jpeg)

|                | Status information and errors in Transmit                                                                                                                                                             |                                                                                   |
|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
|                | Name                                                                                                                                                                                                  | Error codes                                                                       |
|                | ResultMajor                                                                                                                                                                                           | •<br>/resultmajor#ok                                                              |
|                |                                                                                                                                                                                                       | •<br>/resultmajor#error                                                           |
|                | ResultMinor                                                                                                                                                                                           | •<br>/resultminor/ifdl/common#timeoutError                                        |
|                |                                                                                                                                                                                                       | •<br>/resultminor/ifdl/common#invalidSlotHandle                                   |
|                |                                                                                                                                                                                                       | •<br>/resultminor/al/common#unknownError                                          |
|                | ResultMessage                                                                                                                                                                                         | MAY contain more detailed information on the error<br>which occurred if required. |
| Preconditions  | A connection to an eCard was established with Connect.                                                                                                                                                |                                                                                   |
| Postconditions | The commands specified by the batch of APDU are executed by the eCard.                                                                                                                                |                                                                                   |
| Notes          | A PC/SC handler in the IFD-Layer (also refer to Annex A) MAY implement this<br>function with the Transmit function in the PC/SC resource manager (also refer<br>to [PC/SC], Part 5, Section 3.2.5.2). |                                                                                   |

# **3.3 User interaction functions**

#### **3.3.1 VerifyUser**

| Name        | VerifyUser                                                                                       |
|-------------|--------------------------------------------------------------------------------------------------|
| Description | The VerifyUser function initiates user verification with a PIN or a biometric<br>characteristic. |

![](_page_35_Figure_0.jpeg)

<span id="page-36-0"></span>![](_page_36_Figure_0.jpeg)

![](_page_37_Figure_0.jpeg)

| pwdFlags               | Contains information on the character of the PIN (also refer<br>to pwdFlags in accordance with [ISO7816-15]). The<br>PasswordFlagsType is defined as follows:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                        | <simpleType name="PasswordFlagsType"><br><union memberTypes="iso:BitString"><br><simpleType><br><list><br><simpleType><br><restriction base="token"><br><enumeration value="case-sensitive" /><br><enumeration value="local" /><br><enumeration value="change-disabled" /><br><enumeration value="unblock-disabled" /><br><enumeration value="initialized" /><br><enumeration value="needs-padding" /><br><enumeration value="unblockingPassword" /><br><enumeration value="soPassword" /><br><enumeration value="disable-allowed" /><br><enumeration value="integrity-protected" /><br><enumeration<br>value="confidentiality-protected"/><br><enumeration value="exchangeRefData" /><br><enumeration value="resetRetryCounter1" /><br><enumeration value="resetRetryCounter2" /><br></restriction><br></simpleType><br></list><br></simpleType><br></union><br></simpleType> |
| pwdType                | Contains information on the type of PIN (also refer to<br>pwdType in accordance with [ISO7816-15]). The<br>PasswordTypeType is defined as follows:<br><simpleType name="PasswordTypeType"><br><restriction base="string"><br><enumeration value="bcd" /><br><enumeration value="ascii-numeric" /><br><enumeration value="utf8" /><br><enumeration value="half-nibble-bcd" /><br><enumeration value="iso9564-1" /><br></restriction><br></simpleType>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| minLength              | Contains the minimum length of the PIN.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| storedLength           | Contains the length of the PIN as stored on the card.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| maxLength              | MAY contain the maximum length.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| padChar                | MAY contain the padding character which is to be used for<br>padding.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| lastPassword<br>Change | MAY contain the time of the last PIN modification.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |

![](_page_39_Figure_0.jpeg)

|        | RequestConfirmat<br>ionMessage              | Prompts the user to repeat the entry. If this element is<br>missing, the configured default message is used.                                                                                                                                                                                                                            |  |  |  |
|--------|---------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|--|
|        | CancelMessage                               | Shows the user that the entry was cancelled. If this<br>element is missing, the configured default message is<br>used.                                                                                                                                                                                                                  |  |  |  |
| Return | Return of the VerifyUser function.          |                                                                                                                                                                                                                                                                                                                                         |  |  |  |
|        | Name                                        | Description                                                                                                                                                                                                                                                                                                                             |  |  |  |
|        | dss:Result                                  | Contains the status information and the errors of<br>an executed action. This element is described in<br>more detail below.                                                                                                                                                                                                             |  |  |  |
|        | Response                                    | The response of the eCard (e.g. 9000 in the<br>event of successful user verification).                                                                                                                                                                                                                                                  |  |  |  |
|        |                                             |                                                                                                                                                                                                                                                                                                                                         |  |  |  |
|        | Status information and errors in VerifyUser |                                                                                                                                                                                                                                                                                                                                         |  |  |  |
|        | Name                                        | Error codes                                                                                                                                                                                                                                                                                                                             |  |  |  |
|        | ResultMajor                                 | •<br>/resultmajor#ok<br>•<br>/resultmajor#error                                                                                                                                                                                                                                                                                         |  |  |  |
|        | ResultMinor                                 | •<br>/resultminor/ifdl/common#timeoutError<br>•<br>/resultminor/ifdl/common#invalidSlotHandle<br>•<br>/resultminor/ifdl/IO#unknownInputUnit<br>•<br>/resultminor/ifdl#cancellationByUser<br>•<br>/resultminor/al/common#unknownError<br>•<br>/resultminor/ifdl/IO#unknownPINFormat<br>•<br>/resultminor/ifdl/IO#unknownBiometricSubtype |  |  |  |

|                | ResultMessage                                                                                                                                                                                                                                     | MAY contain more detailed information on the error<br>which occurred if required. |
|----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
| Preconditions  | A connection to an eCard was established with Connect.                                                                                                                                                                                            |                                                                                   |
| Postconditions | The corresponding authentication status on the card was established by<br>invocation of VERIFY in accordance with [ISO7816-4].                                                                                                                    |                                                                                   |
| Notes          | A PC/SC handler in the IFD-Layer (also refer to Annex A) MAY implement this<br>function with FEATURE_VERIFY_PIN_START specified in [PC/SC], Part 10<br>(Section 2.9) using the PIN_VERIFY_STRUCTURE defined in [PC/SC], Part<br>10 (Section 2.5). |                                                                                   |

#### **3.3.2 ModifyVerificationData**

| Name        | ModifyVerificationData                                                                                            |
|-------------|-------------------------------------------------------------------------------------------------------------------|
| Description | With this function the data for user authentication (PIN or biometric reference<br>data) on an eCard are changed. |

![](_page_42_Figure_0.jpeg)

| AltMVDMessages       | Is an optional parameter which specifies the<br>various messages which should be shown on<br>the display if the identification data are<br>modified (see below for details). If this element<br>is missing, standard texts are displayed.                                                     |
|----------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| OldReferenceData     | MAY contain the old reference data so that it is<br>only necessary to enter the new data on the<br>terminal. In this case the data is formatted by<br>the calling layer. If this element is missing, the<br>old reference data are to be entered on the<br>terminal if necessary.             |
| TimeoutUntilFirstKey | Is an optional parameter which specifies the<br>timeout in milliseconds before the first key<br>actuation.                                                                                                                                                                                    |
| TimeoutAfterFirstKey | Is an optional parameter which specifies the<br>timeout in milliseconds after the first key<br>actuation.                                                                                                                                                                                     |
| RepeatInput          | If this element is TRUE, repeated entry is<br>mandatory. If the element is missing, it is not<br>necessary to repeat the entry.                                                                                                                                                               |
| Template             | The acquired verification data are entered into<br>the template before the data are sent to the<br>eCard as APDU for the CHANGE<br>REFERENCE DATA command (also refer to<br>[ISO7816-4], Section 7.5.7) or the RESET<br>RETRY COUNTER command (also refer to<br>[ISO7816-4], Section 7.5.10). |

![](_page_44_Figure_0.jpeg)

![](_page_45_Figure_0.jpeg)

|               | ResultMinor<br>ResultMessage                                                                                                                                                                                                                      | •<br>/resultminor/ifdl/common#timeoutError<br>•<br>/resultminor/ifdl/common#invalidSlotHandle<br>•<br>/resultminor/ifdl/IO#unknownInputUnit<br>•<br>/resultminor/ifdl#cancellationByUser<br>•<br>/resultminor/ifdl/IO#repeatedDataMismatch<br>•<br>/resultminor/ifdl/IO#unknownPINFormat<br>•<br>/resultminor/ifdl/IO#unknownBiometricSubtype<br>•<br>/resultminor/al/common#unknownError<br>MAY contain more detailed information on the error which |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|               |                                                                                                                                                                                                                                                   | occurred if required.                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Precondition  | A connection to an eCard was established with Connect.                                                                                                                                                                                            |                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Postcondition | The corresponding command - CHANGE REFERENCE DATA or RESET<br>RETRY COUNTER in accordance with [ISO7816-4] – was executed on the card.                                                                                                            |                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Note          | A PC/SC handler in the IFD-Layer (also refer to Annex A) MAY implement this<br>function with FEATURE_MODIFY_PIN_START specified in [PC/SC], Part 10<br>(Section 2.9) using the PIN_MODIFY_STRUCTURE defined in [PC/SC], Part<br>10 (Section 2.6). |                                                                                                                                                                                                                                                                                                                                                                                                                                                       |

#### **3.3.3 Output**

| Name                     | Output                                                                                                                                     |                                                                        |
|--------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
| Description              | The command is used to output a message on the display of a card terminal<br>and/or output a visual or acoustic signal on a card terminal. |                                                                        |
| Invocation<br>parameters | Invocation of the Output function.                                                                                                         |                                                                        |
|                          |                                                                                                                                            |                                                                        |
|                          | Name                                                                                                                                       | Description                                                            |
|                          | ContextHandle                                                                                                                              | Handle with which the session with the Terminal-Layer<br>is addressed. |
|                          | IFDName                                                                                                                                    | Unique name of the card terminal.                                      |
|                          | OutputInfo                                                                                                                                 | Provides information about the output. Details are<br>specified below. |

![](_page_47_Figure_0.jpeg)

![](_page_48_Figure_0.jpeg)

# **3.4 IFD-Callback-Interface for card terminal events**

The IFD-Callback-Interface is made available from layers above the Terminal-Layer and contains exactly the function SignalEvent.

### **3.4.1 SignalEvent**

| Name                     | SignalEvent                                                                                                                                                                                                                                                      |             |                                                                                                                                                                                                                                                 |
|--------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Description              | With the SignalEvent function layers above the Terminal-Layer can be<br>informed of card terminal events. The Terminal-Layer was informed with the<br>Wait function of the callback address provided for this invocation and additional<br>necessary parameters. |             |                                                                                                                                                                                                                                                 |
| Invocation<br>parameters |                                                                                                                                                                                                                                                                  |             |                                                                                                                                                                                                                                                 |
|                          | Invocation of the SignalEvent function.                                                                                                                                                                                                                          |             |                                                                                                                                                                                                                                                 |
|                          | Name                                                                                                                                                                                                                                                             |             | Description                                                                                                                                                                                                                                     |
|                          | ContextHandle                                                                                                                                                                                                                                                    |             | Handle with which the session with the<br>Terminal-Layer is addressed.                                                                                                                                                                          |
|                          | SessionIdentifier                                                                                                                                                                                                                                                |             | Identifier transmitted during return of the Wait<br>function.                                                                                                                                                                                   |
|                          | IFDEvent                                                                                                                                                                                                                                                         |             | IFDEvent MAY occur several times and<br>contains information about an event which<br>occurred on a card terminal. The parameter is of<br>the IFDStatusType (refer to page 18), and<br>contains the status information modified by the<br>event. |
| Return                   |                                                                                                                                                                                                                                                                  |             |                                                                                                                                                                                                                                                 |
|                          | Return of the SignalEvent function.                                                                                                                                                                                                                              |             |                                                                                                                                                                                                                                                 |
|                          |                                                                                                                                                                                                                                                                  |             |                                                                                                                                                                                                                                                 |
|                          | Name                                                                                                                                                                                                                                                             | Description |                                                                                                                                                                                                                                                 |

|                | dss:Result                                                                                                                                                  | Contains the status information and the errors of an<br>executed action. This element is described in more detail<br>below. |
|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|
|                |                                                                                                                                                             |                                                                                                                             |
|                |                                                                                                                                                             | Status information and errors in SignalEventResponse                                                                        |
|                | Name                                                                                                                                                        | Error codes                                                                                                                 |
|                | ResultMajor                                                                                                                                                 | •<br>/resultmajor#ok                                                                                                        |
|                |                                                                                                                                                             | •<br>/resultmajor#error                                                                                                     |
|                | ResultMinor                                                                                                                                                 | •<br>/resultminor/ifdl/common#timeoutError                                                                                  |
|                |                                                                                                                                                             | •<br>/<br>resultminor/ifdl/common#invalidContextHandl<br>e                                                                  |
|                |                                                                                                                                                             | •<br>/resultminor/ifdl/terminal#unknownIFD                                                                                  |
|                |                                                                                                                                                             | •<br>/resultminor/al/common#unknownError                                                                                    |
|                | ResultMessage                                                                                                                                               | MAY contain more detailed information on the error<br>which occurred if required.                                           |
| Preconditions  | Registration for events was performed on specific terminals by means of Wait,<br>whereby the respective callback address was specified.                     |                                                                                                                             |
| Postconditions | When SignalEvent is invoked, waiting for events on the specified card<br>terminals is terminated and as a result the session identifier loses its validity. |                                                                                                                             |
| Notes          | Also refer to Wait and Cancel.                                                                                                                              |                                                                                                                             |

## **References**

| [TR-03112-2] | BSI: TR-03112-2: eCard-API-Framework – Part 2: eCard-Interface                                                                             |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------------|
| [TR-03112-3] | BSI: TR-03112-3: eCard-API-Framework – Part 3: Management-Interface                                                                        |
| [TR-03112-4] | BSI: TR-03112-4: eCard-API-Framework – Part 4: ISO24727-3-Interface                                                                        |
| [TR-03112-5] | BSI: TR-03112-5: eCard-API Framework – Part 5: Suppor- Interface                                                                           |
| [TR-03112-6] | BSI: TR-03112-6: eCard-API-Framework – Part 6: IFD-Interface                                                                               |
| [TR-03112-7] | BSI: TR-03112-7: eCard-API-Framework – Part 7: Protocols                                                                                   |
| [TR-03119]   | BSI: TR-03119: Anforderungen an Chipkartenleser mit ePA-Unterstützung                                                                      |
| [RFC2119]    | IETF: RFC 2119: S. Bradner: Key words for use in RFCs to Indicate Requirement Levels                                                       |
| [ISO19784-1] | ISO: ISO/IEC 19784-1: Information technology — Biometric application programming<br>interface — Part 1: BioAPI specification               |
| [ISO24727-3] | ISO: ISO/IEC 24727-3: Identification Cards — Integrated Circuit Cards Programming<br>Interfaces — Part 3: Application Interface            |
| [ISO7816-15] | ISO: ISO/IEC 7816-15: Identification cards - Integrated circuit(s) cards with contacts —<br>Part 15: Cryptographic information application |
| [ISO7816-4]  | ISO: ISO/IEC 7816-4: Identification cards — Integrated circuit cards — Part<br>4:Organization, security and commands for interchange       |
| [PC/SC]      | PC/SC Workgroup: PC/SC Workgroup Specifications 1.0/2.0                                                                                    |
|              |                                                                                                                                            |