![](_page_0_Picture_0.jpeg)

![](_page_0_Picture_2.jpeg)

**Technische Richtlinie BSI TR-03144 Anhang**

### **eHealth –**

## **Sicherungsmechanismen im Umfeld der TR-Zertifizierung von G2-Karten-Produkten**

**Version 1.1 – 22.05.2015**

Bundesamt für Sicherheit in der Informationstechnik Postfach 20 03 63 53133 Bonn E-Mail: bsi@bsi.bund.de Internet: https://www.bsi.bund.de © Bundesamt für Sicherheit in der Informationstechnik 2015

| 1   | Einleitung4                                          |  |
|-----|------------------------------------------------------|--|
| 1.1 | Gegenstand, Zielsetzung und Übersicht des Dokuments4 |  |
| 1.2 | Einordnung des Dokuments4                            |  |
| 1.3 | Terminologie5                                        |  |
| 1.4 | Abkürzungen5                                         |  |
| 1.5 | Änderungshistorie6                                   |  |
| 2   | Rollenkonzept8                                       |  |
| 3   | Artefakte und ihre Sicherung10                       |  |
| 4   | Übersicht über die Signaturschlüsselpaare21          |  |
| 5   | Kryptographische Vorgaben23                          |  |
| 6   | Schlüsselverwaltung24                                |  |
|     | Literaturverzeichnis26                               |  |

| Tabelle 1: Änderungshistorie7                         |  |
|-------------------------------------------------------|--|
| Tabelle 2: Aufgaben und Aufgabenbeschreibung8         |  |
| Tabelle 3: Zuordnung von Rollen und ihren Aufgaben9   |  |
| Tabelle 4: Artefakte und ihre Sicherheitsziele11      |  |
| Tabelle 5: Artefakte und ihre Sicherungsmechanismen19 |  |
| Tabelle 6: Übersicht der Signaturschlüsselpaare22     |  |
|                                                       |  |

# <span id="page-3-0"></span>**1 Einleitung**

### **1.1 Gegenstand, Zielsetzung und Übersicht des Dokuments**

Im Rahmen der TR-Konformitätsprüfung von eHealth Karten-Produkten der Kartengeneration G2 nach der Technischen Richtlinie BSI TR-03144 ([TR-03144]) unter Verwendung des Konsistenz-Prüftools gemäß der Technischen Richtlinie BSI TR-03143 ([TR-03143]) werden aus Sicherheitsgründen heraus an verschiedenen Stellen Sicherungsmechanismen wie z.B. Signaturen verwendet. Das vorliegende Dokument betrachtet die hierzu erforderlichen Details, insbesondere hinsichtlich des Key Managements sowie hinsichtlich technischer und/oder organisatorischer Verfahren und Maßnahmen.

Berücksichtigt werden in den nachfolgenden Ausführungen nur die für die TR-Konformitätsprüfung eines Karten-Produktes nach der Technischen Richtlinie BSI TR-03144 ([TR-03144]) auf Seiten des Herstellers des Karten-Produktes, der TR-Prüfstelle für das betreffende Karten-Produkt, der CC-Prüfstelle für die dem Karten-Produkt unterliegende Karten-Plattform, der TR-Zertifizierungsstelle des BSI und der gematik für die Nutzung des Konsistenz-Prüftools der gematik grundsätzlich benötigten Artefakte. Nicht betrachtet werden die vom Hersteller des Karten-Produktes und der dem Karten-Produkt unterliegenden Karten-Plattform für die TR-Konformitätsprüfung des betreffenden Karten-Produktes beizusteuernden Hersteller-abhängigen Artefakte (wie z.B. das Karten-Produkt selbst, zugehörige Benutzerdokumentation zur Karten-Plattform und zum Karten-Produkt usw.) mit Ausnahme des Challenge/Fingerprint-Referenzwert-Paars der Karten-Plattform. Für diese Beistellungen des Herstellers des Karten-Produktes und der dem Karten-Produkt unterliegenden Karten-Plattform kommen in der Regel Hersteller-spezifische Sicherungsmechanismen, insbesondere für den Auslieferungsweg zum tragen, die außerhalb des Scopes des vorliegenden Dokuments liegen.

Der vorliegende Anhang zur Technischen Richtlinie BSI TR-03144 ([TR-03144]) richtet sich an TR-Prüfstellen, die die TR-Konformitätsprüfung von Karten-Produkten der Kartengeneration G2 im Rahmen des G2-Zertifizierungskonzepts wie in der Technischen Richtlinie BSI TR-03106 ([TR- -03106] dargestellt auf Basis der Technischen Richtlinie BSI TR-03144 ([TR-03144]) durchführen. Weiterhin richtet sich der vorliegende Anhang zur Technischen Richtlinie BSI TR-03144 ([TR- -03144] an Hersteller von Karten-Produkten der Generation G2, die ihre Karten-Produkte einer TR-Zertifizierung nach der Technischen Richtlinie BSI TR-03144 ([TR-03144]) im Rahmen des G2- Zertifizierungskonzepts mit dem Ziel einer Zulassung ihrer Karten-Produkte durch die gematik für einen Einsatz in der Telematikinfrastruktur im deutschen Gesundheitswesen unterziehen.

Das vorliegende Dokument beschreibt in Kap. [2](#page-7-0) das für die Ausgestaltung der oben genannten Sicherungsmechanismen vorgesehene Rollenkonzept. In Kap. [3](#page-9-0) werden die Artefakte und ihre Sicherung genauer beleuchtet. Kap. [4](#page-20-0) gibt eine Übersicht über die erforderlichen Signaturschlüsselpaare. In Kap. [5](#page-22-0) werden kryptographische Vorgaben zusammengestellt und in Kap. [6](#page-23-0) schließlich Informationen zur Schlüsselverwaltung bereitgestellt.

#### **1.2 Einordnung des Dokuments**

Das vorliegende Dokument bildet einen Anhang zur Technischen Richtlinie BSI TR-03144 ([TR- -03144], die die TR-Konformitätsprüfung und -Zertifizierung von eHealth Karten-Produkten der Kartengeneration G2 im Fokus hat.

Die Technische Richtlinie BSI TR-03144 ([TR-03144]) gliedert sich in das Zertifizierungskonzept für die eHealth-Karten der Kartengeneration G2 ein und ist als nachgelagerte Dokumentation zur

Technischen Richtlinie BSI TR-03106 "eHealth – Zertifizierungskonzept für Karten der Generation G2" ([TR-03106]), die eine detaillierte Beschreibung dieses Zertifizierungskonzepts für die G2- Karten beinhaltet, zu betrachten.

Die Technische Richtlinie BSI TR-03144 ([TR-03144]) referenziert weiterhin auf die Technische Richtlinie BSI TR-03143 "eHealth G2-COS Konsistenz-Prüftool" ([TR-03143]), die das für das G2-Zertifizierungskonzept bzw. für die TR-Konformitätsprüfung von Karten-Produkten nach der Technischen Richtlinie BSI TR-03144 ([TR-03144]) erforderliche Konsistenz-Prüftool der gematik spezifiziert sowie die TR-Zertifizierung dieses Konsistenz-Prüftools selbst regelt. Die TR-Zertifizierung eines Karten-Produktes, die Gegenstand der Technischen Richtlinie BSI TR-03144 ([TR- -03144] ist, macht von dem nach der Technischen Richtlinie BSI TR-03143 ([TR-03143]) zertifizierten Konsistenz-Prüftool der gematik wesentlich Gebrauch.

#### **1.3 Terminologie**

Dieser Anhang zur Technischen Richtlinie BSI TR-03144 ([TR-03144]) ist grundsätzlich als normativ anzusehen. Informative Teile werden explizit als solche gekennzeichnet (mit dem Vermerk "informativ" oder "Hinweis").

Ferner orientiert sich dieser Anhang zur Technischen Richtlinie BSI TR-03144 ([TR-03144]) an den dort vereinbarten Begrifflichkeiten und deren Beschreibungen.

#### **1.4 Abkürzungen**

In diesem Anhang zur Technischen Richtlinie BSI TR-03144 ([TR-03144]) sowie in den Dokumenten [TR-03106] und [TR-03143] werden folgende Abkürzungen verwendet:

| A      | Application                                         |
|--------|-----------------------------------------------------|
| ADF    | Application Dedicated File                          |
| ATR    | Answer To Reset                                     |
| BMG    | Bundesministerium für Gesundheit                    |
| BSI    | Bundesamt für Sicherheit in der Informationstechnik |
| CC     | Common Criteria                                     |
| CMS    | Card Management System                              |
| COS    | Card Operating System                               |
| DF     | Dedicated File                                      |
| EF     | Elementary File                                     |
| eGK    | elektronische Gesundheitskarte                      |
| FW     | Firmware                                            |
| G1     | eHealth Kartengeneration G1                         |
| G2     | eHealth Kartengeneration G2                         |
| G2-COS | G2 Card Operating System                            |
| gSMC-K | gerätespezifische Security Module Card Typ K        |

| gSMC-KT | gerätespezifische Security Module Card Typ KT     |
|---------|---------------------------------------------------|
| HBA     | Heilberufsausweis                                 |
| IC      | Integrated Circuit                                |
| PDF     | Portable Document Format                          |
| PGP     | Pretty Good Privacy                               |
| PIN     | Personal Identification Number                    |
| PKI     | Public Key Infrastructure                         |
| PP      | Protection Profile (Common Criteria)              |
| PT      | Prüftool                                          |
| PUK     | Personal Unblocking Key                           |
| QES     | Qualified Electronic Signature                    |
| RSA     | Rivest, Shamir, Adleman                           |
| SAK     | Signaturanwendungskomponente                      |
| SFR     | Security Functional Requirement (Common Criteria) |
| SGB     | Sozialgesetzbuch                                  |
| SHA     | Secure Hash Algorithm                             |
| SigG    | Signaturgesetz                                    |
| SigV    | Signaturverordnung                                |
| SMC-B   | Security Module Card Typ B                        |
| SSCD    | Secure Signature Creation Device                  |
| SSEE    | Sichere Signaturerstellungseinheit                |
| TI      | Telematikinfrastruktur                            |
| TOE     | Target Of Evaluation (Common Criteria)            |
| TR      | Technische Richtlinie                             |
| VSDD    | Versichertenstammdatendienst                      |
| XML     | Extensible Markup Language                        |
| ZDA     | Zertifizierungsdiensteanbieter                    |

### **1.5 Änderungshistorie**

| Version | Datum      | Änderung                                                                         |
|---------|------------|----------------------------------------------------------------------------------|
| v0.1    | 05.06.2014 | Erstausgabe                                                                      |
| v1.0    | 29.07.2014 | Veröffentlichung                                                                 |
| v1.1    | 22.05.2015 | Einzelne inhaltliche Ergänzungen und Klarstellungen in verschiedenen<br>Kapiteln |
|         |            |                                                                                  |

| Version | Datum | Änderung |
|---------|-------|----------|
|         |       |          |

Tabelle 1: Änderungshistorie

# <span id="page-7-0"></span>**2 Rollenkonzept**

Im Rahmen der TR-Konformitätsprüfung eines Karten-Produktes nach der Technischen Richtlinie BSI TR-03144 ([TR-03144]) unter Nutzung des Konsistenz-Prüftools werden grundsätzlich einige Artefakte benötigt, die aus Sicherheitsgründen heraus abzusichern sind. Siehe hierzu die genaueren Ausführungen in Kap. [3.](#page-9-0)

In der nachfolgenden Tabelle [2](#page-7-1) werden die für diese Absicherung der Artefakte anfallenden Aufgaben zusammengestellt und genauer beschrieben.

Notation: Der konkrete Inhalt der Beschreibung "Sicherung der ..." in der nachstehenden Tabelle [2](#page-7-1) wird in den folgenden Kapiteln genauer bestimmt und ausgeführt.

| Aufgabe                   | Aufgabenbeschreibung                                                                                                                                                                                                          |
|---------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| R_Prüftool-Code           | Sicherung der Implementierung des Konsistenz-Prüftools.                                                                                                                                                                       |
| R_Prüftool-Schemata       | Sicherung der zum Konsistenz-Prüftool zugehörigen XML-Schemata der<br>G2-COS-Spezifikation, der Challenge/Fingerprint-Referenzwert-Paare<br>und der Testberichte.                                                             |
| R_Prüftool-Dokumentation  | Sicherung der zum Konsistenz-Prüftool zugehörigen Dokumentation (Be<br>nutzerdokumentation usw.).                                                                                                                             |
| R_Prüftool-Konf-Dateien   | Sicherung der vom Konsistenz-Prüftool im Rahmen der Überprüfung ei<br>nes Karten-Produktes benötigten Konfigurationsdateien.                                                                                                  |
|                           | Hinweis: Diese gemäß den Vorgaben der Benutzerdokumentation zum<br>Konsistenz-Prüftool codierten Dateien enthalten jeweils eine Signatur<br>bzw. einen Signaturprüfschlüssel (siehe untenstehende Ausführungen in<br>Kap. 3). |
| R_Objektsys-Spezifikation | Sicherung der XML-Dateien der Objektsystem-Spezifikationen (XML<br>Master / XML-Derivat).                                                                                                                                     |
| R_Plattform-Fingerprint   | Sicherung der Challenge/Fingerprint-Referenzwert-Paare einer Karten<br>Plattform.                                                                                                                                             |
| R_Testbericht             | Sicherung des vom Konsistenz-Prüftool ausgegebenen Testberichts.                                                                                                                                                              |
| R_Schlüsseltabelle        | Verwaltung und Sicherung der Schlüsseltabelle mit den Signaturprüf<br>schlüsseln (siehe Kap. 6).                                                                                                                              |

<span id="page-7-1"></span>Tabelle 2: Aufgaben und Aufgabenbeschreibung

In der nachfolgenden Tabelle [3](#page-8-0) erfolgt eine Zuordnung der in die TR-Konformitätsprüfung eines Karten-Produktes nach der Technischen Richtlinie BSI TR-03144 ([TR-03144]) involvierten Rollen und der in Tabelle [2](#page-7-1) definierten Aufgaben.

| Rolle                            | Aufgaben      |
|----------------------------------|---------------|
| TR-Prüfstelle für Karten-Produkt | R_Testbericht |

#### BSI TR-03144 Anhang

| Rolle                              | Aufgaben                  |
|------------------------------------|---------------------------|
| CC-Prüfstelle für Karten-Plattform | R_Plattform-Fingerprint   |
| gematik                            | R_Prüftool-Code           |
|                                    | R_Prüftool-Schemata       |
|                                    | R_Prüftool-Dokumentation  |
|                                    | R_Prüftool-Konf-Dateien   |
|                                    | R_Objektsys-Spezifikation |
| TR-Zertifizierungsstelle (BSI)     | R_Schlüsseltabelle        |

<span id="page-8-0"></span>Tabelle 3: Zuordnung von Rollen und ihren Aufgaben

# <span id="page-9-0"></span>**3 Artefakte und ihre Sicherung**

In der nachfolgenden Tabelle [4](#page-10-0) werden die für die TR-Konformitätsprüfung eines Karten-Produktes nach der Technischen Richtlinie BSI TR-03144 ([TR-03144]) für die Nutzung des Konsistenz-Prüftools grundsätzlich benötigten Artefakte zusammengestellt. Für jedes Artefakt werden seine Sicherheitsziele definiert und Informationen zu seiner kryptographischen Sicherung angegeben.

In den nachfolgenden Ausführungen wird der Begriff "Konfigurationsdatei" für Dateien verwendet, die zur Übergabe von Signaturen und Signaturprüfschlüsseln an das Konsistenz-Prüftool benutzt werden. Formatierungsvorgaben für solche Konfigurationsdateien sind Gegenstand der zum Konsistenz-Prüftool zugehörigen Benutzerdokumentation.

| Artefakt                                                                                                                                               | Sicherheitsziel(e)           | Kryptographische<br>Sicherung                      | Art der Signatur              |  |
|--------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|----------------------------------------------------|-------------------------------|--|
| Konsistenz-Prüftool                                                                                                                                    |                              |                                                    |                               |  |
| Code / Dateien mit den Java-Bibliothe<br>ken des Konsistenz-Prüftools (inklusive<br>Java-Laufzeitumgebung)                                             | Integrität,<br>Authentizität | Signatur                                           | äußere technische<br>Signatur |  |
| XML-Schema der G2-COS-Spezifikati<br>on<br>(zugehörig zum Konsistenz-Prüftool)                                                                         | Integrität,<br>Authentizität | Signatur                                           | äußere technische<br>Signatur |  |
| XML-Schema der Challenge/Finger<br>print-Referenzwert-Paare<br>(zugehörig zum Konsistenz-Prüftool)                                                     | Integrität,<br>Authentizität | Signatur                                           | äußere technische<br>Signatur |  |
| XML-Schema der Testberichte<br>(zugehörig zum Konsistenz-Prüftool)                                                                                     | Integrität,<br>Authentizität | Signatur                                           | äußere technische<br>Signatur |  |
| Benutzerdokumentation zum Konsis<br>tenz-Prüftool                                                                                                      | Integrität,<br>Authentizität | Signatur (bei elek<br>tronischer Aus<br>lieferung) | äußere technische<br>Signatur |  |
| TR-Zertifikat und -Konformitätsreport<br>zum Konsistenz-Prüftool                                                                                       | Integrität,<br>Authentizität | ---                                                | ---                           |  |
| Inputquellen für das Konsistenz-Prüftool                                                                                                               |                              |                                                    |                               |  |
| Konfigurationsdatei mit der Signatur<br>über das Konsistenz-Prüftool (Code /<br>Dateien mit den Java-Bibliotheken in<br>klusive Java-Laufzeitumgebung) | Integrität,<br>Authentizität | ---                                                | ---                           |  |
| Konfigurationsdatei mit der Signatur<br>über das XML-Schema der G2-COS<br>Spezifikation                                                                | Integrität,<br>Authentizität | ---                                                | ---                           |  |
| Konfigurationsdatei mit der Signatur<br>über das XML-Schema der<br>Challenge/Fingerprint-Referenzwert                                                  | Integrität,<br>Authentizität | ---                                                | ---                           |  |

| Artefakt                                                                                                                                                                                                                  | Sicherheitsziel(e)                                    | Kryptographische<br>Sicherung | Art der Signatur              |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|-------------------------------|-------------------------------|
| Paare                                                                                                                                                                                                                     |                                                       |                               |                               |
| Konfigurationsdatei mit der Signatur<br>über das XML-Schema der Testberichte                                                                                                                                              | Integrität,<br>Authentizität                          | ---                           | ---                           |
| Konfigurationsdatei mit der Signatur<br>über die XML-Datei der Objektsystem<br>Spezifikation xy (XML-Master / XML<br>Derivat)<br>(xy = eGK/HBA/SMC-B/gSMC-K/<br>gSMC-KT/)                                                 | Integrität,<br>Authentizität                          | ---                           | ---                           |
| Konfigurationsdatei mit der Signatur<br>über das Challenge/Fingerprint<br>Referenzwert-Paar der Karten-Plattform                                                                                                          | Integrität,<br>Authentizität                          | ---                           | ---                           |
| Konfigurationsdatei mit dem Signatur<br>prüfschlüssel für die Prüfung der Signa<br>tur über die XML-Datei der Objektsys<br>tem-Spezifikation xy (XML-Master /<br>XML-Derivat)<br>(xy = eGK/HBA/SMC-B/gSMC-K/<br>gSMC-KT/) | Integrität,<br>Authentizität                          | ---                           | ---                           |
| Konfigurationsdatei mit dem Signatur<br>prüfschlüssel für die Prüfung der Signa<br>tur über das Challenge/<br>Fingerprint-Referenzwert-Paar der Kar<br>ten-Plattform                                                      | Integrität,<br>Authentizität                          | ---                           | ---                           |
| XML-Datei der Objektsystem-Spezifi<br>kation xy (XML-Master / XML-Deri<br>vat)<br>(xy = eGK/HBA/SMC-B/gSMC-K/<br>gSMC-KT/)                                                                                                | Integrität,<br>Authentizität                          | Signatur                      | äußere technische<br>Signatur |
| Challenge/Fingerprint-Referenzwert<br>Paar der Karten-Plattform                                                                                                                                                           | Integrität,<br>Authentizität,<br>Vertraulichkeit      | Signatur,<br>Verschlüsselung  | äußere technische<br>Signatur |
| Output des Konsistenz-Prüftools                                                                                                                                                                                           |                                                       |                               |                               |
| Testbericht                                                                                                                                                                                                               | Integrität,<br>Authentizität,<br>ggf. Vertraulichkeit | ---                           | ---                           |

#### <span id="page-10-0"></span>Tabelle 4: Artefakte und ihre Sicherheitsziele

In der nachfolgenden Tabelle [5](#page-18-0) werden die für die TR-Konformitätsprüfung eines Karten-Produktes nach der Technischen Richtlinie BSI TR-03144 ([TR-03144]) für die Nutzung des Konsistenz-Prüftools grundsätzlich benötigten Artefakte aus Tabelle [4](#page-10-0) genauer betrachtet und für jedes Artefakt geeignete Sicherungsmechanismen technischer und/oder organisatorischer Art angegeben.

Notation: Für die Bezeichnung von Typen von Signaturschlüsseln und Signaturprüfschlüsseln siehe (Übersichts-) Tabelle [6](#page-21-0) in Kap. [4.](#page-20-0)

| Artefakt                                                                                                         | Technische / Organisatorische Lö<br>sung                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Typ des Signatur<br>schlüssels | Speicherort des Si<br>gnaturprüf<br>schlüssels<br>(abgesehen von der Schlüs<br>seltabelle der TR-Zertifi<br>zierungsstelle des BSI, sie<br>he Kap. 6) |
|------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
| Konsistenz-Prüftool                                                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                |                                                                                                                                                       |
| Code / Dateien mit den<br>Java-Bibliotheken des<br>Konsistenz-Prüftools<br>(inklusive Java-Lauf<br>zeitumgebung) | Äußere technische Signatur über den<br>Code des Konsistenz-Prüftools.<br>Automatische Signaturprüfung im<br>Konsistenz-Prüftool selbst im Rah<br>men seines Selbsttests.                                                                                                                                                                                                                                                                                                                   | S_Prüftool-Code                | P_Prüftool-Code ist<br>im Konsistenz<br>Prüftool selbst hinter<br>legt                                                                                |
|                                                                                                                  | Für die automatische Signaturprü<br>fung ist ein vorhergehender Import<br>der zugehörigen Konfigurationsdatei<br>mit der zu prüfenden Signatur über<br>das Konsistenz-Prüftool in das Kon<br>sistenz-Prüftool erforderlich.                                                                                                                                                                                                                                                                |                                |                                                                                                                                                       |
|                                                                                                                  | Zusätzlich kann eine externe Signa<br>turprüfung (ohne Nutzung des Kon<br>sistenz-Prüftools) durchgeführt wer<br>den.                                                                                                                                                                                                                                                                                                                                                                      |                                |                                                                                                                                                       |
| XML-Schema der G2-<br>COS-Spezifikation<br>(zugehörig zum Konsis<br>tenz-Prüftool)                               | Äußere technische Signatur über das<br>XML-Schema.<br>Automatische Signaturprüfung im<br>Konsistenz-Prüftool selbst.<br>Für die automatische Signaturprü<br>fung ist ein vorhergehender Import<br>des XML-Schemas und der zugehö<br>rigen Konfigurationsdatei mit der zu<br>prüfenden Signatur über das XML<br>Schema in das Konsistenz-Prüftool<br>erforderlich.<br>Zusätzlich kann eine externe Signa<br>turprüfung (ohne Nutzung des Kon<br>sistenz-Prüftools) durchgeführt wer<br>den. | S_Prüftool-Schema              | P_Prüftool-Schema<br>ist im Konsistenz<br>Prüftool selbst hinter<br>legt                                                                              |
| XML-Schema der Chal<br>lenge/Fingerprint<br>Referenzwert-Paare<br>(zugehörig zum Konsis<br>tenz-Prüftool)        | Äußere technische Signatur über das<br>XML-Schema.<br>Automatische Signaturprüfung im<br>Konsistenz-Prüftool selbst.<br>Für die automatische Signaturprü<br>fung ist ein vorhergehender Import<br>des XML-Schemas und der zugehö<br>rigen Konfigurationsdatei mit der zu<br>prüfenden Signatur über das XML                                                                                                                                                                                | S_Prüftool-Schema              | P_Prüftool-Schema<br>ist im Konsistenz<br>Prüftool selbst hinter<br>legt                                                                              |

| Artefakt                                                                                                                                                | Technische / Organisatorische Lö<br>sung                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Typ des Signatur<br>schlüssels | Speicherort des Si<br>gnaturprüf<br>schlüssels<br>(abgesehen von der Schlüs<br>seltabelle der TR-Zertifi<br>zierungsstelle des BSI, sie<br>he Kap. 6) |
|---------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                                                                                                                                         | Schema in das Konsistenz-Prüftool<br>erforderlich.<br>Zusätzlich kann eine externe Signa<br>turprüfung (ohne Nutzung des Kon<br>sistenz-Prüftools) durchgeführt wer<br>den.                                                                                                                                                                                                                                                                                                                |                                |                                                                                                                                                       |
| XML-Schema der Test<br>berichte<br>(zugehörig zum Konsis<br>tenz-Prüftool)                                                                              | Äußere technische Signatur über das<br>XML-Schema.<br>Automatische Signaturprüfung im<br>Konsistenz-Prüftool selbst.<br>Für die automatische Signaturprü<br>fung ist ein vorhergehender Import<br>des XML-Schemas und der zugehö<br>rigen Konfigurationsdatei mit der zu<br>prüfenden Signatur über das XML<br>Schema in das Konsistenz-Prüftool<br>erforderlich.<br>Zusätzlich kann eine externe Signa<br>turprüfung (ohne Nutzung des Kon<br>sistenz-Prüftools) durchgeführt wer<br>den. | S_Prüftool-Schema              | P_Prüftool-Schema<br>ist im Konsistenz<br>Prüftool selbst hinter<br>legt                                                                              |
| Benutzerdokumentation<br>zum Konsistenz<br>Prüftool                                                                                                     | Integre/authentische Auslieferung<br>der Dokumentation durch die gema<br>tik in Papierform oder in elektroni<br>scher Form.<br>Äußere Signatur über die Dokumen<br>tation im Falle einer elektronischen<br>Auslieferung.                                                                                                                                                                                                                                                                   | (S_Prüftool-Dok)               | ---                                                                                                                                                   |
| TR-Zertifikat und -Kon<br>formitätsreport zum<br>Konsistenz<br>Prüftool                                                                                 | Bezug von den Webseiten des BSI<br>oder sonstige integre/authentische<br>Auslieferung einer Kopie des Origi<br>nals.                                                                                                                                                                                                                                                                                                                                                                       | ---                            | ---                                                                                                                                                   |
| Inputquellen für das Konsistenz-Prüftool                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                |                                                                                                                                                       |
| Konfigurationsdatei mit<br>der Signatur über das<br>Konsistenz-Prüftool<br>(Code / Dateien mit den<br>Java-Bibliotheken inklu<br>sive Java-Laufzeitumge | Im Konsistenz-Prüftool erfolgt unter<br>Verwendung des im Konsistenz<br>Prüftool hinterlegten Signaturprüf<br>schlüssels P_Prüftool-Code eine<br>Prüfung der in der Konfigurations<br>datei enthaltenen Signatur über das                                                                                                                                                                                                                                                                  | ---                            | ---                                                                                                                                                   |

| Artefakt                                                                                                           | Technische / Organisatorische Lö<br>sung                                                                                                                                                                                                                                                                                                                                                                                                                                             | Typ des Signatur<br>schlüssels | Speicherort des Si<br>gnaturprüf<br>schlüssels<br>(abgesehen von der Schlüs<br>seltabelle der TR-Zertifi<br>zierungsstelle des BSI, sie<br>he Kap. 6) |
|--------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
| bung)                                                                                                              | Konsistenz-Prüftool.<br>Für die Signaturprüfung ist ein vor<br>hergehender Import der Konfigura<br>tionsdatei in das Konsistenz-Prüftool<br>erforderlich.<br>Auf eine kryptographische Siche<br>rung der Konfigurationsdatei selbst<br>kann verzichtet werden.                                                                                                                                                                                                                       |                                |                                                                                                                                                       |
| Konfigurationsdatei mit<br>der Signatur über das<br>XML-Schema der G2-<br>COS-Spezifikation                        | Im Konsistenz-Prüftool erfolgt unter<br>Verwendung des im Konsistenz<br>Prüftool hinterlegten Signaturprüf<br>schlüssels P_Prüftool-Schema eine<br>Prüfung der in der Konfigurations<br>datei enthaltenen Signatur über das<br>XML-Schema.<br>Für die Signaturprüfung ist ein vor<br>hergehender Import der Konfigura<br>tionsdatei in das Konsistenz-Prüftool<br>erforderlich.<br>Auf eine kryptographische Siche<br>rung der Konfigurationsdatei selbst<br>kann verzichtet werden. | ---                            | ---                                                                                                                                                   |
| Konfigurationsdatei mit<br>der Signatur über das<br>XML-Schema der Chal<br>lenge/Fingerprint<br>Referenzwert-Paare | Im Konsistenz-Prüftool erfolgt unter<br>Verwendung des im Konsistenz<br>Prüftool hinterlegten Signaturprüf<br>schlüssels P_Prüftool-Schema eine<br>Prüfung der in der Konfigurations<br>datei enthaltenen Signatur über das<br>XML-Schema.<br>Für die Signaturprüfung ist ein vor<br>hergehender Import der Konfigura<br>tionsdatei in das Konsistenz-Prüftool<br>erforderlich.<br>Auf eine kryptographische Siche<br>rung der Konfigurationsdatei selbst<br>kann verzichtet werden. | ---                            | ---                                                                                                                                                   |
| Konfigurationsdatei mit<br>der Signatur über das<br>XML-Schema der Test<br>berichte                                | Im Konsistenz-Prüftool erfolgt unter<br>Verwendung des im Konsistenz<br>Prüftool hinterlegten Signaturprüf<br>schlüssels P_Prüftool-Schema eine<br>Prüfung der in der Konfigurations-                                                                                                                                                                                                                                                                                                | ---                            | ---                                                                                                                                                   |

| Artefakt                                                                                                                                                                             | Technische / Organisatorische Lö<br>sung                                                                                                                                                                                                                                                                                                                        | Typ des Signatur<br>schlüssels | Speicherort des Si<br>gnaturprüf<br>schlüssels<br>(abgesehen von der Schlüs |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|-----------------------------------------------------------------------------|
|                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                 |                                | seltabelle der TR-Zertifi<br>zierungsstelle des BSI, sie<br>he Kap. 6)      |
|                                                                                                                                                                                      | datei enthaltenen Signatur über das<br>XML-Schema.                                                                                                                                                                                                                                                                                                              |                                |                                                                             |
|                                                                                                                                                                                      | Für die Signaturprüfung ist ein vor<br>hergehender Import der Konfigura<br>tionsdatei in das Konsistenz-Prüftool<br>erforderlich.                                                                                                                                                                                                                               |                                |                                                                             |
|                                                                                                                                                                                      | Auf eine kryptographische Siche<br>rung der Konfigurationsdatei selbst<br>kann verzichtet werden.                                                                                                                                                                                                                                                               |                                |                                                                             |
| Konfigurationsdatei mit<br>der Signatur über die<br>XML-Datei der Objekt<br>system-Spezifikation xy<br>(XML-Master / XML<br>Derivat)<br>(xy = eGK/HBA/<br>SMC-B/gSMC-K/<br>gSMC-KT/) | Im Konsistenz-Prüftool erfolgt unter<br>Verwendung des in das Konsistenz<br>Prüftool importierten Signaturprüf<br>schlüssels P_Objektsys-Spez (Im<br>port mittels seiner zugehörigen Kon<br>figurationsdatei, siehe unten) eine<br>Prüfung der in der Konfigurations<br>datei enthaltenen Signatur über die<br>XML-Datei der Objektsystem-Spe<br>zifikation xy. | ---                            | ---                                                                         |
|                                                                                                                                                                                      | Für die Signaturprüfung ist ein vor<br>hergehender Import der Konfigura<br>tionsdatei in das Konsistenz-Prüftool<br>erforderlich.                                                                                                                                                                                                                               |                                |                                                                             |
|                                                                                                                                                                                      | Auf eine kryptographische Siche<br>rung der Konfigurationsdatei selbst<br>kann verzichtet werden.                                                                                                                                                                                                                                                               |                                |                                                                             |
| Konfigurationsdatei mit<br>der Signatur über das<br>Challenge/Fingerprint<br>Referenzwert-Paar der<br>Karten-Plattform                                                               | Im Konsistenz-Prüftool erfolgt unter<br>Verwendung des in das Konsistenz<br>Prüftool importierten Signaturprüf<br>schlüssels P_Plattform-FP (Import<br>mittels seiner zugehörigen Konfigu<br>rationsdatei, siehe unten) eine Prü<br>fung der in der Konfigurationsdatei<br>enthaltenen Signatur über das Chal<br>lenge/<br>Fingerprint-Referenzwert-Paar.       | ---                            | ---                                                                         |
|                                                                                                                                                                                      | Für die Signaturprüfung ist ein vor<br>hergehender Import der Konfigura<br>tionsdatei in das Konsistenz-Prüftool<br>erforderlich.                                                                                                                                                                                                                               |                                |                                                                             |
|                                                                                                                                                                                      | Auf eine kryptographische Siche<br>rung der Konfigurationsdatei selbst                                                                                                                                                                                                                                                                                          |                                |                                                                             |

| Artefakt                                                                                                                                                                                                     | Technische / Organisatorische Lö<br>sung                                                                                                                                                                                                                                                                                                                  | Typ des Signatur<br>schlüssels | Speicherort des Si<br>gnaturprüf<br>schlüssels<br>(abgesehen von der Schlüs<br>seltabelle der TR-Zertifi<br>zierungsstelle des BSI, sie<br>he Kap. 6) |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                                                                                                                                                                                              | kann verzichtet werden.                                                                                                                                                                                                                                                                                                                                   |                                |                                                                                                                                                       |
| Konfigurationsdatei mit<br>dem Signaturprüf<br>schlüssel für die Prü<br>fung der Signatur über<br>die XML-Datei der Ob<br>jektsystem-Spezifi<br>kation xy<br>(XML-Master / XML<br>Derivat)<br>(xy = eGK/HBA/ | Außerhalb des Konsistenz-Prüftools<br>erfolgt eine Überprüfung der Integri<br>tät/Authentizität der Konfigurations<br>datei bzw. des darin enthaltenen Si<br>gnaturprüfschlüssels P_Objektsys<br>Spez gegen die mit S_Schlüsselta<br>belle signierte Schlüsseltabelle von<br>Signaturprüfschlüsseln (siehe Kap.<br>6).<br>Auf eine kryptographische Siche | ---                            | ---                                                                                                                                                   |
| SMC-B/gSMC-K/<br>gSMC-KT/)                                                                                                                                                                                   | rung der Konfigurationsdatei selbst<br>kann verzichtet werden.                                                                                                                                                                                                                                                                                            |                                |                                                                                                                                                       |
|                                                                                                                                                                                                              | Es erfolgt ein Import der Konfigura<br>tionsdatei in das Konsistenz-Prüf<br>tool, damit der enthaltene Signatur<br>prüfschlüssel P_Objektsys-Spez im<br>Konsistenz<br>Prüftool zur weiteren Verwendung<br>zur Verfügung steht.                                                                                                                            |                                |                                                                                                                                                       |
| Konfigurationsdatei mit<br>dem Signaturprüf<br>schlüssel für die Prü<br>fung der Signatur über<br>das Challenge/<br>Fingerprint-Referenz<br>wert-Paar der Karten<br>Plattform                                | Außerhalb des Konsistenz-Prüftools<br>erfolgt eine Überprüfung der Integri<br>tät/Authentizität der Konfigurations<br>datei bzw. des darin enthaltenen Si<br>gnaturprüfschlüssels P_Plattform-FP<br>gegen die mit S_Schlüsseltabelle si<br>gnierte Schlüsseltabelle von Signa<br>turprüfschlüsseln (siehe Kap. 6).                                        | ---                            | ---                                                                                                                                                   |
|                                                                                                                                                                                                              | Auf eine kryptographische Siche<br>rung der Konfigurationsdatei selbst<br>kann verzichtet werden.                                                                                                                                                                                                                                                         |                                |                                                                                                                                                       |
|                                                                                                                                                                                                              | Es erfolgt ein Import der Konfigura<br>tionsdatei in das Konsistenz-Prüf<br>tool, damit der enthaltene Signatur<br>prüfschlüssel P_Plattform-FP im<br>Konsistenz<br>Prüftool zur weiteren Verwendung<br>zur Verfügung steht.                                                                                                                              |                                |                                                                                                                                                       |
| XML-Datei der Objekt<br>system-Spezifikation xy<br>(XML-Master / XML<br>Derivat)                                                                                                                             | Äußere Signatur der XML-Datei.<br>Im Konsistenz-Prüftool erfolgt unter<br>Verwendung des Signaturprüf                                                                                                                                                                                                                                                     | S_Objektsys-Spez               | Konfigurationsdatei<br>mit dem Signatur<br>prüfschlüssel P_Ob<br>jektsys-Spez                                                                         |

| Artefakt                                                               | Technische / Organisatorische Lö<br>sung                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Typ des Signatur<br>schlüssels | Speicherort des Si<br>gnaturprüf<br>schlüssels<br>(abgesehen von der Schlüs<br>seltabelle der TR-Zertifi<br>zierungsstelle des BSI, sie<br>he Kap. 6) |
|------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
| (xy = eGK/HBA/<br>SMC-B/gSMC-K/<br>gSMC-KT/)                           | schlüssels P_Objektsys-Spez eine<br>Prüfung der Signatur über die XML<br>Datei der Objektsystem-Spezifikati<br>on xy.<br>Für die Signaturprüfung ist ein vor<br>hergehender Import der zugehörigen<br>Konfigurationsdatei mit dem Signa<br>turprüfschlüssel P_Objektsys-Spez<br>in das Konsistenz-Prüftool erforder<br>lich.                                                                                                                                                                 |                                |                                                                                                                                                       |
| Challenge/Fingerprint<br>Referenzwert<br>Paar der Karten-Platt<br>form | Die vertrauliche Übermittlung des<br>signierten Challenge/Fingerprint<br>Referenzwert-Paars vom Hersteller<br>der dem Karten-Produkt unterliegen<br>den Karten-Plattform an die TR<br>Prüfstelle für das betreffende Kar<br>ten-Produkt erfolgt verschlüsselt.<br>Das erforderliche Schlüsselmaterial<br>zur Verschlüsselung des Datenaus<br>tausches ist vorab gesichert zwi<br>schen dem Hersteller der Karten<br>Plattform und der TR-Prüfstelle für<br>das Karten-Produkt auszutauschen. | S_Plattform-FP                 | Konfigurationsdatei<br>mit dem Signatur<br>prüfschlüssel P_Platt<br>form-FP                                                                           |
|                                                                        | Für den Hersteller der Karten-Platt<br>form und die TR-Prüfstelle für das<br>Karten-Produkt wird von einer aus<br>reichend gesicherten Umgebung<br>ausgegangen, so dass ein dort im<br>Klartext vorliegendes Challenge/<br>Fingerprint-Referenzwert-Paar aus<br>reichend gesichert behandelt wird.                                                                                                                                                                                           |                                |                                                                                                                                                       |
|                                                                        | Hinweis: Das Konsistenz-Prüftool<br>benötigt für die Weiterverwendung<br>des Challenge/Fingerprint-Refe<br>renzwert-Paars dieses im Klartext,<br>da das Konsistenz-Prüftool selbst<br>keine Entschlüsselungsfunktion be<br>reitstellt.                                                                                                                                                                                                                                                       |                                |                                                                                                                                                       |
|                                                                        | Äußere Signatur des Challenge/<br>Fingerprint-Referenzwert-Paars.<br>Im Konsistenz-Prüftool erfolgt unter<br>Verwendung des Signaturprüf<br>schlüssels P_Plattform-FP eine Prü                                                                                                                                                                                                                                                                                                               |                                |                                                                                                                                                       |

| Artefakt                        | Technische / Organisatorische Lö<br>sung                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Typ des Signatur<br>schlüssels | Speicherort des Si<br>gnaturprüf<br>schlüssels<br>(abgesehen von der Schlüs<br>seltabelle der TR-Zertifi<br>zierungsstelle des BSI, sie<br>he Kap. 6) |
|---------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                 | fung der Signatur über das Challen<br>ge/Fingerprint-Referenzwert-Paar.<br>Für die Signaturprüfung ist ein vor<br>hergehender Import der zugehörigen<br>Konfigurationsdatei mit dem Signa<br>turprüfschlüssel P_Plattform-FP in<br>das Konsistenz-Prüftool erforder<br>lich.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                |                                                                                                                                                       |
| Output des Konsistenz-Prüftools |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                |                                                                                                                                                       |
| Testbericht                     | Es wird auf eine kryptographische<br>Sicherung durch das Konsistenz<br>Prüftool selbst verzichtet.<br>Es steht der TR-Prüfstelle für das<br>betreffende Karten-Produkt aber<br>frei, zusätzlich selbst eine krypto<br>graphische Sicherung an den Testbe<br>richt (z.B. in Form einer Signatur<br>und/oder Verschlüsselung) anzubrin<br>gen. In diesem Fall obliegt es der<br>TR-Prüfstelle, zugehöriges Schlüs<br>selmaterial (z.B. für die Prüfung der<br>Signatur und/oder die Entschlüsse<br>lung) gesichert mit der den Testbe<br>richt nutzenden Stelle auszutau<br>schen.<br>Der vom Konsistenz-Prüftool ausge<br>gebene Testbericht wird dem TR<br>Prüfbericht der TR-Prüfstelle für das<br>betreffende Karten-Produkt beige<br>fügt. Dieser TR-Prüfbericht wird<br>insgesamt von der TR-Prüfstelle in<br>Papierform unterschrieben und der<br>TR-Zertifizierungsstelle des BSI<br>übermittelt. | ---                            | ---                                                                                                                                                   |

<span id="page-18-0"></span>Tabelle 5: Artefakte und ihre Sicherungsmechanismen

Hinweis:

Die Signaturen über die XML-Schemata für die G2-COS-Spezifikation, Challenge/Fingerprint-Referenzwert-Paare und Testberichte sowie die Signaturen über die XML-Dateien der Objektsystem-Spezifikationen (XML-Master / XML-Derivat) sind *nicht* Bestandteil der zuvor genannten XML-Strukturen. Diese Signaturen werden jeweils als äußere Signaturen an die XML-Schemata bzw. XML-Dateien angebracht. Hintergrund hierfür ist, dass XML-Signaturen für XML-Schemata nach dem standardisierten XML-Signatur-Verfahren nicht möglich sind. Um eine einheitliche Implementierung der Signaturprüfung im Konsistenz-Prüftool zu erreichen, wird auch für XML-Dateien entsprechend mit einer äußeren Signatur gearbeitet. Weiterer Vorteil äußerer Signaturen im vorliegenden Fall ist die größere Flexibilität bzgl. der Auswahl kryptographischer Verfahren.

# <span id="page-20-0"></span>**4 Übersicht über die Signaturschlüsselpaare**

In der nachfolgenden Tabelle [6](#page-21-0) wird eine Übersicht über die benötigten Typen von Signaturschlüsselpaaren (bzw. Signaturschlüsseln und zugehörigen Signaturprüfschlüsseln), deren Verwendungszweck und deren Inhaber bzw. Nutzer gegeben. Siehe hierzu auch Kap. [3.](#page-9-0)

Notation: In der letzten Tabellenspalte werden nur diejenigen Stellen benannt, die mindestens den betreffenden Signaturprüfschlüssel (direkt oder indirekt, z.B. bei Nutzung des Konsistenz-Prüftools) verwenden.

| Signaturschlüsselpaar<br>(Signaturschlüssel /<br>Signaturprüfschlüssel) | Verwendungszweck des<br>Signaturschlüssels                                                                                                                                         | Generierende Stelle /<br>Inhaber des Signa<br>turschlüssel<br>paars | Verwendende Stelle des Si<br>gnaturprüfschlüssels                                                                                                                                                                                             |
|-------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| S_Prüftool-Code /<br>P_Prüftool-Code                                    | Signatur über die Imple<br>mentierung des Konsistenz<br>Prüftools                                                                                                                  | gematik                                                             | •<br>TR-Zertifizierungsstelle<br>(BSI)<br>•<br>TR-Prüfstellen für Kar<br>ten-Produkte<br>Hinweis:<br>Der Signaturprüfschlüssel P_<br>Prüftool-Code ist im Konsis<br>tenz-Prüftool enthalten.                                                  |
| S_Prüftool-Schema /<br>P_Prüftool-Schema                                | Signatur über die zum Kon<br>sistenz-Prüftool zu<br>gehörigen XML-Schemata<br>der G2-COS-Spezifikation,<br>der Challenge/Fingerprint<br>Referenzwert-Paare und der<br>Testberichte | gematik                                                             | •<br>TR-Zertifizierungsstelle<br>(BSI)<br>•<br>TR-Prüfstellen für Kar<br>ten-Produkte<br>Hinweis:<br>Der Signaturprüfschlüssel P_<br>Prüftool-Schema ist im Kon<br>sistenz-Prüftool enthalten.                                                |
| S_Prüftool-Dok<br>/P_Prüftool-Dok                                       | Signatur der Benutzerdoku<br>mentation zum Konsistenz<br>Prüftool (sofern elektro<br>nisch Auslieferung vorgese<br>hen)                                                            | gematik                                                             | •<br>TR-Zertifizierungsstelle<br>(BSI)<br>•<br>TR-Prüfstellen für Kar<br>ten-Produkte                                                                                                                                                         |
| S_Objektsys-Spez /<br>P_Objektsys-Spez                                  | Signatur über die XML<br>Dateien der Objektsystem<br>Spezifikationen (XML<br>Master / XML-Derivat)                                                                                 | gematik                                                             | •<br>TR-Zertifizierungsstelle<br>(BSI)<br>•<br>TR-Prüfstellen für Kar<br>ten-Produkte<br>Hinweis:<br>Der Signaturprüfschlüssel<br>P_Objektsys-Spez ist in der<br>zur Objektsystem<br>Spezifikation zugehörigen<br>Konfigurationsdatei für das |

| Signaturschlüsselpaar<br>(Signaturschlüssel /<br>Signaturprüfschlüssel) | Verwendungszweck des<br>Signaturschlüssels                                                 | Generierende Stelle /<br>Inhaber des Signa<br>turschlüssel<br>paars                              | Verwendende Stelle des Si<br>gnaturprüfschlüssels                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|-------------------------------------------------------------------------|--------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                                                         |                                                                                            |                                                                                                  | Konsistenz-Prüftool enthal<br>ten.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| S_Plattform-FP /<br>P_Plattform-FP                                      | Signatur über das Challen<br>ge/Fingerprint<br>Referenzwert-Paar einer<br>Karten-Plattform | CC-Prüfstelle der<br>(dem betreffenden<br>Karten-Produkt unter<br>liegenden) Karten<br>Plattform | •<br>TR-Zertifizierungsstelle<br>(BSI)<br>•<br>TR-Prüfstellen für Kar<br>ten-Produkte, die auf der<br>betreffenden Karten-Platt<br>form aufsetzen<br>•<br>gematik<br>(zur Verwendung im Rah<br>men von weiteren Prüf<br>oder Zulassungsprozes<br>sen/-verfahren für Karten<br>Plattformen und Karten<br>Produkte, die außerhalb<br>der TR-Konformitätsprü<br>fung von Karten-Produk<br>ten nach der Technischen<br>Richtlinie BSI TR-03144<br>([TR-03144]) liegen)<br>Hinweis:<br>Der Signaturprüfschlüssel<br>P_Plattform-FP ist in der<br>zum Challenge/Fingerprint<br>Referenzwert-Paar zugehöri<br>gen Konfigurationsdatei für<br>das Konsistenz<br>Prüftool enthalten. |
| S_Schlüsseltabelle /<br>P_Schlüsseltabelle                              | Signatur über die Schlüssel<br>tabelle mit den Signatur<br>prüfschlüsseln                  | TR-Zertifizierungs<br>stelle (BSI)                                                               | •<br>gematik<br>•<br>TR-Prüfstellen für Kar<br>ten-Produkte                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |

<span id="page-21-0"></span>Tabelle 6: Übersicht der Signaturschlüsselpaare

Es besteht die Möglichkeit, die Signaturschlüsselpaare

- (S\_Prüftool-Code, P\_Prüftool-Code),
- (S\_Prüftool-Schema, P\_Prüftool-Schema),
- (S\_Prüftool-Dok, P\_Prüftool-Dok) und
- (S\_Objektsys-Spez, P\_Objektsys-Spez)

zusammenzufassen, also durch ein einziges Schlüsselpaar zu repräsentieren.

Für die sichere (d.h. integre und authentische) Auslieferung der Signaturprüfschlüssel ist der jeweilige Inhaber des zugehörigen Signaturschlüsselpaars verantwortlich.

# <span id="page-22-0"></span>**5 Kryptographische Vorgaben**

Für die in Kap. [3](#page-9-0) genannten Signaturen soll RSA mit einer Schlüssellänge von mindestens 2048 Bit mit SHA-256 (mit einem ausreichend sicheren Signatur-/Paddingverfahren) verwendet werden.

Für die Erzeugung von Signaturen (siehe Kap. [3\)](#page-9-0) soll (zunächst) eine PGP-Implementierung, die konform zur standardisierten Version OpenPGP gemäß [RFC 4880] ist, eingesetzt werden.

Die Generierung der Signaturschlüsselpaare soll ebenfalls durch eine solche PGP-Implementierung erfolgen. Die PGP-Signaturschlüsselpaare werden dabei in einem zu [RFC 4880] konformen PGP-Format angelegt; das Feld userID ist dabei mit dem Namen der Organisation, der der Inhaber des Signaturschlüsselpaars angehört, zu füllen. Für weitere Details hierzu sei auf die Benutzerdokumentation zum Konsistenz-Prüftool verwiesen.

Die für die Generierung eines Signaturschlüsselpaars (und für die Erzeugung von Signaturen) eingesetzte PGP-Implementierung soll weiterhin für den Signaturprüfschlüssel die Erstellung und Ausgabe eines PGP-Fingerprints ermöglichen, der in der Schlüsseltabelle mit den Signaturprüfschlüsseln (siehe Kap. [6\)](#page-23-0) hinterlegt wird.

Hinweis:

Zukünftig ist vorgesehen, die PGP-Lösung durch eine andere, PKI-basierte Lösung, die sich an den Vorgaben der Technischen Richtlinie BSI TR-03116-1 ([TR-03116-1]) orientiert, zu ersetzen.

# <span id="page-23-0"></span>**6 Schlüsselverwaltung**

Zwecks Schlüsselverwaltung wird eine Schlüsseltabelle mit den im Rahmen von TR-Konformitätsprüfungen von Karten-Produkten nach der Technischen Richtlinie BSI TR-03144 ([TR-03144]) verwendeten Signaturprüfschlüsseln (siehe auch Kap. [4\)](#page-20-0) aufgesetzt und verwaltet.

Die Schlüsseltabelle liefert eine Übersicht über die verwendeten Signaturprüfschlüssel und stellt für jeden eingetragenen Signaturprüfschlüssel folgende Informationen bereit:

• Name und Anschrift der Stelle, der der Inhaber des zugehörigen Signaturschlüsselpaars angehört.

Als Stelle kommt zur Auswahl:

CC-Prüfstelle für Karten-Plattform, gematik, TR-Zertifizierungsstelle (BSI).

- Name des Inhabers des zugehörigen Signaturschlüsselpaars.
- Schlüssel-ID des Signaturprüfschlüssels.
- Typ des Signaturprüfschlüssels.

Als Typ des Signaturprüfschlüssels kommt zur Auswahl:

P\_Prüftool-Code, P\_Prüftool-Schema, P\_Prüftool-Dok, P\_Objektsys-Spez, P\_Plattform-FP, P\_Schlüsseltabelle.

- Laufzeit (insbesondere Ablaufdatum) des zugehörigen Signaturschlüsselpaars.
- PGP-Fingerprint des Signaturprüfschlüssels.

Es empfiehlt sich, für einen Signaturprüfschlüssel bzw. ein Signaturschlüsselpaar eine geignete Vertreterregelung einzurichten bzw. pro Stelle mehrere Signaturschlüsselpaare bzw. Signaturprüfschlüssel vorzusehen.

Die Schlüsseltabelle enthält insbesondere den (bzw. die) Signaturprüfschlüssel der TR-Zertifizierungsstelle des BSI vom Typ P\_Schlüsseltabelle.

Die Ausgestaltung und Verwaltung der Schlüsseltabelle erfolgt durch die TR-Zertifizierungsstelle des BSI. Die betreffenden Stellen haben hierzu der TR-Zertifizierungsstelle des BSI ihre Signaturprüfschlüssel sowie die benötigten weiteren Informationen zu ihren Schlüsseln in integrer und authentischer Weise bereitzustellen. Die Vergabe der Schlüssel-ID für einen Signaturprüfschlüssel erfolgt durch die TR-Zertifizierungsstelle des BSI. Die Schlüsseltabelle unterliegt einer Versionierung und wird mit Versionsnummer und Datum versehen.

Die Schlüsseltabelle kann von den betreffenden Stellen für Zwecke der TR-Konformitätsprüfung von Karten-Produkten nach der Technischen Richtlinie BSI TR-03144 ([TR-03144]) (und für Zwecke weitergehender Prüf- und Zulassungsprozesse und -verfahren von Karten-Plattformen und Karten-Produkten auf Seiten der gematik, die außerhalb der vorgenannten TR-Konformitätsprüfung von Karten-Produkten liegen) von der TR-Zertifizierungsstelle des BSI bezogen werden.

Hinweis: Je nach Erfordernis kann die Schlüsseltabelle auch an CC-Prüfstellen weitergegeben werden, die für die Bestätigung eines Karten-Produktes nach SigG/SigV vom Konsistenz-Prüftool Gebrauch machen wollen.

Für eine integre und authentische Auslieferung der Schlüsseltabelle wird diese von der TR-Zertifizierungsstelle des BSI unter Verwendung eines Signaturschlüssels vom Typ S\_Schlüsseltabelle signiert und zusammen mit ihrer Signatur ausgeliefert. Der für die Prüfung der Signatur über die

Schlüsseltabelle relevante Signaturprüfschlüssel wird mit seiner Schlüssel-ID in der Schlüsseltabelle ausgewiesen. (Hinweis: Auf eine Signatur eines jeden einzelnen in der Schlüsseltabelle eingetragenen Signaturprüfschlüssels durch die TR-Zertifizierungsstelle des BSI kann (und soll aus Effizienzgründen) verzichtet werden, da eine Signatur über die Schlüsseltabelle, die insbesondere für jeden eingetragenen Signaturprüfschlüssel seinen PGP-Fingerprint beinhaltet, als ausreichend zu erachten ist.)

## <span id="page-25-0"></span>**Literaturverzeichnis**

- [TR-03106] BSI TR-03106 eHealth Zertifizierungskonzept für Karten der Generation G2, aktuelle Fassung, BSI
- [TR-03143] BSI TR-03143 eHealth G2-COS Konsistenz-Prüftool, aktuelle Fassung, BSI
- [TR-03144] BSI TR-03144 eHealth Konformitätsnachweis für Karten-Produkte der Kartengeneration G2, aktuelle Fassung, BSI
- [TR-03116-1] BSI TR-03116-1 Kryptographische Vorgaben für Projekte der Bundesregierung, Teil 1: Telematikinfrastruktur, aktuelle Fassung, BSI
- [RFC 4880] RFC 4880, J. Callas, L. Donnerhacke, H. Finney, D. Shaw, R. Thayer, OpenPGP Message Format, 2007, IETF