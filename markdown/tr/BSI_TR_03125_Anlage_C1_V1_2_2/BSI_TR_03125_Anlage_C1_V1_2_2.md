![](_page_0_Picture_0.jpeg)

![](_page_0_Picture_2.jpeg)

# BSI Technical Guideline 03125 Preservation of Evidence of Cryptographically Signed Documents

# **Annex TR-ESOR-C.1: Conformity Test Specification (Level 1 - Functional Conformity)**

Designation Functional Conformity Test Specification (Level 1)

Abbreviation BSI TR-ESOR-C.1

Version 1.2.2 (on base of the eIDAS-Regulation, ETSI Preservation, NEW: LXAIP and Upload-/Download-Module, TS119512-Interface)

Datum 15.03.2021

Federal Office for Information Security Post Box 20 03 63 53133 Bonn Phone: +49 228 99 9582-0 E-Mail: [tresor@bsi.bund.de](mailto:tresor@bsi.bund.de) Internet: [https://www.bsi.bund.de](https://www.bsi.bund.de/) © Federal Office for Information Security 2021

# Inhalt

|    | 1.<br>INTRODUCTION                                                                                                                                   | 6        |
|----|------------------------------------------------------------------------------------------------------------------------------------------------------|----------|
| 2. | OVERVIEW                                                                                                                                             | 9        |
| 3. | TEST APPROACH                                                                                                                                        | 11       |
|    | 3.1<br>Structure of the Test Case Specifications                                                                                                     | 11       |
|    | 3.2<br>Strictness of Test Result Assessment                                                                                                          | 11       |
|    | 3.3<br>Baseline for all Test Cases                                                                                                                   | 12       |
|    | 3.3.1<br>Standard Test Configurations                                                                                                                | 12       |
|    | 3.3.2<br>Standard Test Objects                                                                                                                       | 13       |
|    | 3.4<br>Occurring Abbreviations                                                                                                                       | 20       |
| 4. | THE TEST CASES FOR CONFORMITY LEVEL 1 – FUNCTIONAL CONFORMITY                                                                                        | 23       |
|    | 4.1<br>Tests for all products                                                                                                                        | 23       |
|    | 4.1.1<br>A-01 – Middleware modules should be realised as separate modules                                                                            | 23       |
|    | 4.1.2<br>A-02 – The upper Interfaces (inbound and outbound) of the TR-ESOR-Middleware shall be the XML                                               |          |
|    | based S.4- or S.512-Interfaces, based on open, standardised data formats, or in case of Upload-/Download                                             |          |
|    | Module shall be based on open, standardised cryptographically protocols with standardised data formats                                               |          |
|    | and interfaces                                                                                                                                       | 25       |
|    | 4.1.3<br>A-03 – No access without mutual authentication                                                                                              | 27       |
|    | 4.1.4<br>A-04 – Authentication procedure shall be resistant against replay attacks                                                                   | 37       |
|    | 4.1.5<br>A-05 – Protection of communication channel and interface shall be robust against DoS-attacks                                                | 38       |
|    | 4.1.6<br>A-06 – A secure tunnel can be maintained after successful authentication                                                                    | 40       |
|    | 4.1.7<br>A-07 – Secure administration interfaces                                                                                                     | 42       |
|    | 4.1.8<br>A-08 – No security breach induced by administration interfaces or components                                                                | 44       |
|    | 4.1.9<br>A-09 – Administration interfaces shall be available for authorised accounts only                                                            | 45       |
|    | 4.1.10<br>A-10 – Additional interfaces shall not compromise security                                                                                 | 46       |
|    | 4.2<br>Module 1 – ArchiSafe                                                                                                                          | 47       |
|    | 4.2.1<br>M.1-01 – Preservation Services conform to [eIDAS-VO], [ETSI TS 119 401], [ETSI TS 119 511] and                                              |          |
|    | using the preservation product [TR-ESOR] should fulfil the security objectives and requirements of [ASS 319                                          |          |
|    | 401] and [ASS 119 511]                                                                                                                               | 47       |
|    | 4.2.2<br>M.1-02 – ArchiSafe-module shall be separated and deployed on a trustworthy IT system                                                        | 49       |
|    | 4.2.3<br>M.1-03 – Access to ECM storage shall be claimed to be controlled by ArchiSafe module and if                                                 |          |
|    | existent, also by the Upload- and Download-Module                                                                                                    | 50       |
|    | 4.2.4<br>M.1-04 – Support of specified functions                                                                                                     | 52       |
|    | 4.2.5<br>M.1-05 – Using interfaces S.1 and S.6 is possible<br>4.2.6<br>M.1-06 – Comprehensive and configurable options for logging shall be offered. | 56<br>57 |
|    | 4.2.7<br>M.1-07 – Access to log files shall be possible by authorized persons only                                                                   | 60       |
|    | 4.2.8<br>M.1-08 – Changing metadata or data objects results in a new version of stored (L)XAIP or XAIP(BIN)                                          |          |
|    | 61<br>4.2.9<br>M.1-09 – ArchiSafe-module should be capable of serving and separating multiple clients                                                | 63       |
|    | 4.2.10<br>M.1-10 – ArchiSafe-Module shall be thread safe                                                                                             | 65       |
|    | 4.2.11<br>M.1-11 – Access rights are enforced for individual archive objects                                                                         | 67       |
|    |                                                                                                                                                      |          |

| 4.3              | Module 2 – Crypto-Module                                                                                                                                                                  | 70         |
|------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
| 4.3.1            | M.2-01 – Crypto- Module may request digital signatures from a Trust Service Provider according to                                                                                         |            |
|                  | [eIDAS-VO]                                                                                                                                                                                | 70         |
| 4.3.2            | M.2-02 – Cryptographic algorithms shall be exchangeable                                                                                                                                   | 74         |
| 4.3.3            | M.2-03 – Crypto-Module should fulfil the requirements of TR-03112                                                                                                                         | 75         |
| 4.3.4            | M.2-04 – Random number generators fulfil the BSI requirements                                                                                                                             | 76         |
| 4.3.5            | M.2-05 – Support of Hash functions                                                                                                                                                        | 77         |
| 4.3.6            | M.2-06 – Crypto-Module supports canonicalisation for the validation of XML digital signatures                                                                                             | 79         |
| 4.3.7            | M.2-07 – Canonicalisation procedures do not change the content data                                                                                                                       | 81         |
| 4.3.8            | M.2-08 – Reliable validation of digital signatures by itself or by a Trust Service Provider                                                                                               | 83         |
| 4.3.9            | M.2-09 – Crypto-Module shall have function to validate certificate chains by itself or by a Trust                                                                                         |            |
|                  | Service Provider                                                                                                                                                                          | 88         |
| 4.3.10           | M.2-10 – Validation of digital signatures and evidence records yields standardised and                                                                                                    |            |
|                  | comprehensive Verification Report                                                                                                                                                         | 91         |
| 4.3.11           | M.2-11 – Suitability of cryptographic algorithms should be defined by policy file                                                                                                         | 94         |
| 4.3.12           | M.2-12 – Protect its own security                                                                                                                                                         | 95         |
| 4.3.13           | M.2-13 – Recording security functions                                                                                                                                                     | 96         |
| 4.3.14           | M.2-14 – Responsivity to unauthorized access                                                                                                                                              | 97         |
| 4.3.15           | M.2-15 – Configuration of cryptographic functions                                                                                                                                         | 98         |
| 4.3.16           | M.2-16 – Validation of certificates based on a standardized protocol                                                                                                                      | 99         |
| 4.3.17           | M.2-17 – Crypto-Module is able to request qualified electronic time stamps from a qualified Trust                                                                                         |            |
|                  | Service Provider                                                                                                                                                                          | 100        |
| 4.3.18           | M.2-18 – Crypto-Module supports [RFC 3161, [RFC5816], [RFC5652] and [EN 319 422] and                                                                                                      |            |
|                  | suitable algorithms                                                                                                                                                                       | 103        |
| 4.3.19           | M.2-19 – Qualified Electronic Time Stamps fulfil the requirements of [eIDAS-VO, article 42]                                                                                               | 105        |
| 4.3.20           | M.2-20 – Crypto-Module shall validate digital signatures of received electronic time stamps or                                                                                            |            |
| 4.3.21           | hash values (or another cryptographic security element) in <asic:DataObjectReference> of a LXAIP<br>M.2-21 – The Cryptographic Module shall have a trustworthy communication channel to a | 108        |
|                  | qualified Trust Service Provider in order to request qualified electronic time stamps according to [eIDAS-VO,                                                                             |            |
|                  | Article 3 (34)]                                                                                                                                                                           | 111        |
|                  |                                                                                                                                                                                           |            |
| 4.4              | Module 3 – ArchiSig-Module                                                                                                                                                                | 113        |
| 4.4.1            | M.3-01 – ArchiSig-Module should be realised as a separate module                                                                                                                          | 114        |
| 4.4.2            | M.3-02 – Using interface S.3 is possible                                                                                                                                                  | 116        |
| 4.4.3            | M.3-03 – ArchiSig-Module implements specified functions                                                                                                                                   | 117        |
| 4.4.4            | M.3-04 – Creation of Initial Archive Timestamps according to [RFC4998] or [RFC6283]                                                                                                       | 119        |
| 4.4.5            | M.3-05 – AOID shall be unique                                                                                                                                                             | 121        |
| 4.4.6            | M.3-06 – ArchiSig-Module creates Evidence Records according to RFC4998 or RFC6283                                                                                                         | 122        |
| 4.4.7            | M.3-07 – ArchiSig-Module should not implement cryptographic functions                                                                                                                     | 124        |
| 4.4.8            | M.3-08 – ArchiSig-Module should be thread safe                                                                                                                                            | 126        |
| 4.4.9            | M.3-09 – Instances of ArchiSig-Module should be deployable on different machines                                                                                                          | 128        |
| 4.4.10           | M.3-10 – ArchiSig-Module uses a secure storage for electronic time stamps and AOIDs                                                                                                       | 129        |
| 4.4.11           | M.3-11 – Canonicalisation of XML is performed prior to hashing and noted in XAIP                                                                                                          | 131        |
| 4.4.12           | M.3-12 – Hashing of relevant parts is performed with suitable algorithms                                                                                                                  | 132        |
| 4.4.13           | M.3-13 – ArchiSig-Module supports Timestamp Renewal and Hash-Tree Renewal                                                                                                                 | 133        |
| 4.4.14           | M.3-14 – Timestamp Renewal                                                                                                                                                                | 137        |
| 4.4.15           | M.3-15 – ArchiSig-Module shall validate requested electronic time stamps                                                                                                                  | 139        |
|                  | 4.4.16<br>M.3-16 – Time stamps shall be verified prior to renewal                                                                                                                         | 142        |
|                  | M.3-17 – Timestamp Renewal can only be requested by authorised users through administrative                                                                                               |            |
| 4.4.17           | interfaces 144                                                                                                                                                                            |            |
|                  | M.3-18 – Hash-tree Renewal can only be requested through administrative interface                                                                                                         |            |
| 4.4.18           |                                                                                                                                                                                           | 145        |
| 4.4.19           | M.3-19 – Authenticity and integrity of ArchiSig-Module needs to be guaranteed                                                                                                             | 147        |
| 4.4.20           | M.3-20 – ArchiSig-Module should be able to maintain parallel hash-trees                                                                                                                   | 148        |
| 4.4.21<br>4.4.22 | M.3-21 – Resigning-procedure is efficient and compatible with ERS<br>M.3-22 – Deletion of an archive object shall not impair the conclusiveness of others                                 | 149<br>150 |

| 4.5   | Interface functions | 153 |
|-------|---------------------|-----|
| 4.5.1 | Interface S.1       | 153 |
| 4.5.2 | Interface S.2       | 160 |
| 4.5.3 | Interface S.3       | 160 |
| 4.5.4 | Interface S4        | 161 |
| 4.5.5 | Interface S.5       | 248 |
| 4.5.6 | Interface S.6       | 248 |
| 4.6   | Annex TR-ESOR-F     | 248 |

# **Illustration Index**

| Figure 1: Schematic Depiction of the IT Reference Architecture with TR-S.47   |  |
|-------------------------------------------------------------------------------|--|
| Figure 2: Schematic Depiction of the IT Reference Architecture with TR-S.5127 |  |

# **Index of Tables**

| Table 1: Definition of test objects18            |  |
|--------------------------------------------------|--|
| Table 2: Definition of test data in detail<br>19 |  |
| Table 3: Occurring Abbreviations<br>20           |  |

# <span id="page-5-0"></span>**1. Introduction**

The goal of the Technical Guideline "Preservation of Evidence of Cryptographically Signed Documents" is to specify technical security requirements for the long-term preservation of evidence of cryptographically signed electronic documents and data along with associated electronic administrative data (meta data).

A Middleware defined for this purpose (TR-ESOR-Middleware) in the sense of this Guideline includes all of the modules (**M**) and interfaces (**S**) [for the German "*Schnittstellen*"] used for securing and preserving the authenticity and proving the integrity of the stored documents and data.

The Reference Architecture introduced in the Main Document of this Technical Guideline consists of the interfaces, functions and logical units described in the following:

- the S.4 and the TS119512 input interface S.512 in the profiling [TR-ESOR-TRANS] of the TR-ESOR-Middleware, which serves to embed the TR-ESOR-Middleware in the existing IT and infrastructure landscape;
- the "ArchiSafe-Module" (**[TR-ESOR-M.1]**), which regulates the flow of information in the Middleware, implements the security requirements for the interfaces with the IT applications and ensures that the application systems are decoupled from the ECM/long-term storage;
- the "Cryptographic"-Module (**[TR-ESOR-M.2]**) and the associated interfaces S.1 and S.3 that provide the required functions for creating hash values, verifying electronic signatures or seals or time stamps, verifying electronic certificates, and for obtaining qualified electronic time stamps or (optional) of electronic signatures or seals for the Middleware. Furthermore, it can provide the functions for the encryption and decryption of data and documents;
- the "ArchiSig"-Module (**[TR-ESOR-M.3]**) with the S.6 interface that provides the required functions for the preservation of evidence of the digitally signed documents;
- an ECM/Long-Term Storage with the S.2 and S.5 interfaces that assumes the physical archiving/storage and also the storage of the meta data that preserve evidence. *This ECM/long-term storage is no longer directly a part of the Technical Guideline, but requirements will be set for it through the two interfaces that are still part of the TR-ESOR-Middleware.*

*The application layer that can include an XML-Adapter is not a direct part of this Technical Guideline, either, even though this XML-Adapter can be implemented as part of a Middleware.*

The IT Reference Architecture depicted in Figure 1 and Figure 2 is based on the ArchiSafe Reference Architecture and is supposed to enable and support the logical (functional) interoperability of future products with the objectives and requirements of the Technical Guideline. In principle, the upper interface of the TR-ESOR-Middleware is either the S.4-Interface (TR-S.4) pursuant to **[TR-ESOR-E],** according to Figure 1 or the S.512-Interface (TR-S.512) pursuant to **[ETSI TS 119 512]** in the profiling of **[TR-ESOR-TRANS]** according to [Figure 2.](#page-6-2)

<span id="page-6-2"></span>![](_page_6_Figure_1.jpeg)

<span id="page-6-0"></span>*Figure 1: Schematic Depiction of the IT Reference Architecture with TR-S.4* 

![](_page_6_Figure_3.jpeg)

<span id="page-6-1"></span>*Figure 2: Schematic Depiction of the IT Reference Architecture with TR-S.512* 

The optional XML-Adapter and/or the optional TR-ESOR-512-Transformator[1](#page-7-0) may be integrated under the following circumstances only:

- <span id="page-7-2"></span>- Both as separate components with two interfaces to the IT-application and the ArchiSafe-Module,
- Both as separate components, but as parts of the IT-application with interfaces to the ArchiSafe-Modul
- One common component, separate from the IT-application and including the XML-Adapter and TR-ESOR-512-Transformator as parts, with two interfaces to the IT-application and the ArchiSafe-Module,
- One common component including the XML-Adapter and TR-ESOR-512-Transformator as parts, which is part of the IT-application, with an interface to the ArchiSafe-Module.

This ["ETSI TS119512 TR-ESOR Transformator"](https://github.com/de-bund-bsi-tr-esor/tresor-ETSITS119512-transformator) enables preservation services pursuant to [eIDAS](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32014R0910) to transform incoming [ETSI TS119512 \(V1.1.1\)](https://www.etsi.org/deliver/etsi_ts/119500_119599/119512/01.01.01_60/ts_119512v010101p.pdf) messages[2](#page-7-1) into [TR-ESOR S4](https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/TechGuidelines/TR03125/TR-03125_E_v1_2_2.pdf) messages. These messages can be sent to an attached [TR-ESOR](http://www.bsi.bund.de/EN/tr-esor) system without any need for changing the system.

The usage of the [ETSI TS119512 TR-ESOR Transformator](https://github.com/de-bund-bsi-tr-esor/tresor-ETSITS119512-transformator) is recommended in case that a TR-ESOR-Product with a TR-S.4-Interface should be used in Europe supporting interoperability with other European (qualified) Preservation Services or Preservation Products.

This Technical Guideline is modularly structured, and the individual annexes to the Main Document specify the functional and technological security requirements for the needed IT components and interfaces of the TR-ESOR-Middleware. The specifications are strictly platform, product, and manufacturer independent.

The document at hand bears the designation "Annex TR-ESOR-C.1" and describes and specifies the conformity tests for the conformity level 1 "Functional Conformity" for TR-ESOR V1.2.2 supporting also the archive information package LXAIP and the Upload- and Download-interface and the upper ETSI TS119512-interface TR-S.512 in the profiling of **[TR-ESOR-TRANS]**, alternatively to the TR-ESOR upper interface S.4, but not yet the archive information package ASiC-AIP.

<span id="page-7-0"></span><sup>1</sup> Se[e ETSI TS 119512 TR-ESOR Transformator](https://github.com/de-bund-bsi-tr-esor/tresor-ETSITS119512-transformator) under Open Source License

<span id="page-7-1"></span><sup>2</sup> In the profiling of **[TR-ESOR-TRANS]**

# <span id="page-8-1"></span><span id="page-8-0"></span>**2. Overview**

Products or systems which want to get certified according to this Technical Guideline have to demonstrate their conformance to the specifications. There are three conformance levels defined which mainly differ in the technical detail specifications of interfaces and data formats used.

- Conformity Level 1 Functional Conformity
- Conformity Level 2 Technical Conformity
- Conformity Level 3 Recommendations for Federal Agencies

The three levels are built on top of each other. This means e.g. in order to demonstrate conformity to level 2 all conformance criteria for level 1 have to be passed in addition to the conformance criteria for level 2.

This document specifies the functional conformity criteria (tests) derived from the requirements specified in the documents of the Technical Guideline.

In order to become certified according to a conformity level, a product or system must pass all conformity criteria (tests) for this conformity level and for all lower conformity levels. If one or more tests are not successful, the conformity cannot be certified.

In the following chapter the test criteria will be derived from the requirements defined of the TR. Furthermore, the requirements and therefore also the test criteria are assigned to a conformity level.

Based on these assignments the subsequent chapters define the test cases for the conformity levels in detail. Red headlined (marked) test cases MUST be passed for fulfilling the conformity criteria.

The test case specifications are written in such a way that this document (or the respective parts of it) could be used as template for the documentation of the final results of actual testing.

## *NOTICE 1:*

*In TR-ESOR-Version1.3 the two terms "Archive Information Package (AIP)" and "Archive Data Object" are used synonymously.*

## *NOTICE 2:*

*The TR-ESOR input interface S.4 or the TS119512 input interface S.512 pursuant to the preservation-API of [ETSI TS 119 512] in the profiling of [TR-ESOR-TRANS[\]](#page-7-2)<sup>1</sup> shall be used which logically corresponds to the input-interface S.4 of the TR-ESOR-Middleware [TR-ESOR-E], as shown in the table 1 of [TR-ESOR-E, clause 4.1]. Another input interface instead of S.4 or S.512 is not allowed.*

*To improve readability, the insertion of the TS119512-function calls, equivalent to S.4, is renounced, at several places in this document and the footnote "Either S.4 or S.512 shall be supported." is added to each test case concerning "S.4"/TS119152.*

## *NOTICE 3:*

*In this TR-ESOR- Version, the word "AIP"means in all TR-ESOR-Annexes:*

*a) the XML-based archival information package "XAIP" pursuant to [TR-ESOR V1.2.2 and higher, Annex F, clause 3.1] as well as* 

*b) the logical XAIP "LXAIP" pursuant to [TR-ESOR V1.2.2 and higher, Annex F, clause 3.2] as well as c) the "ASiC-AIP" pursuant to [TR-ESOR V1.2.2 and higher, Annex F, clause 3.3] on base of [ETSI EN 319162-1].*

*In this TR-ESOR Version, the main document MD, the Annex F and E differentiate in detail between "XAIP", "LXAIP" and "ASiC-AIP".*

*To improve readability, at several places in this document, the insertion of "LXAIP" and "ASiC-AIP" is renounced, and the footnote ""XAIP" shall be supported, "LXAIP" and "ASiC-AIP, if implemented"*  *may be supported" is added to each "XAIP".*

*NOTICE 4: In this TR-ESOR- Version, BIN is restricted to the following preservation object formats: -ASiC-ERS pursuant to [ETSI TS 119 512] Annex A.3.1 and A.3.1.3 [\(http://uri.etsi.org/ades/ASiC/type/ASiC-ERS\)](http://uri.etsi.org/ades/ASiC/type/ASiC-ERS) and pursuant to [BSI TR-03125-F] Clause 3.3);*

*-CAdES pursuant to [ETSI TS 119 512] Annex A.1.1 [\(http://uri.etsi.org/ades/CAdES\)](http://uri.etsi.org/ades/CAdES). If there is no MIME type filled, then the default application/cms is used;*

*-XAdES pursuant to [ETSI TS 119 512] Annex A.1.2 [\(http://uri.etsi.org/ades/XAdES\)](http://uri.etsi.org/ades/XAdES). If there is no MIME type filled, then the default application/xml is used;*

*-PAdES pursuant to [ETSI TS 119 512] Annex A.1.3 [\(http://uri.etsi.org/ades/PAdES\)](http://uri.etsi.org/ades/PAdES). If there is no MIME Type filled, then the default application/pdf is used;*

*-ASiC-E pursuant to [ETSI TS 119 512] Annex A.1.4 (http://uri.etsi.org/ades/ASiC/type/ASiC-E). If there is no MIME type filled, then the default application/vnd.etsi.asic-e+zip is used;*

*-DigestList pursuant to [ETSI TS 119 512] Annex A.1.6 (http://uri.etsi.org/19512/format/DigestList). If there is no MIME Type filled, then the default application/xml is used;*

*-Binary Data (BIN) as Octet Stream, which is stored in the ECM/long-term storage by an "Upload-Request" and retrieved by a "Download-Request" – linked to a corresponding LXAIP only*

## *NOTICE 5:*

*In the following text the term "digital signature" covers "advanced electronic signatures" pursuant to [eIDAS-VO, Article 3(11)], "qualified electronic signatures" pursuant to [eIDAS-VO, Article 3(12)], "advanced electronic seals" pursuant to [eIDAS-VO, Article 3(26)] and "qualified electronic seals" pursuant to [eIDAS-VO, Article 3(27)]. Insofar, the term "digital signed document" covers as well documents signed by advanced electronic signatures or seals as documents signed by qualified electronic signatures or seals.*

*In this TR the term "cryptographic signed documents" covers not only qualified signed documents pursuant to [eIDAS-VO, Article 3(12)] or qualified sealed documents pursuant to [eIDAS-VO, Article 3(27)] or qualified time-stamped documents pursuant to [eIDAS-VO, Article 3(34)] (within the meaning of the eIDAS regulation) ) but also documents with advanced electronic signatures pursuant to [eIDAS-VO, Article 3(11)] or with advanced electronic seals pursuant to [eIDAS-VO, Article 3(26)] or with electronic time stamps pursuant to [eIDAS-VO, Article 3(33)], as they are often used in the internal communication of public authorities. What is not meant here are documents with simple signatures or seals based on other (e.g. noncryptographic) technologies.*

# <span id="page-10-0"></span>**3. Test Approach**

The following test specifications are based on the recommended reference architecture in chapter 7.1 of the main document of this technical guideline. Thus, in the following differences between expected and observed test results should be carefully interpreted by the testers respecting the fact that actual implementations of components and / or modules of the middleware may deviate from the recommended reference architecture. This may result also in different characteristics of implemented and provided interfaces.

Besides this testing the conformity to this guideline may refer to a single module only. This may result also in different characteristics and expected results of implemented and provided features and interfaces.

In the following text we use the wording "S.4 Interface" instead of "S.4 Interface or functionally analogous interfaces". It is worth noting, therefore, that testing the conformity level 1 the referred interfaces are required in a logical functional manner only and not in a technical interoperable characteristic.

The TR-ESOR interfaces S.2 and S.5 are actually not part of the TR-ESOR middleware because they will be provided by the storage system. Therefore, no conformity tests will be specified here.

For fulfilling the required conformity in general, the red marked test specifications in this document shall be tested and passed.

For fulfilling the required conformity in compliance with the pre-suppositions written down before the test cases, the yellow marked test specifications in this document shall be tested and passed.

<span id="page-10-1"></span>All other test specifications shall be passed or the non-fulfilment must be justified.

## **3.1 Structure of the Test Case Specifications**

Some test cases are ordered according to the modules M.1 – M.3 and "all products". These test cases cannot be assigned to the certain interface of the module but check general properties of the module.

The other test cases are ordered according to the interface specifications S.1 – S.6. The reason for that is that these tests will only be performed on the level of external interfaces of a certain product. If a product claims compliance with the module specified in the Technical Guideline, the respective interfaces of the module (product) will be tested or the product proves that it supports functional analogous interfaces.

Below this structural level, the test cases are ordered according to the logical functions of this interface, e.g. "Archive Submission" or "Archive Deletion". For each logical function of the interface a set of test cases test all relevant requirements.

Each test case is identified by a unique ID. The test case description also refers to the respective requirements, which will be (partly) tested with this test case. The test case also states the purpose of the test as a summary of the test case. The baseline configuration of the test system will be stated as well as all pre-conditions, which must exist prior performance of the test. The test case defines the single test steps, which must be performed in the given order. Per test step the expected result is defined and there is space that the tester could document the actual findings. Finally, the tester can state the final verdict of the test case (PASS/FAIL).

FAIL shall be assigned if any of the test steps does not match the expected result and a justification for this difference is not possible.

## <span id="page-10-2"></span>**3.2 Strictness of Test Result Assessment**

The Technical Guideline differs between three major classes of requirements (cf. **[RFC 2119**])

• CAN (or synonymously MAY, COULD) : These requirements are just hints or optional features. These requirements will not be tested.

- SHOULD: These requirements are strong recommendations. Respective test cases should demonstrate the specified behaviour. Alternatively, the vendor explains why its product uses another approach and why the resulting security level is equal to the security level described in the Technical Guideline.
- MUST (or synonymously SHALL): These are strict requirements. It is not allowed to use another approach or alternative techniques.

Test cases which tests MUST requirements are identified with a red coloured title line. The expected results of these test cases must exactly be the actual results.

Test cases identified by a grey coloured title line are pure SHOULD requirements. The expected test results may differ from the actual test results, if the vendor can demonstrate the same or higher security level.

## <span id="page-11-0"></span>**3.3 Baseline for all Test Cases**

This section describes the basics valid and usable for all test cases.

## <span id="page-11-1"></span>**3.3.1 Standard Test Configurations**

Here, a set of standard configurations of the test setup will be described. These setups are referenced in the test cases and should be used to actually perform the tests.

## **3.3.1.1 CONFIG\_Common**

This is the standard configuration for all tests.

- The test setup shall contain the product to be tested (Target of Testing, TOT).
- The user manual in the test setup shall refer at least to one Preservation Profile pursuant to **[ETSI TS 119 512, clause 5.4.7],** to one actual Preservation Evidence Policy pursuant to **[ETSI TS 119 511, clause 6.5]** and to one actual signature validation policy and time-stamp validation policy pursuant to **[ETSI TS 119 511, clause 6.6]**.
- The test setup shall contain all other modules of the reference architecture (including the storage) functionally not covered by the TOT. The purpose is that a functionally complete system can be tested.
- The TOT and all other modules required shall be installed and configured according to the respective guidance including all security recommendations.
- The TOT and all other modules shall be physically and logically interconnected. The connections shall be secured as described in the respective guidance documents (e.g. enabling encryption, explicit physical connection).
- The test system shall be connected to an external Trust Service Provider as required by the TOT or the tests.
- At least it is recommended to install three different client applications for using and testing the multi-client-capability of the middleware (if the TOT supports/provides a multi-client-capability).

In this case the middleware in turn shall be configured to handle these three applications as different clients (multi-client-capability). Per client application at least two user accounts and an administrator account shall be configured.

• The BSI ERVerifyTool is installed and running in a proper working mode.

The complete test setup shall be started and running in a proper operational and working mode.

## **3.3.1.2 CONFIG\_ArchiSafe**

This configuration includes CONFIG\_Common.

Additionally, the ArchiSafe-Module (if TOT) shall be configured as follows:

- XAIP shall be mandatory.
	- The default value in case of "no-input of the PO-Format" is "XAIP".
	- If configurable, LXAIP shall be optional and may be enabled and used in parallel with XAIP.
- A XSD defining the XAIPs or LXAIPs pursuant to TR-ESOR-F V1.2.2 shall be configured. Preferable, the XAIP described in Annex TR-ESOR-F should be used.
- The XSD verification of (L)XAIP containers during Archive Submission and Archive Update shall be enabled.
- The validation of digital signatures and electronic time stamps[3](#page-12-1) and (L)XAIP during Archive Submission and Archive Update shall be enabled.
- The requesting of qualified time-stamps from a qualified Trust Service Provider and of verification of (qualified) time-stamps (doing by itself or upon request from an external Trust Service Provider) shall be enabled.
- Either the S.4 interface or the TS119512 interface S.512 in the profiling of **[TR-ESOR-TRANS]** shall be configured.
	- The default value in case of "no interface configuration" is the interface "S.4".
- The S.4 interface or the TS119512 interface S.512 in the profiling of **[TR-ESOR-TRANS]** shall only be accessible using a secure Channel (e.g. TLS tunnel) with certificatebased mutual authentication.
- If configurable, OptionalInput and OptionalOutput pursuant to **[TR-ESOR-E]** may be supported.

## **3.3.1.3 CONFIG\_Upload**

• If configurable, CONFIG\_Upload is defined and Upload shall be enabled, but usable for BIN *linked to a corresponding LXAIP* only.

## **3.3.1.4 CONFIG\_Download**

<span id="page-12-0"></span>• If configurable, CONFIG\_Download is defined and Download shall be enabled.

## **3.3.2 Standard Test Objects**

For most of the tests test data is required. In order to make the tests repeatable, this section defines some standard test objects.

## *NOTICE 4:*

<span id="page-12-2"></span>

*The word "XAIP" in the following table names represents "XAIP" or "LXAIP" pursuant to [TR-ESOR-F] V1.2.2. The word "DXAIP" in the following container names represents "DXAIP" or "DLXAIP"" pursuant to [TR-ESOR-F] V1.2.2.*

## **The following test objects are available for the three Conformity Levels 1, 2 and 3.**

| No. | Container Name | Used in<br>Conformity<br>Level | Description                                  |
|-----|----------------|--------------------------------|----------------------------------------------|
| 1   | XAIP_OK        | 1, 2, 3                        | The XAIP is syntactically correct and passes |

<span id="page-12-1"></span><sup>3</sup> The validation of digital signatures or electronic time stamps of documents included in the XAIP or passed over as binary.

| No. | Container Name    | Used in<br>Conformity<br>Level | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |
|-----|-------------------|--------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|     |                   |                                | the defined consistency checks.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
| 2   | LXAIP_OK          | 1, 2, 3                        | The LXAIP is syntactically correct and passes<br>the defined consistency checks.                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |
| 3   | XAIP_OK_SIG       | 1                              | The XAIP is syntactically correct and passes<br>the defined consistency checks and there is a<br>valid digital signature or electronic time stamp.                                                                                                                                                                                                                                                                                                                                                               |  |
| 4   | LXAIP_OK_SIG      | 1                              | The LXAIP is syntactically correct and passes<br>the defined consistency checks and there is a<br>valid digital signature or electronic time stamp.                                                                                                                                                                                                                                                                                                                                                              |  |
| 5   | (L)XAIP_OK_SIG    | 1                              | A XAIP_OK_SIG or a LXAIP_OK_SIG.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |
| 6   | XAIP_NOK          | 1, 2, 3                        | The schema validation of the XAIP fails.                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
| 7   | LXAIP_NOK         | 1, 2, 3                        | The schema validation of the LXAIP fails.                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| 8   | XAIP_NOK_EXPIRED  | 1,2                            | The schema validation for the XAIP succeeds,<br>but the preservationInfo-element indicates a<br>preservation date, which is already exceeded.                                                                                                                                                                                                                                                                                                                                                                    |  |
| 9   | XAIP_NOK_SUBMTIME | 2                              | The schema validation for the XAIP succeeds,<br>but the submissionTime-element deviates from<br>the current time beyond a reasonable tolerance<br>range.<br>The documentation of the middleware or the<br>module, which shall be tested, shall<br>contain<br>some assertions and related conditions or<br>constraints indicating when the<br>submissionTime contained in the provided<br>XAIP deviates too much from the current time.                                                                           |  |
| 10  | XAIP_NOK_SIG      | 1, 2,                          | The XAIP is syntactically correct and passes<br>the defined consistency checks, but the XAIP<br>contains an invalid digital signature or<br>electronic time stamp.<br>Invalid digital signature or electronic time<br>stamp means that the digital signature or<br>electronic time stamp is syntactically not<br>correct or at least one of the evidence relevant<br>data, for example a digital signature or<br>electronic time stamp or certificate or<br>revocation list or OCSP-response, etc., is<br>wrong. |  |
| 11  | XAIP_NOK_ER       | 1, 2                           | The XAIP is syntactically correct and passes<br>the defined consistency checks, but the XAIP<br>contains an invalid Evidence Record.<br>Invalid Evidence Record means, that the<br>Evidence Record is syntactically not correct or<br>does not pass the defined consistency checks                                                                                                                                                                                                                               |  |

<span id="page-14-0"></span>

| No. | Container Name     | Used in<br>Conformity<br>Level | Description                                                                                                                                                                                                                                                                                                                 |
|-----|--------------------|--------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|     |                    |                                | according to annex C.2, chapter 4.1. or annex<br>ERS.                                                                                                                                                                                                                                                                       |
| 12  | XAIP_NOK_SIG_OK_ER | 1, 2                           | The XAIP is syntactically correct and passes<br>the defined consistency checks and there is a<br>correct Evidence Record or a number of<br>correct Evidence Records, but the XAIP<br>contains a digital signature or electronic time<br>stamp, which was not correct at the time of its<br>archiving.                       |
| 13  | XAIP_OK_SIG_OK_ER  | 1,<br>2                        | The XAIP is syntactically correct and passes<br>the defined consistency checks and there is a<br>valid digital signature or electronic time stamp<br>and a valid Evidence Record or a number of<br>correct Evidence Records.                                                                                                |
| 14  | BIN                | 1, 2, 3                        | This test object is a binary document restricted<br>to the preservation object formats<br>described in<br>clause 2, Notice 4, which is provided in the<br>ArchiveData-element.                                                                                                                                              |
| 15  | XAIP(BIN)          | 1, 2                           | The XAIP(BIN) is a XAIP, which is part of the<br>response of a successful<br>ArchiveRetrievalRequest or a RetrievePO<br>Request concerning an archive data object,<br>which was previously inserted as a BIN in the<br>long-term storage by an<br>ArchiveSubmissionRequest or a<br>PreservePO-Request ([TR-ESOR<br>TRANS]). |
| 16  | DXAIP              | 1, 2, 3                        | The DXAIP represents an update container<br>("Delta XAIP") for XAIP, which contains the<br>corresponding AOID.                                                                                                                                                                                                              |
| 17  | DLXAIP             | 1,2,3                          | The DLXAIP represents an update container<br>("Delta LXAIP") for LXAIP, which contains<br>the corresponding AOID.                                                                                                                                                                                                           |
| 18  | DXAIP_OK           | 1, 2, 3                        | The DXAIP is syntactically correct and<br>represents a valid update container ("Delta<br>XAIP") for XAIP_OK, which contains the<br>corresponding AOID.                                                                                                                                                                      |
| 19  | DXAIP_OK_SIG       | 1                              | The DXAIP is syntactically correct and<br>represents a valid update container ("Delta<br>XAIP") for XAIP_OK, which contains the<br>corresponding AOID and contains a valid<br>digital signature or electronic time stamp.                                                                                                   |
| 20  | DXAIP_NOK          | 1, 2, 3                        | The DXAIP is syntactically not correct<br>because the schema validation fails.                                                                                                                                                                                                                                              |

<span id="page-15-0"></span>

| No. | Container Name     | Used in<br>Conformity<br>Level | Description                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
|-----|--------------------|--------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 21  | DXAIP_NOK_AOID     | 2                              | The schema validation for the Delta XAIP<br>succeeds, but the update container ("Delta<br>XAIP") contains a not yet assigned AOID.                                                                                                                                                                                                                                                                                                           |  |
| 22  | DXAIP_NOK_EXPIRED  | 2                              | The schema validation for the Delta XAIP<br>succeeds, but the preservationInfo-element<br>indicates a point in time in the past.                                                                                                                                                                                                                                                                                                             |  |
| 23  | DXAIP_NOK_SUBMTIME | 2                              | The schema validation for the Delta XAIP<br>succeeds, but the submissionTime-element<br>deviates from the current time beyond a<br>reasonable tolerance range.<br>The documentation of the middleware or the<br>module, which shall be tested, shall<br>contain<br>some assertions and related conditions or<br>constraints indicating when the<br>submissionTime contained in the provided<br>XAIP deviates too much from the current time. |  |
| 24  | DXAIP_NOK_SIG      | 1, 2                           | The schema validation for the Delta XAIP<br>succeeds, but the XAIP contains an invalid<br>digital signature or electronic time stamp.                                                                                                                                                                                                                                                                                                        |  |
| 25  | DXAIP_NOK_ER       | 2                              | The schema validation for the Delta XAIP<br>succeeds, but the XAIP contains an invalid<br>Evidence Record.                                                                                                                                                                                                                                                                                                                                   |  |
| 26  | DXAIP_NOK_VERSION  | 2                              | The schema validation for the XAIP succeeds,<br>but there is a syntactical collision with the<br>original XAIP such that the schema validation<br>for the compound XAIP fails, for example the<br>element prevVersion in the updateSection of<br>the DXAIP is not the latest version of this<br>XAIP.                                                                                                                                        |  |
| 27  | TST_OK             | 2                              | The time stamp token is syntactically correct<br>and based on a valid digital signature.                                                                                                                                                                                                                                                                                                                                                     |  |
| 28  | TST_OK_VALINFO     | 2                              | This time stamp token is based on TST_OK<br>and contains the validation information, which<br>has been collected during validation.                                                                                                                                                                                                                                                                                                          |  |
| 29  | TST_NOK            | 2                              | The time stamp token is syntactically incorrect.                                                                                                                                                                                                                                                                                                                                                                                             |  |
| 30  | TST_NOK_SIG        | 2                              | The time stamp token is syntactically correct,<br>but the digital signature does not verify<br>correctly.                                                                                                                                                                                                                                                                                                                                    |  |
| 31  | TST_NOK_VALINFO    | 2                              | This time stamp token is based on TST_OK<br>and contains validation information, which has<br>been collected during validation, but are not<br>complete.                                                                                                                                                                                                                                                                                     |  |

| No. | Container Name                | Used in<br>Conformity<br>Level | Description                                                                                                                                                                                   |  |
|-----|-------------------------------|--------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 32  | TST_BASIS_ERS_OK              | 2                              | The time stamp token is based on ([TR<br>ESOR-ERS], Profile BASIS_ERS) and is<br>syntactically correct and based on a valid<br>digital signature.                                             |  |
| 33  | TST_BASIS_ERS_OK_VA<br>LINFO  | 2                              | This time stamp token is based on ([TR<br>ESOR-ERS], Profile BASIS_ERS) and<br>contains the validation information, which has<br>been collected during validation.                            |  |
| 34  | TST_BASIS_ERS_NOK             | 2                              | The time stamp token is based on ([TR<br>ESOR-ERS], Profile BASIS_ERS) and is<br>syntactically incorrect.                                                                                     |  |
| 35  | TST_BASIS_ERS_NOK_SI<br>G     | 2                              | The time stamp token is based on ([TR<br>ESOR-ERS], Profile BASIS_ERS) and is<br>syntactically correct, but the digital signature<br>does not verify correctly.                               |  |
| 36  | TST_BASIS_ERS_NOK_V<br>ALINFO | 2                              | This time stamp token is based on ([TR<br>ESOR-ERS], Profile BASIS_ERS) and<br>contains validation information, which has<br>been collected during validation, but are not<br>complete.       |  |
| 37  | ER_OK_INIT                    | 2                              | The Evidence Record according [RFC4998]<br>and [TR-ESOR-ERS]/Basic-ERS-Profile and<br>based on XAIP_OK contains only an initial<br>Archive Timestamp.                                         |  |
| 38  | ER_NOK_INIT                   | 2                              | The initial Archive Timestamp of the Evidence<br>Record according [RFC4998]<br>and [TR<br>ESOR-ERS]/Basic-ERS-Profile and based on<br>XAIP_OK can not be validated.                           |  |
| 39  | ER_OK_CHAIN                   | 2                              | The Evidence Record according to [TR<br>ESOR-ERS]/Basic-ERS-Profile is based on<br>XAIP_OK and includes an Archive Timestamp<br>Chain according to [RFC4998].                                 |  |
| 40  | ER_NOK_CHAIN                  | 2                              | The Evidence Record according to [TR<br>ESOR-ERS]/Basic-ERS-Profile and based on<br>XAIP_OK, includes an Archive Timestamp<br>Chain according to [RFC4998],<br>which can not<br>be validated. |  |
| 41  | ER_OK_SEQ                     | 2                              | The Evidence Record according to [TR<br>ESOR-ERS]/Basic-ERS-Profile is based on<br>XAIP_OK and includes an Archive Timestamp<br>Sequence according to [RFC4998].                              |  |
| 42  | ER_NOK_SEQ                    | 2                              | The Evidence Record according to [TR<br>ESOR-ERS]/Basic-ERS-Profile and based on                                                                                                              |  |

| No. | Container Name | Used in<br>Conformity<br>Level | Description                                                                                                  |  |
|-----|----------------|--------------------------------|--------------------------------------------------------------------------------------------------------------|--|
|     |                |                                | XAIP_OK, includes an Archive Timestamp<br>Sequence according to [RFC4998],<br>which can<br>not be validated. |  |

## <span id="page-17-0"></span>*Table 1: Definition of test objects*

These test objects are referred in the test cases by their unique name.

The actual test objects (the files) for this annex are provided as appendix to this document.

- "Container Name" contains the unique name of the container and is identical to the file name.
- "XML Schema"
	- "valid" means that a XML-based object conforms with the specified XML Schema.
	- "not valid" means that a XML-based object does not conform with the specified XML Schema.
	- "---" means that this is a binary object which does not claim conformance to a XML schema.
- "Binary"
	- "no" means that this is an XML object.
	- "yes" means that this is a binary (a non-XML) object.
- "Preservation Time"
	- "Future" means that the minimum retention date is somewhere in the future (e.g. 01.01.2100).
	- "Past" means that the minimum retention date is somewhere in the past (e.g. 01.01.2000).
- "Signature"
	- "No signature" means that the user data contained in the test object does not contain a digital signature or electronic time stamp.
	- "Valid" means that the user data contained in the test object contains a digital signature or electronic time stamp which is mathematically correct, produced with an approved algorithm and with a valid (neither expired nor revoked) certificate issued by a known and trustworthy Trust Service Provider. It does not need to be a qualified electronic signature or seal or time stamp.
	- "Not Valid" means that the user data contained in the test object contains a digital signature or electronic time stamp which is mathematically not correct but produced with an approved algorithm and with a valid (neither expired nor revoked) certificate issued by a known and trustworthy Trust Service Provider. It does not need to be a qualified electronic signature or seal or time stamp.

<span id="page-18-9"></span><span id="page-18-7"></span><span id="page-18-6"></span><span id="page-18-4"></span><span id="page-18-2"></span>

| Container Name                                                                                                       | XML Schema | Binary | Preservation<br>Time | Digital Signature or<br>Electronic Time Stamp             |
|----------------------------------------------------------------------------------------------------------------------|------------|--------|----------------------|-----------------------------------------------------------|
| XAIP_OK                                                                                                              | Valid      | No     | Future               | No digital Signature and no<br>Electronic time stamp      |
| XAIP_OK_SIG                                                                                                          | Valid      | No     | Future               | Valid                                                     |
| XAIP_NOK_EXPIRED                                                                                                     | Valid      | No     | Past                 | undefined                                                 |
| XAIP_NOK                                                                                                             | Not Valid  | No     | Future               | undefined                                                 |
| XAIP_NOK_SIG                                                                                                         | Valid      | No     | Future               | Not Valid                                                 |
| XAIP_NOK_ER                                                                                                          | Valid      | No     | Future               | Evidence Record NOT<br>Valid                              |
|                                                                                                                      |            |        |                      | Digital Signature /<br>Electronic time stamp<br>undefined |
| XAIP_NOK_SIG_OK_ER                                                                                                   | Valid      | No     | Future               | Evidence Record Valid                                     |
|                                                                                                                      |            |        |                      | Digital Signature /<br>Electronic time stamp Not<br>Valid |
| XAIP_OK_SIG_OK_ER                                                                                                    | Valid      | No     | Future               | Evidence Record Valid                                     |
|                                                                                                                      |            |        |                      | Digital Signature /<br>Electronic time stamp Valid        |
| XAIP(BIN)                                                                                                            | Valid      | No     | Future               | Evidence Record Valid                                     |
|                                                                                                                      |            |        |                      | Digital Signature /<br>Electronic time stamp Valid        |
| BIN<br>restricted<br>to the<br>preservation object formats<br>described in clause 2, Notice<br>4                     | ---        | Yes    | undefined            | Digital Signature /<br>Electronic time stamp valid        |
| BIN_NOK_SIG restricted<br>to<br>the preservation object<br>formats described<br>pursuant<br>to clause<br>2, Notice 4 | ---        | Yes    | undefined            | Digital Signature /<br>Electronic time stamp Not<br>Valid |
| DXAIP_OK                                                                                                             | Valid      | No     | Future               | No Digital Signature and no<br>Electronic time stamp      |
| DXAIP_OK_SIG                                                                                                         | Valid      | No     | Future               | Valid Digital Signature /<br>Electronic time stamp        |
| DXAIP_NOK                                                                                                            | Not Valid  | No     | Future               | undefined                                                 |
| DXAIP_NOK_SIG                                                                                                        | Valid      | No     | Future               | Not Valid                                                 |

<span id="page-18-13"></span><span id="page-18-11"></span><span id="page-18-10"></span><span id="page-18-8"></span><span id="page-18-5"></span><span id="page-18-3"></span>Table 1: Definition of test data in detail

<span id="page-18-14"></span><span id="page-18-12"></span><span id="page-18-1"></span><span id="page-18-0"></span>*Table 2: Definition of test data in detail*

## <span id="page-19-0"></span>**3.4 Occurring Abbreviations**

| Abbreviation | Meaning                                       |
|--------------|-----------------------------------------------|
| AES-128      | Advanced Encryption Standard (128 bits)       |
| AOID         | Archive Object Identifier                     |
| ATS          | Archive Time Stamp                            |
| BIN          | Binary                                        |
| BSI          | Federal Office for Information Security       |
| C14N         | Canonical XML Version 1.0                     |
| C14N11       | Canonical XML Version 1.1                     |
| C14N20       | Canonical XML Version 2.0                     |
| CMS          | Cryptographic Message Syntax                  |
| CRL          | Certificate Revocation List                   |
| DES          | Data Encryption Standard                      |
| DoS          | Denial of Service                             |
| DLXAIP       | Delta-LXAIP                                   |
| D(L)XAIP     | Delta-LXAIP or Delta-XAIP                     |
| DXAIP        | Delta-XAIP                                    |
| e.g.         | for example (exempli gratia)                  |
| EC14N        | Exclusive XML Canonicalization                |
| ECM          | Enterprise Content Management                 |
| ERS          | Evidence Record Syntax                        |
| ETSI         | European Telecommunication Standard Institute |
| HTTP         | Hypertext Transfer Protocol                   |
| i.e.         | in other words (id est)                       |
| ID           | Identifier                                    |
| IT           | Information Technology                        |
| LXAIP        | Logical XAIP                                  |
| (L)XAIP      | XAIP or LXAIP                                 |
| M            | Modules                                       |

<span id="page-19-1"></span>*Table 3: Occurring Abbreviations*

| Abbreviation | Meaning                                                  |  |
|--------------|----------------------------------------------------------|--|
| MER          | Merkle hash trees                                        |  |
| n/a          | not applicable                                           |  |
| No.          | Number                                                   |  |
| OCSP         | Online Certificate Status Protocol                       |  |
| Par.         | Paragraph                                                |  |
| PKCS         | Public Key Cryptographic Standard                        |  |
| PKI          | Public Key Infrastructure                                |  |
| RC2          | Rivest Cipher 2                                          |  |
| resp.        | respectively                                             |  |
| RFC          | Request for Comments                                     |  |
| RMI          | Remote Method Invocation                                 |  |
| RPC          | Remote Procedure Call                                    |  |
| S            | Interfaces                                               |  |
| SASL         | Simple Authentication and Security Layer                 |  |
| SCVP         | Server-based Certification Validation Protocol           |  |
| Sig          | Signature                                                |  |
| SOAP         | Simple Object Access Protocol                            |  |
| SQL          | Structured Query Language                                |  |
| ST           | Security Target                                          |  |
| TCP          | Transmission Control Protocol                            |  |
| TLS          | Transport Layer Security                                 |  |
| TSP          | Trust Service Provider                                   |  |
| TOT          | Target of Testing, here the to be tested TR-ESOR Product |  |
| TR           | Technical Guideline (German: Technische Richtlinie)      |  |
| Transformer  | "ETSI TS119512<br>TR-ESOR<br>Transformator"              |  |
| TSP          | Time Stamp Protocol                                      |  |
| USB          | Universal Serial Bus                                     |  |
| WSDL         | Web Services Description Language                        |  |
| XAIP         | XML-based Archive Information Package                    |  |

| Abbreviation | Meaning                    |  |
|--------------|----------------------------|--|
| XML          | Extensible Markup Language |  |
| XSD          | XML Schema Description     |  |

# <span id="page-22-3"></span>**4. The Test Cases for Conformity Level 1 – Functional Conformity**

## **4.1 Tests for all products**

## **4.1.1 A-01 – Middleware modules should be realised as separate modules**

<span id="page-22-0"></span>

| Identifier                     |                                                                                                                                                                                                              |                                                  | A-01                                                                                                                                                                                                                                                                                                                    |              |  |
|--------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
|                                | Requirement                                                                                                                                                                                                  | M1:A3.2-1<br>M1:A3.1-1<br>M2:A3.2-1<br>M3:A3.1-4 |                                                                                                                                                                                                                                                                                                                         |              |  |
| The test shall<br>Test Purpose |                                                                                                                                                                                                              | compatible implementations at any time.          | verify that the middleware or middleware components runs as independent applications or independent (functionally delimited) parts of an application<br>on a trustworthy IT system. They are neither a logical nor functional component of upstream IT specialist applications and can be replaced by new, functionally |              |  |
| CONFIG_Common<br>Configuration |                                                                                                                                                                                                              |                                                  |                                                                                                                                                                                                                                                                                                                         |              |  |
| •<br>Pre-test conditions<br>•  |                                                                                                                                                                                                              | User manual is present.                          | The middleware documentation is available                                                                                                                                                                                                                                                                               |              |  |
| Step                           | Test sequence                                                                                                                                                                                                |                                                  | Expected Results                                                                                                                                                                                                                                                                                                        | Observations |  |
| 1.                             | Check the definition of the modules in the middleware<br>documentation. Check especially the interface definitions<br>and whether there is a guidance for upgrading the<br>modules to a new product version. |                                                  | The middleware is based on modular components, which can be<br>replaced by new implementations or there are explanations why<br>this is not necessary. The interfaces and upgrade strategies are<br>documented.                                                                                                         |              |  |
| 2.                             | Check,<br>whether the IT system is trustworthy,<br>on which<br>the module is implemented.                                                                                                                    |                                                  | There are vendor statements about the trustworthy IT system,<br>which serves as a platform for the execution of the modules.                                                                                                                                                                                            |              |  |
|                                | For this purpose,<br>the vendor could provide an<br>especially<br>hardened system or could assume an<br>especially hardened<br>system.                                                                       |                                                  |                                                                                                                                                                                                                                                                                                                         |              |  |
|                                | The test fails, if no settings for the baseline system are<br>assumed or already provided.4                                                                                                                  |                                                  |                                                                                                                                                                                                                                                                                                                         |              |  |

<span id="page-22-2"></span><span id="page-22-1"></span><sup>4</sup> For example, if the vendor just states that the product runs on the platform XYZ, the test fails. If the vendor states that the products runs on the platform XYZ and a security white paper of the vendor of this platform may be considered, the test passes.

|         | Identifier | A-01                                                                                                                                                                                                                                                               |  |
|---------|------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 3.      |            | Check the TOT and/or the user manual, whether the<br>The Modules are neither a logical nor functional component of<br>Modules are neither a logical or functional component of<br>upstream IT specialist applications.<br>an upstream IT specialized applications. |  |
| Verdict |            |                                                                                                                                                                                                                                                                    |  |

**4.1.2 A-02 – The upper Interfaces (inbound and outbound) of the TR-ESOR-Middleware shall be the XML-based S.4- or S.512-Interfaces, based on open, standardised data formats, or in case of Upload-/Download-Module shall be based on open, standardised cryptographically protocols with standardised data formats and interfaces**

<span id="page-24-0"></span>

|                     | Identifier    | A-02                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                               |
|---------------------|---------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| Requirement         |               | MD:A4.3-1                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                               |
|                     |               | MD:A6.1-1                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                               |
|                     |               | MD:A6.1-2                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                               |
|                     |               | MD:A6.2-1                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                               |
|                     |               | MD:A6.3-3                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                               |
|                     |               | MD:A7.2-7                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                               |
|                     |               | MD:A7.2-8                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                               |
|                     |               | MD:A7.4-12                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                               |
|                     |               | MD:A7.4-14                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                               |
| M1:A3.2-1           |               |                                                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                               |
|                     |               | M1:A3.2-2                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                               |
| Test Purpose        |               | The test shall<br>verify that the interfaces<br>for the exchange of data between the                                                                                                                                                                                                                                                                                                                             |                                                                                               |
|                     |               | -<br>client application or XML-Adapter or Transformer Module and<br>-<br>the TR-ESOR-Middleware                                                                                                                                                                                                                                                                                                                  |                                                                                               |
| are                 |               | generally described in the user manual and realised as XML-based S.4-                                                                                                                                                                                                                                                                                                                                            | or S.512-interfaces<br>with corresponding schema definitions.                                 |
|                     |               | If the Upload-<br>and Download-Modules are also implemented, it<br>shall<br>data formats<br>and interfaces.                                                                                                                                                                                                                                                                                                      | also to be checked wheter these interfaces are also based on open, standardised protocols and |
| Configuration       |               | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                               |
|                     |               | Conditional:<br>CONFIG_Uplaod,                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                               |
|                     |               | Conditional:<br>CONFIG_Download.                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                               |
| Pre-test conditions |               | •<br>Test user has user manual.                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                               |
|                     |               | •<br>Conditional: If existent, the Upload-<br>and Download-Module are installed and configured. Upload-Module<br>shall<br>be configured in such a way that<br>only<br>Upload of BIN,<br>linked<br>to a<br>LXAIP and referenced there acc. to [TR-ESOR-F<br>Sec. 3.2], is<br>possible. The Upload-/Download-Module shall<br>use<br>standardised, non-proprietary and published cryptographical protocols<br>only. |                                                                                               |
| Step                | Test sequence | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                 | Observations                                                                                  |

|         | Identifier                                                                                                                                                                                                   |                                                                                                            | A-02                                                                                                                                                                                                                                                 |  |
|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 1.      | Check in the user manual, whether the TOT external<br>defined as XML-based S.4-<br>a look at the interface definitions within the annex<br>ESOR-E]).                                                         | upper interfaces for data exchange are described and<br>or S.512-interfaces (e.g. take<br>[TR              | All interfaces are defined as XML-based S.4-<br>or S.512-interfaces.                                                                                                                                                                                 |  |
| 2.      | their definitions described in the user manual.                                                                                                                                                              | Compare the implemented data exchange interfaces with                                                      | The interfaces are implemented the way they have been defined<br>and fulfil the requirements of the TR.                                                                                                                                              |  |
| 3.      | Conditional:<br>If the Upload-<br>implemented, check in the user manual, whether the<br>interfaces of the Upload-<br>open, standardised interfaces of standardised<br>cryptographical protocols data formats | and Download-Module are<br>and Download-Module, use<br>and interfaces.                                     | The interfaces of the Upload-<br>and Download-Interface are<br>standardised, non-proprietary and published<br>interfaces<br>of<br>standardised cryptographical protocols. The used standards are<br>documented in the user manual of the middleware. |  |
| 4.      | If the Upload-<br>Conditional:<br>the Upload-<br>and Download-Module<br>described in the user manual.                                                                                                        | and Download-Module are<br>implemented, compare the implemented data exchange of<br>with their definitions | The interfaces and protocols are implemented the way they have<br>been defined and fulfil the requirements of the TR.                                                                                                                                |  |
| Verdict |                                                                                                                                                                                                              |                                                                                                            |                                                                                                                                                                                                                                                      |  |

| Identifier                                                                                                                                          |               | A-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                            |              |  |
|-----------------------------------------------------------------------------------------------------------------------------------------------------|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement                                                                                                                                         |               | MD:A7.2-2<br>MD:A7.2-4<br>MD:A7.2-5<br>MD:A7.2-6<br>MD:A7.2-7                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                            |              |  |
|                                                                                                                                                     |               | M1:A4.0-5<br>M3:A5.1-1<br>M3:A5.1-2<br>OVR-7.16-03<br>PRP-8.1-01<br>PRP-8.1-03<br>The test shall                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                            |              |  |
| Test Purpose                                                                                                                                        |               | verify (i) that any access from a source module to a target module can only take place via defined interfaces and is impossible without prior mutual<br>authentication, (ii) that the mutual authentication between source and target module is cryptographically sufficient so that it is impossible to exchange individual<br>components without being noticed and (iii) that it is impossible to bypass authentication mechanisms of two components by a replay attack. |                                                                                                            |              |  |
| Configuration                                                                                                                                       |               | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                            |              |  |
| Pre-test conditions                                                                                                                                 |               | Source and target module are not mutually authenticated.<br>•<br>•<br>User manual is present.                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                            |              |  |
| Step                                                                                                                                                | Test sequence |                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Expected Results                                                                                           | Observations |  |
| 1.<br>Check the user manual for information about<br>standardised interfaces.                                                                       |               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | The list of interfaces and authentications possibilities pursuant to a<br>standardised protocol is stated. |              |  |
| 2.<br>Check the user manual for information about the used<br>standard, which is fulfilled by the protocol between the<br>source and target module. |               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | A standardised protocol is in usage.                                                                       |              |  |

## <span id="page-26-1"></span>**4.1.3 A-03 – No access without mutual authentication[5](#page-26-1)**

<span id="page-26-0"></span><sup>5</sup> The following test course assumes that the mutual authentication of the entities can be separated. In fact, there are situations where for security reasons such a separation isn't possible. In such cases the test course must be anticipated.

<span id="page-27-0"></span>

|         | Identifier                                                                                                                                                                               |                                                                                                                | A-03                                                                                                                                                                                                                   |  |
|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 3.      | Send requests to the target module (the TOT6) without<br>any identification or authentication at all.                                                                                    |                                                                                                                | One of the following results is expected:<br>-<br>A response is given that the request couldn't be executed.                                                                                                           |  |
| 4.      | Send requests to the target module (the TOT) after the<br>valid authentication of<br>the source module only.                                                                             |                                                                                                                | One of the following results is expected:<br>-<br>A response is given that the request couldn't be executed.                                                                                                           |  |
| 5.      | Send requests to the target module (the TOT) after the<br>valid authentication of source and target module.                                                                              |                                                                                                                | A valid response is<br>sent back by the target module.                                                                                                                                                                 |  |
| 6.      | After step 4 send another request to the target module<br>(the TOT) without mutual authentication.                                                                                       |                                                                                                                | If there is no secured tunnel established:<br>-<br>A response is given that the request couldn't be executed.<br>If there is a secured tunnel established:<br>-<br>A valid response is sent back by the target module. |  |
| 7.      | Replace the source module by a fake. Do not take over<br>the authentication credentials of the source module.                                                                            |                                                                                                                | n/a                                                                                                                                                                                                                    |  |
| 8.      | Try to establish a connection between source and target<br>component (the TOT) without authentication.                                                                                   |                                                                                                                | -<br>A response is given that the request couldn't be executed.                                                                                                                                                        |  |
| 9.      | Try to establish a connection between source and target<br>component (the TOT) with authentication.<br>Try to also fake the authentication credentials of<br>the<br>faked source module. |                                                                                                                | -<br>A response is given that the request couldn't be executed.                                                                                                                                                        |  |
| 10.     | Start logging the data traffic between the TOT and<br>another component.                                                                                                                 |                                                                                                                | The data logging process has been started.                                                                                                                                                                             |  |
| 11.     | source to target module (TOT).                                                                                                                                                           | Establish a valid and mutually authenticated connection<br>between the two components and place a request from | A valid connection is established and a valid answer from the TOT<br>is received.                                                                                                                                      |  |
| 12.     | Close the connection of the two components.                                                                                                                                              |                                                                                                                | The complete data exchange between the components has been<br>intercepted and logged.                                                                                                                                  |  |
| Verdict |                                                                                                                                                                                          |                                                                                                                |                                                                                                                                                                                                                        |  |

<sup>6</sup> TOT = ArchiSafe or Upload-Module or Download-Module or ECM/Liong-Term Storage (see also A-03.1 and A-03.2)

| Identifier | A-03 |
|------------|------|
|            |      |

#### **4.1.3.1 A-03.1 – Mutual authenticated secure communication channel between client application and ArchiSafe-Module or Upload-Module or Download-Module**

#### **Pre-supposition:**

An ArchiSafe-Module or Upload- or Download-Module, which has an interface to a Client application.

| Identifier                                                                                                           |               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | A-03.1                                                                                                                                                                                                         |              |
|----------------------------------------------------------------------------------------------------------------------|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| MD:A.5.1-28<br>Requirement<br>MD:A.7.2-2<br>MD:A.7.2-5<br>MD:A.7.2-6<br>MD:A.7.2-7<br>PRP-8.1-01                     |               | PRP-8.1-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                |              |
| Test Purpose                                                                                                         |               | The test shall<br>verify whether a secure communication channel with certificate-based, mutual authentication is used for each transmission between the ArchiSafe<br>module or Upload-Module or Download-Module and the XML module and<br>the<br>client application.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                |              |
| Configuration                                                                                                        |               | CONFIG_ArchiSafe (includes secure Channel enforcement by ArchiSafe) if an ArchiSafe Module is present<br>CONFIG_Upload (with secure Channel, e.g. TLS<br>or other enforcement by Upload) if an Upload-Module is present<br>Conditional:<br>Conditional:<br>CONFIG_Download (<br>with secure Channel, e.g.<br>TLS<br>or other enforcement by Download) if an Download-Module is present                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                |              |
| Pre-test conditions                                                                                                  |               | •<br>The IT system documentation is available<br>•<br>If required, perform identification and authentication<br>•<br>Administration access to the IT systems is needed<br>•<br>"XAIP" shall<br>be supported,<br>"LXAIP" may be supported, if configured<br>(only via a secure communication channel between client application and<br>ArchiSafe).<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>shall be configured.<br>[TR-ESOR-TRANS]<br>•<br>BIN<br>shall be restricted<br>to the preservation object formats<br>described in clause 2, Notice 4.<br>•<br>Conditional: If existent, the Upload-<br>and Download-Module are installed and configured. Upload-Module is configured in such a way that only Upload of<br>BIN linked to a<br>LXAIP and referenced there acc. to [TR-ESOR-F<br>Sec. 3.2] is possible. The Upload-/Download-Module uses<br>standardised, non-proprietary<br>and publishedcryptographical protocols<br>only.<br>•<br>The test dispenses if the pre-supposition is not valid. |                                                                                                                                                                                                                |              |
| Step                                                                                                                 | Test sequence |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Expected Results                                                                                                                                                                                               | Observations |
| 1.<br>Verify that the client application also use a secure<br>channel for the communication with the S.4 or S.512 of |               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | The client application is configured in such a way that a secure<br>channel with certificate-based mutual authentication will be used.<br>The client application and the Upload-Module, if implemented,<br>are |              |

<span id="page-30-2"></span><span id="page-30-1"></span><span id="page-30-0"></span>

| Identifier |                                                                                                                                                                                   | A-03.1                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                        |  |
|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|            | [ETSI TS119512]<br>Upload-Module or the Download-Module,<br>Upload BIN<br>to [TR-ESOR-F<br>Sec. 3.2];<br>standardised, non-proprietary and published<br>cryptographical protocols | 7 interface of ArchiSafe<br>or the<br>if<br>implemented. The Upload-Module is usable only for<br>linked to a LXAIP and referenced there acc.<br>no<br>Upload<br>of XAIP nor<br>LXAIP is possible. The Upload-/Download-Module use<br>only. | configured in such a way that only Upload of BIN linked to a<br>LXAIP and referenced there acc. to [TR-ESOR-F<br>Sec. 3.2] is<br>possible. Upload-/Download-Module uses<br>standardised, non<br>proprietary and published cryptographical protocols only.              |  |
| 2.         | BIN,<br>XAIP(BIN).                                                                                                                                                                | Try to store a XAIP_OK_SIG or LXAIP_OK_SIG or<br>and then retrieve a new (L)XAIP_OK_SIG<br>or                                                                                                                                              | Data can be transmitted and the function be called. The XAIP/BIN<br>can be stored.<br>Only TR-ESOR S.4 or the S.512 of [ETSI TS<br>119<br>8 -<br>512]<br>interface is used.                                                                                            |  |
| 3.         |                                                                                                                                                                                   | Disable the authentication on the client application site.                                                                                                                                                                                 | Data encryption is not active any more on client application site.<br>ArchiSafe or the equivalent middleware interface still requires a<br>mutual authentication.                                                                                                      |  |
| 4.         | Try to store a XAIP_OK_SIG or<br>BIN<br>XAIP(BIN).<br>Try to update an existing archive object.<br>Try to delete an existing archive object.                                      | LXAIP_OK_SIG or<br>and then retrieve a new XAIP_OK_SIG or                                                                                                                                                                                  | No data is transmitted because no encryption tunnel is active.<br>ArchiSafe or the equivalent middleware interface does not accept<br>any unencrypted connection.<br>9 -interface<br>Only TR-ESOR S.4 or the S.512 of [ETSI TS<br>119<br>512]<br>of ArchiSafe is used. |  |
| 5.         | Conditional: If<br>from No. 2 to No. 4 are to be repeated for LXAIP.                                                                                                              | LXAIP is implemented,<br>the test steps                                                                                                                                                                                                    | See expected results of the test cases from No. 2 to No. 4<br>for<br>LXAIP.                                                                                                                                                                                            |  |
| 6.         | Conditional:<br>Module implemented,<br>Upload-<br>and Download-Module.                                                                                                            | If the Upload-Module and the Download<br>verify that the client application<br>also use a secure channel for the communication with the                                                                                                    | The client application is configured in such a way that a secure<br>channel with certificate-based mutual authentication will be used.                                                                                                                                 |  |
| 7.         | Conditional:<br>Module are implemented,                                                                                                                                           | If the Upload-Module and the Download<br>verify that the client<br>application is not allowed to upload XAIP nor LXAIP in                                                                                                                  | The client application is configured in such a way that a secure<br>channel with certificate-based mutual authentication will be used.<br>No XAIP or LXAIP is transmitted by Upload-Module, because no                                                                 |  |

<sup>7</sup> Either S.4 or S.512 shall be supported.

<sup>8</sup> Either S.4 or S.512 shall be supported.

<sup>9</sup> Either S.4 or S.512 shall be supported.

| Identifier |                                                                                                                                                                                                                                                                 | A-03.1                                                                                                                                                                                    |  |
|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|            | communication with the Upload<br>-Module.                                                                                                                                                                                                                       | XAIP nor LXAIP are<br>allowed to be stored by Upload-Module.                                                                                                                              |  |
| 8.         | Conditional:<br>If the Upload-Module and the Download<br>Module are implemented,<br>try to upload a BIN<br>linked to a<br>LXAIP and referenced there acc. to [TR-ESOR-F<br>Sec.<br>3.2] and then to download this BIN and<br>to retrieve<br>XAIP(BIN).          | Data can be transmitted and the function be called. The BIN can be<br>stored.<br>Then, the BIN is downloaded successfully and the<br>XAIP(BIN) is also retrieved sucessfully.             |  |
| 9.         | Conditional:<br>If<br>the Upload-Module and the Download<br>Module are implemented,<br>disable the authentication on<br>the client application<br>site.                                                                                                         | Data encryption is not active any more on client application site.<br>Upload Module and Download-Module still require a mutual<br>authentication.                                         |  |
| 10.        | Conditional:<br>If<br>the Upload-Module and the Download<br>Module are implemented, try to store a BIN<br>linked to<br>aLXAIP and referenced there acc. to [TR-ESOR-F<br>Sec.<br>3.2]<br>and then then to download this BIN and<br>retrieve a<br>new XAIP(BIN). | No data is transmitted by Upload-<br>or Download-Modul, because no<br>encryption tunnel is active. The Upload-Module and the<br>Download-Module do not accept any unencrypted connection. |  |
| Verdict    |                                                                                                                                                                                                                                                                 |                                                                                                                                                                                           |  |
|            |                                                                                                                                                                                                                                                                 |                                                                                                                                                                                           |  |

## **4.1.3.2 A-03.2 – Mutual authenticated secure communication between (XML Adapter or Transformer-Module) and (ArchiSafe-Module or Upload-Module or Download-Module) and between (Upload- or Download-Module) and the ECM/Long-Term Storage**

**Pre-supposition:**

• An ArchiSafe-Module or Upload- or Download-Module, which has an interface to an XML-Adapter or Transformer-Module

and/or

• An Upload- or Download-Module, which has an interface to the ECM/Long-Term Storage.

| Identifier                                                                                                                                                                                                                                                                      | A-03.2                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |              |  |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| MD:A.7.2-2<br>Requirement<br>PRP-8.1-01<br>PRP-8.1-03                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |              |  |
| The test shall<br>verify that when using a secure communication channel without certificate-based authentication, a transmission between the ArchiSafe Module or<br>Test Purpose<br>Upload-<br>or Download-Module<br>and the XML Adapter or Transformer-Module is not possible. |                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |              |  |
| Configuration                                                                                                                                                                                                                                                                   | CONFIG_ArchiSafe (includes secure Channel enforcement by ArchiSafe) if an ArchiSafe Module is present<br>Conditional:<br>CONFIG_Upload (includes e.g. TLS or other standardized<br>enforcement by Upload) if an Upload-Module is present<br>Conditional:<br>CONFIG_Download (includes e.g. TLS or other standardized enforcement by Download) if an Download-Module is present |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |              |  |
| Pre-test conditions                                                                                                                                                                                                                                                             | •<br>•<br>•<br>•<br>•<br>•<br>•                                                                                                                                                                                                                                                                                                                                                | The IT system documentation is available.<br>If required, perform identification and authentication.<br>Administration access to the IT systems is needed.<br>nor a Transformer-Module<br>This test dispenses if neither a<br>XML Adapter<br>nor an Upload-/Download-Module is implemented.<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>Conditional: If existent, the Upload-<br>and Download-Module are installed and configured. Upload-Module is configured in such a way that only Upload of<br>BIN linked to LXAIP and referenced there acc. to [TR-ESOR-F<br>Sec. 3.2] is possible. The Upload-/Download-Module uses<br>standardised, non-proprietary<br>and published cryptographical protocols only.<br>The test dispenses if the pre-supposition is not valid. |              |  |
| Step<br>Test sequence                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Observations |  |

<span id="page-33-1"></span><span id="page-33-0"></span>

|         | Identifier                                                                                                                                                                                                                                                                                                                          | A-03.2                                                                                                                                                                                                                                                                          |  |
|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 1.      | Verify that,<br>if existent,<br>the XML-Adapter and if<br>existend, the Transformer-Module<br>uses<br>a secure channel<br>tunnel for the communication with the S.4 or S.512 of<br>10 interface of ArchiSafe.<br>[ETSI TS119512]                                                                                                    | If existent, the XML-Adapter and if existent, the Transformer<br>Module is configured in such a way that a communication channel<br>with certificate-based mutual authentication with the S.4 or S.512<br>11 interface of ArchiSafe will be used.<br>of [ETSI TS<br>119<br>512] |  |
| 2.      | Establish a communication channel without using a<br>certificate on client application site.                                                                                                                                                                                                                                        | A secure channel cannot be established.                                                                                                                                                                                                                                         |  |
| 3.      | Establish a communication channel without using a valid<br>certificate on client application site.                                                                                                                                                                                                                                  | A channel cannot be established.                                                                                                                                                                                                                                                |  |
| 4.      | Conditional:<br>If<br>the Upload-Module and the Download<br>Module are implemented,<br>verify that the Upload<br>Module or<br>Download-Module<br>also use a secure channel<br>tunnel for the communication with the ECM/long-term<br>storage<br>by using standardised, non-proprietary and<br>published cryptographic<br>protocols. | Upload-Module or<br>Download-Module<br>are<br>configured in such a<br>way that a secure channel enforcement will be used<br>by using<br>standardised, non-proprietary and published cryptographical<br>protocols.                                                               |  |
| 5.      | Conditional:<br>If<br>the Upload-Module and the Download<br>Module or Transformer-Module are implemented,<br>establish a communication channel by using<br>standardised, non-proprietary and published<br>cryptographic protocols without using a certificate on<br>client application site.                                        | A secure channel cannot be established.                                                                                                                                                                                                                                         |  |
| 6.      | Conditional:<br>If<br>the Upload-Module and the Download<br>Module or Transformer-Module are implemented,<br>establish a communication channel<br>by using<br>standardised, non-proprietary and published<br>cryptographic protocols without using a valid<br>certificate<br>on client application site.                            | A channel cannot be established.                                                                                                                                                                                                                                                |  |
| Verdict |                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                 |  |

<sup>10</sup> Either S.4 or S.512 shall be supported.

<sup>11</sup> Either S.4 or S.512 shall be supported.

| Identifier          |                                                                                                                                                 | A-03.3                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                               |              |  |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|--|
| Requirement         |                                                                                                                                                 | MD:A7.2-3<br>PRP-8.1-01                                                                                                                                                                                                  |                                                                                                                                                                                                                                                               |              |  |  |
| Test Purpose        |                                                                                                                                                 | The test shall<br>verify that secure communication channels use cryptographic procedures that are strong enough to ensure data integrity and confidentiality.                                                            |                                                                                                                                                                                                                                                               |              |  |  |
| Configuration       |                                                                                                                                                 | CONFIG_ArchiSafe (includes secure channel (e.g. TLS) enforcement by ArchiSafe)<br>if an ArchiSafe Module is present                                                                                                      |                                                                                                                                                                                                                                                               |              |  |  |
| Pre-test conditions |                                                                                                                                                 | •<br>The middleware documentation is available<br>•<br>The IT system documentation is available<br>•<br>If required, perform identification and authentication<br>•<br>Administration access to the IT systems is needed |                                                                                                                                                                                                                                                               |              |  |  |
| Step                | Test sequence                                                                                                                                   |                                                                                                                                                                                                                          | Expected Results                                                                                                                                                                                                                                              | Observations |  |  |
| 1.                  | Verify that the client application also uses an encrypted<br>communication tunnel for the communication with the<br>S.4 interface of ArchiSafe. |                                                                                                                                                                                                                          | The client application is configured in such a way that an encrypted<br>communication tunnel with certificate-based mutual authentication<br>will be used.<br>The used algorithms are sufficiently strong<br>cryptographic procedures pursuant to [TR 02102]. |              |  |  |
| 2.                  | Try to establish an encrypted communication tunnel<br>using a weak encryption algorithm (e.g. RC2, DES) on<br>client application site.          |                                                                                                                                                                                                                          | A communication tunnel cannot be established.                                                                                                                                                                                                                 |              |  |  |
| 3.                  | Try to establish an encrypted communication tunnel<br>using a strong encryption algorithm (e.g. AES-128) on<br>client application site.         |                                                                                                                                                                                                                          | A communication tunnel can be established.                                                                                                                                                                                                                    |              |  |  |
| 4.                  | Try to establish an encrypted tunnel with illegal<br>parameters in the handshake message                                                        |                                                                                                                                                                                                                          | A tunnel cannot be established.                                                                                                                                                                                                                               |              |  |  |
| 5.                  | Try to establish an encrypted tunnel with a wrong or<br>incomplete certificate                                                                  |                                                                                                                                                                                                                          | A tunnel cannot be established.                                                                                                                                                                                                                               |              |  |  |
| 6.                  | Try<br>to establish an encrypted tunnel with a certificate<br>expired.                                                                          |                                                                                                                                                                                                                          | A tunnel cannot be established.                                                                                                                                                                                                                               |              |  |  |
| 7.                  | Try to establish an encrypted tunnel with a wrong MAC<br>algorithm.                                                                             |                                                                                                                                                                                                                          | A tunnel cannot be established.                                                                                                                                                                                                                               |              |  |  |

#### **4.1.3.3 A-03.3 – secure communication channels are based on suitable cryptographic procedures**

| Identifier | A-03.3 |
|------------|--------|
| Verdict    |        |
|            |        |

## <span id="page-36-1"></span>**4.1.4 A-04 – Authentication procedure shall be resistant against replay attacks**

| Identifier    |                                                                                                                                                  | A-04                                                                                                                     |                                                                                       |              |  |  |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|--------------|--|--|
| Requirement   |                                                                                                                                                  | MD:A7.4-21<br>MD:A7.4-22                                                                                                 |                                                                                       |              |  |  |
| Test Purpose  |                                                                                                                                                  | The test shall<br>verify that it is impossible to bypass authentication mechanisms of two components by a replay attack. |                                                                                       |              |  |  |
| Configuration |                                                                                                                                                  | CONFIG_Common                                                                                                            |                                                                                       |              |  |  |
|               | Pre-test conditions                                                                                                                              |                                                                                                                          |                                                                                       |              |  |  |
| Step          | Test sequence                                                                                                                                    |                                                                                                                          | Expected Results                                                                      | Observations |  |  |
| 1.            | another component.                                                                                                                               | Start logging the data traffic between the TOT12 and                                                                     | The data logging process has been started.                                            |              |  |  |
| 2.            | Establish a valid and mutually authenticated connection<br>between the two components and place a request from<br>source to target module (TOT). |                                                                                                                          | A valid connection is established and a valid answer from the TOT<br>is received.     |              |  |  |
| 3.            | Close the connection of the two components.                                                                                                      |                                                                                                                          | The complete data exchange between the components has been<br>intercepted and logged. |              |  |  |
| 4.            | Replay the intercepted data in order to establish a valid<br>authenticated connection between the attacker and the<br>TOT.                       |                                                                                                                          | No connection is established.                                                         |              |  |  |
| Verdict       |                                                                                                                                                  |                                                                                                                          |                                                                                       |              |  |  |

<span id="page-36-0"></span><sup>12</sup> TOT = ArchiSafe or Upload-Module or Download-Module or ECM/Liong-Term Storage (see also A-03.1 and A-03.2)

## **4.1.5 A-05 – Protection of communication channel and interface shall be robust against DoS-attacks**

<span id="page-37-0"></span>

| Identifier    |                                                                                                                                                                                                                                                                                                                                | A-05                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                 |              |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| Requirement   |                                                                                                                                                                                                                                                                                                                                | MD:7.4-26                                                                                                                                                                                                                                                                                                      |                                                                                                                                                                 |              |
| Test Purpose  |                                                                                                                                                                                                                                                                                                                                | The test shall<br>verify that any unauthorised access to authentication or payload data during communication is reliably prevented and that the<br>interface is implemented<br>in such a way that denial of service (DoS) or consequential errors, such as buffer overflow or SQL injections are not possible. |                                                                                                                                                                 |              |
| Configuration |                                                                                                                                                                                                                                                                                                                                | CONFIG_Common                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                 |              |
|               | Pre-test conditions                                                                                                                                                                                                                                                                                                            | •<br>If required, perform identification and authentication.                                                                                                                                                                                                                                                   |                                                                                                                                                                 |              |
| Step          | Test sequence                                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                | Expected Results                                                                                                                                                | Observations |
| 1.            | Start logging the data traffic between the TOT and<br>another component.                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                | The data logging process has been started.                                                                                                                      |              |
| 2.            | Establish a valid and mutually authenticated connection<br>between the two components and place a request from<br>source to target module (TOT).                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                | A valid connection is established and a valid answer from the TOT<br>is received.                                                                               |              |
| 3.            | Close the connection of the two components.                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                | The complete data exchange between the components has been<br>intercepted and logged.                                                                           |              |
| 4.            | Check if the logged traffic data reveals any authorisation<br>or payload data.                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                | No authorisation or payload data is revealed.                                                                                                                   |              |
| 5.            | Automatically send a large amount of small requests to<br>the TOT interface in a short period of time and check if<br>its availability is affected (DoS). Use several client<br>applications on several computers in parallel in order to<br>completely fill the network bandwidth of at least 10 Mbit<br>provided to the TOT. |                                                                                                                                                                                                                                                                                                                | The availability is not affected in a negative way. The TOT<br>responses to all the requests or identify the DoS targets and block<br>them.                     |              |
| 6.            | Establish a valid connection between the components<br>and place requests to the TOT with large amounts of data<br>to provoke buffer overflows.                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                | -<br>The sent data is properly processed and checked for plausibility.<br>-<br>Invalid data is rejected<br>-<br>No buffer overflow will occur                   |              |
| 7.            | command sequences.                                                                                                                                                                                                                                                                                                             | Establish a valid connection between the components<br>and place requests to the TOT with included database                                                                                                                                                                                                    | -<br>The sent data is properly processed and checked for plausibility.<br>-<br>Invalid data is rejected<br>-<br>The included database commands are not executed |              |
| Verdict       |                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                 |              |

| Identifier | A-05 |
|------------|------|
|            |      |

## **4.1.6 A-06 – A secure tunnel can be maintained after successful authentication**

<span id="page-39-0"></span>

| Identifier          |                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | A-06                                                                                                                                                                                                                                                 |              |  |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|--|
| Requirement         |                                                                                                                                                                                                                                                                                                                                           | M2:A6.2-1<br>MD:7.2-4<br>MD:7.2-6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                      |              |  |  |
| Test                | Purpose                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | A secure tunnel can be maintained after successful authentication                                                                                                                                                                                    |              |  |  |
| Configuration       |                                                                                                                                                                                                                                                                                                                                           | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                      |              |  |  |
| Pre-test conditions |                                                                                                                                                                                                                                                                                                                                           | •<br>Tester has access rights to the Cryptographic Module<br>•<br>No mutual authentication between the Cryptographic Module and the interface partner was made<br>•<br>M.2 is configured to use a secure tunnel<br>•<br>The hash of XAIP_OK_SIG or XAIP(BIN)<br>or BIN<br>is present<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F]<br>V1.2.2,<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F]<br>V1.2.2.<br>•<br>XAIP shall<br>be<br>supported,<br>"LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN<br>shall be restricted<br>to the preservation object formats<br>described in clause 2, Notice 4.<br>• |                                                                                                                                                                                                                                                      |              |  |  |
| Step                | Test sequence                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Expected Results                                                                                                                                                                                                                                     | Observations |  |  |
| 1.                  | Transfer the archival information package<br>XAIP_OK_SIG<br>or XAIP(BIN)<br>or BIN<br>or<br>DXAIP_OK_SIG<br>to the TOT using<br>the interface (S1)<br>function "VerifyRequest"<br>or "ValidateEvidence" ([TS<br>119 512]) Request.<br>Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence" Response. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | The call of the function with this XAIP / XAIP(BIN) / BIN /<br>DXAIP_OK_SIG<br>as parameter is possible but a negative feedback<br>will be received or the call of the function is not possible at all<br>because Crypto-Module declined connection. |              |  |  |
| 2.                  | Perform the mutual authentication.                                                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Performing of the authentication is possible.                                                                                                                                                                                                        |              |  |  |
| 3.                  | Transfer the archival information package<br>XAIP_OK_SIG<br>or XAIP(BIN)<br>or BIN<br>to the TOT using<br>the interface (S1) function "VerifyRequest"<br>in case of<br>S.x-<br>or S.512-interfaces.                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | The call of the function with this XAIP / XAIP(BIN) / BIN<br>/DXAIP_OK_SIG<br>as parameter is possible.                                                                                                                                              |              |  |  |

| Identifier |                                                                                                                                                                                                       |                                             | A-06                                                                                                                    |
|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
| 4.         | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                                                |                                             | A positive feedback will be received; no error message or error<br>code.                                                |
| 5.         | Transfer the archival information package XAIP_OK<br>or<br>XAIP(BIN)<br>or BIN<br>or<br>DXAIP_OK_SIG<br>to the TOT<br>using<br>the interface (S1) function "SignRequest" (if the<br>function exists). |                                             | If the function exists, the call of the function with this XAIP /<br>X(BIN)/ BIN/DXAIP_OK_SIG as parameter is possible. |
| 6.         | Observe the output of the interface function<br>"SignResponse".                                                                                                                                       |                                             | A positive feedback will be received; no error message or error<br>code.                                                |
| 7.         | Transfer the hash of the archival information package<br>XAIP_OK<br>or XAIP(BIN)<br>or BIN<br>or DXAIP_OK_SIG<br>to the TOT using<br>the interface (S3) function<br>"TimestampRequest".               |                                             | The call of the function with this hash as parameter is possible.                                                       |
| 8.         | Observe the output of the interface function<br>"TimestampResponse".                                                                                                                                  |                                             | A positive feedback will be received; no error message or error<br>code.                                                |
| 9.         | Transfer the archival information package XAIP_OK<br>or<br>r XAIP(BIN)<br>or BIN<br>or DXAIP_OK_SIG<br>to the TOT<br>using the interface (S3) function "HashRequest".                                 |                                             | The call of the function with this XAIP / X(BIN)/<br>BIN/DXAIP_OK_SIG as parameter is possible.                         |
| 10.        | Observe the output of the interface function<br>"HashResponse".                                                                                                                                       |                                             | A positive feedback will be received; no error message or error<br>code.                                                |
| 11.        | Conditional: If<br>1 to No. 10 are repeated for LXAIP.                                                                                                                                                | LXAIP is implemented,<br>the test steps No. | See expected results of No. 1 to No. 10.                                                                                |
| Verdict    |                                                                                                                                                                                                       |                                             |                                                                                                                         |

## **4.1.7 A-07 – Secure administration interfaces**

<span id="page-41-0"></span>

| Identifier                         |                                                                                                                                 |                  | A-07                                                                                                                                        |              |
|------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|------------------|---------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|                                    | Requirement                                                                                                                     | MD:A6.1-5        |                                                                                                                                             |              |
| The test shall<br>Test Purpose     |                                                                                                                                 |                  | verify that the middleware supports secure administration and configuration.                                                                |              |
|                                    | Configuration                                                                                                                   | CONFIG_ArchiSafe |                                                                                                                                             |              |
| •<br>Pre-test conditions<br>•<br>• |                                                                                                                                 |                  | The middleware is installed and configured<br>The middleware documentation is available<br>The user has administration rights on the system |              |
| Step                               | Test sequence                                                                                                                   |                  | Expected Results                                                                                                                            | Observations |
| 1.                                 | Check the middleware documentation for the<br>possibilities of administration and configuration.                                |                  | The documentation states that secure administration and<br>configuration is possible.                                                       |              |
| 2.                                 | Check the middleware's administration and configuration<br>features.                                                            |                  | The middleware supports secure<br>administration and configuration.                                                                         |              |
| 3.                                 | Start a data traffic capture tool to record the data between<br>client application and middleware.                              |                  | Data traffic capturing is started.                                                                                                          |              |
| 4.                                 | Try to connect remotely to the middleware<br>administration and configuration interface.                                        |                  | The credentials of an authorised user are needed to access the<br>administration and configuration interface.                               |              |
| 5.                                 | Try to log in to the middleware administration and<br>configuration interface using the credentials of an<br>unauthorised user. |                  | Access is denied.                                                                                                                           |              |
| 6.                                 | Try to log in to the middleware administration and<br>configuration interface using the credentials of an<br>authorised user.   |                  | Access is granted.                                                                                                                          |              |
| 7.                                 | Change several options<br>and save the current settings.                                                                        |                  | It is possible to change the configuration and save the new settings.                                                                       |              |
| 8.                                 | Stop the data traffic capture tool.                                                                                             |                  | Data traffic capturing is stopped.                                                                                                          |              |
| 9.                                 | Check the captured traffic log file.                                                                                            |                  | All the data that was transmitted during<br>the administration process<br>is encrypted.                                                     |              |
| Verdict                            |                                                                                                                                 |                  |                                                                                                                                             |              |

| Identifier | A-07 |
|------------|------|
|            |      |

## **4.1.8 A-08 – No security breach induced by administration interfaces or components**

<span id="page-43-0"></span>

| Identifier          |                                                                                                                                                                | A-08                                                                                                                                                                                                                                                                                                                      |                                                                                                                  |              |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|--------------|
| Requirement         |                                                                                                                                                                | MD:A7.4-18<br>M2:A6.3-4                                                                                                                                                                                                                                                                                                   |                                                                                                                  |              |
| Test Purpose        |                                                                                                                                                                | The test shall<br>verify, that security characteristics of the middleware overall and of individual components, as well as the integrity and the authenticity of the stored<br>data and documents can not compromised by an administration interface of the middleware or individual<br>components without being noticed. |                                                                                                                  |              |
| Configuration       |                                                                                                                                                                | CONFIG_Common                                                                                                                                                                                                                                                                                                             |                                                                                                                  |              |
| Pre-test conditions |                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                           |                                                                                                                  |              |
| Step                | Test sequence                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                           | Expected Results                                                                                                 | Observations |
| 1.                  | Check whether the access to administration interfaces is<br>possible without any means of identification and<br>authentication.                                |                                                                                                                                                                                                                                                                                                                           | When accessing the administration interfaces, the user is asked for<br>authentication.                           |              |
| 2.                  | Check whether any archive data can be accessed using<br>the administrative interfaces that should<br>not be<br>accessible for the authenticated administrator. |                                                                                                                                                                                                                                                                                                                           | No unauthorised access to any documents is possible.                                                             |              |
| 3.                  | Check whether any administration settings can be<br>accessed that should<br>not be accessible for an<br>authenticated non-administrative user.                 |                                                                                                                                                                                                                                                                                                                           | No unauthorised access to any administration setting is possible.                                                |              |
| 4.                  | Check whether the administrative interface can still be<br>used for administration after logging out.                                                          |                                                                                                                                                                                                                                                                                                                           | After logging out of any administration interface none of its<br>functions are available any more.               |              |
| 5.                  | Check whether the actions performed by the<br>administration interfaces are recorded in a log file.                                                            |                                                                                                                                                                                                                                                                                                                           | The log file shows the performed administrative actions.                                                         |              |
| 6.                  | Check whether the administration interfaces allow<br>altering digitally signed documents while bypassing the<br>required cryptographic functions.              |                                                                                                                                                                                                                                                                                                                           | It is not possible to alter a digitally signed document while<br>bypassing the required cryptographic functions. |              |
| Verdict             |                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                           |                                                                                                                  |              |
|                     |                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                           |                                                                                                                  |              |

<span id="page-44-0"></span>

| Identifier                     |                                                                                                                                  |                                                           | A-09                                                                                                                                    |              |
|--------------------------------|----------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------|--------------|
|                                | Requirement                                                                                                                      | MD:A7.4-17<br>M1:A4.0-4<br>PRP-8.1-01<br>PRP-8.1-03       |                                                                                                                                         |              |
|                                | Test Purpose                                                                                                                     | The test shall                                            | verify that any administration interfaces of the middleware or of any individual components are accessible to authorised accounts only. |              |
| CONFIG_Common<br>Configuration |                                                                                                                                  |                                                           |                                                                                                                                         |              |
| Pre-test conditions<br>•       |                                                                                                                                  |                                                           | The middleware is installed and configured.<br>The middleware documentation is available.                                               |              |
| Step                           | Test sequence                                                                                                                    |                                                           | Expected Results                                                                                                                        | Observations |
| 1.                             | account.                                                                                                                         | Check if there is an official definition of an authorised | The authorised accounts are defined.                                                                                                    |              |
| 2.                             | Try to access the administration interfaces without<br>authentication.                                                           |                                                           | It is not possible to access the administration interfaces without<br>authentication.                                                   |              |
| 3.                             | Try to intercept the authentication of an authorised<br>person to perform a replay attack.                                       |                                                           | The administration interfaces cannot be accessed.                                                                                       |              |
| 4.                             | Try to access the administration interfaces by guessing<br>administrator credentials or unchanged system default<br>credentials. |                                                           | The administration interfaces cannot be accessed.                                                                                       |              |
| Verdict                        |                                                                                                                                  |                                                           |                                                                                                                                         |              |
|                                |                                                                                                                                  |                                                           |                                                                                                                                         |              |

## **4.1.9 A-09 – Administration interfaces shall be available for authorised accounts only**

## <span id="page-45-1"></span>**4.1.10 A-10 – Additional interfaces[13](#page-45-1) shall not compromise security**

| Identifier          |                                                                                                 | A-10                                                                                                                                                                                                                                                                                                                 |              |  |
|---------------------|-------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                 | M1:A3.2-3                                                                                                                                                                                                                                                                                                            |              |  |
| Test Purpose        |                                                                                                 | The test shall<br>verify that the implementation of additional interfaces do<br>not compromise the guarantee of basic security-relevant requirements (see Chapter 5).                                                                                                                                                |              |  |
| Configuration       |                                                                                                 | CONFIG_Common                                                                                                                                                                                                                                                                                                        |              |  |
| Pre-test conditions |                                                                                                 | •<br>The test dispenses if no additional interfaces are implemented.<br>•<br>User manual is present                                                                                                                                                                                                                  |              |  |
| Step                | Test sequence                                                                                   | Expected Results                                                                                                                                                                                                                                                                                                     | Observations |  |
| 1.                  | additional interfaces of the<br>spoof another secure module (e.g. ArchiSafe or the<br>storage). | Perform test cases A-4 and A-5, and check whether the<br>The additional interfaces do not provide such a capability or do<br>TOT enables an attacker to<br>even not provide the property to connect from or to other modules.                                                                                        |              |  |
| 2.                  | circumventing security features.                                                                | Perform test cases A-4 and A-5, and check whether the<br>The additional interfaces do not provide such a capability or do<br>additional interfaces of the TOT enables an attacker to<br>even not provide the property to connect from or to other modules.<br>submit a data object or to request Evidence Records by |              |  |
| 3.                  | circumvent the self-test function.                                                              | Perform test cases A-4 and A-5, and check whether the<br>The additional interfaces do not provide such a capability.<br>additional interfaces of the TOT enables an attacker to                                                                                                                                      |              |  |
| Verdict             |                                                                                                 |                                                                                                                                                                                                                                                                                                                      |              |  |
|                     |                                                                                                 |                                                                                                                                                                                                                                                                                                                      |              |  |

<span id="page-45-0"></span><sup>13</sup> Other than the S.4- or S.512 interface

## **4.2 Module 1 – ArchiSafe**

#### **Pre-supposition**:

A product, which claims to comply with the M.1 ArchiSafe specification of this TR, has to pass

- all test cases in this section and
- all test cases for the interface S.4 specified in Section 4.5.4 or prove that it supports functional analogous interfaces.

## **4.2.1 M.1-01 – Preservation Services conform to [eIDAS-VO], [ETSI TS 119 401], [ETSI TS 119 511] and using the preservation product [TR-ESOR] should fulfil the security objectives and requirements of [ASS 319 401] and [ASS 119 511]**

## *NOTICE 5:*

The following assessment-criteria for ETSI 319 401 and ETSI TS 119 511 are developed as **Assessment/Audit Manuals for Conformity Assessment Bodies (CABs):**

<span id="page-46-0"></span>

| Short Name    | Title                                                                                                                                                                                                                                                     |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [ASS 319 401] | BSI,<br>Criteria for Assessing Trust Service Providers against ETSI Policy<br>Requirements, Part 1: Assessment Criteria for all TSP -<br>ETSI EN 319 401                                                                                                  |
| [ASS 119 511] | BSI, Criteria for Assessing Trust Service Providers against ETSI Policy<br>Requirements, Part 2: Assessment Criteria providing long-term preservation of<br>digital signatures or general data using digital signature techniques -<br>ETSI TS<br>119 511 |

<span id="page-46-1"></span>and are to be found under the link [https://www.bundesnetzagentur.de/cln\\_121/EVD/DE/Fachkreis/Empfehlungen/Empfehlungen-node.html](https://www.bundesnetzagentur.de/cln_121/EVD/DE/Fachkreis/Empfehlungen/Empfehlungen-node.html) .

"If the PSP claims to use a certified **TR-ESOR product [TR-ESOR] of version V1.2.1 or higher** and the claimed **[TR-ESOR]** certified product is in fact deployed for providing this service, proved e.g. by comparing the digital fingerprint of relevant executables, then the assessment result of the equivalent **[ETSI TS 119 511]** test case is substituted by the TR-ESOR-certification result and this **[ETSI TS 119 511]** - assessment test step SHALL be omitted." (see **[ASS 119 511]**, clause 3.4.1)

The Federal Office for Information Security **recommends** that the certification of Preservation Services pursuant to **[eIDAS-VO]**, **[ETSI TS 119 401]**, **[ETSI TS 119 511]** is based on these Criteria for Assessing Trust Service Providers **[ASS 319 401]** and **[ASS 319 401]** including the **Integration of TR-ESOR Products in the ETSI TS 119 511 certification process, as described in [ASS 119 511]**.

<span id="page-48-0"></span>

| Identifier          |                                                                                                                | M.1-02                                                                                                                                                                                                                            |                                                                                                                                                                                                  |              |
|---------------------|----------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| Requirement         |                                                                                                                | M1:A3.1-2                                                                                                                                                                                                                         |                                                                                                                                                                                                  |              |
| Test Purpose        |                                                                                                                | The test shall<br>verify that the ArchiSafe module is a component of the middleware and runs as an independent application or as an independent<br>(functionally<br>separated) part of an application on a trustworthy IT system. |                                                                                                                                                                                                  |              |
| Configuration       |                                                                                                                | CONFIG_ArchiSafe                                                                                                                                                                                                                  |                                                                                                                                                                                                  |              |
| Pre-test conditions |                                                                                                                | •<br>The middleware documentation is available<br>•<br>The IT system documentation is available                                                                                                                                   |                                                                                                                                                                                                  |              |
| Step                | Test sequence                                                                                                  |                                                                                                                                                                                                                                   | Expected Results                                                                                                                                                                                 | Observations |
| 1.                  | Check the IT system documentation about the<br>implemented security mechanisms for the underlying<br>platform. |                                                                                                                                                                                                                                   | There are recommendations or requirements to ensure the<br>trustworthiness of the platform ArchiSafe is running on.<br>Alternatively, ArchiSafe is delivered on a security enhanced<br>platform. |              |
| 2.                  | Check the middleware documentation for a description<br>of the design of the ArchiSafe module.                 |                                                                                                                                                                                                                                   | The ArchiSafe module is designed as an independent module or is<br>at least functionally separated from other parts of the product.                                                              |              |
| Verdict             |                                                                                                                |                                                                                                                                                                                                                                   |                                                                                                                                                                                                  |              |
|                     |                                                                                                                |                                                                                                                                                                                                                                   |                                                                                                                                                                                                  |              |

## **4.2.2 M.1-02 – ArchiSafe-module shall be separated and deployed on a trustworthy IT system**

**4.2.3 M.1-03 – Access to ECM storage shall be claimed to be controlled by ArchiSafe module and if existent, also by the Upload- and Download-Module**

<span id="page-49-0"></span>

| Identifier                                                         | M.1-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |              |  |
|--------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement                                                        | MD:A7.4-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |              |  |
|                                                                    | MD:A7.4-12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |              |  |
|                                                                    | MD:A7.4-13                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |              |  |
|                                                                    | M1:A3.1-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |              |  |
|                                                                    | M1:A3.1-3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |              |  |
|                                                                    | M1:A5.0-2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |              |  |
| Test Purpose                                                       | The test shall<br>verify that any application access to the data on the ECM/long-term storage via the TOT (TR-ESOR Middleware) is claimed to be controlled and<br>performed by the ArchiSafe module<br>and if existent, also by the Upload-<br>or Download-Module                                                                                                                                                                                                                                                                                |              |  |
| CONFIG_ArchiSafe<br>Configuration<br>Conditional:<br>CONFIG_Upload |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |              |  |
|                                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |              |  |
|                                                                    | Conditional:<br>CONFIG_Download                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |              |  |
| Pre-test conditions                                                | •<br>The ArchiSafe module is installed and configured<br>•<br>The middleware documentation is available<br>•<br>The user has administration rights on the system<br>•<br>Conditional: If existent, the Upload-<br>and Download-Module are installed and configured. Upload-Module is configured in such a way that<br>only Upload of<br>BIN linked to a LXAIP and referenced there acc. to [TR-ESOR-F<br>Sec. 3.2] is possible. The Upload-/Download-Module use standardised, non-proprietary<br>and publishedcryptographical protocols<br>only. |              |  |
| Step<br>Test sequence                                              | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Observations |  |

|         | Identifier                       |                                                        | M.1-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
|---------|----------------------------------|--------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 1.      | of the data storage process.     | Check the middleware documentation for the description | New data objects are not sent to the ECM/long-term storage<br>directly but only by using the middleware function calls<br>"ArchiveSubmissionRequest" or the "PreservePO" of the<br>ArchiSafe module<br>or, if existent, the protocols and interfaces of the<br>Upload-<br>and Download-Module.<br>Upload-Module is only allowed to upload BIN<br>linked to a LXAIP<br>and referenced there acc. to [TR-ESOR-F<br>Sec. 3.2] by using<br>standardised, non-proprietary and published cryptographical<br>protocols<br>only. |  |
| 2.      | of the data change process.      | Check the middleware documentation for the description | Existing data objects are not changed on the ECM/long-term<br>storage directly but only by using the middleware function calls<br>"ArchiveUpdateRequest" or the "UpdatePOC"<br>of the ArchiSafe<br>module.                                                                                                                                                                                                                                                                                                               |  |
| 3.      | of the<br>data deletion process. | Check the middleware documentation for the description | Existing data objects are not deleted from the ECM/long-term<br>storage directly but only by using the middleware function calls<br>"ArchiveDeletionRequest" or the "DeletePO<br>Request"<br>of the<br>ArchiSafe module.                                                                                                                                                                                                                                                                                                 |  |
| Verdict |                                  |                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  |

## **4.2.4 M.1-04 – Support of specified functions**

<span id="page-51-0"></span>

| Identifier          | M.1-04                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |
|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A5.1-1<br>MD:A4.3-1<br>MD:A6.1-1<br>MD:A6.2-1<br>MD:A6.3-3<br>M1:A4.0-1<br>AF:A3-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |  |
| Test Purpose        | The test shall<br>verify that the<br>only<br>interface TR-ESOR-S.4 or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>provides at least the following<br>functions:<br>•<br>A function for the secure and reliable storage of archival information packages<br>•<br>A function for retrieving archival information packages (in (L)XAIP format)<br>•<br>A function for retrieving technical (cryptographic) Evidence Records<br>•<br>A function for deleting archived data<br>•<br>A function for updating archival information packages that have already been archived<br>The test should<br>verify that the interface TR-ESOR-S.4 or the TS119512 interface S.512 in the profiling of<br>provides the following functions, if<br>[TR-ESOR-TRANS]<br>implemented:<br>•<br>A function for retrieving data elements of individual archival information packages<br>•<br>A function to verify an archive data object with evidence relevant data (digital signature, electronic time stamp, certificate, revocation lists, OCSP<br>responses, ) and technical evidence data (evidence record) |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |
| Pre-test conditions | or a functional analogous interface is<br>•<br>User manual for S.4 interface or for the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>accessible<br>or the functional analogous interface<br>•<br>Developer documents of S.4 interface or of the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>are accessible<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F],<br>•<br>DXAIP means "DXAIP" or "DLXAIP"" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be<br>supported,<br>"LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN<br>shall be restricted<br>to the preservation object formats<br>described in clause 2, Notice 4.                                                                                                                                                                                                                                                                                          |  |

| Identifier |                                                                                                                                                                                                                                                           |                                                                   | M.1-04                                                                                                                               |              |  |
|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
|            |                                                                                                                                                                                                                                                           | •                                                                 |                                                                                                                                      |              |  |
| Step       | Test sequence                                                                                                                                                                                                                                             |                                                                   | Expected Results                                                                                                                     | Observations |  |
| 1.         | Check if the middleware documentation contains the<br>description of the necessary functions, either pursuant to<br>S.4 or S.512.                                                                                                                         |                                                                   | The necessary functions are defined in the documentation.                                                                            |              |  |
| 2.         | Store an<br>XAIP_OK_SIG<br>or BIN<br>using the<br>"ArchiveSubmissionRequest" or the "PreservePO"<br>function<br>pursuant to S. 4 or S.512.                                                                                                                |                                                                   | The function call is possible.                                                                                                       |              |  |
| 3.         | Check the output of the "ArchiveSubmissionResponse"<br>or the "PreservePOResponse"<br>function.                                                                                                                                                           |                                                                   | The XAIP/BIN object is assigned to an AOID and returned<br>successfully.                                                             |              |  |
| 4.         | ,<br>Use<br>the "ArchiveUpdateRequest" or the<br>"UpdatePOC" function with the AOID from step 3<br>and a DXAIP_OK<br>to change the<br>data stored within the<br>XAIP/ XAIP(BIN)<br>pursuant to S.4 or S.512,                                              |                                                                   | The function call is possible.                                                                                                       |              |  |
| 5.         | Check the output of the "ArchiveUpdateResponse"<br>or<br>the "UpdatePOCResponse"<br>function.                                                                                                                                                             |                                                                   | A new version ID is received.                                                                                                        |              |  |
| 6.         | Use the "ArchiveRetrievalRequest" or the<br>"RetrievePO with SubjectOfRetrieval<br>"PO""<br>function with the AOID from step 3 to retrieve a<br>XAIP with all versions (e.g. Version Id = "all") from the<br>storage<br>pursuant to S.4 or S.512          |                                                                   | The function call is possible.                                                                                                       |              |  |
| 7.         | Check the output of the "ArchiveRetrievalResponse" or<br>the "RetrievePOResponse"<br>function.                                                                                                                                                            |                                                                   | The archive<br>data object is received in XAIP format.                                                                               |              |  |
| 8.         | Use the "ArchiveEvidenceRequest" or the<br>"RetrievePO<br>with SubjectOfRetrieval<br>"Evidence" "<br>the function with the AOID from step 3<br>to check the XAIP / BIN authenticity and integrity<br>concerning all versions<br>pursuant to S.4 or S.512. |                                                                   | The function call is possible.                                                                                                       |              |  |
| 9.         | the "RetrievePOResponse"                                                                                                                                                                                                                                  | Check the output of the "ArchiveEvidenceResponse" or<br>function. | If there exist only one version of the archive data object, one<br>Evidence Record is received. Otherwise, for each existing version |              |  |

| Identifier |                                                                                                                                                                                                                                                                                                                                                     | M.1-04                                                                                             |  |
|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|--|
|            |                                                                                                                                                                                                                                                                                                                                                     | an Evidence Record is received.                                                                    |  |
| 10.        | If the "ArchiveDataRequest" or the "Search<br>request" is implemented, use the<br>"ArchiveDataRequest" or the "Search<br>request"<br>function with the AOID from step 3 and a valid<br>dataLocation parameter to identify an individual data<br>element within the XAIP or BIN<br>pursuant to S.4 or S.512                                          | The function call is possible.                                                                     |  |
| 11.        | If the "ArchiveDataRequest" or the "Search<br>request" is implemented, check the output of the<br>"ArchiveDataResponse" or the<br>"SearchResponse" function.                                                                                                                                                                                        | The requested data value and the original location value are<br>received.                          |  |
| 12.        | Use the "ArchiveDeletionRequest" or the "DeletePO<br>Request"<br>function with the AOID from step 3 to delete<br>the XAIP or the BIN<br>pursuant to S.4 or S.512.                                                                                                                                                                                   | The function call is possible.                                                                     |  |
| 13.        | Check the output of the "ArchiveDeletionResponse"<br>or<br>the "DeletePOResponse"<br>function.                                                                                                                                                                                                                                                      | The XAIP or BIN has<br>been deleted from the storage.                                              |  |
| 14.        | If the "VerifyRequest" or the "ValidateEvidence<br>Request"<br>is implemented, use the "Verify Request"<br>or<br>the "ValidateEvidence<br>Request"<br>function with the<br>XAIP/BIN from step 7<br>and the evidence records from<br>step 9 to check the XAIP, the evidence relevant data and<br>the evidence record(s)<br>pursuant to S.4 or S.512. | The function call is possible.                                                                     |  |
| 15.        | If the "VerifyRequest" or the "ValidateEvidence<br>Request"<br>is implemented, check the output of the<br>"VerifyResponse" or the<br>ValidateEvidenceResponse function.                                                                                                                                                                             | The "VerifyRequest" is possible and returns a return code or a<br>verification report, if ordered. |  |
| 16.        | Check the results of the test cases<br>S.4.1-01 –<br>S.4.1-07<br>S.4.2-01 –<br>S.4.2-03<br>S.4.3-02<br>S.4.4-02,<br>S.4.4-03<br>S.4.5-01 –<br>S.4.5-04                                                                                                                                                                                              | The tests are performed successfully                                                               |  |

|         | Identifier                                                                                                    |  | M.1-04                                                                       |  |
|---------|---------------------------------------------------------------------------------------------------------------|--|------------------------------------------------------------------------------|--|
|         | S.4.6-01<br>or functional analogous test cases                                                                |  |                                                                              |  |
| 17.     | Conditional: If<br>LXAIP is implemented, the test steps<br>from No. 1 to No. 16 are to be repeated for LXAIP. |  | See expected results of the test cases from No. 1 to No. 16<br>for<br>LXAIP. |  |
| Verdict |                                                                                                               |  |                                                                              |  |

## **4.2.5 M.1-05 – Using interfaces S.1 and S.6 is possible**

#### **Pre-supposition:**

A product, which claims to functionally comply with the interfaces specification S.1 and S.6 of this TR or part of it, has to pass the following test case or part of it or prove that it supports functional analogous interfaces.

<span id="page-55-0"></span>

| Identifier          |                                                                                                                       | M.1-05                                                                                                                                                                                                                                      |                                                  |              |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|--------------|--|
| Requirement         |                                                                                                                       | M1:A4.1-6<br>M1:A3.2-2<br>M1:A3.1-4                                                                                                                                                                                                         |                                                  |              |  |
| Test Purpose        |                                                                                                                       | The test shall<br>verify that the ArchiSafe module is able to access the other modules of the middleware via dedicated interfaces as described in the annexes TR-ESOR<br>M.2, TR-ESOR-M.3<br>and TR-ESOR--E<br>of this technical guideline. |                                                  |              |  |
| Configuration       |                                                                                                                       | CONFIG_ArchiSafe                                                                                                                                                                                                                            |                                                  |              |  |
| Pre-test conditions |                                                                                                                       | •<br>The tests of test case M.1-01 have been successfully completed<br>•<br>The middleware documentation is available<br>•<br>The test dispenses if the pre-supposition is not valid.                                                       |                                                  |              |  |
| Step                | Test sequence                                                                                                         |                                                                                                                                                                                                                                             | Expected Results                                 | Observations |  |
| 1.                  | Check if the ArchiSafe documentation contains the<br>description of how to connect to the interface S.1.              |                                                                                                                                                                                                                                             | The interface is described in the documentation. |              |  |
| 2.                  | Check if the ArchiSafe documentation contains the<br>description of how to connect to the interface S.6.              |                                                                                                                                                                                                                                             | The interface is described in the documentation. |              |  |
| 3.                  | Check if it is possible for the ArchiSafe module to<br>communicate with the Crypto-Module via the S.1<br>interface.   |                                                                                                                                                                                                                                             | Communication is possible.                       |              |  |
| 4.                  | Check if it is possible for the ArchiSafe module to<br>communicate with the ArchiSig module via the S.6<br>interface. |                                                                                                                                                                                                                                             | Communication is possible.                       |              |  |
| Verdict             |                                                                                                                       |                                                                                                                                                                                                                                             |                                                  |              |  |

<span id="page-56-0"></span>

| Identifier                                                                                                                |                                                                                                                                    | M.1-06                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                |  |
|---------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|--|
| MD:A5.1-1<br>Requirement<br>MD:A5.1-17<br>MD:A5.1-33<br>MD:A5.2-1<br>M1:A4.0-3<br>M1:A4.4-6<br>OVR-7.10-02<br>OVR-7.16-04 |                                                                                                                                    | PRP-8.1-06                                                                                                                              |                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                |  |
| Test Purpose                                                                                                              |                                                                                                                                    | The test shall<br>verify that the ArchiSafe module offers comprehensive and configurable options for logging any access to the archive. |                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                |  |
| Configuration                                                                                                             |                                                                                                                                    | CONFIG_ArchiSafe                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                |  |
|                                                                                                                           | Pre-test conditions                                                                                                                | •<br>User manual is present.<br>•<br>•<br>•<br>•<br>•<br>XAIP shall<br>be<br>•<br>•<br>BIN<br>shall be restricted                       | The ArchiSafe module is installed and configured.<br>The user has administration rights on the system.<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>supported,<br>"LXAIP" may be supported, if configured.<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>to the preservation object formats | [TR-ESOR-TRANS]<br>shall<br>be configured.<br>described in clause 2, Notice 4. |  |
| Step                                                                                                                      | Test sequence                                                                                                                      |                                                                                                                                         | Expected Results                                                                                                                                                                                                                                                                                                                                                                                            | Observations                                                                   |  |
| 1.                                                                                                                        | Check the user manual of the software for logging<br>options.                                                                      |                                                                                                                                         | Comprehensive and configurable logging options are described in<br>the user manual.                                                                                                                                                                                                                                                                                                                         |                                                                                |  |
| 2.                                                                                                                        | Configure the log function to the most comprehensive<br>level.                                                                     |                                                                                                                                         | Any kind<br>of access to the archive will be logged to the log file.                                                                                                                                                                                                                                                                                                                                        |                                                                                |  |
| 3.                                                                                                                        | Store an XAIP_OK_SIG<br>or BIN<br>using the<br>"ArchiveSubmissionRequest" or<br>"PreservePO" function<br>pursuant to S.4 or S.512. |                                                                                                                                         | The function call is possible. The XAIP / BIN object is assigned an<br>AOID and stored successfully.                                                                                                                                                                                                                                                                                                        |                                                                                |  |

## **4.2.6 M.1-06 – Comprehensive and configurable options for logging shall be offered.**

|     | Identifier                                                                                                                                                                                                                                                                                                                             | M.1-06                                                                                                                                                                                                    |  |
|-----|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 4.  | Use<br>the "ArchiveUpdateRequest"<br>or<br>"UpdatePOC"<br>function with the AOID from step 3 and<br>a DXAIP_OK<br>to change the data contained within the<br>XAIP or XAIP(BIN)<br>pursuant to S.4 or S.512.                                                                                                                            | The function call is possible. A new version ID is received.                                                                                                                                              |  |
| 5.  | Use the "ArchiveRetrievalRequest" or<br>"RetrievePO with SubjectOfRetrieval<br>"PO""<br>function with the AOID from step 3 to retrieve<br>the XAIP/XAIP(BIN) from the storage<br>pursuant to S.4<br>or S.512.                                                                                                                          | The function call is possible. The archive data object is received in<br>XAIP format.                                                                                                                     |  |
| 6.  | Use the "ArchiveEvidenceRequest" or<br>"RetrievePO<br>with SubjectOfRetrieval<br>"Evidence" "<br>function with the AOID from step 3 to<br>check the XAIP / BIN authenticity and integrity for all<br>versions<br>pursuant to S.4 or S.512.                                                                                             | The function call is possible. If there exist only<br>one version of the<br>archive data object, one Evidence Record is received. Otherwise,<br>for each existing version an Evidence Record is received. |  |
| 7.  | If implemented, use the "ArchiveDataRequest"<br>or<br>"Search" function<br>with the AOID from step 3 and the<br>dataLocation parameter to identify an individual data<br>element within the XAIP / BIN<br>pursuant to S.4 or S.512.                                                                                                    | The function call is possible. The requested data value and the<br>original locationValue are received.                                                                                                   |  |
| 8.  | Use the<br>"ArchiveDeletionRequest"<br>or<br>"DeletePO"<br>function with the AOID from step 3 to<br>delete the XAIP / BIN<br>pursuant to S.4 or S.512.                                                                                                                                                                                 | The function call is possible.                                                                                                                                                                            |  |
| 9.  | Check the deletion by calling the<br>"ArchiveRetrievalRequest"<br>or "RetrievePO<br>with SubjectOfRetrieval<br>"PO""<br>Request<br>with<br>AOID from step 3<br>and SubjectOfRetrieval<br>"PO".                                                                                                                                         | The "ArchiveRetrievalResponse" or "RetrievePOResponse"<br>indicates that no stored object with corresponding AOID can be<br>found in the storage                                                          |  |
| 10. | If the "VerifyRequest" or<br>"ValidateEvidence"-Request is implemented, use<br>the "Verify<br>Request" or "ValidateEvidence"<br>Response function with the XAIP / BIN from step 3 and<br>the evidence records from step 6 to check the XAIP/BIN,<br>the evidence relevant data and the evidence record(s)<br>pursuant to S.4 or S.512. | The function call is possible.                                                                                                                                                                            |  |
| 11. | If the "VerifyRequest" or                                                                                                                                                                                                                                                                                                              | The "VerifyRequest" or "ValidateEvidence"-Request<br>is                                                                                                                                                   |  |

|     | Identifier                                                                                                                                         |                                                                       | M.1-06                                                                                                                                             |  |  |
|-----|----------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|--|--|
|     | "ValidateEvidence"-Request is implemented,<br>check the output of the "VerifyResponse" or<br>"ValidateEvidence" Response function<br>S.4 or S.512. | pursuant to                                                           | possible and returns a return code or a verification report, if<br>ordered.                                                                        |  |  |
| 12. | Check the log file for logs of all the access procedures<br>from the previous steps.                                                               |                                                                       | The log file contains all the access procedures from the previous<br>steps and also the return codes (error, success) and actual return<br>values. |  |  |
| 13. | Conditional: If<br>from No. 1<br>to No. 12                                                                                                         | LXAIP is implemented, the test steps<br>are to be repeated for LXAIP. | See expected results of the test cases from No. 1 to No. 13 for<br>LXAIP.                                                                          |  |  |
|     | Verdict                                                                                                                                            |                                                                       |                                                                                                                                                    |  |  |
|     |                                                                                                                                                    |                                                                       |                                                                                                                                                    |  |  |

## **4.2.7 M.1-07 – Access to log files shall be possible by authorized persons only**

<span id="page-59-0"></span>

| Identifier          |                                                                                                                                                                                             | M.1-07                                                                                                                                 |                                                                                                                                                                                                                                                                                                   |              |  |
|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                                                                                                             | MD:A5.1-1<br>M1:A4.0-4<br>PRP-8.1-03                                                                                                   |                                                                                                                                                                                                                                                                                                   |              |  |
| Test Purpose        |                                                                                                                                                                                             | The test shall<br>verify that only authorised persons are able to access the log files that have been created by the ArchiSafe-Module. |                                                                                                                                                                                                                                                                                                   |              |  |
| Configuration       |                                                                                                                                                                                             | CONFIG_ArchiSafe                                                                                                                       |                                                                                                                                                                                                                                                                                                   |              |  |
| Pre-test conditions |                                                                                                                                                                                             | •<br>The ArchiSafe-Module is installed and configured.<br>•<br>The user has administration rights on the system.                       |                                                                                                                                                                                                                                                                                                   |              |  |
| Step                | Test sequence                                                                                                                                                                               |                                                                                                                                        | Expected Results                                                                                                                                                                                                                                                                                  | Observations |  |
| 1.                  | Check the vendor documentation whether there is a<br>description how to restrict the access to the log records.                                                                             |                                                                                                                                        | There is such a description or the documentation refers to the<br>access control mechanism of the underlying platform.                                                                                                                                                                            |              |  |
| 2.                  | Check the vendor documentation whether there are<br>recommendations regarding the access control<br>restrictions for the log files.                                                         |                                                                                                                                        | There are such recommendations. It is recommended that only the<br>authorized persons shall<br>be able to access (read) the log files.<br>Nobody shall<br>be able to modify the log files. Only administrators<br>are allowed to delete the log files after archiving or after the end of<br>use. |              |  |
| 3.                  | Configure access restrictions as recommended in the<br>guidance.                                                                                                                            |                                                                                                                                        | Successfully possible.                                                                                                                                                                                                                                                                            |              |  |
| 4.                  | Verify that an unauthorized person is not able to access<br>the log records.<br>Please take all recommended security mechanisms into<br>account, also the organizational and physical ones. |                                                                                                                                        | Access is not possible.                                                                                                                                                                                                                                                                           |              |  |
|                     | Verdict                                                                                                                                                                                     |                                                                                                                                        |                                                                                                                                                                                                                                                                                                   |              |  |
|                     |                                                                                                                                                                                             |                                                                                                                                        |                                                                                                                                                                                                                                                                                                   |              |  |

## **4.2.8 M.1-08 – Changing metadata or data objects results in a new version of stored (L)XAIP or XAIP(BIN)**

<span id="page-60-0"></span>

| Identifier          |                                                                                                                                                                                                                                                                                                                                                     | M.1-08                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                       |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         |                                                                                                                                                                                                                                                                                                                                                     | M1:A4.2-6                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                       |  |
| Test Purpose        |                                                                                                                                                                                                                                                                                                                                                     | The test shall                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | verify that any changes of metadata or data objects within an XAIP or BIN is based on the principles defined in the TR documentation. |  |
|                     | Configuration                                                                                                                                                                                                                                                                                                                                       | CONFIG_ArchiSafe                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                       |  |
| Pre-test conditions |                                                                                                                                                                                                                                                                                                                                                     | •<br>•<br>•<br>•<br>•<br>•<br>•<br>XAIP shall<br>•<br>•<br>BIN<br>• | The middleware documentation is available<br>The user has administration rights on the system<br>Test case S.4-24 has been tested successfully<br>(L)XAIP means "XAIP"<br>or "LXAIP".<br>XAIP means "XAIP"<br>or "LXAIP"<br>pursuant to [TR-ESOR-F].<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>be supported,<br>"LXAIP" may be supported, if configured.<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>shall be restricted<br>to the preservation object formats<br>described in clause 2, Notice 4 |                                                                                                                                       |  |
| Step                | Test sequence                                                                                                                                                                                                                                                                                                                                       |                                                                     | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Observations                                                                                                                          |  |
| 1.                  | Check the middleware documentation for the procedure<br>of the update process.<br>It is important that per update (version) a new version<br>manifest will be created, new/updated data will be added,<br>for "removed" data just the links in the new version<br>manifest will be removed –<br>the data keeps stored in the<br>(L)XAIP / XAIP(BIN) |                                                                     | The data update function is documented as defined in the TR.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                       |  |
| 2.                  | Store an XAIP_OK<br>or BIN<br>using the interface function<br>"ArchiveSubmissionRequest"<br>or "PreservePO"<br>pursuant to S.4 or S.512.                                                                                                                                                                                                            |                                                                     | The call is successful, a valid AOID is returned                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                                       |  |
| 3.                  | Use the "ArchiveRetrievalRequest" or "RetrievePO<br>with SubjectOfRetrieval<br>"PO""<br>with returned                                                                                                                                                                                                                                               |                                                                     | The call is successful.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                       |  |

| Identifier |                                                                                                                                                                                                                |                                                                                                                                                                                                  | M.1-08                                                        |  |
|------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|--|
|            | AOID from step 2 to request an XAIP_OK<br>or an<br>XAIP(BIN)<br>pursuant to S.4 or S.512.                                                                                                                      |                                                                                                                                                                                                  |                                                               |  |
| 4.         | Use the "ArchiveUpdateRequest" or "UpdatePOC"<br>with the returned AOID and a DXAIP_OK to create a<br>new version with updated metadata in the archived<br>XAIP_OK<br>/ XAIP(BIN)<br>pursuant to S.4 or S.512. |                                                                                                                                                                                                  | The call is possible, no error is returned                    |  |
| 5.         | with SubjectOfRetrieval<br>AOID to request an XAIP_OK<br>manifest has been changed                                                                                                                             | Use the "ArchiveRetrievalRequest" or "RetrievePO<br>"PO""<br>with returned<br>and check if the version<br>using S.4 or S.512.                                                                    | The call is successful, the version manifest has been changed |  |
| 6.         | in the archived XAIP_OK<br>S.512.                                                                                                                                                                              | Use the "ArchiveUpdateRequest" or "UpdatePOC"<br>with the returned AOID and the returned VersionID of<br>step 5 to create a new version with updated data objects<br>/ XAIP(BIN)<br>using S.4 or | The call is possible, no error is returned                    |  |
| 7.         | with SubjectOfRetrieval<br>manifest has been changed using S.4 or S.512.                                                                                                                                       | Use the "ArchiveRetrievalRequest" or "RetrievePO<br>"PO""<br>with returned<br>AOID to request an XAIP_OK and check if the version                                                                | The call is successful, the version manifest has been changed |  |
|            | Verdict                                                                                                                                                                                                        |                                                                                                                                                                                                  |                                                               |  |

<span id="page-62-0"></span>

|                                                           | Identifier  | M.1-09                                                                                                                          |  |  |  |
|-----------------------------------------------------------|-------------|---------------------------------------------------------------------------------------------------------------------------------|--|--|--|
|                                                           | Requirement | MD:A6.1-3                                                                                                                       |  |  |  |
|                                                           |             | MD:A7.4-15                                                                                                                      |  |  |  |
|                                                           |             |                                                                                                                                 |  |  |  |
| Test Purpose                                              |             | The test should<br>check whether the middleware is able to manage multiple clients and separate the different clients' data.    |  |  |  |
| Configuration                                             |             | CONFIG_ArchiSafe                                                                                                                |  |  |  |
|                                                           |             | Conditional:<br>CONFIG_Upload                                                                                                   |  |  |  |
|                                                           |             | CONFIG_Download<br>Conditional:                                                                                                 |  |  |  |
| Pre-test conditions                                       |             | •<br>The middleware documentation is available                                                                                  |  |  |  |
|                                                           |             | •<br>If required, perform identification and authentication                                                                     |  |  |  |
|                                                           |             | •<br>XAIP means "XAIP"<br>or "LXAIP"<br>pursuant to [TR-ESOR-F].                                                                |  |  |  |
|                                                           |             | •<br>XAIP<br>shall<br>be<br>supported,<br>"LXAIP" may be supported, if configured.                                              |  |  |  |
|                                                           |             | •<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>shall<br>be configured.<br>[TR-ESOR-TRANS] |  |  |  |
|                                                           |             | •<br>BIN<br>shall be restricted<br>to the preservation object formats<br>described in clause 2, Notice 4.                       |  |  |  |
|                                                           |             | •<br>Conditional: If existent, the Upload-<br>and Download-Module are installed and configured                                  |  |  |  |
| Step<br>Test sequence<br>Expected Results<br>Observations |             |                                                                                                                                 |  |  |  |

**4.2.9 M.1-09 – ArchiSafe-module should be capable of serving and separating multiple clients**

| Identifier |                                                                                                                                                                                                                                                                      | M.1-09                                                                                               |  |
|------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------|--|
| 1.         | Check the middleware documentation for the<br>management of multiple clients.                                                                                                                                                                                        | It is possible to manage multiple clients simultaneously while<br>storing their data separately.     |  |
| 2.         | Authenticate with valid user credentials of client A.                                                                                                                                                                                                                | The authentication is successful.                                                                    |  |
| 3.         | Store an XAIP_OK<br>or BIN<br>using the interface function<br>"ArchiveSubmissionRequest"<br>or a BIN using the<br>Upload-Function<br>or "PreservePO""<br>or a BIN,<br>using<br>the Upload-Function                                                                   | The call of the function with this XAIP / BIN as a parameter is<br>possible.                         |  |
| 4.         | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or<br>"PreservePOResponse"                                                                                                                                                            | A positive feedback is received. No error message or error code is<br>returned. An AOID is assigned. |  |
| 5.         | Authenticate with valid user credentials of client B.                                                                                                                                                                                                                | The authentication is successful.                                                                    |  |
| 6.         | Attempt to get an "ArchiveRetrievalRequest" or<br>"RetrievePO<br>with SubjectOfRetrieval<br>"PO""<br>with the AOID from client A.                                                                                                                                    | The access will be denied.                                                                           |  |
| 7.         | Repeat the test sequence storing first an XAIP_OK<br>or<br>BIN<br>assigned to client B and then attempt to access<br>stored data ("ArchiveRetrievalRequest"<br>or<br>"RetrievePO<br>with SubjectOfRetrieval<br>"PO""<br>Request) with an authentication of client A. | The access will be denied.                                                                           |  |
| 8.         | Conditional: If<br>LXAIP is implemented, the<br>test steps<br>from No. 1<br>to No. 7 are to be repeated for LXAIP.                                                                                                                                                   | See expected results for the test cases from No. 1<br>to No. 7 for<br>LXAIP.                         |  |
| Verdict    |                                                                                                                                                                                                                                                                      |                                                                                                      |  |

## **4.2.10 M.1-10 – ArchiSafe-Module shall be thread safe**

<span id="page-64-0"></span>

| Identifier          |                                                                                                                                                                                                      | M.1-10                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                          |  |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|                     | Requirement                                                                                                                                                                                          | MD:A7.2-9                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                          |  |
|                     | Test Purpose                                                                                                                                                                                         | The test shall                                                                                                                                                        | verify that the ArchiSafe module can process several transactions simultaneously.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                          |  |
| Configuration       |                                                                                                                                                                                                      | CONFIG_ArchiSafe<br>Conditional:<br>CONFIG_Upload<br>CONFIG_Download<br>Conditional:                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                          |  |
| Pre-test conditions |                                                                                                                                                                                                      | •<br>•<br>•<br>•<br>•<br>•<br>ECM/long-term<br>•<br>XAIP means "XAIP"<br>•<br>XAIP<br>shall<br>be<br>•<br>•<br>Conditional: If existent, the Upload-<br>and published | The middleware documentation is available<br>The IT system documentation is available<br>The application documentation is available<br>If required, establish a session with the TOT in order to perform the following tests<br>If required, perform identification and authentication<br>A sufficient amount of XAIPs or BINs,<br>restricted<br>to the preservation object formats<br>storage to perform the technical tests<br>or "LXAIP"<br>pursuant to [TR-ESOR-F].<br>supported,<br>"LXAIP" may be supported, if configured.<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>and Download-Module are installed and configured. Upload-Module is configured in such a way that<br>BIN linked to a LXAIP and referenced there acc. to [TR-ESOR-F<br>cryptographical protocols<br>only. | described in clause 2, Notice 4,<br>have already been stored on the<br>shall<br>be configured.<br>only Upload of<br>Sec. 3.2] is possible. The Upload-/Download-Module use standardised, non-proprietary |  |
| Step                | Test sequence                                                                                                                                                                                        |                                                                                                                                                                       | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Observations                                                                                                                                                                                             |  |
| 1.                  | Use a number of "ArchiveRetrievalRequests" or<br>"PreservePO Requests<br>with valid AOIDs to<br>request a number (at least 20) of XAIPs from one client<br>application<br>pursuant to S. 4 or S.512. |                                                                                                                                                                       | The function calls with the given AOIDs are possible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                          |  |
| 2.                  | Observe the output of the severeal interface functions<br>"ArchiveRetrievalResponse"<br>or<br>"RetrievePOResponse".                                                                                  |                                                                                                                                                                       | Positive feedbacks are received. No error messages or error codes<br>occur. The requested XAIPs are retrieved successfully.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                          |  |
| 3.                  |                                                                                                                                                                                                      |                                                                                                                                                                       | If possible use a number of "ArchiveRetrievalRequests" The function calls with the given AOIDs are possible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                          |  |

| Identifier |                                                                                                                                                                                                                                                               | M.1-10                                                                                                                                                                                  |  |
|------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|            | r "RetrievePO<br>with SubjectOfRetrieval<br>"PO""<br>Request with valid AOIDs to request a number<br>(at least 20) of XAIPs from at least 2 client applications<br>simultaneously. (Request the same XAIPs from both<br>clients)<br>pursuant to S.4 or S.512. |                                                                                                                                                                                         |  |
| 4.         | Observe the output<br>of the several interface functions<br>"ArchiveRetrievalResponse"<br>or<br>"PreservePOResponse"                                                                                                                                          | Positive feedbacks are received. No error messages or error codes<br>occur. The requested XAIPs are retrieved successfully by both<br>client applications.                              |  |
| 5.         | Conditional: If<br>LXAIP is implemented, the<br>test steps<br>from No. 1 to No. 4 are to be repeated for LXAIP.                                                                                                                                               | See expected results for the test cases from No. 1 to No. 4 for<br>LXAIP.                                                                                                               |  |
| 6.         | Conditional: Use a number of "Download-Requests"<br>with valid AOIDs to request a number (at least 20) of<br>BINs from one client application.                                                                                                                | The function calls with the given AOIDs are possible.<br>The<br>Download-Module uses standardised, non-proprietary and<br>published<br>cryptographical protocols<br>and interfaces only |  |
| 7.         | Conditional: Observe the output of the severeal<br>interface functions "Download-Response".                                                                                                                                                                   | Positive feedbacks are received. No error messages or error codes<br>occur. The requested BINs are retrieved successfully.                                                              |  |
| Verdict    |                                                                                                                                                                                                                                                               |                                                                                                                                                                                         |  |

| 4.2.11<br>M.1-11 –<br>Access rights are enforced for individual<br>archive objects |  |
|------------------------------------------------------------------------------------|--|
|------------------------------------------------------------------------------------|--|

<span id="page-66-0"></span>

|                                                                                                             | Identifier                                         | M.1-11                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |              |
|-------------------------------------------------------------------------------------------------------------|----------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|                                                                                                             | Requirement                                        | MD: A5.1-1<br>M1:A3.1-1<br>M1:A4.0-6<br>M1:A5.0-1<br>M1:A5.0-3<br>OVR-7.16-03<br>PRP-8.1-03                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |              |
|                                                                                                             | Test Purpose                                       | The test shall<br>verify that client software can only access archive objects for which it has access rights. This is also stringently enforced<br>when several archival<br>information packages are requested simultaneously and, as applicable, there are only access rights to a few<br>of them. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |              |
|                                                                                                             |                                                    | CONFIG_ArchiSafe (including at least two different and separated clients configured)                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |              |
| Configuration<br>•<br>Pre-test conditions<br>•<br>•<br>•<br>•<br>XAIP shall<br>•<br>BIN<br>•<br>•<br>•<br>• |                                                    | shall be restricted<br>preservation object formats<br>occurs. An AOID A1 is assigned.<br>preservation object formats<br>occurs. An AOID A2 is assigned.<br>preservation object formats<br>occurs. An AOID B1 is assigned.                                                                           | If required, perform identification and authentication<br>If required, the tester has to manually simulate access requests as if<br>they were issued by client applications<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F]<br>be supported, "LXAIP" may be supported, if configured.<br>to the preservation object formats<br>described in clause 2, Notice 4<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>The call of the function "ArchiveSubmissionRequest" or "PreservePO"-Request by a client application A with a XAIP_OK<br>or BIN<br>restricted<br>to the<br>described in clause 2, Notice 4<br>as a parameter is possible. A positive feedback is received. No error message or error code<br>The call of the function "ArchiveSubmissionRequest" or "PreservePO"-Request by a client application A with another XAIP_OK<br>or BIN<br>restricted<br>to the<br>described in clause 2, Notice 4<br>as a parameter is possible. A positive feedback is received. No error message or error code<br>The call of the function "ArchiveSubmissionRequest" or "PreservePO"-Request by a client application B with a XAIP_OK<br>or BIN<br>restricted<br>to the<br>described in clause 2, Notice 4<br>as a parameter is possible. A positive feedback is received. No error message or error code |              |
| Step                                                                                                        | Test sequence                                      |                                                                                                                                                                                                                                                                                                     | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Observations |
| 1.                                                                                                          | By using client application A: Using the interface |                                                                                                                                                                                                                                                                                                     | The call of the function with this AOID as a parameter is possible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |              |

|    | Identifier                                                                                                                                                                                                                                            | M.1-11                                                                                                                                      |  |
|----|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|--|
|    | function "ArchiveRetrievalRequest""or "RetrievePO<br>with SubjectOfRetrieval<br>"PO""<br>Request<br>and the<br>AOID A1<br>to request the XAIP<br>pursuant to S.4 or S.512.                                                                            |                                                                                                                                             |  |
| 2. | Observe the output of the interface<br>function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                                                                                         | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                             |  |
| 3. | By using client application B: Using the interface<br>function "ArchiveUpdateRequest"<br>or<br>"UpdatePOC"<br>and the AOID A1<br>with any DXAIP_OK<br>as update data<br>to update the XAIP or XAIP(BIN)<br>pursuant to S.4 or<br>S.512.               | The call of the function with this AOID as a parameter is possible.                                                                         |  |
| 4. | Observe the output of the interface function<br>"ArchiveUpdateResponse"<br>or<br>"UpdatePOC".                                                                                                                                                         | A negative feedback is received. An error message or error code<br>occurs because access is denied. The XAIP / XAIP(BIN) is not<br>updated. |  |
| 5. | By using client application B:<br>Using the interface<br>function "ArchiveRetrievalRequest"or "RetrievePO<br>with SubjectOfRetrieval<br>"PO""<br>Request<br>and the<br>AOID A1<br>to request the XAIP/XAIP(BIN)<br>pursuant to<br>S.4 or S.512.       | The call of the function with this AOID as a parameter is possible.                                                                         |  |
| 6. | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                                                                                            | A negative feedback is received. An error message or error code<br>occurs because access is denied. No XAIP is received.                    |  |
| 7. | By using client application B: Using the interface<br>function "ArchiveDeletionRequest"or "DeletePO"<br>Request<br>and the AOID A1<br>to delete the XAIP or BIN<br>pursuant to S.4 or S.512.                                                          | The call of the function with this AOID as a parameter is possible.                                                                         |  |
| 8. | Observe the output of the interface function<br>"ArchiveDeletionResponse"<br>or "DeletePO"<br>Response                                                                                                                                                | A negative feedback is received. An error message or error code<br>occurs because access is denied. The XAIP / BIN is not deleted.          |  |
| 9. | By using client application A: Using the interface<br>function "ArchiveRetrievalRequest"<br>or "RetrievePO<br>with SubjectOfRetrieval<br>"PO""<br>Request<br>and the<br>AOID A1, A2<br>and B1<br>to request the XAIPs<br>pursuant to<br>S.4 or S.512. | The call of the function with this AOID as a parameter is possible.                                                                         |  |

|     | Identifier                                                                                                                                                                                                                                                     | M.1-11                                                                                                                                        |  |
|-----|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|--|
| 10. | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response                                                                                                                                                      | A mixed feedback is received. The XAIP's A1<br>and A2<br>could be<br>retrieved, for B1<br>an error was received.                              |  |
| 11. | By using client application B: Using the interface<br>function "ArchiveRetrievalRequest"<br>or "RetrievePO<br>with SubjectOfRetrieval<br>"PO""<br>Request<br>and<br>the AOID A1, A2<br>and B1<br>to request the XAIPs<br>pursuant<br>to S.4 or S.512.          | The call of the function with this AOID as a parameter is possible.                                                                           |  |
| 12. | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                                                                                                     | A mixed feedback is received. The XAIP B1<br>could be retrieved, for<br>A1<br>and A2,<br>an error was received.                               |  |
| 13. | Try to use a client application C, which is not an<br>authorized archive application, to submit<br>a XAIP or BIN<br>to update<br>a XAIP or XAIP(BIN), to retrieve<br>a XAIP or<br>to delete<br>a XAIP or BIN of another client<br>pursuant to S.4<br>or S.512. | A negative feedback is received. An error message or error code<br>occurs. Access to the middleware and the storage is denied in any<br>case. |  |
| 14. | LXAIP is implemented, test steps from<br>Conditional: If<br>No. 1<br>to No. 13<br>are to be repeated for LXAIP.                                                                                                                                                | See expected results of the test cases from No. 1 to No. 13 for<br>LXAIP.                                                                     |  |
|     | Verdict                                                                                                                                                                                                                                                        |                                                                                                                                               |  |

## **4.3 Module 2 – Crypto-Module**

A product which claims to comply with the M.2 Crypto-Module specification of this TR has to pass

- all test cases in this section and
- all test cases for the interface S.1 and S.3 specified in section 4.5.1 and 4.5.3 respectively or prove that it supports functional analogous interfaces.

## <span id="page-69-2"></span>**4.3.1** M.2-01 – Crypto- Module may request digital signatures from a Trust Service Provider according to [eIDAS-VO]

## **Pre-supposition**:

<span id="page-69-1"></span><span id="page-69-0"></span>A product which claims to comply the M.2 Crypto-Module specification of this TR and which intends to request digital signatures from a trust service provider according to **[eIDAS-VO, Article 3(19) or 3(20)]** has to pass the following test case.

|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Identifier | M.2-01                                                                                                                                                                                                                                                                                                                      |                  |              |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------|--------------|
| Requirement                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |            | MD:A4.3-1<br>M2:A3.4-2, M2:A3.4-3<br>M2:A5.1-1, M2:A5.1-2, M2:A5.1-3, M2:A5.1-4, M2:A5.1-5, M2:A5.1-6, M2:A5.1-7                                                                                                                                                                                                            |                  |              |
| If the Crypto-Module intends to request digital signatures from a trust service provider according to [eIDAS-VO, article 3(19) or 3(20)], the Crypto-Module shall<br>Test Purpose<br>fulfil the requirements of M2:A3.4-2<br>and M2:A3.4-3<br>The digital signature format generated by a trust service provider shall fulfil one of the following digital signature formats.<br>The trust service provider shall be able to generate the following digital signature formats.<br>•<br>XadES-signatures according to<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and<br>◦<br>the requirements in [TR-ESOR-F, (A5.1-2)];<br>◦<br>•<br>CAdES-signatures according to<br>◦<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F, (A5.1-1)];<br>◦<br>•<br>PAdES-signatures according to<br>◦<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F, (A5.1-3)].;<br>◦<br>•<br>ASiC-Container with AdES-signatures, time stamps and Evidence Records according to<br>◦<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and |            |                                                                                                                                                                                                                                                                                                                             |                  |              |
| CONFIG_Common<br>Configuration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |            |                                                                                                                                                                                                                                                                                                                             |                  |              |
| Pre-test conditions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |            | 1.<br>User manual is present<br>2.<br>If the Crypto-Module requests digital signatures from a trust service provider, install a trustworthy communication channel to a trust service provider, e.g.<br>according to [TR 03116] (Part<br>4) and [TR 02102].<br>3.<br>The test dispenses if the pre-supposition is not valid. |                  |              |
| Step                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |            | Test sequence                                                                                                                                                                                                                                                                                                               | Expected Results | Observations |

| Identifier |                                                                                                                                                  |                                                                                                                                                                                   | M.2-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |  |
|------------|--------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 1.         | according to [eIDAS-VO, article 3(19) or 3(20)]<br>trustworthy communication channel.                                                            | Check the user manual and related documentation, if<br>there is described that the Cryptographic Module may<br>request a digital signature from a trust service provider<br>via a | In the user manual there is a confirmation, that the Cryptographic<br>Module may request a digital signature from a trust service<br>provider according to [eIDAS-VO, article 3(19) or 3(20)] via a<br>trustworthy communication channel according to [eIDAS-VO,<br>52] .and e.g. according to [TR 03116] (Part<br>4) and [TR 02102].<br>T                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| 2.         | Check the user manual for information about which<br>digital signature formats are supported by the<br>Cryptographic Module.                     |                                                                                                                                                                                   | The Cryptographic Module -<br>by requesting a signature generation<br>service from a trust service provider -<br>supports<br>•<br>XadES-signatures according to<br>the actual COMMISSION IMPLEMENTING<br>◦<br>DECISION (EU) [2015/1506/EU] and<br>◦<br>the requirements in [TR-ESOR-F, (A5.1-2)];<br>•<br>CAdES-signatures according to<br>the actual COMMISSION IMPLEMENTING<br>◦<br>DECISION (EU) [2015/1506/EU] and<br>◦<br>the requirements in [TR-ESOR-F, (A5.1-1)];<br>•<br>PAdES-signatures according to<br>◦<br>the actual COMMISSION IMPLEMENTING<br>DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F, (A5.1-3)].;<br>◦<br>•<br>SiC-Container with AdES-signatures, time stamps and<br>Evidence Records according to<br>◦<br>the actual COMMISSION IMPLEMENTING<br>DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F, (A5.1-4)].<br>◦ |  |
| 3.         | according to e.g.<br>provider is configured and activated.                                                                                       | Check whether a secure communication channel, e.g.<br>[TR 03116] (Part<br>4) and<br>[TR 02102]),<br>between the Cryptographic Module and the trust service                        | A secure communication channel, e.g.<br>according to e.g.<br>[TR<br>03116] (Part<br>4) and<br>[TR 02102]), is set up and active.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
| 4.         | Module and the trust service provider.                                                                                                           | Start logging the data traffic between the Cryptographic                                                                                                                          | The data logging process has been started.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| 5.         | Request a digital signature using the corresponding<br>interface functions from a (qualified) trust service<br>provider according to [eIDAS-VO]. |                                                                                                                                                                                   | The request of a digital signature is possible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |

| Identifier |                                                                                                                                                                                    | M.2-01                                                                                                                                                    |  |
|------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 6.         | Observe the output of the interface function.                                                                                                                                      | A positive feedback<br>will be received; no error message or error<br>code. The digital signature<br>shall<br>be received.                                |  |
| 7.         | Check the digital signature whether it is a valid one using<br>a common certified tool or product or a validation<br>function of a (qualified) trust service provider.             | The digital signature is a valid signature.                                                                                                               |  |
| 8.         | Check that the generated digital signature fulfils one of<br>the digital signature formats according to test step 2.                                                               | The digital signature format of the received generated digital<br>signature.<br>fulfils one of the digital signature formats according to<br>test step 2. |  |
| 9.         | Check the IT system documentation for the used protocol<br>within the secure communication channel protocol<br>between the Cryptographic Module and the trust service<br>provider. | The documentation states which protocol is used (e.g. HTTP, RPC,<br>RMI,).                                                                                |  |
| 10.        | Check the documentation for this protocol whether<br>technical confirmations of receipts are implemented.                                                                          | The protocol implements such confirmations (e.g. TCP ACK,<br>HTTP Return codes,).                                                                         |  |
| 11.        | Close the connection of the two components. Stop<br>logging the data traffic.                                                                                                      | The complete data exchange between the components has been<br>intercepted and logged.                                                                     |  |
| 12.        | Check the data traffic log file for unprotected document<br>data.                                                                                                                  | No document data (in clear text) can be accessed.                                                                                                         |  |
| Verdict    |                                                                                                                                                                                    |                                                                                                                                                           |  |
|            |                                                                                                                                                                                    |                                                                                                                                                           |  |

## **4.3.2 M.2-02 – Cryptographic algorithms shall be exchangeable**

<span id="page-73-0"></span>

| Identifier          |                                                                                                                                                                                                                                                                  | M.2-02                                                                                                                                                 |                                                                                                                                                                                                                                   |              |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| Requirement         |                                                                                                                                                                                                                                                                  | MD:A7.4-5<br>M2:A3.2-1<br>OVR-7.14-01<br>OVR-7.14-02<br>OVR-7.15-03                                                                                    |                                                                                                                                                                                                                                   |              |
| Test Purpose        |                                                                                                                                                                                                                                                                  | The algorithms and parameters of the Cryptographic Module that are suitable for security<br>shall<br>be exchanged in a quick and uncomplicated manner. |                                                                                                                                                                                                                                   |              |
| Configuration       |                                                                                                                                                                                                                                                                  | CONFIG_Common                                                                                                                                          |                                                                                                                                                                                                                                   |              |
| Pre-test conditions |                                                                                                                                                                                                                                                                  | •<br>User has administrator rights on the system<br>•<br>User manual is present                                                                        |                                                                                                                                                                                                                                   |              |
| Step                | Test sequence                                                                                                                                                                                                                                                    |                                                                                                                                                        | Expected Results                                                                                                                                                                                                                  | Observations |
| 1.                  | Check, whether a hash-algorithm and parameters can be<br>changed in a quick and uncomplicated manner, before the<br>preservation evidence cannot be used anymore to achieve<br>the corresponding preservation goal.                                              |                                                                                                                                                        | The hash-algorithm and parameters can be changed in a quick and<br>uncomplicated manner,<br>before the preservation evidence cannot be<br>used anymore to achieve the corresponding preservation goal.                            |              |
| 2.                  | Check, whether a digital signature-<br>or electronic time<br>stamp algorithm and parameters can be changed in a<br>quick and uncomplicated manner, before the preservation<br>evidence cannot be used anymore to achieve the<br>corresponding preservation goal. |                                                                                                                                                        | The digital signature-or time stamp algorithm and parameters can<br>be changed in a quick and uncomplicated manner, before the<br>preservation evidence cannot be used anymore to achieve the<br>corresponding preservation goal. |              |
| Verdict             |                                                                                                                                                                                                                                                                  |                                                                                                                                                        |                                                                                                                                                                                                                                   |              |

**4.3.3 M.2-03 – Crypto-Module should fulfil the requirements of TR-03112**

<span id="page-74-0"></span>

| Identifier          |                                                                                                        | M.2-03                                                                                                                                      |                                                                                  |              |  |
|---------------------|--------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                        | MD:A7.4-6                                                                                                                                   |                                                                                  |              |  |
| Test Purpose        |                                                                                                        | The interfaces of the Cryptographic Module should<br>fulfil the requirements of the BSI Technical Guideline TR-03112 (eCard-API-Framework). |                                                                                  |              |  |
| Configuration       |                                                                                                        | CONFIG_Common                                                                                                                               |                                                                                  |              |  |
| Pre-test conditions |                                                                                                        | •<br>User manual is present                                                                                                                 |                                                                                  |              |  |
| Step                | Test sequence                                                                                          |                                                                                                                                             | Expected Results                                                                 | Observations |  |
| 1.                  | Check, if at least the external interfaces of the<br>Cryptographic Module are implemented in software. |                                                                                                                                             | The external interfaces may be implemented in software (e.g.<br>libraries, API). |              |  |
| 2.                  | If step 1 passed:<br>Check whether there is a conformity statement to TR                               |                                                                                                                                             | A conformity statement to TR-03112 exist.                                        |              |  |
| 03112.              |                                                                                                        |                                                                                                                                             |                                                                                  |              |  |
| Verdict             |                                                                                                        |                                                                                                                                             |                                                                                  |              |  |
|                     |                                                                                                        |                                                                                                                                             |                                                                                  |              |  |

## **4.3.4 M.2-04 – Random number generators fulfil the BSI requirements**

<span id="page-75-0"></span>

| Identifier                                                                                                                                                                                                                                                                                                                                                                                                         |               | M.2-04                                                                                                                                                                                                                                                                                         |              |  |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement                                                                                                                                                                                                                                                                                                                                                                                                        |               | M2:A4.1-2                                                                                                                                                                                                                                                                                      |              |  |
| Test Purpose                                                                                                                                                                                                                                                                                                                                                                                                       |               | The random number generators used by the Cryptographic Module fulfil the requirements set forth in the BSI Technical Guidelines [TR 03116]<br>and [TR 02102]<br>pursuant to [AIS 20]<br>for pseudo random number generators or according to [AIS 31]<br>for physical random number generators. |              |  |
| Configuration                                                                                                                                                                                                                                                                                                                                                                                                      |               | CONFIG_Common                                                                                                                                                                                                                                                                                  |              |  |
| Pre-test conditions                                                                                                                                                                                                                                                                                                                                                                                                |               | User manual is present                                                                                                                                                                                                                                                                         |              |  |
| Step                                                                                                                                                                                                                                                                                                                                                                                                               | Test sequence | Expected Results                                                                                                                                                                                                                                                                               | Observations |  |
| 1.<br>Check user manual and developer documents, whether<br>The random number generators fulfil the defined requirements set.<br>the random number generators fulfil the requirements<br>defined by set for the BSI Technical Guidelines<br>[TR<br>03116]<br>and [TR 02102]<br>pursuant to [AIS20]<br>for pseudo<br>random number generators or according to [AIS 31]<br>for<br>physical random number generators. |               |                                                                                                                                                                                                                                                                                                |              |  |
| Verdict                                                                                                                                                                                                                                                                                                                                                                                                            |               |                                                                                                                                                                                                                                                                                                |              |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                    |               |                                                                                                                                                                                                                                                                                                |              |  |

## <span id="page-76-2"></span><span id="page-76-1"></span>**4.3.5 M.2-05 – Support of Hash functions**

#### **Attention:**

For usage of this TR-ESOR-Product by a Preservation Services pursuant to [ETSI TS 119 511] and for substituting equivalent **[ETSI TS 119 511]** - test cases by [TR-ESOR] test cases in an assessment, then this test case is to be replaced by the test case **[TR-ESOR-C.1-APP]** in clause 8, test case M.2-11.

<span id="page-76-0"></span>

| Identifier                                                                                                                                                                                                                                                                            |               | M.2-05                                                                                                                                                                                                                                                                                                                                                                                |                                                                            |              |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|--------------|
| Requirement                                                                                                                                                                                                                                                                           |               | M2:A4.2-1<br>M2:A4.2-2<br>M2:A4.2-3<br>M2:A5.3-1<br>OVR-6.5-04<br>OVR-7.14-03                                                                                                                                                                                                                                                                                                         |                                                                            |              |
| Test Purpose                                                                                                                                                                                                                                                                          |               | The Cryptographic Module shall<br>have functions to calculate hash values for information packages. In doing so, the requirements for hash procedures shall<br>be<br>fulfilled.14                                                                                                                                                                                                     |                                                                            |              |
| Configuration                                                                                                                                                                                                                                                                         |               | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                      |                                                                            |              |
| Pre-test conditions                                                                                                                                                                                                                                                                   |               | •<br>The list of hash algorithms and parameters recommended by [ETSI TS 119 312]<br>and [SOG-IS]is accessible<br>•<br>User manual is present<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F]<br>V1.2.2.<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F]<br>V1.2.2.<br>•<br>XAIP shall<br>be<br>supported,<br>"LXAIP" may be supported, if configured. |                                                                            |              |
| Step                                                                                                                                                                                                                                                                                  | Test sequence |                                                                                                                                                                                                                                                                                                                                                                                       | Expected Results                                                           | Observations |
| 1.<br>Check the user manual for the hash algorithms,<br>which<br>are used by the Cryptographic Module. The<br>Cryptographic Module shall<br>support at least two hash<br>algorithms which have been assessed by<br>[ETSI TS 119<br>312] and [SOG-IS] and [TR 03116] and [TR 02102] as |               |                                                                                                                                                                                                                                                                                                                                                                                       | The used hash algorithms are in the list of the recommended<br>algorithms. |              |

<sup>14</sup> Exclusively those hash algorithms and parameters recommended by **[ETSI TS 119 312]** and **[SOG-IS]** shall be used to form hash values. However, the Cryptographic Module shall continue to support all hash algorithms previously used by the Cryptographic Module in order to enable validation of hash values generated in the past according to **[ALGCAT]**, **[ETSI TS 119 312]/[SOG-IS]** and **[TR-ESOR-ERS, chapter 5.2.1])**.

| Identifier |                                                                                                                                                                                                                               |                                                                                                             | M.2-05                                                                                                        |  |
|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|--|
|            | suitable for security and published.                                                                                                                                                                                          |                                                                                                             |                                                                                                               |  |
| 2.         | Check the user<br>Module continues to support all hash algorithms<br>previously used pursuant to[ALGCAT]<br>hash values computed in the past.                                                                                 | manual whether the Cryptographic<br>or ([TR-ESOR<br>ERS], Chap. 5.2.1) in order to enable the validation of | The used hash algorithms are in the<br>list of the supported<br>algorithms.                                   |  |
| 3.         | Check the user manual<br>algorithms.                                                                                                                                                                                          | for the supported hash                                                                                      | The Cryptographic Module supports all previously used hash<br>algorithms.                                     |  |
| 4.         | Transfer the signed XAIP_OK<br>or DXAIP_OK<br>or BIN<br>to<br>the Cryptographic Module using the interface function<br>"Hash".                                                                                                |                                                                                                             | The call of the function with this XAIP / DXAIP_OK<br>/ BIN as<br>parameter is possible.                      |  |
| 5.         | Observe the output of the interface function "Hash".                                                                                                                                                                          |                                                                                                             | A positive feedback and a HashResponse-Element will be<br>received.                                           |  |
| 6.         | Check the Hash-Element in the HashResponse<br>Element<br>certified tool or product, e.g. a certified eCard<br>Cryptomodul, for comparison of the Hash-value<br>calculated on base of the signed XAIP_OK<br>DXAIP_OK<br>or BIN | whether the Hash-value is correct by using a<br>or                                                          | The received Hash-value was verified by comparison of the<br>hash calculations with a certified Crypto-Modul. |  |
| 7.         | Conditional: If<br>No. 1 to No. 6 are to be repeated for LXAIP.                                                                                                                                                               | LXAIP is implemented, test steps from                                                                       | See expected results of the test cases from No. 1 to No. 6 for<br>LXAIP.                                      |  |
| Verdict    |                                                                                                                                                                                                                               |                                                                                                             |                                                                                                               |  |
|            |                                                                                                                                                                                                                               |                                                                                                             |                                                                                                               |  |

## <span id="page-78-1"></span>**4.3.6 M.2-06 – Crypto-Module supports canonicalisation for the validation of XML digital signatures**

## **Pre-supposition**:

A product, which supports XML digital signatures, and especially the validation of XML digital signatures, has to pass the following test case.

<span id="page-78-0"></span>

|                     | Identifier                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                            | M.2-06                                                                                                                                                                                                                                                                                                                 |              |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
|                     | Requirement                                                                                                                                                                                                                 | M2:A4.4-2<br>M2:A4.4-4                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                        |              |  |
| Test Purpose        |                                                                                                                                                                                                                             | Support of canonicalisation procedures for the validation of of XML digital signatures.<br>The support of canonicalisation procedure C14N -<br>Canonical XML Version 1.0 [C14N]<br>-<br>is supported at a minimum.<br>Note: If the TOT does<br>not support XMLdigital signatures the test case can be passed as fulfilled.                                 |                                                                                                                                                                                                                                                                                                                        |              |  |
|                     | Configuration                                                                                                                                                                                                               | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                        |              |  |
| Pre-test conditions |                                                                                                                                                                                                                             | •<br>User manual is present<br>•<br>Security architecture design is present<br>•<br>A valid signed XML<br>object, e.g. XAIP or BIN, is present.<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F],<br>•<br>XAIP shall<br>be supported, "LXAIP" may be supported, if configured.<br>•<br>The test dispenses if the pre-supposition is not valid. |                                                                                                                                                                                                                                                                                                                        |              |  |
| Step                | Test sequence                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                            | Expected Results                                                                                                                                                                                                                                                                                                       | Observations |  |
| 1.                  | Check the user manual and security architecture design,<br>whether the support of canonicalisation procedures at<br>least for the validation of digital signatures of XML<br>contents by the Cryptographic Module is given. |                                                                                                                                                                                                                                                                                                                                                            | The support of canonicalisation procedures for the validation of<br>digital signatures of XML contents by the Cryptographic Module is<br>present.                                                                                                                                                                      |              |  |
| 2.                  | Check the developer documents for information about<br>how the canonicalisation procedure was implemented.                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                            | The implementation of the canonicalisation procedure support<br>C14N –<br>Canonical XML Version 1.0 [C14N]<br>at a minimum.<br>C14N11 –<br>Canonical XML Version 1.1<br>[C14N11], C14N20 –<br>Canonical XML Version 2.0 [C14N20]<br>and EC14N -<br>Exclusive<br>XML Canonicalization –<br>should<br>also be supported. |              |  |
| 3.                  | If the pre-supposition of chapter 4.3.1<br>request to a Trust Service Provider to generate                                                                                                                                  | is fulfilled, send a<br>a signed                                                                                                                                                                                                                                                                                                                           | A positive feedback will be received; no error message or error<br>code. The signed XAIP or BIN with a valid digital signature<br>shall                                                                                                                                                                                |              |  |

|         | Identifier                                                                                                                                     |                                       | M.2-06                                                                                     |  |
|---------|------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|--------------------------------------------------------------------------------------------|--|
|         | XML, e.g. a signed XAIP or BIN.                                                                                                                |                                       | be received.                                                                               |  |
| 4.      | Verify the digital signature of the XAIP / BIN.                                                                                                |                                       | The validation result should<br>show a positive result. Digital<br>signature is valid.     |  |
| 5.      | Modify the signed XAIP/BIN in such a way so that it is<br>not canonicalised (e.g. by entering empty lines and<br>spaces between the XML tags). |                                       | ---                                                                                        |  |
|         | Do not modify or remove the digital                                                                                                            | signature.                            |                                                                                            |  |
| 6.      | Verify the digital signature of the XAIP/BIN.                                                                                                  |                                       | The validation result should<br>show a positive result. The digital<br>signature is valid. |  |
| 7.      | Conditional: If<br>No. 1 to No. 5 are to be repeated for LXAIP.                                                                                | LXAIP is implemented, test steps from | See expected results of the test cases from No. 1 to No. 5 for<br>LXAIP.                   |  |
| Verdict |                                                                                                                                                |                                       |                                                                                            |  |
|         |                                                                                                                                                |                                       |                                                                                            |  |
|         |                                                                                                                                                |                                       |                                                                                            |  |

## <span id="page-80-1"></span>**4.3.7 M.2-07 – Canonicalisation procedures do not change the content data**

#### **Pre-supposition**:

A product which supports "VerifyRequests" with XML data as parameters has to pass the following test case.

<span id="page-80-0"></span>

| Identifier            | M.2-07                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                  |              |
|-----------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------|--------------|
| Requirement           | M2:A4.4-3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                  |              |
| Test Purpose          | The implemented canonicalisation procedures shall<br>not change the content data.<br>Note: if the TOT doesn't support "VerifyRequests" with XML data as parameters the test case can be passed as fulfilled.                                                                                                                                                                                                                                                                                    |                  |              |
| Configuration         | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                  |              |
| Pre-test conditions   | •<br>XML-data with empty tags, additional white spaces, wrong order of XML-tags and digital signature is present, e.g. from test case M.2-09.<br>•<br>XML_data means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>The test dispenses if the pre-supposition is not valid. |                  |              |
| Step<br>Test sequence |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Expected Results | Observations |

|         | Identifier                                                                                                                                                               |                                       | M.2-07                                                                                                                                             |  |
|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 1.      | Using the interface function "VerifyRequest"<br>or<br>"ValidateEvidence" Request<br>send XML-data to<br>the Cryptographic Module.                                        |                                       | The sending of the XML-data is possible.                                                                                                           |  |
| 2.      | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                   |                                       | A positive feedback will be received; no error message or error<br>code.                                                                           |  |
| 3.      | Check the field "responseData".                                                                                                                                          |                                       | The field "responseData" contains<br>•<br>no XML-data but only the results of the validation OR<br>•<br>XML-data and the results of the validation |  |
| 4.      | If XML-data are returned, compare the received XML<br>data with original XML data.                                                                                       |                                       | The contents of both XML-files are equal (unmodified) or the<br>XML-data is modified (assumed: canonicalised).                                     |  |
| 5.      | Check the result of canonicalisation whether the<br>unmodified and the modified XML-data is equal related<br>to the content and mappable for XML syntax and XSD<br>used. |                                       | The canonicalisation is correct.                                                                                                                   |  |
| 6.      | Conditional: If<br>No. 1 to No. 5 are to be repeated for LXAIP.                                                                                                          | LXAIP is implemented, test steps from | See expected results of the test cases from No. 1 to No. 5 for<br>LXAIP.                                                                           |  |
| Verdict |                                                                                                                                                                          |                                       |                                                                                                                                                    |  |
|         |                                                                                                                                                                          |                                       |                                                                                                                                                    |  |

<span id="page-82-1"></span><span id="page-82-0"></span>**4.3.8 M.2-08 – Reliable validation of digital signatures by itself or by a Trust Service Provider** 

| Identifier    | M.2-08                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|---------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement   | MD:A4.3-1<br>MD:A7.4-3<br>M2:A5.1-8<br>M2:A5.1-9<br>M2:A5.1-11<br>M2:A5.1-13<br>M2:A3.4-2<br>M2:A3.4-3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Test Purpose  | The Cryptographic Module that conforms to this Guideline shall<br>provide functions<br>•<br>for the reliable validation of digital advanced and qualified signatures<br>by itself or<br>◦<br>◦<br>by requesting the validation of digital signatures from a Trust Service Provider according to [eIDAS-VO Article 3(19) or 3(20)]<br>The digital<br>signature validation function of the Cryptographic Module shall<br>support by itself or by the aid of a Trust Service Provider at least the following<br>signature formats<br>•<br>for XAdES-signatures according to<br>◦<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F, (A5.1-2)];<br>◦<br>for CAdES-signatures according to<br>•<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and<br>◦<br>◦<br>the requirements in [TR-ESOR-F, (A5.1-1)];<br>for PAdES-signatures according to<br>•<br>◦<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F, (A5.1-3)].;<br>◦<br>for ASiC-Container with AdES-signatures, time stamps and Evidence Records according to<br>•<br>◦<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F, (A5.1-4)].<br>◦ |
| Configuration | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |

|                                                                                                                         | Identifier                                                                                                                                                                                                                                                                              | M.2-08                                                                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
|-------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| •<br>User manual is present<br>Pre-test conditions<br>•<br>Service Provider<br>•<br>XAIP shall<br>be supported, "LXAIP" |                                                                                                                                                                                                                                                                                         | •                                                                                                                   | If the Crypto-Module requests the validation of digital signatures from a Trust Service Provider instead of doing it by itself, install an access to a Trust<br>may be supported, if configured.<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
| Step                                                                                                                    | Test sequence                                                                                                                                                                                                                                                                           |                                                                                                                     | Expected Results<br>Observations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |
| 1.                                                                                                                      | Check the user manual if the Cryptographic Module<br>provides a function for the reliable validation of digital<br>signatures by itself or if it requests the validation of a<br>digital signature from a Trust Service Provider according<br>to<br>[eIDAS-VO, Article 3(19) or 3(20)]. |                                                                                                                     | The Cryptographic Module provides such a function.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |  |
| 2.                                                                                                                      | digital signature formats are supported by the<br>Cryptographic Module.                                                                                                                                                                                                                 | Check the user manual for information about which                                                                   | The Cryptographic Module by itself or by requesting a validation<br>service from a Trust Service Provider supports at least the<br>following digital signature formats:<br>•<br>XAdES-signatures according to<br>◦<br>the actual COMMISSION IMPLEMENTING<br>DECISION (EU) [2015/1506/EU] and<br>◦<br>the requirements in [TR-ESOR-F, (A5.1-2)];<br>•<br>CAdES-signatures according to<br>◦<br>the actual COMMISSION IMPLEMENTING<br>DECISION (EU) [2015/1506/EU] and<br>◦<br>the requirements in [TR-ESOR-F, (A5.1-1)];<br>•<br>PAdES-signatures according to<br>the actual COMMISSION IMPLEMENTING<br>◦<br>DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F, (A5.1-3)].;<br>◦<br>•<br>ASiC-Container with AdES-signatures, time stamps and<br>Evidence Records according to<br>the actual COMMISSION IMPLEMENTING<br>◦<br>DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F, (A5.1-4)].<br>◦ |  |
| 3.                                                                                                                      | signatures from a Trust Service Provider instead of                                                                                                                                                                                                                                     | If the Crypto-Module requests the validation of digital<br>doing it by itself, check whether a secure communication | A secure communication channel<br>e.gaccording to<br>[TR 03116]<br>(Part<br>4) and<br>[TR 02102]),<br>is set up and active.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |

<span id="page-85-0"></span>

| Identifier |                                                                                                                                           |                                                                                                                    | M.2-08                                                                                                         |  |
|------------|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--|
|            | Service Provider e.g. according to [TR 03116] (Part<br>and<br>[TR 02102]), is configured and activated.                                   | channel between the Cryptographic Module and the Trust<br>4)                                                       |                                                                                                                |  |
| 4.         | signatures from a Trust Service Provider instead of<br>doing it by itself,<br>the Cryptographic Module and the Trust Service<br>Provider. | If the Crypto-Module requests the validation of digital<br>start logging the data traffic between                  | The data logging process has been started.                                                                     |  |
| 5.         | Use "VerifyRequest" -<br>function to verify XML signatures<br>[2015/1506/EU]<br>ESOR-M.2, A5.1-8]                                         | or "ValidateEvidence"-<br>according to<br>and [TR-ESOR-F, A5.1-2], [TR                                             | Validation of these XML signatures are supported by that function.                                             |  |
| 6.         | Compare signature validation results of the<br>tool or product.<br>TR-03112. Then, this test step is not required.                        | Cryptographic module with results of a common certified<br>Alternatively: the TOT15 is certified according to BSI  | The signature validations offer identical results<br>OR<br>the product is certified according to BSI TR-03112. |  |
| 7.         | Use "VerifyRequest" -<br>function to verify CMS signatures according to<br>[RFC3275], [2015/1506/EU]<br>1], [TR-ESOR-M.2, A5.1-8]         | or "ValidateEvidence"-<br>and [TR-ESOR-F, A5.1-                                                                    | Validation of these CMS signatures are supported by that function.                                             |  |
| 8.         | Compare signature validation results of the<br>tool or product.<br>03112.<br>Then, this test step is not required.                        | Cryptographic module with results of a common certified<br>Alternatively: the TOT is certified according to BSI TR | The signature validations offer identical results<br>OR<br>the product is certified according to BSI TR-03112. |  |
| 9.         | Use "VerifyRequest" -<br>function to verify PAdES signatures<br>[RFC3275], [2015/1506/EU]<br>3], [TR-ESOR-M.2, A5.1-8]                    | or "ValidateEvidence"-<br>according to<br>and [TR-ESOR-F, A5.1-                                                    | Validation of these PAdES signatures are supported by that<br>function.                                        |  |
| 10.        | Compare signature validation results of the<br>tool or product.<br>03112. Then, this test step is not required.                           | Cryptographic module with results of a common certified<br>Alternatively: the TOT is certified according to BSI TR | The signature validations offer identical results<br>OR<br>the product is certified according to BSI TR-03112. |  |

<sup>15</sup> TOT means here Crypto-Modul

| Identifier |                                                                                                                                                          |                                                                                                                                                                               | M.2-08                                                                                                         |  |
|------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--|
| 11.        | Use "VerifyRequest" -<br>function to verify ASIC Container according to<br>[RFC3275], [2015/1506/EU]<br>4]. [TR-ESOR-M.2, A5.1-8]                        | or "ValidateEvidence"-<br>and [TR-ESOR-F, A5.1-                                                                                                                               | Validation of these ASiC containers are supported by that function.                                            |  |
| 12.        | Compare signature validation results of the<br>tool or product.<br>03112. Then, this test step is not required.                                          | Cryptographic module with results of a common certified<br>Alternatively: the TOT is certified according to BSI TR                                                            | The signature validations offer identical results<br>OR<br>the product is certified according to BSI TR-03112. |  |
| 13.        | signatures from a Trust Service Provider instead of<br>the used protocol within the secure communication<br>the Trust Service Provider.                  | If the Crypto-Module requests the validation of digital<br>doing it by itself, check the IT system documentation for<br>channel protocol between the Cryptographic Module and | The documentation states which protocol is used (e.g. HTTP, RPC,<br>RMI,).                                     |  |
| 14.        | signatures from a Trust Service Provider instead of<br>doing it by itself, check the documentation for this<br>implemented.                              | If the Crypto-Module requests the validation of digital<br>protocol whether technical confirmations of receipts are                                                           | The protocol implements such confirmations (e.g. TCP ACK,<br>HTTP Return codes,).                              |  |
| 15.        | signatures from a Trust Service Provider instead of<br>doing it by itself, close the connection of the two<br>components. Stop logging the data traffic. | If the Crypto-Module requests the validation of digital                                                                                                                       | The complete data exchange between the components has been<br>intercepted and logged.                          |  |
| 16.        | signatures from a Trust Service Provider instead of<br>doing it by itself, check the data traffic log file for<br>unprotected document data.             | If the Crypto-Module requests the validation of digital                                                                                                                       | No document data can be accessed.                                                                              |  |
| Verdict    |                                                                                                                                                          |                                                                                                                                                                               |                                                                                                                |  |
|            |                                                                                                                                                          |                                                                                                                                                                               |                                                                                                                |  |

<span id="page-87-0"></span>

| Identifier                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | M.2-09                                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                                                       |              |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|--------------|
| Requirement                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | MD:A4.3-2<br>M2:A5.1-8<br>M2:A5.1-10<br>M2:A5.1-14<br>M2:A5.1-19<br>M2:A3.4-2<br>M2:A3.4-3<br>OVR-9.3-01                                                                                                                                                                                                                                                                                                |                                                                                                                       |              |
| Test Purpose                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | OVR-9.3-02<br>The Cryptographic Module shall<br>have a function to validate certificate chains by itself or by using a Trust Service Provider<br>according to [eIDAS-VO, article 3(19)<br>or 3(20)], in order to verify the integrity of archived certificate chains and archived packages (see [RFC5280, Section 6]<br>and<br>[TR-ESOR-M.3]). The list of trusted<br>certificates can be configurable. |                                                                                                                       |              |
| Configuration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                                       |              |
| •<br>Pre-test conditions<br>User manual is present.<br>•<br>If the Crypto-Module requests the validation of certificates from a Trust Service Provider instead of doing it by itself,<br>the Trust Service Provider shall<br>be listed in the trust list according to [TR-ESOR-M.2, chapter 33] and has the status "granted"<br>◦<br>◦<br>The TOT shall<br>install an access to a Trust Service Provider<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>•<br>XAIP shall<br>be<br>supported, "LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of |                                                                                                                                                                                                                                                                                                                                                                                                         | [TR-ESOR-TRANS]<br>shall<br>be configured.                                                                            |              |
| Step<br>Test sequence                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                         | Expected Results                                                                                                      | Observations |
| 1.<br>A Trust Service Provider signs the XAIP_OK<br>or<br>DXAIP_OK<br>or BIN<br>archival information package using<br>a valid and not expired certificate issued by a Trust<br>Center.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                                                                                                                                                                                                                                                                                                                                                                                         | The signed XAIP_OK<br>/ DXAIP_OK<br>/ BIN<br>was created<br>successfully.                                             |              |
| 2.<br>If the Crypto-Module requests the<br>Conditional:<br>validation of certificates from a Trust Service Provider                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                         | A secure communication channel, e.g. according to [TR 03116]<br>4) and<br>[TR 02102]), is set up and active.<br>(Part |              |

## <span id="page-87-1"></span>**4.3.9 M.2-09 – Crypto-Module shall have function to validate certificate chains by itself or by a Trust Service Provider**

| Identifier |                                                                                                                                                              |                                                                                                                                                                                                                          | M.2-09                                                                                                                                                             |  |
|------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|            | instead of doing it by itself, check whether a secure<br>communication channel between the Cryptographic<br>e.g.<br>[TR 03116] (Part<br>4)<br>and activated. | Module and the Trust Service Provider, e.g. according to<br>and [TR 02102]), is configured                                                                                                                               |                                                                                                                                                                    |  |
| 3.         | Conditional:<br>instead of doing it by itself,<br>Provider.                                                                                                  | If the Crypto-Module requests the<br>validation of certificates from a Trust Service Provider<br>start logging the data traffic<br>between the Cryptographic Module and the Trust Service                                | The data logging process has been started.                                                                                                                         |  |
| 4.         | Transfer the signed XAIP_OK<br>"ValidateEvidence" Request                                                                                                    | or DXAIP_OK<br>or BIN<br>to<br>the TOT using the interface function "VerifyRequest"or                                                                                                                                    | The call of the function with this XAIP / DXAIP_OK<br>/ BIN as<br>parameter is possible.                                                                           |  |
| 5.         | Observe the output of the interface function<br>"VerifyResponse"                                                                                             | or "ValidateEvidence" Response.                                                                                                                                                                                          | A positive feedback will be received; the digital signature has been<br>verified.                                                                                  |  |
| 6.         | was verified.                                                                                                                                                | Check the validation results whether the certificate used<br>for the digital signature of the XAIP / DXAIP_OK / BIN                                                                                                      | The certificate used for the digital signature was verified. The<br>validation results are included.                                                               |  |
| 7.         | Check the validation results whether the CA certificate<br>used for the digital signature of the certificate was<br>verified.                                |                                                                                                                                                                                                                          | The CA certificate was verified. The validation results are<br>included.<br>There must be an indication that this certificate is a trusted root CA<br>certificate. |  |
| 8.         | Conditional:<br>instead of doing it by itself, check the IT system<br>communication channel protocol between the                                             | If the Crypto-Module requests the<br>validation of certificates from a Trust Service Provider<br>documentation for the used protocol within the secure<br>Cryptographic Module and the Trust Service Provider.           | The documentation states which protocol is used (e.g. HTTP, RPC,<br>RMI,).                                                                                         |  |
| 9.         | Conditional:<br>are implemented.                                                                                                                             | If the Crypto-Module requests the<br>validation of certificates from a Trust Service Provider<br>instead of doing it by itself, check the documentation for<br>this protocol whether technical confirmations of receipts | The protocol implements such confirmations (e.g. TCP ACK,<br>HTTP Return codes,).                                                                                  |  |
| 10.        | Conditional:                                                                                                                                                 | If the Crypto-Module requests the<br>validation of certificates from a Trust Service Provider                                                                                                                            | The complete data exchange between the components has been<br>intercepted and logged.                                                                              |  |

|         | Identifier                                                                                                                                                                                                               |  | M.2-09                                                                           |  |
|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|----------------------------------------------------------------------------------|--|
|         | instead of doing it by itself, close the connection of the<br>two components. Stop<br>logging the data traffic.                                                                                                          |  |                                                                                  |  |
|         | 11.<br>Conditional:<br>If the Crypto-Module requests the<br>validation of certificates from a Trust Service Provider<br>instead of doing it by itself, check the data traffic log file<br>for unprotected document data. |  | No document data can be accessed.                                                |  |
|         | 12.Check the user manual if the list of trusted certificates<br>may be configured.                                                                                                                                       |  | The list of trusted certificates may be configured.                              |  |
|         | 13.Perform a test with a configured<br>list of trusted<br>certificates                                                                                                                                                   |  | The Cryptographic Module can check a configured list of trusted<br>certificates. |  |
|         | 14.In case of a qualified certificate according to [eIDAS<br>VO, Article 3(15)], check, whether the qualified<br>certificate used for signature or seal full-fills the<br>requirements of [eIDAS-VO, Annex I or III]     |  | The certificate full-fills the requirements of [eIDAS-VO, annex I<br>or III].    |  |
|         | 15.Conditional: If<br>LXAIP is implemented, test steps<br>from<br>No. 1 to No. 14 are to be repeated for LXAIP.                                                                                                          |  | See expected results of the test cases from No. 1 to No. 14 for<br>LXAIP.        |  |
| Verdict |                                                                                                                                                                                                                          |  |                                                                                  |  |
|         |                                                                                                                                                                                                                          |  |                                                                                  |  |

| Identifier                                                                                                                                                                                                                                                                                                                                                                                    | M.2-10                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |              |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| Requirement                                                                                                                                                                                                                                                                                                                                                                                   | MD:A5.1-10<br>M2:A5.1-10<br>M2:A5.1-11<br>M2:A5.1-12<br>M2:A5.2-1<br>OVR-6.2-06<br>OVR-9.3-01 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |              |
|                                                                                                                                                                                                                                                                                                                                                                                               | OVR-9.3-02<br>PRP-8.1-08                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |              |
| Test Purpose<br>The Cryptographic Module shall<br>The Cryptographic Module shall<br>root.                                                                                                                                                                                                                                                                                                     |                                                                                               | The Cryptographic Module is able to validate digital (advanced and qualified) signatures and evidence records generating digital signature validation results in<br>standardised formats by itself or by requesting a (qualified) Trust Service Provider with the status "granted".<br>be able to return digital signature and evidence record validation results, including related certificate information and further<br>supplemental evidence data including e.g. signatures, seals, time stamps, CRLs, OCSP-Responses etc.<br>offer a function that is able to validate user certificates for digital signatures. The validation shall<br>be complete up to a trustworthy |              |
| CONFIG_ArchiSafe<br>Configuration                                                                                                                                                                                                                                                                                                                                                             |                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |              |
| •<br>Pre-test conditions<br>User<br>manual is present<br>•                                                                                                                                                                                                                                                                                                                                    |                                                                                               | Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |              |
| Step<br>Test sequence                                                                                                                                                                                                                                                                                                                                                                         |                                                                                               | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Observations |
| 1.<br>Check the user manual whether the cryptographic<br>module has a function that is able to demonstrably verify<br>the presence and validity status of user certificates for<br>digital advanced and qualified signatures and time<br>stamps at the time of signature creation by itself or by<br>requesting a (qualified) trust validation service provider<br>with the status "granted". |                                                                                               | The cryptographic module provides such a function.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |              |
| 2.<br>Transfer the archival information package<br>interface function "VerifyRequest"                                                                                                                                                                                                                                                                                                         | XAIP_OK_SIG and / or BIN16to the TOT using the<br>or                                          | The call of the function with this signed object as parameter is<br>possible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |              |

## <span id="page-90-1"></span>**4.3.10 M.2-10 – Validation of digital signatures and evidence records yields standardised and comprehensive Verification Report**

<span id="page-90-0"></span><sup>16</sup> restricted to the *preservation object formats* described in claus[e 2,](#page-8-1) Notice 4

|     | Identifier                                                                                                                                                                                                                                                                                                                                | M.2-10                                                                                                                                                                                                                                                                     |  |
|-----|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|     | "ValidateEvidence"-Request<br>using S.4 or 512                                                                                                                                                                                                                                                                                            |                                                                                                                                                                                                                                                                            |  |
| 3.  | Observe the output of the verify-<br>function<br>"VerifyResponse"<br>or "ValidateEvidence"-Response                                                                                                                                                                                                                                       | A positive feedback will be received; no error message or error<br>code.                                                                                                                                                                                                   |  |
| 4.  | Check, whether validation information is missing. The<br>complete validation information of the digital signature,<br>the certificate and all certificates back to a trustworthy<br>root CA must be present.                                                                                                                              | All the digital signature validation results, including related<br>certificate<br>information, are returned without changes to the module<br>making the request.                                                                                                           |  |
| 5.  | Check the format for the validation results. Check the<br>user guidance to determine the format used.                                                                                                                                                                                                                                     | The results are documented in a standardized format. Preferably the<br>"VerificationReport" of the [OASIS-VR]<br>or [TR-ESOR-VR]<br>is<br>used.                                                                                                                            |  |
| 6.  | transfer the archival information package<br>If implemented,<br>XAIP_OK_SIG and / or BIN<br>(see clause 2, Notice 4) to<br>the TOT using the interface function "VerifyRequest" or<br>"ValidateEvidence"-<br>Request and asking for a<br>ReturnVerificationReport<br>using S.4 or 512.                                                    | The call of the function with this signed object as parameter is<br>possible.                                                                                                                                                                                              |  |
| 7.  | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"-Response.".                                                                                                                                                                                                                                     | A positive feedback will be received; no error message or error<br>code.                                                                                                                                                                                                   |  |
| 8.  | Check, whether validation information is missing. The<br>complete validation information of the digital signature,<br>the certificate and all certificates back to a trustworthy<br>root CA must be present.                                                                                                                              | All the digital signature validation results, including related<br>certificate information, are returned without changes to the module<br>making the request. A<br>ReturnVerificationReport<br>element according [OASIS VR], [eCard-2]<br>and [TR-ESOR-VR]<br>is returned. |  |
| 9.  | Check the format for the validation results. Check the<br>user guidance to determine the format used.                                                                                                                                                                                                                                     | The results are documented in a standardized format of a<br>"VerificationReport" of the eCard-API-Framework ([OASIS VR],<br>[eCard-2]<br>and [TR-ESOR-VR]).                                                                                                                |  |
| 10. | If implemented,<br>transfer the archival information package<br>XAIP_OK_SIG<br>and / or BIN<br>(see clause 2, Notice 4)<br>together with at least<br>one evidence record to the TOT<br>using the interface function "VerifyRequest" or<br>"ValidateEvidence"-Request<br>and asking for a<br>ReturnVerificationReport<br>using S.4 or 512. | The call of the function with this signed object as parameter is<br>possible.                                                                                                                                                                                              |  |
| 11. | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"-Response                                                                                                                                                                                                                                        | A positive feedback will be received; no error message or error<br>code.                                                                                                                                                                                                   |  |

|         | Identifier<br>M.2-10                                                                                  |                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                 |
|---------|-------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 12.     | root CA must be present.                                                                              | Check, whether validation information is missing. The<br>complete validation information of the digital signature,<br>the certificate and all certificates back to a trustworthy | All the digital signature validation results, including related<br>certificate information, and evidence record validation results are<br>returned without changes to the module making the request. At<br>least one ReturnVerificationReport-element<br>according [OASIS VR], [eCard-2]<br>and [TR-ESOR-VR]<br>is<br>returned. |
| 13.     | Check the format for the validation results. Check the<br>user guidance to determine the format used. |                                                                                                                                                                                  | The results are documented in a standardized format of a<br>"VerificationReport" of the eCard-API-Framework ([OASIS VR],<br>[eCard-2]<br>and [TR-ESOR-VR]).                                                                                                                                                                     |
| Verdict |                                                                                                       |                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                 |
|         |                                                                                                       |                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                 |

## **4.3.11 M.2-11 – Suitability of cryptographic algorithms should be defined by policy file**

#### **Attention:**

For usage of this TR-ESOR-Product by a Preservation Services pursuant to [ETSI TS 119 511] and for substituting equivalent **[ETSI TS 119 511]** - test cases by [TR-ESOR] test cases in an assessment, then this test case is to be replaced by the test case **[TR-ESOR-C.1-APP]** in clause 8, test case M.2-11.

<span id="page-93-0"></span>

| Identifier                                                                                                                   | M.2-11 |                                                                                                                                   |              |  |
|------------------------------------------------------------------------------------------------------------------------------|--------|-----------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| M3:A5.3-2<br>Requirement                                                                                                     |        |                                                                                                                                   |              |  |
| Test Purpose                                                                                                                 |        | Check whether the validity periods of hash and digital signature algorithms are stored and managed in the form of a policy file.  |              |  |
| CONFIG_Common<br>Configuration                                                                                               |        |                                                                                                                                   |              |  |
| •<br>Pre-test conditions<br>User manual is present                                                                           |        |                                                                                                                                   |              |  |
| Step<br>Test sequence                                                                                                        |        | Expected Results                                                                                                                  | Observations |  |
| 1.<br>Check the user manual,<br>how the validity periods of hash<br>and digital signature algorithms are stored and managed. |        | The validity periods of hash and digital signature<br>algorithms should<br>be stored and managed in the form of a<br>policy file. |              |  |
| Verdict                                                                                                                      |        |                                                                                                                                   |              |  |
|                                                                                                                              |        |                                                                                                                                   |              |  |

## **4.3.12 M.2-12 – Protect its own security**

<span id="page-94-0"></span>

| Identifier                                         |                                                                                                                                        |                                                                                   | M.2-12                                                                                                                                                                                       |              |  |
|----------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| MD:A7.4-2<br>Requirement<br>M2:A3.2-1<br>M2:A6.2-2 |                                                                                                                                        |                                                                                   |                                                                                                                                                                                              |              |  |
| Test<br>Purpose                                    |                                                                                                                                        |                                                                                   | Check whether the Cryptographic Module includes a function to verify its own integrity as internal defence against manipulation.                                                             |              |  |
| Configuration                                      |                                                                                                                                        | CONFIG_Common                                                                     |                                                                                                                                                                                              |              |  |
| Pre-test conditions                                |                                                                                                                                        | •<br>Developer documents<br>are present.<br>•<br>Design documents<br>are present. |                                                                                                                                                                                              |              |  |
| Step                                               | Test sequence                                                                                                                          |                                                                                   | Expected Results                                                                                                                                                                             | Observations |  |
| 1.                                                 | Check the middleware documentation for a description<br>of the design of the Cryptographic-Module<br>module.                           |                                                                                   | The Cryptographic-Module<br>module is designed as an independent<br>module or is at least functionally separated from other parts of the<br>product<br>pursuant to [TR-ESOR-M2], clause 3.1. |              |  |
| 2.                                                 | Check the vendor documentation for information<br>whether the Cryptographic Module includes a function to<br>verify its own integrity. |                                                                                   | The Cryptographic Module includes a function to verify its own<br>integrity.                                                                                                                 |              |  |
| Verdict                                            |                                                                                                                                        |                                                                                   |                                                                                                                                                                                              |              |  |
|                                                    |                                                                                                                                        |                                                                                   |                                                                                                                                                                                              |              |  |

## **4.3.13 M.2-13 – Recording security functions**

<span id="page-95-0"></span>

| Identifier                                            |                                                                                                                                                                                     |                                                                 | M.2-13                                                                                                                                                             |              |  |
|-------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| M2:A6.2-3<br>Requirement<br>OVR-7.10-02<br>PRP-8.1-06 |                                                                                                                                                                                     |                                                                 |                                                                                                                                                                    |              |  |
| Test<br>Purpose                                       |                                                                                                                                                                                     |                                                                 | Check whether the Cryptographic Module has functions to record all security functions in a meaningful and traceable manner.                                        |              |  |
| CONFIG_Common<br>Configuration                        |                                                                                                                                                                                     |                                                                 |                                                                                                                                                                    |              |  |
| •<br>Pre-test conditions<br>•                         |                                                                                                                                                                                     | Developer documents are present<br>Design documents are present |                                                                                                                                                                    |              |  |
| Step                                                  | Test sequence                                                                                                                                                                       |                                                                 | Expected Results                                                                                                                                                   | Observations |  |
| 1.                                                    | Check the vendor documentation for information<br>whether the Cryptographic Module includes a function to<br>record all security functions in a meaningful and<br>traceable manner. |                                                                 | The Cryptographic Module includes a function,<br>which records the<br>administration and the exchange of software or keys in a<br>meaningful and traceable manner. |              |  |
| 2.                                                    | Check the log files (records) of the Cryptographic<br>module.                                                                                                                       |                                                                 | The log files record the execution of the security functions in a<br>meaningful and traceable manner.                                                              |              |  |
|                                                       | Verdict                                                                                                                                                                             |                                                                 |                                                                                                                                                                    |              |  |
|                                                       |                                                                                                                                                                                     |                                                                 |                                                                                                                                                                    |              |  |

<span id="page-96-0"></span>

|                                                     | Identifier<br>M.2-14                                                                                                                                                                                                                                        |                                                           |                                                                                                                                                                                                                           |              |
|-----------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| M2:A6.2-4<br>Requirement<br>M2:A3.4-3<br>PRP-8.1-01 |                                                                                                                                                                                                                                                             | PRP-8.1-03                                                |                                                                                                                                                                                                                           |              |
| Test<br>Purpose                                     |                                                                                                                                                                                                                                                             |                                                           | Check whether the Cryptographic Module is capable of cancelling the execution of a function with a meaningful and comprehensible error<br>message in the event of unauthorised access in the module's security functions. |              |
|                                                     | Configuration                                                                                                                                                                                                                                               |                                                           | CONFIG_Common                                                                                                                                                                                                             |              |
| •<br>Pre-test conditions<br>•                       |                                                                                                                                                                                                                                                             | Developer documents are present<br>User manual is present |                                                                                                                                                                                                                           |              |
| Step                                                | Test sequence                                                                                                                                                                                                                                               |                                                           | Expected Results                                                                                                                                                                                                          | Observations |
| 1.                                                  | Check the vendor documentation for information<br>whether the Cryptographic Module is capable of<br>cancelling the execution of a function.                                                                                                                 |                                                           | The Cryptographic Module is capable of cancelling the<br>execution of functions.                                                                                                                                          |              |
| 2.                                                  | Check the vendor documentation for information if the<br>capability<br>of cancelling the execution of a function<br>produces<br>a meaningful and comprehensible error<br>message in the event of unauthorised access in the<br>module's security functions. |                                                           | of the execution of a function produces<br>The cancellation<br>meaningful and comprehensible error message in the event of<br>unauthorised access in the module's security functions.                                     | a            |
| 3.                                                  | Check the error messages produced during test case A-03<br>due to unauthorized access.<br>Are these error messages meaningful and<br>comprehensible?                                                                                                        |                                                           | All these error messages are meaningful and comprehensible.                                                                                                                                                               |              |
| Verdict                                             |                                                                                                                                                                                                                                                             |                                                           |                                                                                                                                                                                                                           |              |
|                                                     |                                                                                                                                                                                                                                                             |                                                           |                                                                                                                                                                                                                           |              |

## **4.3.14 M.2-14 – Responsivity to unauthorized access**

## **4.3.15 M.2-15 – Configuration of cryptographic functions**

<span id="page-97-0"></span>

| Identifier                     |                                                                                                                                                                                                                                      |                                                                                                               | M.2-15                                                                                                                                                                                                                                                                                                                                                      |              |
|--------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|                                | Requirement                                                                                                                                                                                                                          | M2:A6.3-1<br>M2:A6.3-2<br>M2:A6.3-3<br>OVR-6.5-04<br>OVR-7.14-01<br>OVR-7.14-03<br>OVR-7.15-01<br>OVR-7.15-03 |                                                                                                                                                                                                                                                                                                                                                             |              |
| Test<br>Purpose                |                                                                                                                                                                                                                                      |                                                                                                               | Check whether the Cryptographic Module has a central function to configure cryptographic functions.<br>Check whether the configuration is managed by a configuration file and whether this file complies with [RFC5698].                                                                                                                                    |              |
| CONFIG_Common<br>Configuration |                                                                                                                                                                                                                                      |                                                                                                               |                                                                                                                                                                                                                                                                                                                                                             |              |
| •<br>Pre-test conditions<br>•  |                                                                                                                                                                                                                                      | User manual is present<br>Product design documents are present                                                |                                                                                                                                                                                                                                                                                                                                                             |              |
| Step                           | Test sequence                                                                                                                                                                                                                        |                                                                                                               | Expected Results                                                                                                                                                                                                                                                                                                                                            | Observations |
| 1.                             | Check the vendor documentation and assess the Crypto<br>Module to identify how the Cryptographic Module<br>realises the configuration of cryptographic functions,<br>especially the algorithms and parameters used for<br>operation. |                                                                                                               | The Cryptographic Module has a central function to configure<br>cryptographic functions, preferably in a configuration file.<br>or<br>the Crypto-Module just supports those algorithms and parameters<br>assessed as suitable for [eIDAS-VO]<br>with [EN 119 312]<br>(hard<br>wired) and the Crypto-Modules needs to be updated in order to<br>change that. |              |
| 2.                             | If a configuration file is used, check whether this files<br>complies with [DSSC].                                                                                                                                                   |                                                                                                               | The [DSSC]<br>format is used.                                                                                                                                                                                                                                                                                                                               |              |
| Verdict                        |                                                                                                                                                                                                                                      |                                                                                                               |                                                                                                                                                                                                                                                                                                                                                             |              |

## **4.3.16 M.2-16 – Validation of certificates based on a standardized protocol**

<span id="page-98-0"></span>

|                                                                         | Identifier                                                                                                                                                  | M.2-16                                                    |                                                                                                                          |              |  |
|-------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------|--------------|--|
|                                                                         | Requirement                                                                                                                                                 | M2:A5.1-16<br>OVR-6.2-06<br>OVR-9.3-01<br>OVR-9.3-02      |                                                                                                                          |              |  |
| The validation of the validity of the certificate shall<br>Test Purpose |                                                                                                                                                             |                                                           | occur based on a standardized protocol. (see A5.1-16 in M.2)                                                             |              |  |
| CONFIG_Common<br>Configuration                                          |                                                                                                                                                             |                                                           |                                                                                                                          |              |  |
| •<br>Pre-test conditions<br>•                                           |                                                                                                                                                             | User manual is present<br>Developer documents are present |                                                                                                                          |              |  |
| Step                                                                    | Test sequence                                                                                                                                               |                                                           | Expected Results                                                                                                         | Observations |  |
| 1.                                                                      | Check the user manual and developer documents for<br>information about which protocols for the validation of<br>the validity of certificates are supported. |                                                           | The list of supported protocols for the validation of the validity of<br>the certificate is given.<br>OCSP is supported. |              |  |
| 2.                                                                      | Check each other supported validation protocol, if it is<br>standardized.                                                                                   |                                                           | All other supported protocols for the validation of the validity of<br>the certificate are standardized.                 |              |  |
| Verdict                                                                 |                                                                                                                                                             |                                                           |                                                                                                                          |              |  |
|                                                                         |                                                                                                                                                             |                                                           |                                                                                                                          |              |  |

<span id="page-99-1"></span><span id="page-99-0"></span>**4.3.17 M.2-17 – Crypto-Module is able to request qualified electronic time stamps from a qualified Trust Service Provider**

| Identifier                                                                                                                                                                                                                          | M.2-17        |                                                                                                                                                                                                                           |              |  |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| M2:A5.4-1<br>Requirement<br>M2:A3.4-1<br>OVR-A-03                                                                                                                                                                                   |               |                                                                                                                                                                                                                           |              |  |
| Test Purpose                                                                                                                                                                                                                        |               | The Cryptographic Module has a function to request a qualified electronic time stamp according to<br>[eIDAS-VO, article 42] from a qualified Trust Service Provider.                                                      |              |  |
| Configuration                                                                                                                                                                                                                       | CONFIG_Common |                                                                                                                                                                                                                           |              |  |
| •<br>Pre-test conditions<br>User manual is present<br>•                                                                                                                                                                             |               | The Cryptographic module is configured to request an electronic time stamp by a qualified Trust Service Provider                                                                                                          |              |  |
| Step<br>Test sequence                                                                                                                                                                                                               |               | Expected Results                                                                                                                                                                                                          | Observations |  |
| 1.<br>Check the user manual whether the Cryptographic<br>Module has a function to request a qualified electronic<br>time stamp.                                                                                                     |               | The Cryptographic Module has a function to request a qualified<br>electronic time stamp.                                                                                                                                  |              |  |
| 2.<br>Check whether a secure communication channel between<br>the Cryptographic Module and the Trust Service Provider<br>is configured and activated.                                                                               |               | A secure communication channel is set up and active.                                                                                                                                                                      |              |  |
| 3.<br>Start logging the data traffic between the Cryptographic<br>Module and the Trust Service Provider.                                                                                                                            |               | The data logging process has been started.                                                                                                                                                                                |              |  |
| 4.<br>Request a qualified electronic time stamp using the<br>corresponding interface function<br>from a qualified Trust Service Provider according to<br>eIDAS (according to [eIDAS-VO, article 42c])                               |               | The request of the qualified electronic time stamp is possible.                                                                                                                                                           |              |  |
| 5.<br>Observe the output of the interface function.                                                                                                                                                                                 |               | A positive feedback will be received; no error message or error<br>code. The electronic time stamp shall<br>be received.                                                                                                  |              |  |
| 6.<br>Check the electronic time stamp whether it is a qualified<br>one.                                                                                                                                                             |               | The electronic time stamp is a qualified electronic time stamp.                                                                                                                                                           |              |  |
| 7.<br>Check whether the Trust Service Provider is listed in the<br>trust list of the European Commission according to<br>[eIDAS-VO, article 22 (4)] for providing qualified<br>electronic time stamps<br>with the status "granted". |               | The qualified Trust Service Provider is listed in the trust list of the<br>European Commission according to [eIDAS-VO, article 22 (4)]<br>for providing qualified electronic time stamps<br>with the status<br>"granted". |              |  |

|    | Identifier                                                                                                                                                                         | M.2-17                                                                                |  |  |
|----|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|--|--|
| 8. | Check the IT system documentation for the used protocol<br>within the secure communication channel protocol<br>between the Cryptographic Module and the Trust Service<br>Provider. | The documentation states which protocol is used (e.g. HTTP, RPC,<br>RMI,).            |  |  |
| 9. | Check the documentation for this protocol whether<br>technical confirmations of receipts are implemented.                                                                          | The protocol implements such confirmations (e.g. TCP ACK,<br>HTTP Return codes,).     |  |  |
| 10 | Close the connection of the two components. Stop<br>logging the data traffic.                                                                                                      | The complete data exchange between the components has been<br>intercepted and logged. |  |  |
| 11 | Check the data traffic log file for unprotected document<br>data.                                                                                                                  | No document data can be accessed.                                                     |  |  |
|    | Verdict                                                                                                                                                                            |                                                                                       |  |  |
|    |                                                                                                                                                                                    |                                                                                       |  |  |

## <span id="page-102-2"></span><span id="page-102-1"></span>**4.3.18 M.2-18 – Crypto-Module supports [RFC 3161, [RFC5816], [RFC5652] and [EN 319 422] and suitable algorithms Attention:**

For usage of this TR-ESOR-Product by a Preservation Services pursuant to [ETSI TS 119 511] and for substituting equivalent **[ETSI TS 119 511]** - test cases by [TR-ESOR] test cases in an assessment, then this test case is to be replaced by the test case **[TR-ESOR-C.1-APP]** in clause 8, test case M.2-18.

<span id="page-102-0"></span>

| Identifier                                                                                                                                                                                         |                                                                                                                                                                                                                                             |  | M.2-18                                                                                                                                                                                                                                                                                                       |              |  |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| M2:A5.4-3<br>Requirement<br>M3:A4.7-4<br>OVR-9.2-01                                                                                                                                                |                                                                                                                                                                                                                                             |  |                                                                                                                                                                                                                                                                                                              |              |  |
| The Cryptographic Module shall<br>Test Purpose<br>pursuant to [RFC3161], [RFC5816], [RFC5652] and<br>according to [ETSI TS 119 312] and [SOG-IS]                                                   |                                                                                                                                                                                                                                             |  | check whether requested electronic time stamp fulfils the requirements and specifications of the electronic time stamp protocol<br>and whether the limitations for algorithms and parameters assessed as suitable for security<br>[EN 319 422]]<br>are implemented.                                          |              |  |
| CONFIG_Common<br>Configuration                                                                                                                                                                     |                                                                                                                                                                                                                                             |  |                                                                                                                                                                                                                                                                                                              |              |  |
| •<br>Pre-test condition<br>•<br>•                                                                                                                                                                  |                                                                                                                                                                                                                                             |  | Install an access to a qualified time stamp Trust Service Provider which accepts requests compliant with TSP (RFC 3161)<br>Configure the Crypto-Module to use this Time Stamp Service<br>Supply the list of algorithms and parameters assessed as suitable according to [ETSI<br>TS 119 312]<br>and [SOG-IS] |              |  |
| Step                                                                                                                                                                                               | Test sequence                                                                                                                                                                                                                               |  | Expected Results                                                                                                                                                                                                                                                                                             | Observations |  |
| 1.<br>Configure the Crypto-Module according to the guidance;<br>especially the protocol used to access the qualified time<br>stamp trust service provider according to [eIDAS-VO,<br>Articel 42c]. |                                                                                                                                                                                                                                             |  | It is expected that there are at least some hints regarding the<br>configuration of algorithms according to the eIDAS<br>recommendations of [ETSI TS 119<br>312] and [SOG-IS].                                                                                                                               |              |  |
|                                                                                                                                                                                                    | Check also whether there are guidance hints regarding<br>the configuration of algorithms and other cryptographic<br>parameters.                                                                                                             |  |                                                                                                                                                                                                                                                                                                              |              |  |
| 2.                                                                                                                                                                                                 | Request the qualified electronic time stamp using the<br>interface function "TimestampRequest" for each hash<br>algorithm supported by the Cryptographic Module. The<br>requestData contain the corresponding hash-algorithm<br>identifier. |  | The request of the qualified electronic time stamp with algorithm<br>identifier in requestData as parameter is possible.<br>A positive feedback will be received; no error message or error<br>code. The electronic time stamp shall<br>be received for at least one<br>algorithm.                           |              |  |
| 3.                                                                                                                                                                                                 | Check whether the<br>time stamp protocol is pursuant<br>to<br>[RFC3161], [RFC5816], [RFC5652] and<br>[EN 319 422].                                                                                                                          |  | The time stamp protocol, used in step 2,<br>has an allowed format<br>pursuant to [RFC3161], [RFC5816], [RFC5652] and<br>[EN 319<br>422].                                                                                                                                                                     |              |  |

|    | Identifier                                                                                                                                                                                                                                          | M.2-18                                                                                                                                                                |  |  |
|----|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|
| 4. | Check whether the<br>cryptographic algorithms and<br>parameters used in the time stamp protocol are suitable<br>for security according to [ETSI TS 119 312] and [SOG<br>IS].                                                                        | The<br>cryptographic algorithms and parameters used in the time<br>stamp protocol in step 2 are suitable for security according to<br>[ETSI TS 119 312] and [SOG-IS]. |  |  |
| 5. | Request a qualified electronic time stamp using the<br>interface function "TimestampRequest" where the time<br>of the executing the request has been manipulated in<br>such a manner that it differs substantial from the moment<br>of the request. | The Crypto-Module returns an error message indicating that the<br>returned time is incorrect.                                                                         |  |  |
| 6. | Request an electronic time stamp using the interface<br>function "TimestampRequest" where the digital<br>signature of the electronic time stamp is invalid.                                                                                         | The Crypto-Module returns an error message indicating that the<br>digital signature of the electronic time stamp is invalid.                                          |  |  |
|    | Verdict                                                                                                                                                                                                                                             |                                                                                                                                                                       |  |  |
|    |                                                                                                                                                                                                                                                     |                                                                                                                                                                       |  |  |

<span id="page-104-0"></span>

| Identifier                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                   |                          | M.2-19                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |              |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|--------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| M2:A3.4-1<br>Requirement<br>M2:A3.4-3<br>M2:A5.4-2<br>OVR-7.14-0<br>OVR-7.5-02<br>OVR-7.15-01<br>OVR-7.15-03<br>OVR-A-03                                                                                                                                                                                                                                                                                                                              |                                                                                                                   |                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |              |
| The Cryptographic Module<br>Test Purpose<br>•<br>42] .<br>•<br>CONFIG_Common<br>Configuration<br>Pre-test conditions<br>•<br>•<br>•                                                                                                                                                                                                                                                                                                                   |                                                                                                                   | User manuals are present | shall check whether<br>the qualified electronic time stamp requested and received from a qualified Trust Service Provider with status "granted" on base of § 17 [VDG] (see also<br>[TR-ESOR-M.3), including a valid digital signature created by this qualified Trust Service Provider, fulfils the requirements of o [eIDAS-VO, Article<br>requested qualified electronic Time-Stamps include an advanced electronic signature or an advanced electronic seal from the qualified Trust Service<br>Provider issuing qualified electronic time stamp according to [eIDAS-VO, article 42].<br>Install an access to a qualified time stamp Trust Service Provider which accepts requests compliant with TSP (RFC 3161)<br>Cryptographic Module is configured (if possible) to check whether requested qualified electronic time stamps for re-signing include an advanced<br>electronic signature or an advanced electronic seal from a qualified Trust Service Provider issuing qualified electronic time stamp |              |
| Step                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Test sequence                                                                                                     |                          | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Observations |
| 1.<br>Check the user manual and related documentation, if<br>there is described that the Cryptographic Module has a<br>trustworthy communication channel, e.g. according to<br>e.g. [TR 03116] (Part<br>4)<br>and<br>[TR 02102]),<br>to a<br>qualified Trust Service Provider with status "granted"<br>according to [eIDAS-VO, Article 2 (20)]<br>in order to<br>request qualified electronic time stamps according to<br>[eIDAS-VO, Article 3 (34)]. |                                                                                                                   |                          | In the user manual there is a confirmation, that the Cryptographic<br>Module has a trustworthy communication channel, e.g. according<br>to e.g. [TR 03116] (Part<br>4) and<br>[TR 02102]),<br>to a qualified Trust<br>Service Provider with status "granted" according to [eIDAS-VO,<br>Article 2 (20)]<br>in order to request qualified electronic time stamps<br>according to [eIDAS-VO, Article 3 (34)].                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |              |
| 2.                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Check the user manual and related documentation, if the<br>qualified electronic time stamp requested and received |                          | In the user manuals there is a confirmation, that the qualified<br>electronic time stamp requested and received from a qualified Trust                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |              |

## <span id="page-104-2"></span><span id="page-104-1"></span>**4.3.19 M.2-19 – Qualified Electronic Time Stamps fulfil the requirements of [eIDAS-VO, article 42]**

|    | Identifier                                                                                                                                                                                | M.2-19                                                                                                                                                                                                              |  |
|----|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|    | from a qualified Trust Service Provider on base of § 17<br>[VDG] (see also [TR-ESOR-M.3) fulfils the<br>requirements of o [eIDAS-VO, Article 42].                                         | Service Provider on base of § 17 [VDG] (see also [TR-ESOR<br>M.3) fulfils the requirements of o [eIDAS-VO, Article 42].                                                                                             |  |
| 3. | If possible, configure the electronic time stamp Trust<br>Service Provider in such a way that the electronic time<br>stamps will be qualified signed.                                     | The test set-up is possible.                                                                                                                                                                                        |  |
|    | Otherwise, use an electronic time stamp Trust Service<br>Provider actually generating qualified signed time<br>stamps.                                                                    |                                                                                                                                                                                                                     |  |
| 4. | The Cryptographic Module requests a qualified<br>electronic time stamp from the qualified time stamp<br>Trust Service Provider.                                                           | The Cryptographic Module requests the qualified electronic time<br>stamp.                                                                                                                                           |  |
| 5. | Observe the output of the Cryptographic Module.                                                                                                                                           | A positive feedback will be received; no error message or error<br>code. The Cryptographic Module accepts the qualified electronic<br>time stamp.                                                                   |  |
| 6. | If possible, configure the qualified Trust Service<br>Provider issuing qualified electronic time stamps in such<br>a way that the electronic time stamps will be not<br>qualified signed. | The test set-up is possible.                                                                                                                                                                                        |  |
|    | Otherwise, use an electronic time stamp service provider<br>actually generating signed electronic time stamps but not<br>qualified signed.                                                |                                                                                                                                                                                                                     |  |
| 7. | Let the Cryptographic Module request an electronic time<br>stamp from the Trust Service Provider issuing electronic<br>time stamps.                                                       | The Cryptographic Module requests the electronic time stamp.                                                                                                                                                        |  |
| 8. | Observe the output of the Cryptographic Module.                                                                                                                                           | A negative feedback will be received; an error message or error<br>code on display or in error log will appear. The Cryptographic<br>Module doesn't accept not qualified signed qualified electronic<br>time stamp. |  |
| 9. | If possible, configure the time stamp Trust Service<br>Provider or the requesting middleware in such a way that<br>the electronic time stamps will be not signed.                         | The test set-up is possible.                                                                                                                                                                                        |  |
|    | Otherwise, use a time stamp Trust Service Provider<br>actually generating not signed electronic time stamps.                                                                              |                                                                                                                                                                                                                     |  |

|     | Identifier                                                                                                   | M.2-19                                                                                                                                                                                                 |  |  |  |
|-----|--------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|--|
| 10. | Let the Cryptographic Module request an electronic time<br>stamp from the time stamp Trust Service Provider. | The Cryptographic Module requests the electronic time stamp.                                                                                                                                           |  |  |  |
| 11. | Observe the output of the Cryptographic Module.                                                              | A negative feedback will be received; an error message or error<br>code on display or in error log will appear. The Cryptographic<br>Module doesn't accept not signed qualified electronic time stamp. |  |  |  |
|     | Verdict                                                                                                      |                                                                                                                                                                                                        |  |  |  |

## <span id="page-107-2"></span><span id="page-107-1"></span>**4.3.20 M.2-20 – Crypto-Module shall validate digital signatures of received electronic time stamps or hash values (or another cryptographic security element) in <asic:DataObjectReference> of a LXAIP**

#### **Attention:**

For usage of this TR-ESOR-Product by a Preservation Services pursuant to [ETSI TS 119 511] and for substituting equivalent **[ETSI TS 119 511]** - test cases by [TR-ESOR] test cases in an assessment, then this test case is to be replaced by the test case **[TR-ESOR-C.1-APP]** in clause 8, test case M.2-20.

<span id="page-107-0"></span>

| Identifier                    |                                                                                                                                                                                                                                                                                         | M.2-20                                                                                                                                                                                                                                                                                                                                                        |                                                                                                                                                                           |              |  |
|-------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
|                               | Requirement                                                                                                                                                                                                                                                                             | MD: A7.4-4<br>MD: A7.4-7<br>M2:A5.4-4<br>M2:A5.4-5<br>OVR-7.10-02<br>PRP-8.1-06<br>OVR-9.3-01<br>OVR-9.3-02                                                                                                                                                                                                                                                   |                                                                                                                                                                           |              |  |
| Test Purpose                  |                                                                                                                                                                                                                                                                                         | Check whether the Cryptographic Module validates the authenticity and integrity of received qualified electronic time stamps immediately upon receipt and prior to<br>further processing including the validation of the certificate chain back to a trustworthy root TSP by itself17 or by requesting a validation service from a Trust<br>Service Provider. |                                                                                                                                                                           |              |  |
| Configuration                 |                                                                                                                                                                                                                                                                                         | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                           |              |  |
| •<br>Pre-test conditions<br>• |                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                               | Configure Crypto-Module to maximum verbose logging<br>The Cryptographic module may be configured to ask for a time stamp validation service from a Trust Service Provider |              |  |
| Step                          | Test sequence                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                               | Expected Results                                                                                                                                                          | Observations |  |
| 1.                            | Request a qualified electronic time stamp using the<br>functions of the Crypto-Module.                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                               | The Crypto-Module performs the request.                                                                                                                                   |              |  |
| 2.                            | Check log files or other evidences whether the Crypto<br>Module has verified the authenticity and integrity of the<br>received qualified electronic time stamp (the digital<br>signature)<br>by itself or by a connected time-stamp<br>validation service from a Trust Service Provider |                                                                                                                                                                                                                                                                                                                                                               | The Crypto-Module or the connected Time-Stamp Validation Trust<br>Service Provider has successfully verified the mathematical<br>correctness of the digital signature.    |              |  |

<sup>17</sup> See See http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-timestamp

| Identifier |                                                                                                                       |                                                                                                                                                                                                                                                    | M.2-20                                                                                                                                                                                                                                                                                             |  |
|------------|-----------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 3.         | Service Provider has verified the certificate used for<br>digital signature.                                          | Check log files or other evidences whether the Crypto<br>Module or the connected Time-Stamp Validation Trust                                                                                                                                       | The Crypto-Module or the connected Time-Stamp Validation Trust<br>Service Provider has verified successfully the digital signature<br>certificate.                                                                                                                                                 |  |
| 4.         | sign the certificate used for digital signature.                                                                      | Check log files or other evidences whether the Crypto<br>Module or the connected Time-Stamp Validation Trust<br>Service Provider has verified the CA certificate used to                                                                           | The Crypto-Module or the connected Time-Stamp Validation Trust<br>Service Provider has verified successfully the CA certificate                                                                                                                                                                    |  |
| 5.         | Emulate the check of invalid digital signatures and<br>certificates.                                                  |                                                                                                                                                                                                                                                    | The Cryptographic module detects and logs the failures<br>with its<br>reason codes.                                                                                                                                                                                                                |  |
| 6.         | Conditional: If<br>Store an LXAIP_OK<br>using the<br>function.                                                        | LXAIP is implemented:<br>"ArchiveSubmissionRequest" or the "PreservePO"                                                                                                                                                                            | The function call is possible.                                                                                                                                                                                                                                                                     |  |
| 7.         | Conditional: If<br>or the "PreservePOResponse"                                                                        | LXAIP is implemented:<br>Check the output of the "ArchiveSubmissionResponse"<br>function.                                                                                                                                                          | The XAIP/BIN object is assigned to an AOID and returned<br>successfully.                                                                                                                                                                                                                           |  |
| 8.         | Conditional: If<br><asic:DataObjectReference><br>cryptographic security element)<br><asic:DataObjectReference> of the | LXAIP is implemented:<br>Check log files or other evidences whether the Crypto<br>Module has retrieved the data object, referenced in in the<br>from the ECM-/ Long<br>Term Storage and verified the hash value (or another<br>in the<br>LXAIP_OK. | The Crypto-Module has retrieved the data object, referenced in in<br>the <asic:DataObjectReference><br>from the ECM-/ Long-Term<br>Storage and has verified successfully the hash value (or another<br>cryptographic security element)<br>in the<br><asic:DataObjectReference> of the<br>LXAIP_OK. |  |
| 9.         | Conditional: If<br>Store an LXAIP_NOK<br>the<br>LXAIP_NOK is wrong.                                                   | LXAIP is implemented:<br>using the<br>"ArchiveSubmissionRequest" or the "PreservePO"<br>function, where the hash value or another cryptographic<br>security element in the <asic:DataObjectReference> of                                           | The function call is possible.                                                                                                                                                                                                                                                                     |  |
| 10.        | Conditional: If<br>or<br>the "PreservePOResponse"                                                                     | LXAIP is implemented:<br>Check the output of the "ArchiveSubmissionResponse"<br>function.                                                                                                                                                          | The XAIP/BIN object is not assigned to an AOID and a negative<br>feedback will be received with error message and error code.                                                                                                                                                                      |  |

|         | Identifier                                                                                                            |                                                                                                                                                                                                                                                    | M.2-20                                                                                                                                                                                                                                                                                                                                                            |  |
|---------|-----------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 11.     | Conditional: If<br><asic:DataObjectReference><br>cryptographic security element)<br><asic:DataObjectReference> of the | LXAIP is implemented:<br>Check log files or other evidences whether the Crypto<br>Module has retrieved the data object, referenced in in the<br>from the ECM-/ Long<br>Term Storage and verified the hash value (or another<br>in the<br>LXAIP_OK. | The Crypto-Module has retrieved the data object, referenced in in<br>the <asic:DataObjectReference><br>from the ECM-/ Long-Term<br>Storage and has not verified successfully the hash value (or another<br>cryptographic security element)<br>in the<br><asic:DataObjectReference> of the<br>LXAIP_OK.<br>The Cryptographic module detects and logs the failures. |  |
| Verdict |                                                                                                                       |                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                                                   |  |

**4.3.21 M.2-21 – The Cryptographic Module shall have a trustworthy communication channel to a qualified Trust Service Provider in order to request qualified electronic time stamps according to [eIDAS-VO, Article 3 (34)]**

<span id="page-110-0"></span>

| Identifier          |                                                                                                                                                                                                                                                                                                                                                                                                                           | M.2-21                                                                                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                       |              |  |
|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                                                                                                                                                                                                                                                                                                                                           | M2:A3.4-1<br>M2:A3.4-3<br>M2:A5.1-15<br>OVR-7.5-02<br>PRP-8.1-01                                                                                                                                                                                            |                                                                                                                                                                                                                                                                                                                                                                                       |              |  |
| Test Purpose        |                                                                                                                                                                                                                                                                                                                                                                                                                           | The Cryptographic Module<br>shall have a trustworthy communication channel to a qualified Trust Service Provider according to [eIDAS-VO, Article 2 (20)]<br>in order<br>to request qualified electronic time stamps according to [eIDAS-VO, Article 3 (34)] |                                                                                                                                                                                                                                                                                                                                                                                       |              |  |
|                     | Configuration                                                                                                                                                                                                                                                                                                                                                                                                             | CONFIG_Common                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                       |              |  |
| Pre-test conditions |                                                                                                                                                                                                                                                                                                                                                                                                                           | •<br>User manual is present.<br>•<br>Install an access to two qualified time stamp Trust Service Providers,<br>which accepts requests compliant with TSP (RFC 3161).                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                       |              |  |
| Step                | Test sequence                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                             | Expected Results                                                                                                                                                                                                                                                                                                                                                                      | Observations |  |
| 1.                  | Check the user manual and related documentation, if<br>there is described that the Cryptographic Module has a<br>trustworthy communication channel, e.g. according to<br>e.g. [TR 03116] (Part<br>4)<br>and<br>[TR 02102]),<br>to a<br>qualified Trust Service Provider according to [eIDAS<br>VO, Article 2 (20)]<br>in order to request qualified<br>electronic time stamps according to [eIDAS-VO, Article<br>3 (34)]. |                                                                                                                                                                                                                                                             | In the user manual there is a confirmation, that the Cryptographic<br>Module has a trustworthy communication channel, e.g. according<br>to e.g. [TR 03116] (Part<br>4) and<br>[TR 02102]),<br>to a qualified Trust<br>Service Provider according to [eIDAS-VO, Article 2 (20)]<br>in order<br>to request qualified electronic time stamps according to [eIDAS<br>VO, Article 3 (34)]. |              |  |
| 2.                  | If possible, configure the electronic time stamp Trust<br>Service Provider or the requesting middleware in such a<br>way that the electronic time stamps will be qualified<br>signed.<br>Otherwise, use an electronic time stamp Trust Service<br>Provider actually generating qualified electronic time<br>stamps.                                                                                                       |                                                                                                                                                                                                                                                             | The test set-up is possible.                                                                                                                                                                                                                                                                                                                                                          |              |  |
| 3.                  | The Cryptographic Module requests a qualified<br>electronic time stamp from the qualified time stamp<br>Trust Service Provider.                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                             | The Cryptographic Module receives the qualified electronic time<br>stamp.                                                                                                                                                                                                                                                                                                             |              |  |

| Identifier |                                                                                                      |                                                                                                            | M.2-21                                                                                                                                            |  |
|------------|------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 4.         | Observe the output of the Cryptographic Module.                                                      |                                                                                                            | A positive feedback will be received; no error message or error<br>code. The Cryptographic Module accepts the qualified electronic<br>time stamp. |  |
| 5.         | electronic time stamp to an<br>Validation Trust Service Provider<br>qualified electronic time stamp. | The Cryptographic Module sends the received qualified<br>external (qualified)<br>(VAL)<br>to validate this | The Cryptographic Module receives a response of the qualified<br>Trust Service Provider.                                                          |  |
| 6.         | Observe the output from the qualified Trust Service<br>Provider.                                     |                                                                                                            | A positive feedback will be received; no error message or error<br>code. The qualified electronic time stamp is valid.                            |  |
|            | Verdict                                                                                              |                                                                                                            |                                                                                                                                                   |  |

## **4.4 Module 3 – ArchiSig-Module**

## **Pre-supposition**:

A product which claims to be conform to the M.3 ArchiSig specification of this TR has to pass

- all test cases in this section and
- <span id="page-112-0"></span>• all test cases for the interface S.6 specified in section [4.5.6](#page-247-3) or prove that it supports functional analogous interfaces.

## <span id="page-113-1"></span>**4.4.1 M.3-01 – ArchiSig-Module should be realised as a separate module**

| Identifier          |               | M.3-01                      |                                                                                                                                                                                                                                                             |              |  |  |
|---------------------|---------------|-----------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|--|
| Requirement         |               | MD:A7.4-8                   |                                                                                                                                                                                                                                                             |              |  |  |
|                     |               | MD:A7.4-11                  |                                                                                                                                                                                                                                                             |              |  |  |
|                     |               | M3:A3.1-1                   |                                                                                                                                                                                                                                                             |              |  |  |
|                     |               | M3:A3.1-4                   |                                                                                                                                                                                                                                                             |              |  |  |
| Test Purpose        |               | The test shall              | verify that the ArchiSig-Module runs as an independent application or independent (functionally delimited) part of an application on a trustworthy IT<br>system18 and is neither a logical nor functional component of upstream IT specialist applications. |              |  |  |
| Configuration       |               | CONFIG_Common               |                                                                                                                                                                                                                                                             |              |  |  |
| Pre-test conditions |               | •<br>User manual is present |                                                                                                                                                                                                                                                             |              |  |  |
| Step                | Test sequence |                             | Expected Results                                                                                                                                                                                                                                            | Observations |  |  |

<span id="page-113-0"></span><sup>18</sup> The term trustworthy has been applied to IT systems that are inherently secure, available and reliable.

<span id="page-114-0"></span>

|    | Identifier                                                                                                             |                                                                                                                                                                                             | M.3-01                                                                                                       |  |
|----|------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------|--|
| 1. | (functionally delimited) part of an application.                                                                       | Check TOT and the user manual, whether the ArchiSig<br>Module is an independent application or independent                                                                                  | The ArchiSig-Module is an independent application or independent<br>part of an application.                  |  |
| 2. | module is implemented.<br>For this purpose the vendor could provide an<br>system.<br>or already provided.19<br>assumed | Check whether the IT system is trustworthy on which the<br>especially<br>hardened system or could assume a specially hardened<br>The test fails, if no settings for the baseline system are | There are statements about the trustworthy IT system.                                                        |  |
| 3. | Check the TOT and/or the user manual, whether the<br>ArchiSig-Module is either a logical or functional                 | component of the upstream IT specialist applications.                                                                                                                                       | The ArchiSig-Module is neither a logical nor functional component<br>of upstream IT specialist applications. |  |
|    | Verdict                                                                                                                |                                                                                                                                                                                             |                                                                                                              |  |
|    |                                                                                                                        |                                                                                                                                                                                             |                                                                                                              |  |

<sup>19</sup> For example, if the vendor just states that the product runs on the platform XYZ, the test fails.

If the vendor states that the products runs on the platform XYZ and the security white paper of the vendor of this platform have to be considers, the test passes.

## **4.4.2 M.3-02 – Using interface S.3 is possible**

#### **Pre-supposition**:

A product which claims to comply with the interfaces specification S.3, of this TR or part of it has to pass the following test case or part of it or prove that they support functional analogous interfaces.

<span id="page-115-0"></span>

| Identifier          | M.3-02                                                                                                                                                                                                                    |                                                  |              |  |
|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|--------------|--|
| Requirement         | M3:A3.2-2                                                                                                                                                                                                                 |                                                  |              |  |
| Test Purpose        | The test shall<br>verify that the ArchiSig module is able to access the other modules of the middleware via dedicated interfaces as described in the annexes TR-ESOR-M.2<br>and TR-ESOR-E<br>of this technical guideline. |                                                  |              |  |
| Configuration       | CONFIG_ArchiSig                                                                                                                                                                                                           |                                                  |              |  |
| Pre-test conditions | •<br>The middleware documentation is available<br>•<br>The test dispenses if the pre-supposition is not valid.                                                                                                            |                                                  |              |  |
| Step                | Test sequence                                                                                                                                                                                                             | Expected Results                                 | Observations |  |
| 1.                  | Check whether the ArchiSig documentation<br>contains the description of how to connect to the<br>interface S.3 interface.                                                                                                 | The interface is described in the documentation. |              |  |
| 2.                  | Check whether it is possible for the ArchiSig<br>module to communicate with the Crypto<br>Module via the S.3 interface.                                                                                                   | Communication is possible.                       |              |  |
| Verdict             |                                                                                                                                                                                                                           |                                                  |              |  |
|                     |                                                                                                                                                                                                                           |                                                  |              |  |

## **4.4.3 M.3-03 – ArchiSig-Module implements specified functions**

<span id="page-116-0"></span>

| Identifier                     |                                                                                                                                                                                         | M.3-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                         |              |  |
|--------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|--------------|--|
| Requirement                    |                                                                                                                                                                                         | M3:A4.0-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                         |              |  |
| Test Purpose                   |                                                                                                                                                                                         | The test shall<br>verify that an ArchiSig-Module provides at least the following functions:<br>•<br>Archive Submission<br>•<br>Generation of an AOID<br>•<br>Performing canonicalisation<br>•<br>Generating hash values (using a Crypto-Module)<br>•<br>Generating an initial electronic time stamp (using a Crypto-Module)<br>•<br>Passing archive objects to the storage<br>•<br>Renewal of Archive Time Stamps<br>•<br>Renewal of hash trees<br>•<br>Generating an Evidence Record (ER) for a specified archive object |                                                                                         |              |  |
| CONFIG_Common<br>Configuration |                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                         |              |  |
| Pre-test conditions            |                                                                                                                                                                                         | •<br>User manual is present                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                         |              |  |
| Step                           | Test sequence                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Expected Results                                                                        | Observations |  |
| 1.                             | Check whether a "Archive Submission" function exists.                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Yes, such a function exists.                                                            |              |  |
| 2.                             | Check whether a function for the generation of AOIDs<br>exists or the guidance states that this function shall<br>be<br>provided by other modules like the storage.                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Yes, such a function exists or the feature is declares to be done by<br>another module. |              |  |
| 3.                             | Check whether a function for XML canonicalisation<br>exists.<br>Note: For products which supports the storage<br>(processing) of BIN data only this step may be passed as<br>fulfilled. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Yes, ArchiSig ensures that all XML objects are canonicalised<br>before hashed.          |              |  |
| 4.                             | Check whether ArchiSig is able to generate hash values,<br>by using a Crypto-Module.                                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Yes, ArchiSig is able to calculate hash values by using a Crypto<br>Module.             |              |  |
| 5.                             | Check whether ArchiSig is able to generate initial<br>Archive Timestamps (ATS), by using a Crypto-Module.                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Yes, ArchiSig is able to calculate ATS by using a Crypto-Module.                        |              |  |
| 6.                             | Check whether ArchiSig passes the archive objects to the<br>storage system.                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Yes, ArchiSig passes all objects to the storage after hashing.                          |              |  |

<span id="page-117-0"></span>

|         | Identifier                                                                                                                                          | M.3-03                                                                                                           |  |
|---------|-----------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|--|
| 7.      | Check whether ArchiSig renews the Archive<br>Timestamps.                                                                                            | Yes, ArchiSig is able to calculate and renew ATS by using a<br>Crypto-Module.                                    |  |
| 8.      | Check whether ArchiSig is able to renew the hash trees.<br>For this purpose, ArchiSig must be able to read the<br>archive objects from the storage. | Yes, ArchiSig is able to<br>renew hash trees. For this purpose it reads<br>the archive objects from the storage. |  |
| 9.      | Check whether ArchiSig is able to generate an ERS<br>record conform to RFC 499820 or RFC 6283 for a<br>specific archive object.                     | Yes, ArchiSig is able to generate an ERS record conform to RFC<br>4998 or RFC 6283 for every archive object.     |  |
| Verdict |                                                                                                                                                     |                                                                                                                  |  |

<sup>20</sup> **[RFC4998]** must be supported, **[RFC6283]** can be supported.

## **4.4.4 M.3-04 – Creation of Initial Archive Timestamps according to [RFC4998] or [RFC6283]**

#### **Attention:**

For usage of this TR-ESOR-Product by a Preservation Services pursuant to [ETSI TS 119 511] and for substituting equivalent **[ETSI TS 119 511]** - test cases by [TR-ESOR] test cases in an assessment, then this test case is to be replaced by the test case **[TR-ESOR-C.1-APP]** in clause 8, test case M.3-04.

<span id="page-118-0"></span>

|                                                                   | Identifier    | M.3-04                                                                                                                                                                             |                  |              |
|-------------------------------------------------------------------|---------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------|--------------|
| M3:A4.5-1<br>Requirement<br>M3:A4.5-4<br>OVR-9.3-03<br>OVR-9.3-04 |               |                                                                                                                                                                                    |                  |              |
| Test Purpose                                                      |               | The test shall<br>verify that the creation of the Initial Archive Timestamp is automated and take place according to configurable rules reliably stored in the ArchiSig<br>Module. |                  |              |
| Configuration                                                     |               | CONFIG_Common                                                                                                                                                                      |                  |              |
| Pre-test conditions                                               |               | •<br>User has administrator rights on the system<br>•<br>If required, perform identification and authentication<br>•<br>At least one archive object is already archived            |                  |              |
| Step                                                              | Test sequence |                                                                                                                                                                                    | Expected Results | Observations |

<span id="page-119-0"></span>

|    | Identifier                                                                                                                                         | M.3-04                                                                                                                     |  |  |
|----|----------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|--|--|
| 1. | Check the ArchiSig-Module, whether there are<br>configurable rules for the creation of<br>Initial Archive<br>Timestamps.                           | There are configurable rules for the creation of Initial Archive<br>Timestamps.                                            |  |  |
| 2. | Configure the<br>ArchiSig-Module in such a way that every<br>10 minutes (or another short time period) a new Archive<br>Timestamp will be created. | Configuration is possible.                                                                                                 |  |  |
| 3. | Request every 10 minutes (or the configured period of<br>time) a new ER of an already archived object (3<br>or 4<br>times).                        | ER can be retrieved.                                                                                                       |  |  |
| 4. | Check the last Initial Archive Timestamp.                                                                                                          | The check is performed successfully.<br>The Initial Archive<br>Timestamp is created according to [RFC4998]21 or [RFC6283]. |  |  |
|    | Verdict                                                                                                                                            |                                                                                                                            |  |  |
|    |                                                                                                                                                    |                                                                                                                            |  |  |

<sup>21</sup> **[RFC4998]** must be supported, **[RFC6283]** can be supported.

## <span id="page-120-1"></span>**4.4.5 M.3-05 – AOID shall be unique**

| Identifier          |                          |                                                                                                                                                                                                                                              | M.3-05                  |              |  |
|---------------------|--------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|--------------|--|
| Requirement         |                          | M3:A4.2-2                                                                                                                                                                                                                                    |                         |              |  |
| Test Purpose        |                          | The test shall<br>verify that the generation of an AOID shall<br>be unique (collision free).                                                                                                                                                 |                         |              |  |
| Configuration       |                          | CONFIG_Common                                                                                                                                                                                                                                |                         |              |  |
| Pre-test conditions |                          | •<br>User has administrator rights on the system<br>•<br>If required, perform identification and authentication<br>in this test case.22<br>•<br>Test case S.4.1-02 was performed successfully<br>and the AOIDs were given back and are known |                         |              |  |
| Step                | Test sequence            |                                                                                                                                                                                                                                              | Expected Results        | Observations |  |
| 1.                  | Compare the known AOIDs. |                                                                                                                                                                                                                                              | No two AOIDs are equal. |              |  |
|                     | Verdict                  |                                                                                                                                                                                                                                              |                         |              |  |

<span id="page-120-0"></span><sup>•</sup> <sup>22</sup> There are XAIPs or LXAIPs or BINs restricted to the *preservation object formats* described in clause [2,](#page-8-1) Notice 4, which were successfully stored in the ECM/long-term storage and their AOID's were given back by the Response –Messages and therefore are "known" in this test case.

<span id="page-121-1"></span>

| 4.4.6<br>M.3-06 – | ArchiSig-Module creates Evidence Records according to RFC4998 or RFC6283 |  |
|-------------------|--------------------------------------------------------------------------|--|
|-------------------|--------------------------------------------------------------------------|--|

| Identifier                                                                                                                |                                                                                                                                                                                                                                              | M.3-06                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                              |              |  |
|---------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------|--------------|--|
| MD:A5.1-24<br>Requirement<br>MD:A5.1-8<br>M3:A3.1-1<br>M3:A4.10-1<br>OVR-9.2-03<br>OVR-6.5-08<br>PRP-8.1-10<br>OVR-9.3-03 |                                                                                                                                                                                                                                              | OVR-9.3-04                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                              |              |  |
| Test Purpose                                                                                                              |                                                                                                                                                                                                                                              | Check whether the Middleware<br>is able to provide technical evidence for the authenticity and unsophisticatedness of the archival information packages upon request<br>as well as all electronic Evidence Records needed for this purpose.<br>The function shall<br>calculate all Evidence Records (ERs) pursuant to the ERS standard for an Archival Information Package identified uniquely by the AOID, and<br>[RFC6283]23 to the application or module making the request.<br>the result shall<br>be returned in an allowed format [RFC4998]<br>/ |                                                                                              |              |  |
|                                                                                                                           | Configuration                                                                                                                                                                                                                                | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                              |              |  |
| Pre-test conditions                                                                                                       |                                                                                                                                                                                                                                              | •<br>user manual is present<br>•<br>Tester has read/write permissions on the Middleware<br>•<br>If required, perform identification and authentication<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>The<br>BSI-ERVerifyTool<br>under an<br>Open Source License<br>(Apache 2.0)<br>is installed and the tester<br>has access rights to it.                                                                                                                |                                                                                              |              |  |
| Step                                                                                                                      | Test sequence                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Expected Results                                                                             | Observations |  |
| 1.                                                                                                                        | Check the user manual if an Evidence Record is<br>calculated pursuant to the ERS standard for an Archival<br>Information Package identified uniquely by the AOID.                                                                            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | The Evidence Record is calculated pursuant to the ERS standard<br>[RFC4998]<br>or [RFC6283]. |              |  |
| 2.                                                                                                                        | Using the interface function<br>"ArchiveEvidenceRequest"or the "RetrievePO<br>with<br>SubjectOfRetrieval "Evidence""<br>and an<br>existing AOID request all Evidence Records identified<br>uniquely by the AOID<br>pursuant to S.4 or S.512. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | The call of the function with this AOID as parameter is possible.                            |              |  |

<span id="page-121-0"></span><sup>23</sup> **[RFC4998]** must be supported, **[RFC6283]** can be supported.

|         | Identifier                                                                                                                                                                                                      | M.3-06                                                                                                                                                                                         |
|---------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 3.      | Observe the output of the interface function<br>"ArchiveEvidenceResponse"<br>or the<br>"RetrievePOResponse.                                                                                                     | A positive feedback will be received; no error message or error<br>code. All Evidence Records idenified uniquely by the AOID will<br>be received.                                              |
| 4.      | Check whether each Evidence Record contains the hash<br>values according to the version of the archive object.                                                                                                  | Each Evidence Record contains the hash values according the<br>version.                                                                                                                        |
| 5.      | Check whether each Evidence Record contains an<br>Archive Timestamp Sequence which demonstrates the<br>integrity of the archive object.                                                                         | Each Evidence Record contains such a sequence.                                                                                                                                                 |
| 6.      | Check whether the electronic time stamps of the Archive<br>Timestamp Sequence are qualified electronic time<br>stamps, which demonstrates the integrity and possibly<br>the authenticity of the archive object. | All electronic time stamps are qualified electronic time stamps, i.e.<br>time stamps completed by an advanced digital signature (signature<br>or seal) according to<br>[eIDAS-VO, article 42]. |
| 7.      | Check whether the Evidence Record has an allowed<br>format [RFC4998]<br>/ [RFC6283], using the BSI<br>ERVerifyTool.                                                                                             | The BSI-ERVerifyTool returns a Verification Report with a<br>positive result. The Evidence Record has an allowed format<br>[RFC4998]<br>/ [RFC6283].                                           |
| Verdict |                                                                                                                                                                                                                 |                                                                                                                                                                                                |

## **4.4.7 M.3-07 – ArchiSig-Module should not implement cryptographic functions**

<span id="page-123-0"></span>

|                     | Identifier    | M.3-07                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                  |              |
|---------------------|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------|--------------|
|                     | Requirement   | M3:A3.1-5<br>M3:A4.4-3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                  |              |
|                     | Test Purpose  | The test shall<br>verify that the ArchiSig-Module itself has not implemented cryptographic functions for the protection of the authenticity or validation of the integrity<br>and authenticity with the exception of the canonicalisation functions and the functions for generation of Merkle hash trees.                                                                                                                                                                                                                                                                                                      |                  |              |
| Configuration       |               | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                  |              |
| Pre-test conditions |               | •<br>Disconnect the Crypto-Module from the ArchiSig Module<br>•<br>User manual is present<br>•<br>User has administrator rights on the system<br>•<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP<br>shall<br>be<br>supported,<br>"LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN<br>shall be restricted<br>to the preservation object formats<br>described in clause 2, Notice 4 |                  |              |
| Step                | Test sequence |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Expected Results | Observations |

|    | Identifier                                                                               |                                                                                                                                          | M.3-07                                                                                                                                                                                                                                               |  |
|----|------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 1. | way that no Crypto-Module needs to be used.                                              | Check, whether ArchiSig could be configured in such a                                                                                    | The TOT may or may not have such a configuration option. If it<br>does not, this test case is finished and considered to be passed. If it<br>does, the security guidance of the vendor clearly states that this<br>configuration is not recommended. |  |
| 2. | Call the "ArchiveSubmissionRequest" or<br>or BIN,<br>as<br>parameter                     | "PreservePO" function of ArchiSafe using XAIP_OK<br>pursuant to S.4 or S.512.<br>If required, perform identification and authentication. | The call of the function with this XAIP / BIN as parameter is<br>possible.                                                                                                                                                                           |  |
| 3. | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>Response. | or "PreservePO"-                                                                                                                         | A negative feedback will be received; an error message or error<br>code should<br>show that the digital signature or electronic time stamp<br>cannot be verified because a hash value for the XAIP / BIN<br>couldn't be calculated.                  |  |
| 4. | Conditional: If<br>No. 1 to No. 3 are to be repeated for LXAIP.                          | LXAIP is implemented, test steps from                                                                                                    | See expected results of the test cases from No. 1 to No. 3 for<br>LXAIP.                                                                                                                                                                             |  |
|    | Verdict                                                                                  |                                                                                                                                          |                                                                                                                                                                                                                                                      |  |
|    |                                                                                          |                                                                                                                                          |                                                                                                                                                                                                                                                      |  |

## **4.4.8 M.3-08 – ArchiSig-Module should be thread safe**

<span id="page-125-0"></span>

|                     | Identifier                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                      | M.3-08                                                                                                                             |              |  |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
|                     | Requirement                                                                                                                                                                                                                                                                                                        | MD:A7.2-9                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                                    |              |  |
|                     |                                                                                                                                                                                                                                                                                                                    | MD:A7.4-9<br>MD:A7.4-10<br>MD:A7.4-11                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                    |              |  |
| Test Purpose        |                                                                                                                                                                                                                                                                                                                    | The ArchiSig-Module should<br>be able to work parallel in multiple entities, in particular with regard to the case when all archival information packages present in the<br>ECM/long-term storage have to be re-signed and/or to be re-hashed.                                                                                                                                                                                                       |                                                                                                                                    |              |  |
| Configuration       |                                                                                                                                                                                                                                                                                                                    | CONFIG_ArchiSafe<br>If possible, configure ArchiSig to work parallel in multiple entities on one computer; consult the guidance for that purpose.                                                                                                                                                                                                                                                                                                    |                                                                                                                                    |              |  |
| Pre-test conditions |                                                                                                                                                                                                                                                                                                                    | •<br>Test case S.4.1-02 was performed successful and the AOID is noted<br>•<br>User has administrator rights on the system<br>•<br>User manual is present<br>•<br>If required, perform identification and authentication<br>•<br>Ensure that there are a lot (several thousand) of archive objects in the archive<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>shall<br>be configured.<br>[TR-ESOR-TRANS] |                                                                                                                                    |              |  |
| Step                | Test sequence                                                                                                                                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Expected Results                                                                                                                   | Observations |  |
| 1.                  | Start a complete resigning of the archival information<br>packages.                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                      | The resigning of the archival information packages starts.                                                                         |              |  |
| 2.                  | This must be done during the resigning<br>Request some archival information package from the<br>TOT using the interface function<br>"ArchiveRetrievalRequest"<br>or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO""<br>Request<br>and the<br>noted AOID from the test case S.4-14<br>pursuant to S.4 or<br>S.512. |                                                                                                                                                                                                                                                                                                                                                                                                                                                      | The call of the function with this AOID as<br>parameter is possible.<br>The results were received in an acceptable amount of time. |              |  |
| 3.                  | This must be done during the resigning<br>Submit some archival information package to the TOT<br>using the interface function<br>"ArchiveSubmissionRequest"<br>or "PreservePO"-<br>Request<br>pursuant to S.4 or S.512.                                                                                            |                                                                                                                                                                                                                                                                                                                                                                                                                                                      | The call of the function is possible. The results (the AOID) were<br>received in an acceptable amount of time.                     |              |  |

|         | Identifier                                                                                                                                                                            |                                                                                                                           | M.3-08                                                                                                                          |  |
|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|--|
| 4.      | packages.                                                                                                                                                                             | Start a complete rehashing of the archival information                                                                    | The rehashing of the archival information packages starts.                                                                      |  |
| 5.      | This must be done during the rehashing<br>TOT using the interface function<br>"ArchiveRetrievalRequest"<br>SubjectOfRetrieval "PO""<br>noted AOID from the test case S.4-14<br>S.512. | Request some archival information package from the<br>or "RetrievePO"<br>with<br>Request<br>and the<br>pursuant to S.4 or | The call of the function with this AOID as parameter is possible.<br>The results were received in an acceptable amount of time. |  |
| 6.      | This must be done during the rehashing<br>using the interface function<br>"ArchiveSubmissionRequest"<br>Request<br>pursuant to S.4 or S.512.                                          | Submit some archival information package to the TOT<br>or "PreservePO"-                                                   | The call of the function is possible. The results (the AOID) were<br>received in an acceptable amount of time (<= 2 Min).       |  |
| Verdict |                                                                                                                                                                                       |                                                                                                                           |                                                                                                                                 |  |

## **4.4.9 M.3-09 – Instances of ArchiSig-Module should be deployable on different machines**

<span id="page-127-0"></span>

| Identifier          |                                                                                                                                                    |                                                                                     | M.3-09                                                                   |              |  |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|--------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                                                                    | MD:A7.4-10<br>MD:A7.4-11                                                            |                                                                          |              |  |
| Test Purpose        |                                                                                                                                                    | The individual entities of ArchiSig should<br>be able to run on different machines. |                                                                          |              |  |
| Configuration       |                                                                                                                                                    | CONFIG_Common                                                                       |                                                                          |              |  |
| Pre-test conditions |                                                                                                                                                    | •                                                                                   | If required, perform identification and authentication                   |              |  |
| Step                | Test sequence                                                                                                                                      |                                                                                     | Expected Results                                                         | Observations |  |
| 1.                  | Perform test case M.3-01                                                                                                                           |                                                                                     | This demonstrates that multiple entities on one computer work.           |              |  |
| 2.                  | Configure<br>ArchiSig in such a way that the multiple<br>entities are running on different computers.<br>Consulting the guidance for that purpose. |                                                                                     | That should<br>be possible.                                              |              |  |
| 3.                  | Perform test case M.3-01 again.                                                                                                                    |                                                                                     | This demonstrates that multiple entities on different computers<br>work. |              |  |
|                     | Verdict                                                                                                                                            |                                                                                     |                                                                          |              |  |

<span id="page-128-0"></span>

| Identifier                                                                                                                                                                                                                               |                                                                                                                                                                                                                                    |                                                         | M.3-10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                 |  |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|--|
|                                                                                                                                                                                                                                          | Requirement                                                                                                                                                                                                                        | M3:A3.1-6<br>M3:A4.4-4                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                 |  |
|                                                                                                                                                                                                                                          | Test Purpose                                                                                                                                                                                                                       | The test shall<br>absolute certainty at any time.       | verify that the calculated hash value HXAIP<br>or HBIN<br>and the AOID and, if applicable, version ID<br>that is part of or allocated to the ArchiSig-Module in such a way that a hash value corresponding to an AOID                                                                                                                                                                                                                                                                                                                                          | will be stored and preserved in secure data storage<br>and, if applicable, version ID<br>can be identified with |  |
| Configuration                                                                                                                                                                                                                            |                                                                                                                                                                                                                                    | CONFIG_Common                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                 |  |
| Pre-test conditions                                                                                                                                                                                                                      |                                                                                                                                                                                                                                    | •<br>XAIP_OK<br>•<br>XAIP(BIN)<br>•<br>•<br>•<br>•<br>• | was archived successful and updated several times to obtain several versions<br>was archived successful and updated several times to obtain several versions<br>The versionIDs were noted<br>If required, establish a session with the TOT in order to perform the following tests<br>If required, perform identification and authentication<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>The BSI-ERVerifyTool is accessible<br>and the tester<br>has access rights to it. |                                                                                                                 |  |
| Step                                                                                                                                                                                                                                     | Test sequence                                                                                                                                                                                                                      |                                                         | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Observations                                                                                                    |  |
| 1.<br>Use the interface function "ArchiveRetrievalRequest" or<br>"RetrievePO"<br>with SubjectOfRetrieval<br>"PO""<br>Request<br>and the AOID from the archived<br>XAIP_OK<br>or XAIP(BIN)<br>pursuant to S.4 or S.512.                   |                                                                                                                                                                                                                                    |                                                         | The call of the function with this AOID as parameter is possible<br>and the latest version of XAIP_OK<br>or XAIP(BIN)<br>will be received.                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                 |  |
| 2.                                                                                                                                                                                                                                       | Use the interface function "ArchiveRetrievalRequest"<br>or<br>"RetrievePO"<br>with SubjectOfRetrieval<br>"PO""<br>Request, the AOID from the archived XAIP_OK<br>or XAIP(BIN) and an older versionID, pursuant to S.4<br>or S.512. |                                                         | The call of the function with this AOID and versionID as<br>parameters is possible and the appropriate version of XAIP_OK<br>or<br>XAIP(BIN)<br>will be received.                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                 |  |
| 3.<br>Use the interface function "ArchiveEvidenceRequest"<br>or<br>the "RetrievePO<br>with SubjectOfRetrieval<br>"Evidence"", the AOID from the archived XAIP_OK<br>or XAIP(BIN) and an older versionID,<br>pursuant to S.4<br>or S.512. |                                                                                                                                                                                                                                    |                                                         | The call of the function with this AOID and versionID as<br>parameters is possible and<br>the appropriate Evidence Records of XAIP_OK<br>or XAIP(BIN)<br>will be received.<br>•<br>The retrieved Evidence Records should<br>be positively<br>verified by the BSI-ERVerifyTool.                                                                                                                                                                                                                                                                                 |                                                                                                                 |  |

## **4.4.10 M.3-10 – ArchiSig-Module uses a secure storage for electronic time stamps and AOIDs**

| Identifier                                                  |                           | M.3-10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |  |
|-------------------------------------------------------------|---------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| "RetrievePO"<br>"PO""<br>Request<br>XAIP_OK<br>or XAIP(BIN) | pursuant to S.4 or S.512. | The call of the function with this AOID as parameter is possible<br>and<br>the latest version of XAIP_OK<br>or BIN embedded in an XAIP<br>( XAIP(BIN)) will be received                                                                                                                                                                                                                                                                                                                                                      |  |
| "RetrievePO"<br>"PO""<br>or S.512.                          | or<br>pursuant to S.4     | The call of the function with this AOID and versionID as<br>parameters is possible and<br>the appropriate version of XAIP_OK<br>or XAIP(BIN) embedded in<br>an XAIP will be received                                                                                                                                                                                                                                                                                                                                         |  |
| the "RetrievePO<br>or S.512.                                | or<br>pursuant to S.4     | The call of the function with this AOID and versionID as<br>parameters is possible and<br>the appropriate Evidence Records of XAIP_OK<br>or XAIP(BIN)<br>will be received.<br>•<br>The retrieved Evidence Records should<br>be positively<br>verified by the the BSI-ERVerifyTool                                                                                                                                                                                                                                            |  |
|                                                             |                           | The hash values of the two quantities of Evidence Records are not<br>equal.<br>This demonstrates that per archive object and also per version of<br>archive object unique hash values will be generated.                                                                                                                                                                                                                                                                                                                     |  |
|                                                             |                           | Use the interface function "ArchiveRetrievalRequest" or<br>with SubjectOfRetrieval<br>and the AOID from the archived<br>Use the interface function "ArchiveRetrievalRequest"<br>with SubjectOfRetrieval<br>Request, the AOID from the archived XAIP_OK<br>or XAIP(BIN) and an older versionID<br>Use the interface function "ArchiveEvidenceRequest"<br>with SubjectOfRetrieval<br>"Evidence", the AOID from the archived XAIP_OK<br>or XAIP(BIN) and an older versionID<br>Compare the hash values of the Evidence Records. |  |

<span id="page-130-0"></span>

| Identifier          |                                                                                                                                                                                                                                                                   | M.3-11                                                                                                                                                                                                                                |                                                                                                                                                          |              |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                                                                                                                                                                                   | M3:A4.3-1<br>M3:A4.3-2                                                                                                                                                                                                                |                                                                                                                                                          |              |  |
| Test Purpose        |                                                                                                                                                                                                                                                                   | The test shall<br>verify that the algorithm used for the canonicalisation is entered into the corresponding field of the Package Headers of the XAIP before the<br>canonicalisation and hash value calculation.                       |                                                                                                                                                          |              |  |
| Configuration       |                                                                                                                                                                                                                                                                   | CONFIG_ArchiSafe                                                                                                                                                                                                                      |                                                                                                                                                          |              |  |
| Pre-test conditions |                                                                                                                                                                                                                                                                   | •<br>Developer documents are present<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F],<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured. |                                                                                                                                                          |              |  |
| Step                | Test sequence                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                       | Expected Results                                                                                                                                         | Observations |  |
| 1.                  | Prepare an XAIP_OK in such a way that it is not<br>canonicalised (e.g. entering some blanks between tags)<br>Check that no AOID and no canonicalisation algorithm<br>is stated in the XAIP.                                                                       |                                                                                                                                                                                                                                       | ---                                                                                                                                                      |              |  |
| 2.                  | Submit this special XAIP to the archive using the<br>respective S.4 function<br>or TS119512 function S.512.                                                                                                                                                       |                                                                                                                                                                                                                                       | This works without error.                                                                                                                                |              |  |
| 3.                  | Retrieve this special XAIP using the respective S.4<br>function<br>or TS119512 function S.512.                                                                                                                                                                    |                                                                                                                                                                                                                                       | This works. The XAIP is retrieved.                                                                                                                       |              |  |
| 4.                  | Compare the retrieved XAIP and the original XAIP.                                                                                                                                                                                                                 |                                                                                                                                                                                                                                       | The retrieved XAIP is canonicalised and the AOID and the<br>canonicalisation algorithm is stated in the XAIP                                             |              |  |
| 5.                  | Retrieve the ERs for the special XAIP using the<br>respective S.4 function<br>or TS119512 function S.512.<br>Calculate the hash values for the special XAIP<br>and the<br>XAIP retrieved in step 3 manually (see annex TR-ESOR<br>M.3 chapter 2.4.1 for details). |                                                                                                                                                                                                                                       | The ERs can be retrieved. The hash value used in the ERs matches<br>to the canonicalised XAIP containing the AOID and the<br>canonicalisation algorithm. |              |  |
|                     | Verdict                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                       |                                                                                                                                                          |              |  |

## **4.4.11 M.3-11 – Canonicalisation of XML is performed prior to hashing and noted in XAIP**

## **4.4.12 M.3-12 – Hashing of relevant parts is performed with suitable algorithms**

<span id="page-131-0"></span>

| Identifier          |                                                                                                                                                                                                                                                                                                                | M.3-12                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                      |              |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| Requirement         |                                                                                                                                                                                                                                                                                                                | MD:7.4-12<br>M3:A4.4-1<br>M3:A4.4-2                                                                                                                                                                                           |                                                                                                                                                                                                                                                                      |              |
| Test Purpose        |                                                                                                                                                                                                                                                                                                                | The test shall<br>verify that the calculation of the hash value for the relevant parts of the Archival Information Package is based on algorithms and parameters which are<br>capable to protect the security for long-terms. |                                                                                                                                                                                                                                                                      |              |
| Configuration       |                                                                                                                                                                                                                                                                                                                | Config_Common                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                      |              |
| Pre-test conditions |                                                                                                                                                                                                                                                                                                                | •<br>User manual is present                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                      |              |
| Step                | Test sequence                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                               | Expected Results                                                                                                                                                                                                                                                     | Observations |
| 1.                  | Check the user manual, whether the calculation of the<br>hash value, done by the Cryptographic Module in order<br>of the ArchiSafe-module<br>or ArchiSig-Module, is done<br>on the basis of suitable algorithms and parameters as<br>recommended by [eIDAS-VO]<br>and<br>[ETSI TS 119<br>312]<br>and [SOG-IS]. |                                                                                                                                                                                                                               | The calculatation of the hash value is done on the basis of at least<br>one of the recommended algorithms and parameters according to<br>[eIDAS-VO]<br>and [ETSI TS 119 312] and [SOG-IS], which can be<br>configured in the ArchiSigModule or Cryptographic Module. |              |
| Verdict             |                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                      |              |

# **4.4.13 M.3-13 – ArchiSig-Module supports Timestamp Renewal and Hash-Tree Renewal**

## **Attention:**

<span id="page-132-0"></span>For usage of this TR-ESOR-Product by a Preservation Services pursuant to [ETSI TS 119 511] and for substituting equivalent **[ETSI TS 119 511]** - test cases by [TR-ESOR] test cases in an assessment, then this test case is to be replaced by the test case **[TR-ESOR-C.1-APP]** in clause 8, test case M.3-13.

| Identifier          |                                                                                                                                                                                                                                          | M.3-13                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |              |  |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                                                                                                                                                          | MD:A5.1-6<br>MD:A5.1-7<br>MD:A5.1-8<br>MD:A8.2-6<br>MD:A8.2-7<br>OVR-6.5-08<br>OVR-7.14-01<br>OVR-7.14-02<br>OVR-7.14-03<br>OVR-7.15-01<br>OVR-7.15-03<br>OVR-9.2-03                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |              |  |
| Test Purpose        |                                                                                                                                                                                                                                          | verify that pursuant to § 15 of the "Vertrauensdienstegesetz"<br>The test shall<br>the signed data can be re-signed and re-hashed<br>by augmenting the preservation<br>evidence in order to "achieve the corresponding preservation goal" (OVR-7.15-01, OVR-7.15-03) |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |              |  |
|                     | Configuration                                                                                                                                                                                                                            | CONFIG_Common                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |              |  |
| Pre-test conditions |                                                                                                                                                                                                                                          | •<br>•<br>•<br>•<br>•                                                                                                                                                                                                                                                | Test user has administrative rights on the system<br>There are XAIPs or LXAIPs or BINs restricted<br>to the preservation object formats<br>described in clause 2, Notice 4,<br>which were successfully stored<br>in the<br>ECM/long-term storage and their AOID's were given back by<br>the Response –Messages and therefore are now "known" in this test case.<br>If required, perform identification and authentication<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>The BSI-ERVerify-Tool is accessible and the tester has access rights to it. |              |  |
| Step                | Test sequence                                                                                                                                                                                                                            |                                                                                                                                                                                                                                                                      | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Observations |  |
| 1.                  | Use several interface functions<br>"ArchiveEvidenceRequest" or "RetrievePO"<br>with<br>SubjectOfRetrieval "Evidence""<br>with the<br>known AOIDs<br>pursuant to S.4 or S.512.<br>If required, perform identification and authentication. |                                                                                                                                                                                                                                                                      | Several calls of the function with the AOIDs as parameters are<br>possible.<br>Appropriate Evidence Records will be received.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |              |  |
| 2.                  | Start the the re-sign (Timestamp Renewal) process based<br>on interfaces provided by the ArchiSig module.                                                                                                                                |                                                                                                                                                                                                                                                                      | The initiation of the re-sign process is possible. No error is<br>indicated.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |              |  |

|     | Identifier                                                                                                                                                                    |                                                       | M.3-13                                                                                                                                                          |  |
|-----|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 3.  | Check log for information about the re-sign process.                                                                                                                          |                                                       | No error messages or error codes for the re-signing are in the log.                                                                                             |  |
| 4.  | Use several interface functions<br>"ArchiveEvidenceRequest" or "RetrievePO"<br>with<br>SubjectOfRetrieval "Evidence""<br>with the<br>known AOIDs<br>pursuant to S.4 or S.512. |                                                       | Appropriate Evidence Records will be received.                                                                                                                  |  |
| 5.  | Compare the new Evidence Records with the old<br>Evidence Records of the XAIPs or BINs from step 1.                                                                           |                                                       | The new and the old Evidence Records are not equal. The new<br>Evidence Records base on the new digital signature algorithms.                                   |  |
| 6.  | Change old hash-algorithm against                                                                                                                                             | new one.                                              | The change of Hash-Algorithm is possible.                                                                                                                       |  |
| 7.  | Initiate re-hash (Hash-tree Renewal) process.                                                                                                                                 |                                                       | The initiation of the re-hash process is possible.                                                                                                              |  |
| 8.  |                                                                                                                                                                               | Check log for information about the re-hash process.  | No error messages or error codes for the re-hashing are in the log.                                                                                             |  |
| 9.  | Start the the re-sign (Timestamp Renewal) process based<br>on interfaces provided by the ArchiSig module.                                                                     |                                                       | The initiation of the re-sign process is possible. No error is<br>indicated.                                                                                    |  |
| 10. | Check log for information about the re-sign process.                                                                                                                          |                                                       | No error messages or error codes for the re-signing are in the log.                                                                                             |  |
| 11. | Use several interface functions<br>"ArchiveEvidenceRequest" or "RetrievePO"<br>with<br>SubjectOfRetrieval "Evidence""<br>with the<br>known AOIDs<br>pursuant to S.4 or S.512. |                                                       | Appropriate Evidence<br>Records will be received.                                                                                                               |  |
| 12. | Compare the new Evidence Records with the old<br>Evidence Records of the XAIPs or BINs from step 1 and<br>step 4.                                                             |                                                       | The new and the old Evidence Records from step 1, 4 and 12 are<br>not equal. The new Evidence Records base on the new hash and<br>digital signature algorithms. |  |
| 13. | Use several interface functions<br>"ArchiveRetrievalRequest" or "RetrievePO" with<br>SubjectOfRetrieval "PO""<br>Request with the<br>known AOIDs<br>pursuant to S.4 or S.512. |                                                       | The XAIP's are retrieved from the storage.                                                                                                                      |  |
| 14. | Check the credential section of the XAIPs.                                                                                                                                    |                                                       | The respective "old" Evidence Records with old hash value are<br>included in the credential section.                                                            |  |
| 15. | BSI-ERVerify-Tool.                                                                                                                                                            | Check the new Evidence Record of test step 4 with the | The verification report, returned from the BSI-ERVerify-Tool,<br>shows no errors.                                                                               |  |

|     | Identifier         |                                                        | M.3-13                                                                            |  |  |
|-----|--------------------|--------------------------------------------------------|-----------------------------------------------------------------------------------|--|--|
| 16. | BSI-ERVerify-Tool. | Check the new Evidence Record of test step 11 with the | The verification report, returned from the BSI-ERVerify-Tool,<br>shows no errors. |  |  |
|     | Verdict            |                                                        |                                                                                   |  |  |

## **4.4.14 M.3-14 – Timestamp Renewal**

#### **Attention:**

For usage of this TR-ESOR-Product by a Preservation Services pursuant to [ETSI TS 119 511] and for substituting equivalent **[ETSI TS 119 511]** - test cases by [TR-ESOR] test cases in an assessment, then this test case is to be replaced by the test case **[TR-ESOR-C.1-APP]** in clause 8, test case M.3-14.

<span id="page-136-0"></span>

|                                | Identifier    | M.3-14                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                               |              |  |
|--------------------------------|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------|--------------|--|
|                                | Requirement   | M3:A4.7-1<br>M3:A4.7-3<br>OVR-6.5-07<br>OVR-7.14-02<br>OVR-7.15-01<br>OVR-7.15-03                                                                                                                                                                                                                                                                                   |                                                                                                                               |              |  |
| The test shall<br>Test Purpose |               |                                                                                                                                                                                                                                                                                                                                                                     | verify that when the function for renewal of the Archive Timestamp is requested, the latest Archive Timestamp will be renewed |              |  |
| Configuration                  |               | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                               |              |  |
| Pre-test conditions            |               | •<br>User manual is present<br>•<br>User has administrator rights on the system<br>•<br>If required, perform identification and authentication<br>•<br>There are already archived Archival Information Packages without Archive Timestamp<br>in the ECM/long-term storage<br>•<br>The BSI-ERVerify-Tool is accessible<br>and the tester<br>has access rights to it. |                                                                                                                               |              |  |
| Step                           | Test sequence |                                                                                                                                                                                                                                                                                                                                                                     | Expected Results                                                                                                              | Observations |  |

|         | Identifier                                                                                 | M.3-14                                                                                                                                                                                                                    |
|---------|--------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1.      | Use the function for renewal of the Archive Timestamp.                                     | The renewal of the latest Archive Timestamps is done.                                                                                                                                                                     |
| 2.      | Request the ERs for the archive object archived or<br>updated at the very last.            | The ERs must contain the hash value of the archive object and an<br>initial Archive Timestamp. The electronic time stamp should<br>show<br>the time of calling the function in step 1 or an earlier time.                 |
| 3.      | Check the new Evidence Record of test step 2<br>with the<br>BSI-ERVerify-Tool.             | The verification report, returned from the BSI-ERVerify-Tool,<br>shows no errors.<br>Therefore, the solution for re-signing is compatible with the<br>"Evidence Record Syntax" according to [RFC4998]<br>or<br>[RFC6283]. |
| 4.      | Disconnect the Crypto-Module from the ArchiSig<br>Module and perform this test case again. | The calculation of the initial Archive Timestamp (the hash value) is<br>not possible because ArchiSig itself does not have this<br>functionality.                                                                         |
| Verdict |                                                                                            |                                                                                                                                                                                                                           |

## **4.4.15 M.3-15 – ArchiSig-Module shall validate requested electronic time stamps**

#### **Attention:**

For usage of this TR-ESOR-Product by a Preservation Services pursuant to [ETSI TS 119 511] and for substituting equivalent **[ETSI TS 119 511]** - test cases by [TR-ESOR] test cases in an assessment, then this test case is to be replaced by the test case **[TR-ESOR-C.1-APP]** in clause 8, test case M.3-15.

<span id="page-138-0"></span>

| Identifier          | M.3-15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |  |  |  |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|--|
| Requirement         | MD:A5.1-26                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |  |  |
|                     | M3:A4.5-3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |  |  |
|                     | M3:A4.7-5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |  |  |
|                     | M3:A4.8-2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |  |  |
|                     | M3:A4.8-5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |  |  |
|                     | OVR-9.3-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |  |  |
|                     | OVR-9.3-02                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |  |  |
|                     | OVR-9.3-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |  |  |
|                     | OVR-9.3-04                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |  |  |
|                     | OVR-7.5-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |  |  |
|                     | OVR-7.15-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  |  |  |
| Test Purpose        | The ArchiSig-Module shall<br>in case of generating new electronic time stamps<br>ensure that the electronic time stamp contains all information required for validation of<br>the electronic time stamp, including the advanced digital signatures contained therein.                                                                                                                                                                                                                                                                      |  |  |  |
|                     | In case of renewal of the hash trees the electronic time stamp shall<br>contain all information required for validation of the electronic time stamp, including the<br>advanced digital signatures contained therein.                                                                                                                                                                                                                                                                                                                      |  |  |  |
|                     | The concluding Archive Timestamp of the hash trees to be renewed will be re-verified for integrity and authenticity before these Archive Timestamps are<br>transferred into a new hash tree or included there. To do so, the digital signature of this Archive Timestamp and the associated certificate chain will be re-verified<br>with the help of the functions of the TR-ESOR-M.2 Cryptographic Module. An inclusion of this Archive Timestamp in the new hash tree only takes place if this<br>validation has had a positive result. |  |  |  |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |  |  |
| Pre-test conditions | •<br>ECM/long-term storage contains already some objects and their AOIDs are known                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |  |  |
|                     | •<br>Tester emulate a TR-ESOR M.2 Cryptographic Module                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |  |  |  |
|                     | •<br>Test case M.3-16 was performed successfully                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |  |  |  |
|                     | •<br>Some archive objects are already archived                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |  |  |  |
|                     | •<br>The BSI-ERVerifyTool is accessible<br>and the tester<br>has access rights to it.                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |  |  |

<span id="page-139-0"></span>

|      | Identifier                                                                                                                                                                 | M.3-15                                                                                                                                                                                                                                                                                                                      |              |  |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Step | Test sequence                                                                                                                                                              | Expected Results                                                                                                                                                                                                                                                                                                            | Observations |  |
| 1.   | Ensure that ArchiSig creates a new Archive Timestamp<br>(e.g. by using a Crypto-Module).                                                                                   | ATS is generated.                                                                                                                                                                                                                                                                                                           |              |  |
| 2.   | Request an Evidence Records for one known AOID.                                                                                                                            | Requesting of an Evidence Record was performed successfully.                                                                                                                                                                                                                                                                |              |  |
| 3.   | Check the Evidence Record for information about time<br>stamps and validations (including OCSP Responses,<br>CRL-Reports) of digital signatures of time stamps.            | The information about the time stamps, its digital signatures and<br>the validation information of the digital signatures are present<br>(including OCSP Responses with reason code, CRL-Reports) and<br>show all information required for validation of the time stamp up to<br>the certificate of a trustworthy root TSP. |              |  |
| 4.   | Start the Hash-tree Renewal process.                                                                                                                                       | The Hash-tree Renewal process was started successfully.                                                                                                                                                                                                                                                                     |              |  |
| 5.   | Observe the requests of the ArchiSig module to the<br>Cryptographic Module.                                                                                                | ArchiSig will request validation of the very last Archive<br>Timestamp with its digital signature.                                                                                                                                                                                                                          |              |  |
| 6.   | Emulation: the Cryptographic Module send negative<br>response.                                                                                                             | Sending of negative response was performed successfully.                                                                                                                                                                                                                                                                    |              |  |
| 7.   | Check the log files of the ArchiSig-Module or observe<br>otherwise the reaction of ArchiSig.                                                                               | ArchiSig should<br>at least mention the failed validation of the<br>qualified time stamp. The ArchiSig module must stop the hash<br>tree<br>renewal and log an exception.                                                                                                                                                   |              |  |
| 8.   | Request an Evidence Record for one known AOID.                                                                                                                             | Requesting of an Evidence Record was performed successfully.                                                                                                                                                                                                                                                                |              |  |
| 9.   | Check the Evidence Records by the BSI-ERVerifyTool<br>24 for information about the Archive Timestamp and<br>digital signature validation (OCSP Responses, CRL<br>Reports). | The check of the tool shows that the ERs resp. the Archive<br>Timestamp Chain is not integer.                                                                                                                                                                                                                               |              |  |
| 10.  | Start the Hash-tree Renewal process manually or wait the<br>preconfigured period of time till automatic renewal<br>process.                                                | The Hash-tree Renewal process was started successfully.                                                                                                                                                                                                                                                                     |              |  |
| 11.  | Observe the requests of the ArchiSig<br>module to the<br>Cryptographic Module.                                                                                             | ArchiSig will request validation of the very last Archive<br>Timestamp with its digital signature.                                                                                                                                                                                                                          |              |  |
| 12.  | Emulation: the Cryptographic Module sends positive                                                                                                                         | Sending of positive response was performed successfully.                                                                                                                                                                                                                                                                    |              |  |

<sup>24</sup> The only appropriate tool is the ERVerifyTool from the Federal Office of Information Security see: https://github.com/de-bund-bsi-tr-esor/ERVerifyTool

<span id="page-140-1"></span><span id="page-140-0"></span>

| Identifier |                                                                                                                                                                                                   | M.3-15                                                                                                                                                            |  |
|------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|            | response.                                                                                                                                                                                         |                                                                                                                                                                   |  |
| 13.        | Check the log files of the ArchiSig-Module or observe<br>otherwise the reaction of ArchiSig.                                                                                                      | ArchiSig should<br>continue and finish the Hash-tree Renewal.                                                                                                     |  |
| 14.        | Request an Evidence Record for one known AOID.                                                                                                                                                    | Requesting of an Evidence Record was performed successfully.                                                                                                      |  |
| 15.        | Check the Evidence Records by the appropriate tool25 for<br>information about the Archive Timestamp and the digital<br>signature validation of steps 11./12./13. (OCSP<br>Responses, CRL-Reports) | The check of the tool26 shows that the ERs resp. the Arhive<br>Timestamp chain for the steps 11./12./13. is integer and for the<br>steps 5./6./7. is not integer. |  |
| Verdict    |                                                                                                                                                                                                   |                                                                                                                                                                   |  |

<sup>25</sup> See footnote 19

<sup>26</sup> See footnote 19

## <span id="page-141-1"></span>**4.4.16 M.3-16 – Time stamps shall be verified prior to renewal**

#### **Attention:**

For usage of this TR-ESOR-Product by a Preservation Services pursuant to [ETSI TS 119 511] and for substituting equivalent **[ETSI TS 119 511]** - test cases by [TR-ESOR] test cases in an assessment, then this test case is to be replaced by the test case **[TR-ESOR-C.1-APP]** in clause 8, test case M.3-16.

<span id="page-141-0"></span>

| Identifier          |                                                                                                                 | M.3-16                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                                                   |              |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                                 | M3:A4.7-2<br>M3:A4.7-3                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                                                   |              |  |
| Test Purpose        |                                                                                                                 | Check, whether a complete Archive Timestamp Renewal verifies the integrity and authenticity of the Archive Timestamps to be renewed and whether the hash<br>values of these Archive Timestamps are included in the new Archive Timestamp.                                                                                                                                                                                                                     |                                                                                                                                   |              |  |
| Configuration       |                                                                                                                 | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                   |              |  |
| Pre-test conditions |                                                                                                                 | •<br>Submit several archive objects to the storage and configure the automatic Archive Timestamping in such a way, that several Archive Timestamps will be<br>generated in parallel and they are not "covered" by a superior Archive Timestamp<br>•<br>If required, perform identification and authentication<br>The timestamp validation policy27 is present.<br>•<br>•<br>The BSI-ERVerify-Tool is accessible<br>and the tester<br>has access rights to it. |                                                                                                                                   |              |  |
| Step                | Test sequence                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Expected Results                                                                                                                  | Observations |  |
| 1.                  | Request the ERs of these archive objects,<br>which are<br>covered by the mentioned parallel Archive Timestamps. |                                                                                                                                                                                                                                                                                                                                                                                                                                                               | The hash value of each of the parallel Archive Timestamps is<br>documented in one ERS.                                            |              |  |
| 2.                  |                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Start the complete Archive Timestamp Renewal process. The complete Archive Timestamp Renewal process was started<br>successfully. |              |  |
| 3.                  | Observe the requests of the ArchiSig module to the<br>Cryptographic Module.                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                               | ArchiSig will request validation of the very last Archive<br>Timestamp signature.                                                 |              |  |
| 4.                  | Emulation: the Cryptographic Module sends a negative<br>response.                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Sending of negative response was performed successfully.                                                                          |              |  |
| 5.                  | Check the log files of the ArchiSig-Module or observe<br>otherwise the reaction of ArchiSig.                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                               | ArchiSig shall<br>mention the failed validation of the qualified time<br>stamp and stop the complete Archive Timestamp Renewal.   |              |  |

<sup>27</sup> See ttp://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-timestamp.

| Identifier |                                                                                                                             |                                                                                                             | M.3-16                                                                                                                                                      |  |
|------------|-----------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 6.         | Request an Evidence Records for one known AOID.                                                                             |                                                                                                             | Requesting of an Evidence Records was performed successfully.                                                                                               |  |
| 7.         | the Archive Timestamp and its digital signature<br>validation of steps 3./4./5. (OCSP Responses, CRL<br>Reports).           | Check the Evidence Records (ERs) for information about                                                      | The ERs should<br>contain no new Archive Timestamp.                                                                                                         |  |
| 8.         | again and start the complete Archive Timestamp<br>Renewal process.                                                          | Start the connection to the true Cryptographic Module                                                       | The complete Archive Timestamp Renewal process was started<br>successfully.                                                                                 |  |
| 9.         | Observe the requests of the ArchiSig module to the<br>Cryptographic Module.                                                 |                                                                                                             | ArchiSig will request validation of the very last Archive<br>Timestamp with its digital signature.                                                          |  |
| 10.        | response.                                                                                                                   | Emulation: The Cryptographic Module sends a positive                                                        | Sending of positive response was performed successfully.                                                                                                    |  |
| 11.        | otherwise the reaction of ArchiSig.                                                                                         | Check the log files of the ArchiSig-Module or observe                                                       | ArchiSig should<br>continue and finish the complete Archive<br>Timestamp Renewal.                                                                           |  |
| 12.        | Request an Evidence Records for one known AOID                                                                              |                                                                                                             | Requesting of an Evidence Records was performed successfully.                                                                                               |  |
| 13.        | Archive Timestamp and check its digital signature<br>concerning the check of steps 9./10./11. (OCSP<br>for this time stamp. | Check the Evidence Records for information about the<br>Responses, CRL-Reports) and the hash algorithm used | The ERs should<br>contain the new Archive Timestamp. All the hash<br>values of the parallel Archive Timestamps are covered by the new<br>Archive Timestamp. |  |
| 14.        | Check the new Evidence Record of test step 12<br>BSI-ERVerify-Tool.                                                         | with the                                                                                                    | The verification report, returned from the BSI-ERVerify-Tool,<br>shows no errors.                                                                           |  |
| Verdict    |                                                                                                                             |                                                                                                             |                                                                                                                                                             |  |

## **4.4.17 M.3-17 – Timestamp Renewal can only be requested by authorised users through administrative interfaces**

<span id="page-143-0"></span>

| Identifier    |                                                                                                                         | M.3-17                                                                                                                                                                                                                        |                                                                                                                                              |              |  |
|---------------|-------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement   |                                                                                                                         | M3:A4.7-6<br>M3:A4.8-6<br>PRP-8.1-03                                                                                                                                                                                          |                                                                                                                                              |              |  |
| Test Purpose  |                                                                                                                         | The test shall<br>verify that the function "Renewal of Archive Timestamp" can –<br>beside the automated function –<br>only be requested manually by authorised users<br>through administrative interfaces and will be logged. |                                                                                                                                              |              |  |
| Configuration |                                                                                                                         | CONFIG_Common                                                                                                                                                                                                                 |                                                                                                                                              |              |  |
|               | Pre-test conditions                                                                                                     | •<br>If required, perform identification and authentication                                                                                                                                                                   |                                                                                                                                              |              |  |
| Step          | Test sequence                                                                                                           |                                                                                                                                                                                                                               | Expected Results                                                                                                                             | Observations |  |
| 1.            | Check whether there is a function "Renewal of Archive<br>Timestamp" for manual start of the renewal process at<br>all.  |                                                                                                                                                                                                                               | There may be a function or not.<br>If not, the remaining test steps do not need to be performed, and the<br>test is considered to be passed. |              |  |
| 2.            | Use the function "Renewal of Archive Timestamp" with<br>an user who has administrator rights on the system.             |                                                                                                                                                                                                                               | A positive feedback will be received; no error message or error<br>code.                                                                     |              |  |
| 3.            | Check the log files of the ArchiSig-Module, if there is<br>information about the renewal of Archive Timestamps.         |                                                                                                                                                                                                                               | There is information about the renewal of Archive Timestamps.                                                                                |              |  |
| 4.            | Use the function "Renewal of Archive Timestamp" with<br>a user who has no administrator rights on the system.           |                                                                                                                                                                                                                               | A call of the function is not possible and a clear and understandable<br>error message or error code will be received.                       |              |  |
| 5.            | Check the log files of the ArchiSig-Module, if there is<br>information about the try of renewing Archive<br>Timestamps. |                                                                                                                                                                                                                               | There is no information that the function was performed<br>successfully, but there shall<br>be information about the failed request.         |              |  |
|               | Verdict                                                                                                                 |                                                                                                                                                                                                                               |                                                                                                                                              |              |  |

<span id="page-144-0"></span>

| Identifier          |                                                                                                                                                   | M.3-18                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                                                                                     |              |  |  |
|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|--------------|--|--|
|                     | Requirement                                                                                                                                       | M3:A4.8-6<br>OVR-6.5-07                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                     |              |  |  |
| Test Purpose        |                                                                                                                                                   | The test shall<br>check whether the function "Renewal of Hash Tree" calculates new hash values on the basis of configured hash algorithm for all archival information<br>packages stored in the ECM/long-term storage that have been registered by the TR-ESOR-Middleware as well as the Archive Timestamp Sequences<br>stored in the<br>data storage of the ArchiSig-Module.                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                     |              |  |  |
| Configuration       |                                                                                                                                                   | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                     |              |  |  |
| Pre-test conditions |                                                                                                                                                   | •<br>Test user has administrative rights on the system<br>•<br>There are XAIPs / BINs<br>restricted<br>to the preservation object formats<br>described in clause 2, Notice 4, registered by the TR-ESOR-Middleware,<br>stored in<br>ECM/long-term storage<br>•<br>There are XAIPs / BINs restricted<br>to the preservation object formats<br>described in clause 2, Notice 4,<br>stored in ECM/long-term storage, which are not<br>registered by the TR-ESOR-Middleware<br>•<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to<br>[TR-ESOR-F].<br>•<br>XAIP<br>shall<br>be<br>supported,<br>"LXAIP" may be supported, if configured.<br>•<br>BIN<br>shall be restricted<br>to the preservation object formats<br>described in clause 2, Notice 4.<br>• |                                                                                                     |              |  |  |
| Step                | Test sequence                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Expected Results                                                                                    | Observations |  |  |
| 1.                  | Change the hash algorithm configuration of the Crypto<br>Module so that another algorithm will be used since now.                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Configuration is possible (even if the complete CryptoModule must<br>be replaced for that purpose). |              |  |  |
| 2.                  | Configure the storage in such a way that the access to<br>objects can be traced (e.g. activate detailed logging).                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Tracing of every object access is activated.                                                        |              |  |  |
| 3.                  | Use the function "Renewal of Archive Timestamp" (with<br>an administrative user).                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | A positive feedback will be received; no error message or error<br>code.                            |              |  |  |
| 4.                  | Check the ECM/long-term storage, whether objects,<br>which are<br>not registered by the TR-ESOR-Middleware,<br>can be accessed by the middleware. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | The middleware should<br>not have accessed these objects.                                           |              |  |  |
| 5.                  | Check the ECM/long-term storage, if XAIPs / BINs,<br>which are<br>registered by the TR-ESOR-Middleware, get a<br>new hash value.                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | The middleware should<br>have accessed these objects.                                               |              |  |  |

## **4.4.18 M.3-18 – Hash-tree Renewal can only be requested through administrative interface**

|         | Identifier                                                                                                  |  | M.3-18                                                                                                                                                                                                                      |  |
|---------|-------------------------------------------------------------------------------------------------------------|--|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 6.      | Request the ERs for all these objects.                                                                      |  | It can be demonstrated that every XAIP / BIN got a new hash value<br>with the new configured algorithm and that the "old" Archive<br>Timestamp Sequences are also covered by the Hash-tree Renewal<br>(see M.3 sec. 2.4.4). |  |
| 7.      | Conditional: If<br>LXAIP is implemented, test<br>steps from<br>No. 1 to No. 6 are to be repeated for LXAIP. |  | See expected results of the test cases from No. 1 to No. 6 for<br>LXAIP.                                                                                                                                                    |  |
| Verdict |                                                                                                             |  |                                                                                                                                                                                                                             |  |

<span id="page-146-0"></span>

| Identifier          |                                                                                                                                                          | M.3-19                                                                                                        |                                                                                                              |              |  |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                                                                          | M3:A5.1-3<br>OVR-9.3-02                                                                                       |                                                                                                              |              |  |
| Test Purpose        |                                                                                                                                                          | Check whether the authenticity and integrity of the installed ArchiSig-Module is guaranteed during operation. |                                                                                                              |              |  |
| Configuration       |                                                                                                                                                          | CONFIG_Common                                                                                                 |                                                                                                              |              |  |
| Pre-test conditions |                                                                                                                                                          | •<br>User manual is present<br>•<br>Development and design documents are present                              |                                                                                                              |              |  |
| Step                | Test sequence                                                                                                                                            |                                                                                                               | Expected Results                                                                                             | Observations |  |
| 1.                  | Check the user manual whether there are statements how<br>to ensure the authenticity and integrity of the installed<br>ArchiSig-Module during operation. |                                                                                                               | The guidance contains such statements and the statements are clear<br>and intelligible.                      |              |  |
| 2.                  | Check whether the ArchiSig-Module is a signed software<br>module.                                                                                        |                                                                                                               | The ArchiSig-Module is signed or otherwise integrity-proteced<br>(e.g. hardware sealed).                     |              |  |
| 3.                  | Check the user manual whether the ArchiSig-Module<br>includes a function to verify its own integrity as self<br>defence against manipulation.            |                                                                                                               | The ArchiSig-Module includes a function to verify its own<br>integrity as self-defence against manipulation. |              |  |
|                     | Verdict                                                                                                                                                  |                                                                                                               |                                                                                                              |              |  |

## **4.4.20 M.3-20 – ArchiSig-Module should be able to maintain parallel hash-trees**

#### **Pre-supposition:**

An ArchiSig-Module, which manages parallel hash-trees.

<span id="page-147-0"></span>

| Identifier          |                                                                                                   | M.3-20                                                                                                                                                                                                                                                                                                                     |                                                                                                       |              |  |  |
|---------------------|---------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|--------------|--|--|
| Requirement         |                                                                                                   | M3:A5.2-2<br>M3:A4.8-7                                                                                                                                                                                                                                                                                                     |                                                                                                       |              |  |  |
| Test Purpose        |                                                                                                   | Check whether the ArchiSig-Module returns several reduced Evidence Records when parallel hash-trees are managed.                                                                                                                                                                                                           |                                                                                                       |              |  |  |
| Configuration       |                                                                                                   | CONFIG_Common                                                                                                                                                                                                                                                                                                              |                                                                                                       |              |  |  |
| Pre-test conditions |                                                                                                   | •<br>Configure ArchiSig in such a way that at least two parallel hash-trees are managed<br>•<br>Archive (submit) several archive objects to build up the trees<br>•<br>Ensure that at least one initial Archive Timestamp is created to build up the trees<br>•<br>The test dispenses if the pre-supposition is not valid. |                                                                                                       |              |  |  |
| Step                | Test sequence                                                                                     |                                                                                                                                                                                                                                                                                                                            | Expected Results                                                                                      | Observations |  |  |
| 1.                  | Request the ERs of archive objects submitted to the<br>archive.                                   |                                                                                                                                                                                                                                                                                                                            | The ERs for these archive<br>objects can be retrieved.                                                |              |  |  |
| 2.                  | Check the ERs whether there are reduced Evidence<br>Records for every managed hash-tree included. |                                                                                                                                                                                                                                                                                                                            | For every managed hash-tree a separate Evidence Record proofs<br>the integrity of the archive object. |              |  |  |
| Verdict             |                                                                                                   |                                                                                                                                                                                                                                                                                                                            |                                                                                                       |              |  |  |

## <span id="page-148-1"></span>**4.4.21 M.3-21 – Resigning-procedure is efficient and compatible with ERS**

| Identifier          |                                            |                                                                                                                                   | M.3-21                                                                                                                                                                                                                                              |              |  |
|---------------------|--------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                            | MD:A5.1-8<br>OVR-9.2-03<br>OVR-6.5-08                                                                                             |                                                                                                                                                                                                                                                     |              |  |
| Test Purpose        |                                            | The test shall<br>verify that the solution for re-signing shall<br>be efficient and compatible with the "Evidence Record Syntax". |                                                                                                                                                                                                                                                     |              |  |
| Configuration       |                                            | CONFIG_Common                                                                                                                     |                                                                                                                                                                                                                                                     |              |  |
| Pre-test conditions |                                            | •<br>User manual and developer documents are present                                                                              |                                                                                                                                                                                                                                                     |              |  |
| Step                | Test sequence                              |                                                                                                                                   | Expected Results                                                                                                                                                                                                                                    | Observations |  |
| 1.                  | Check user manual for re-signing solution. |                                                                                                                                   | The solution for re-signing is efficient while it preserves the<br>marketability of the protected documents. Especially the algorithm<br>used has a much better runtime cost model than O(n) when n is the<br>number of documents in the storage.28 |              |  |
| 2.                  | Check user manual for re-signing solution. |                                                                                                                                   | The solution for re-signing is compatible with the "Evidence<br>Record Syntax" according to [RFC4998]<br>or [RFC6283].                                                                                                                              |              |  |
|                     | Verdict                                    |                                                                                                                                   |                                                                                                                                                                                                                                                     |              |  |

<span id="page-148-0"></span><sup>28</sup> [http://en.wikipedia.org/wiki/Big\\_O\\_notation#Use\\_in\\_computer\\_science](http://en.wikipedia.org/wiki/Big_O_notation#Use_in_computer_science)

## <span id="page-149-0"></span>**4.4.22 M.3-22 – Deletion of an archive object shall not impair the conclusiveness of others**

| Identifier          |                                                                                                                                                                       | M.3-22                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                                                                                                                                           |              |  |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|--|
| Requirement         |                                                                                                                                                                       | MD:A5.1-32                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                                                                           |              |  |  |
| Test Purpose        |                                                                                                                                                                       | The test shall                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | verify that the conclusiveness of the remaining documents in the ECM storage is not affected by the deletion of individual XAIPs or BINs. |              |  |  |
| Configuration       |                                                                                                                                                                       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                                           |              |  |  |
| Pre-test conditions |                                                                                                                                                                       | •<br>Tester has read/write permissions on the middleware<br>•<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP<br>shall<br>be<br>supported,<br>"LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN<br>shall be restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |                                                                                                                                           |              |  |  |
| Step                | Test sequence                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Expected Results                                                                                                                          | Observations |  |  |
| 1.                  | Store an XAIP_OK_SIG or BIN,<br>using the interface<br>function "ArchiveSubmissionRequest"<br>or<br>"PreservePO"-Request<br>pursuant to S.4 or S.512.                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | The call<br>of the function with this XAIP / BIN as a parameter is<br>possible.                                                           |              |  |  |
| 2.                  | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"-<br>Response.                                                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned.                                           |              |  |  |
| 3.                  | Store another XAIP_OK_SIG or BIN,<br>using the<br>interface function "ArchiveSubmissionRequest"<br>or<br>"PreservePO"-Request<br>pursuant to S.4 or S.512.            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | The call<br>of the function with this XAIP / BIN as a parameter is<br>possible.                                                           |              |  |  |
| 4.                  | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"-<br>Response.                                                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | A positive feedback is received. No error message or error code<br>occurs. Another AOID is assigned.                                      |              |  |  |
| 5.                  | Perform an "ArchiveEvidenceRequest"<br>or<br>"RetrievePO"<br>with SubjectOfRetrieval<br>"Evidence" "<br>with the AOID received in step 2<br>pursuant to S.4 or S.512. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | The function call is possible.                                                                                                            |              |  |  |
| 6.                  | Observe the output of the interface function<br>"ArchiveEvidenceResponse"<br>or "RetrievePO"<br>Response                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | An Evidence Record for the XAIP / BIN that has been stored in<br>step 1 is received.                                                      |              |  |  |

| Identifier                                                                                                                                                                      | M.3-22                                                                                                                                                                            |  |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Perform an "ArchiveEvidenceRequest" or<br>"RetrievePO"<br>with SubjectOfRetrieval<br>"Evidence" "<br>with the AOID received in step 4<br>pursuant to S.4 or S.512.              | The function call is possible.                                                                                                                                                    |  |
| Observe the output of the interface function<br>"ArchiveEvidenceResponse"<br>or "RetrievePO"<br>Response.                                                                       | An archive Evidence Record for the XAIP / BIN that has been<br>stored in step 3 is received.                                                                                      |  |
| Using the interface function "ArchiveDeletionRequest"<br>or "DeletePO" Request<br>and the AOID from step 2,<br>delete the XAIP_OK_SIG<br>or BIN<br>pursuant to S.4 or<br>S.512. | The call of the function with this AOID as a parameter is possible.                                                                                                               |  |
| Observe the output of the interface function<br>"ArchiveDeletionResponse"<br>or "DeletePO" Response.                                                                            | A positive feedback is received. No error message or error code<br>occurs. The XAIP / BIN is deleted.                                                                             |  |
| Perform an "ArchiveEvidenceRequest" or<br>"RetrievePO"<br>with SubjectOfRetrieval<br>"Evidence" with the AOID received in step 4<br>pursuant to S.4 or S.512.                   | The function call is possible.                                                                                                                                                    |  |
| Observe the output of the interface function<br>"ArchiveEvidenceResponse"<br>or "RetrievePO"<br>Response<br>pursuant to S.4 or S.512.                                           | An Evidence Record for the XAIP / BIN that has been stored in<br>step 3 is received.                                                                                              |  |
| Compare the two Evidence Records of the XAIP / BIN<br>that was stored in step 3.                                                                                                | The Evidence Records are equal. It may be possible that in the<br>meantime an automated Timestamp Renewal of a Hash-tree<br>Renewal occurred. This would be reflected in the ERS. |  |
| Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No. 13 are to be repeated for LXAIP.                                                                       | See expected results of the test cases from No. 1 to No. 13 for<br>LXAIP.                                                                                                         |  |
|                                                                                                                                                                                 |                                                                                                                                                                                   |  |

## <span id="page-152-2"></span>**4.5 Interface functions**

Note: The following test specifications are based on the recommended reference architecture in chapter 7.1 of the main document of this technical guideline. It is worth noting, that testing the conformity level 1 the referred interfaces are required in a logical functional manner only and not in a technical interoperable characteristic.

## **4.5.1 Interface S.1**

A product, which claims to comply

- with TR-ESOR V1.2.2 and with the Interface S.1 specification of this TR , has to pass
- the following test cases concerning the interface functions Interface S.1

The primary purpose of the TR-ESOR-S.1 interface between the ArchiSafe module and the Cryptographic module is the validation and creation of digital signatures that were or should be attached to electronic data to be archived ((L)XAIP or BIN documents). BIN documents shall be restricted to the *preservation object formats* described in clause [2,](#page-8-1) Notice 4,

## **Pre-supposition**:

A product which claims to functionally comply with the Interface S.1 specification of this TR has to pass all test cases in this section or prove that it supports functional analogous interfaces.

## <span id="page-152-3"></span>**4.5.1.1 VerifyRequest or ValidateEvidence Request**

<span id="page-152-0"></span>*4.5.1.1.1 S.1.1-01 VerifyRequest or ValidateEvidence Request– Validation of digital signature, of Evidence Records and supplemented evidence data (including certificates, certificate status information and certificate path validation according to the signature validation policy)* 

<span id="page-152-1"></span>

| Identifier   | S.1.1-01                                                                                                                                                                                                                                                                                                                                                                  |  |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement  | M2:A5.1-10                                                                                                                                                                                                                                                                                                                                                                |  |
|              | M2:A5.1-9                                                                                                                                                                                                                                                                                                                                                                 |  |
|              | PRP-8.1-08                                                                                                                                                                                                                                                                                                                                                                |  |
|              | OVR-9.3-02                                                                                                                                                                                                                                                                                                                                                                |  |
| Test Purpose | The function is able to verify whether the user certificate used to generate the digital signature was valid at the time the digital signature was generated (see Chapter<br>5.1.3). Validity validation shall<br>be complete, i.e. it includes the entire certificate chain back to a trustworthy root certificate<br>according to the Signature Validation<br>Policy29. |  |
|              | The Cryptographic Module<br>shall<br>be able to verify digital signatures (advanced and qualified electronic signatures and seals).                                                                                                                                                                                                                                       |  |

<sup>29</sup> See http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-xaip.

<span id="page-153-0"></span>

|      | Identifier          | S.1.1-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |
|------|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|      |                     | Qualified time stamps with digital signatures as well as Evidence Records shall<br>stamp generation must be verified.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | be verifiable, i.e. the validity of the time stamp digital signature at the time of time                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |  |
|      | Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |
|      | Pre-test conditions | Signature Validation Policy and Timestamp Validation Policy30 are present.<br>•<br>•<br>An XAIP_OK_Sig_Q / BIN_OK_Sig_Q is present. XAIP_OK_Sig_Q / BIN_OK_Sig_Q is a XAIP_OK_SIG<br>or time stamp<br>•<br>An XAIP_OK_Sig_A / BIN_OK_Sig_A is present.<br>XAIP_OK_Sig_A / BIN_OK_Sig_A is a XAIP_OK_SIG<br>seal or time stamp<br>•<br>An XAIP_OK_Sig_Q_ERS is present. XAIP_OK_Sig_Q_ERS is a XAIP_OK_SIG_OK_ER<br>least one evidence record<br>•<br>An XAIP_OK_Sig_A_ERS is present. XAIP_OK_Sig_A_ERS is a XAIP_OK_SIG_OK_ER<br>least one evidence record<br>•<br>An XAIP_NOK_Sig_Q / BIN_NOK_Sig_Q is present. XAIP_NOK_Sig_Q / BIN_NOK_Sig_Q is a XAIP_NOK_SIG<br>electronic signature or seal or time stamp<br>•<br>An XAIP_NOK_Sig_A / BIN_NOK_Sig_A is present. XAIP_NOK_Sig_A / BIN_NOK_Sig_A is a XAIP_NOK_SIG<br>electronic signature or seal or time stamp<br>•<br>An XAIP_NOK_Sig_Q_ERS is present. XAIP_NOK_Sig_Q_ERS is a XAIP_NOK_SIG_OK_ER<br>and at least one evidence record<br>•<br>An XAIP_NOK_Sig_A_ERS is present. XAIP_NOK_Sig_A_ERS is a XAIP_NOK_SIG_OK_ER<br>and at least one evidence record<br>•<br>An XAIP_NOK_ERS is present. XAIP_NOK_ERS is a XAIP_NOK_ER<br>with qualified<br>record<br>•<br>A DXAIP_OK_SIG is present. DXAIP_OK_SIG is a DXAIP_OK_SIG<br>with qualified<br>referenced to an XAIP_OK_SIG<br>•<br>A DXAIP_NOK_SIG is present. DXAIP_NOK_SIG is a DXAIP_NOK_SIG<br>with qualified<br>referenced to an XAIP_OK_SIG or XAIP_NOK_SIG<br>•<br>developer documents are present<br>•<br>if the Cryptographic Module isn't a certified signature product (e. g. according to BSI-TR-03112) a suitable test-bed should<br>the implementation of the signature-related functionality.<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4.<br>•<br>The test dispenses if the pre-supposition is not valid. | / BIN<br>with qualified<br>electronic signature or seal<br>/ BIN<br>with advanced<br>electronic signature or<br>with qualified<br>electronic signature or seal or time stamp and at<br>with advanced<br>electronic signature or seal or time stamp and at<br>/ BIN_NOK_SIG<br>with qualified<br>/ BIN_NOK_SIG<br>with advanced<br>with qualified<br>electronic signature or seal or time stamp<br>with advanced<br>electronic signature or seal or time stamp<br>electronic signature or seal or time stamp and at least one evidence<br>or advanced electronic signature or seal or (qualified) time stamp<br>or advanced electronic signature or seal or (qualified) time stamp<br>be used to verify the correctness of<br>shall<br>be configured. |  |
| Step | Test sequence       | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Observations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |

<sup>30</sup> See http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-timestamp.

| Identifier |                                                                                                                                                                       |                                                                                                                                        | S.1.1-01                                                                                                                                                               |  |
|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 1.         | Transfer the archival information package<br>XAIP_OK_Sig_Q / BIN_OK_Sig_Q (see pre-test<br>conditions)<br>"VerifyRequest"<br>pursuant to S.4 or S.512.                | to the TOT using the interface function<br>or "ValidateEvidence" Request                                                               | The call of the function with this XAIP / BIN as parameter is<br>possible.                                                                                             |  |
| 2.         | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                |                                                                                                                                        | A positive feedback will be received; no error message or error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response.   |  |
| 3.         | would be done by the Cryptographic Module.                                                                                                                            | Examine the Verification Report if the validity validation                                                                             | The validity validation shall<br>be correct and complete, i.e. it<br>includes the entire certificate chain back to a trustworthy root<br>certificate.                  |  |
| 4.         | Transfer the archival information package<br>XAIP_OK_Sig_A / BIN_OK_Sig_A (see pre-test<br>conditions)<br>to the TOT,<br>"VerifyRequest"<br>pursuant to S.4 or S.512. | using the interface function<br>or "ValidateEvidence" Request                                                                          | The call of the function with this XAIP / BIN<br>as parameter is<br>possible.                                                                                          |  |
| 5.         | Observe the output of the interface function<br>"VerifyResponse"<br>Response.                                                                                         | or "ValidateEvidence"                                                                                                                  | A positive feedback will be received; no error message or error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response.   |  |
| 6.         | would be done by the Cryptographic Module.                                                                                                                            | Examine the Verification Report if the validity validation                                                                             | The validity validation shall<br>be correct and complete, i.e. it<br>includes the entire certificate chain back to a trustworthy root<br>certificate.                  |  |
| 7.         | Transfer the archival information package<br>XAIP_NOK_Sig_Q / BIN_NOK_SIG<br>conditions)<br>asking for a Verification Report                                          | (see pre-test<br>to the TOT using the interface function<br>"VerifyRequest" or "ValidateEvidence" Request<br>pursuant to S.4 or S.512. | The call of the function with this XAIP / BIN as parameter is<br>possible.                                                                                             |  |
| 8.         | Observe the output of the interface function<br>"VerifyResponse"<br>Response.                                                                                         | or "ValidateEvidence"                                                                                                                  | A negative feedback will be received with error message and error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response. |  |
| 9.         | would be done by the Cryptographic Module.                                                                                                                            | Examine the Verification Report if the validity validation                                                                             | The Verification Reports includes verification report structures for<br>the digital signatures, Evidence Records and the XAIP.                                         |  |
| 10.        | Transfer the archival information package                                                                                                                             |                                                                                                                                        | The call of the function with this XAIP / BIN as parameter is                                                                                                          |  |

| Identifier |                                                                                                                                                                                                                                   |                                                            | S.1.1-01                                                                                                                                                                                                               |  |
|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|            | XAIP_NOK_Sig_A / BIN_NOK_SIG<br>(see pre-test<br>conditions)<br>to the TOT. using the interface function<br>"VerifyRequest" or "ValidateEvidence" Request<br>asking for a Verification Report<br>pursuant to S.4 or S.512.        |                                                            | possible.                                                                                                                                                                                                              |  |
| 11.        | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                                                                            |                                                            | A negative feedback will be received with error message and error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response.                                                 |  |
| 12.        | Examine the Verification Report if the validity validation<br>would be done by the Cryptographic Module.                                                                                                                          |                                                            | The<br>Verification Reports includes verification report structures for<br>the digital signatures, Evidence Records and the XAIP.                                                                                      |  |
| 13.        | Transfer the archival information package<br>XAIP_OK_Sig_Q_ERS (see pre-test<br>conditions)<br>to the<br>TOT using the interface function "VerifyRequest"<br>or<br>"ValidateEvidence" Request<br>pursuant to S.4 or<br>S.512.     |                                                            | The call of the function with this XAIP as parameter is possible.                                                                                                                                                      |  |
| 14.        | Observe the output of the interface function<br>"VerifyResponse"<br>Response.                                                                                                                                                     | or "ValidateEvidence"                                      | A positive feedback will be received; no error message or error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response. The validation of the ERs<br>was also successful. |  |
| 15.        | would be done by the Cryptographic Module.                                                                                                                                                                                        | Examine the Verification Report if the validity validation | The validity validation shall<br>be correct and complete, i.e. it<br>includes the entire certificate chain back to a trustworthy root<br>certificate.                                                                  |  |
| 16.        | Transfer the archival information package<br>XAIP_OK_Sig_A_ERS (see pre-test<br>conditions)<br>to the<br>TOT,<br>using the interface function "VerifyRequest"<br>or<br>"ValidateEvidence" Request<br>pursuant to S.4 or<br>S.512. |                                                            | The call of the function with this XAIP as parameter is possible.                                                                                                                                                      |  |
| 17.        | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                                                                            |                                                            | A positive feedback will be received; no error message or error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response. The validation of the ERs<br>was also successful. |  |
| 18.        | would be done by the Cryptographic Module.                                                                                                                                                                                        | Examine the Verification Report if the validity validation | The validity validation shall<br>be correct and complete, i.e. it<br>includes the entire certificate chain back to a trustworthy root<br>certificate.                                                                  |  |
| 19.        | Transfer the archival information package                                                                                                                                                                                         |                                                            | The call of the function with this XAIP as parameter is possible.                                                                                                                                                      |  |

| Identifier |                                                                                                                                                                                                                                                              |                                                            | S.1.1-01                                                                                                                                                                  |  |  |
|------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|
|            | XAIP_NOK_Sig_Q_ERS (see pre-test<br>conditions)<br>to the<br>TOT using the interface function "VerifyRequest" or<br>"ValidateEvidence" Request asking for a<br>Verification Report<br>or "ValidateEvidence"<br>Request<br>pursuant to S.4 or S.512.          |                                                            |                                                                                                                                                                           |  |  |
| 20.        | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response                                                                                                                                                        |                                                            | A negative feedback will be received with error message and error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response.    |  |  |
| 21.        | Examine the Verification Report if the validity validation<br>would be done by the Cryptographic Module.                                                                                                                                                     |                                                            | The Verification Reports includes verification report structures for<br>the digital signatures, Evidence Records and the XAIP.                                            |  |  |
| 22.        | Transfer the archival information package<br>XAIP_NOK_Sig_A_ERS (see pre-test<br>conditions)<br>to the<br>TOT using the interface function "VerifyRequest" or<br>"ValidateEvidence" Request.asking for a<br>Verification Report<br>pursuant to S.4 or S.512. |                                                            | The call of the function with this XAIP as parameter is possible.                                                                                                         |  |  |
| 23.        | Observe the output of the interface function<br>"VerifyResponse"<br>Response.                                                                                                                                                                                | or "ValidateEvidence"                                      | A negative feedback will be received with error<br>message and error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response. |  |  |
| 24.        | would be done by the Cryptographic Module.                                                                                                                                                                                                                   | Examine the Verification Report if the validity validation | The Verification Reports includes verification report structures for<br>the digital signatures, Evidence Records and the XAIP.                                            |  |  |
| 25.        | Transfer the archival information package<br>XAIP_NOK_ERS (see pre-test<br>using the interface function "VerifyRequest" or<br>"ValidateEvidence" Request.asking for a<br>Verification Report                                                                 | conditions)<br>to the TOT<br>pursuant to S.4 or S.512.     | The call of the function with this XAIP as parameter is possible.                                                                                                         |  |  |
| 26.        | Observe the output of the interface function<br>"VerifyResponse"<br>Response.                                                                                                                                                                                | or "ValidateEvidence"                                      | A negative feedback will be received with error message and error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response.    |  |  |
| 27.        | would be done by the Cryptographic Module.                                                                                                                                                                                                                   | Examine the Verification Report if the validity validation | The Verification Reports includes verification report structures for<br>the digital signatures, Evidence Records and the XAIP.                                            |  |  |
| 28.        | Transfer the archival information package<br>DXAIP_OK_SIG (see pre-test<br>using the interface function "VerifyRequest"<br>"ValidateEvidence" Request                                                                                                        | conditions)<br>to the TOT,<br>or<br>pursuant to S.4 or     | The call of the function with this DXAIP_OK_SIG as parameter is<br>possible.                                                                                              |  |  |

| Identifier |                                                                                                                                                                                                |                                                                                                 | S.1.1-01                                                                                                                                                                                                                        |  |  |
|------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|
|            | S.512.                                                                                                                                                                                         |                                                                                                 |                                                                                                                                                                                                                                 |  |  |
| 29.        | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                                         |                                                                                                 | A positive feedback will be received; no error message or error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response. The validation of the<br>DXAIP_OK_SIG was also successful. |  |  |
| 30.        | would be                                                                                                                                                                                       | Examine the Verification Report if the validity validation<br>done by the Cryptographic Module. | The validity validation shall<br>be correct and complete, i.e. it<br>includes the entire certificate chain back to a trustworthy root<br>certificate.                                                                           |  |  |
| 31.        | Transfer the archival information package<br>DXAIP_NOK_SIG (see pre-test<br>using the interface function "VerifyRequest" or<br>"ValidateEvidence" Request.asking for a<br>Verification Report. | conditions)<br>to the TOT<br>pursuant to S.4 or S.512.                                          | The call of the function with this DXAIP_NOK_OK as parameter<br>is possible.                                                                                                                                                    |  |  |
| 32.        | Observe the output of<br>"VerifyResponse"<br>Response.                                                                                                                                         | the interface function<br>or "ValidateEvidence"                                                 | A negative feedback will be received with error message and error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response.                                                          |  |  |
| 33.        | would be done by the Cryptographic Module.                                                                                                                                                     | Examine the Verification Report if the validity validation                                      | The Verification Reports includes verification report structures for<br>the digital signatures, Evidence Records and the XAIP.                                                                                                  |  |  |
| 34.        | Conditional: If<br>No. 1 to No. 33 are to be repeated for LXAIP.                                                                                                                               | LXAIP is implemented, test steps from                                                           | See expected results of the test cases from No. 1 to No. 33 for<br>LXAIP.                                                                                                                                                       |  |  |
| Verdict    |                                                                                                                                                                                                |                                                                                                 |                                                                                                                                                                                                                                 |  |  |

## *4.5.1.1.2 S.1.1-02 Verify Request or ValidateEvidence Request - Unavailable CRL results in invalid certificate*

#### **Pre-supposition**:

A product which claims to use CRLs for certificate validation instead of OCSPs has to pass this test case.

| Identifier          |                                                                                                                                                                                 | S.1.1-02                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                  |              |  |
|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                                                                                                 | M2:A5.1-18                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                  |              |  |
| Test Purpose        |                                                                                                                                                                                 | If CRLs are used for certificate validation instead of OCSPs and the CRL is not available or CRL inquiries failed (or the repository, which hosts the CRL cannot<br>accept inquiries), then the respective certificate will be classified as invalid.                                                                                          |                                                                                                                                  |              |  |
|                     | Configuration                                                                                                                                                                   | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                               |                                                                                                                                  |              |  |
| Pre-test conditions |                                                                                                                                                                                 | •<br>Certificate of a Trust Service Provider,<br>which supports<br>CRLs<br>instead of OCSPs, is present<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |                                                                                                                                  |              |  |
| Step                | Test sequence                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                | Expected Results                                                                                                                 | Observations |  |
| 1.                  | Sign the XAIP_OK<br>/ DXAIP_OK_SIG / BIN archival<br>information package using a valid and not expired<br>certificate issued by a Trust Service Provider which<br>offers CRL.   |                                                                                                                                                                                                                                                                                                                                                | The signed XAIP_OK<br>/ DXAIP_OK_SIG / BIN<br>was created<br>successfully.                                                       |              |  |
| 2.                  | Configure the Cryptographic Module for using CRL.                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                | Configuration of the Cryptographic Module was successful.                                                                        |              |  |
| 3.                  | Block the network connection to the repository, which<br>hosts the CRL.                                                                                                         |                                                                                                                                                                                                                                                                                                                                                | The network connection to CRL is blocked.                                                                                        |              |  |
| 4.                  | Transfer the signed XAIP_OK<br>/ DXAIP_OK_SIG / BIN<br>to the TOT using the interface function<br>"VerifyRequest"<br>or "ValidateEvidence" Request<br>pursuant to S.4 or S.512. |                                                                                                                                                                                                                                                                                                                                                | The call of the function with this XAIP_OK<br>/ DXAIP_OK_SIG /<br>BIN<br>as parameter is possible.                               |              |  |
| 5.                  | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                          |                                                                                                                                                                                                                                                                                                                                                | A negative feedback will be received<br>in form of an error message<br>or error code. The certificate was classified as invalid. |              |  |
|                     | Verdict                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                  |              |  |

## **4.5.1.2 Sign Request**

The test cases M.2-05 (sec. [4.3.5](#page-76-2) Support of Hash functions M.2-05 – [Support of Hash functions\)](#page-76-2), M.2-06 (sec. [4.3.6](#page-78-1) Crypto-Module supports canonicalisation for the validation of XML digital signatures), M.2-07 (sec. [4.3.7](#page-80-1) M.2-07 – [Canonicalisation procedures do not change the content dataC](#page-80-1)anonicalisation procedures do not change the content data), and M.2-08 (sec. [4.3.8](#page-82-1) M.2-08 – [Reliable validation of digital signatures by itself or by a Trust Service Provider R](#page-82-1)eliable validation of digital **signatures** by itself or by a Trust Service Provider ) are also relevant here.

## **4.5.2 Interface S.2**

The main purpose of the TR-ESOR-S.2 interface between the ArchiSig-Module and the ECM/long-term storage is to make the necessary read and write access to ArchiSig's own database and the archive database in the ECM/long-term storage possible for the ArchiSig-Module.

This is an interface of a component which is not part of the TR-ESOR Middle-Ware. Therefore, no conformity tests will be specified here.

## **4.5.3 Interface S.3**

The primary purpose of the TR-ESOR-S.3 interface between the ArchiSig-Module and the Cryptographic-Module is the generation of hash values and the generation and validation of qualified time stamps. Both kinds of data are needed for the development of the Merkle hash trees **[MER 1980].**

## **Pre-supposition**:

A product which claims to functionally comply with the Interface S.3 specification of this TR has to pass

• all test cases in this section or prove that it supports functional analogous interfaces.

## **4.5.3.1 Timestamp Request**

<span id="page-159-0"></span>The test cases M.2-17 (sec. [4.3.17](#page-99-1) M.2-17 – [Crypto-Module is able to request qualified electronic time stamps from a Trust Service Provider\)](#page-99-1), M.2-18 (sec[.4.3.18](#page-102-1) M.2-18 – [Crypto-Module supports RFC 3161, \[RFC5816\], \[RFC5652\] and \[EN 319 422\] and suitable algorithms \)](#page-102-2), M.2-19 (sec. [4.3.19](#page-104-1) M.2-19 – [Qualified](#page-104-1)  [Electronic Time Stamps fulfil the requirements of](#page-104-2) **[eIDAS-VO, article 42]** ) and M.2-20 (sec. [4.3.20](#page-107-2) M.2-20 – Crypto-Module shall [validate digital signatures of](#page-107-2)  [received electronic time stamps \)](#page-107-2) are also relevant here.

## **4.5.3.2 Verify Request**

The test cases of the "VerifyRequest" - function of the interface S.1 (sec. [4.5.1.1](#page-152-3) [VerifyRequest](#page-152-3) [VerifyRequest\)](#page-152-3) are also relevant here.

## **4.5.3.3 Hash Request**

<span id="page-159-1"></span>The test cases M.2-05 (sec. [4.3.5](#page-76-2) M.2-05 – [Support of Hash functions\)](#page-76-2), M.2-09 (sec[.4.3.9](#page-87-1) M.2-09 – Crypto-Module shall have function [to validate certificate chains](#page-87-1)  [by itself or by a Trust Service Provider,](#page-87-1) and M.2-07 (sec. [4.3.7](#page-80-1) M.2-07 – [Canonicalisation procedures do not change the content data](#page-80-1) [\)](#page-80-1) are also relevant here.

## **4.5.4 Interface S4**

The TR-ESOR-interface S.4 or TS119512 interface S.512 in the profiling of **[TR-ESOR-TRANS]** interface shall make it possible for the business applications to access the TR-ESOR-Middleware in a standardised and functional manner. Furthermore, the interface shall reliably prevent unauthorised access to the ECM/longterm storage.

*Note: The term "ArchiSafe" in the following means the logical entry in the TR-ESOR-Middleware.* 

## **Pre-supposition**:

<span id="page-160-1"></span><span id="page-160-0"></span>A product, which claims to functionally comply with TR-ESOR V1.2.2, has to pass all test cases in this section.

#### **4.5.4.1 Archive Submission Request or PreservePO Request**

| Identifier                                                            |                                                                                                                                                    | S.4.1-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                    |              |  |
|-----------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement                                                           |                                                                                                                                                    | AF:A3-1<br>MD:A4.3-1<br>MD:A6.1-1<br>MD:A6.1-2<br>MD:A6.2-1<br>MD:A6.3-3<br>MD:A7.2-1<br>M1:A4.0-1<br>M1:A3.2-1<br>M1:A3.2-2                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                    |              |  |
| Test Purpose                                                          |                                                                                                                                                    | PRP-8.1-05<br>The test shall<br>verify that the "ArchiveSubmissionRequest" or "PreservePO Request" works well with (L)XAIP format and D(L)XAIP format or modified XML<br>formats with the same functionality.                                                                                                                                                                                                                                                                            |                                                                                                                                                                                                                                                                    |              |  |
|                                                                       | Configuration                                                                                                                                      | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                    |              |  |
| Pre-test conditions                                                   |                                                                                                                                                    | •<br>The middleware's user manual is available.<br>•<br>If required, perform identification and authentication.<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F]<br>V1.2.2,<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F]<br>V1.2.2.<br>•<br>XAIP shall<br>be<br>supported,<br>"LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured. |                                                                                                                                                                                                                                                                    |              |  |
| Step                                                                  | Test sequence                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Expected Results                                                                                                                                                                                                                                                   | Observations |  |
| 1.                                                                    | Compare the description of the XML data format in the<br>middleware's user manual with the XAIP structure<br>described in TR-ESOR Annex TR-ESOR-F. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | The implemented XML format complies with the structure defined<br>in TR-ESOR Annex TR-ESOR-F. Deviations are explained and<br>equal functionality is provided. If required, it is explained how a<br>transformation of XAIP to the present XML-format is possible. |              |  |
| 2.<br>Check the interface functions and their possible<br>parameters. |                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Data and metadata to be archived shall<br>always be contained in an<br>XML-container and only be passed in this container to the                                                                                                                                   |              |  |

| Identifier |                                                                                                                                                                                                                                                                                                                 | S.4.1-01                                                         |  |
|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|--|
|            |                                                                                                                                                                                                                                                                                                                 | ArchiSafe.                                                       |  |
| 3.         | Store an XAIP_OK_SIG<br>(transformed in the respective<br>XML format) using the "ArchiveSubmissionRequest"<br>function<br>or "PreservePO"-Request<br>pursuant to S.4 or<br>S.512.                                                                                                                               | The function call is possible.                                   |  |
| 4.         | Check the output of the "ArchiveSubmissionResponse"<br>or "PreservePO"-Response.function.                                                                                                                                                                                                                       | The XAIP object is assigned an AOID and stored successfully.     |  |
| 5.         | Use<br>the "ArchiveUpdateRequest" or<br>"UpdatePOC"<br>function with the AOID from step 3 to change the data<br>contained within the XAIP<br>pursuant to S.4 or S.512.                                                                                                                                          | The function call is possible.                                   |  |
| 6.         | Check the output of the "ArchiveUpdateResponse" or<br>"UpdatePOC" Response.function.                                                                                                                                                                                                                            | A new version ID is received. The AOID kept identical.           |  |
| 7.         | Use the "ArchiveRetrievalRequest" or "RetrievePO<br>with SubjectOfRetrieval<br>"PO""<br>Request<br>function with the AOID from step 3 to retrieve the XAIP<br>from the storage<br>pursuant to S.4 or S.512.                                                                                                     | The function call is possible.                                   |  |
| 8.         | Check the output of the "ArchiveRetrievalResponse" or<br>"RetrievePO" Response.function.                                                                                                                                                                                                                        | The archive data object is received in the specified XML format. |  |
| 9.         | Use the "ArchiveEvidenceRequest" or the<br>"RetrievePO<br>with SubjectOfRetrieval<br>"Evidence" "<br>function with the AOID from step 3 to<br>check the XAIPs authenticity and integrity<br>pursuant to<br>S.4 or S.512.                                                                                        | The function call is possible.                                   |  |
| 10.        | Check the output of the "ArchiveEvidenceResponse" or<br>the "RetrievePOResponse"<br>function.                                                                                                                                                                                                                   | An Evidence Record is received.                                  |  |
| 11.        | If the "ArchiveDataRequest" or the "Search"<br>Request<br>function is impelmented, use the "ArchiveDataRequest"<br>or the "Search"<br>Request<br>function with the AOID from<br>step 3 and the dataLocation parameter to identify an<br>individual data element within the XAIP<br>pursuant to S.4<br>or S.512. | The function call is possible.                                   |  |

|     | Identifier                                                                                                                              |                                                                                                                                                 | S.4.1-01                                                                      |  |
|-----|-----------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|--|
| 12. | If the "ArchiveDataRequest" or the "Search"<br>function is impelmented, check the output of the<br>"ArchiveDataResponse" function.      | Response                                                                                                                                        | The requested data value and the corresponding locationValue are<br>received. |  |
| 13. | XAIP<br>pursuant to S.4 or S.512.                                                                                                       | Use the "ArchiveDeletionRequest" or "DeletePO"<br>Request function with the AOID from step 3 to delete the                                      | The function call is possible.                                                |  |
| 14. | "DeletePO"<br>Response<br>retrieve the deleted XAIP calling the<br>SubjectOfRetrieval "PO"" Request<br>corresponding AOID as parameter. | Check the result of the "ArchiveDeletionResponse" or<br>function by attempting to<br>"ArchiveRetrievalRequest" or "RetrievePO" with<br>with the | The XAIP has been deleted from the storage.                                   |  |
| 15. | Conditional: If<br>from No. 1 to No. 14 are to be repeated for LXAIP.                                                                   | LXAIP is implemented, the test steps                                                                                                            | See expected results of the test cases from No. 1 to No. 14 for<br>LXAIP.     |  |
|     | Verdict                                                                                                                                 |                                                                                                                                                 |                                                                               |  |

| Identifier          |                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | S.4.1-02                                                                                                          |              |  |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|--------------|--|
|                     | Requirement                                                                                                                                                                                                                        | MD:A5.1-3<br>M1:A4.1-7<br>M1:A4.1-8<br>M3:A4.2-2<br>PRP-8.1-05                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                   |              |  |
| Test Purpose        |                                                                                                                                                                                                                                    | The test shall<br>verify that a unique, unchangeable AOID is assigned to each archive data object that is stored in the ECM.<br>The test shall<br>verify that an already archived object will not be overwritten or changed by an "ArchiveSubmissionRequest"<br>or "PreservePO" Request.                                                                                                                                                                                                                                                                                                    |                                                                                                                   |              |  |
|                     | Configuration                                                                                                                                                                                                                      | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                   |              |  |
| Pre-test conditions |                                                                                                                                                                                                                                    | •<br>Tester has write permissions on the system<br>•<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F]<br>V1.2.2,<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F]<br>V1.2.2.<br>•<br>XAIP shall<br>be<br>supported,<br>"LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |                                                                                                                   |              |  |
| Step                | Test sequence                                                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Expected Results                                                                                                  | Observations |  |
| 1.                  | Transfer an XAIP_OK<br>or BIN<br>to the TOT using the<br>interface function "ArchiveSubmissionRequest"<br>or<br>"RetrievePO" with SubjectOfRetrieval<br>"PO"" Request<br>pursuant to S.4 or S.512.                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | The call of the function with this XAIP / BIN as a parameter is<br>possible.                                      |              |  |
| 2.                  | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "RetrievePO"<br>Response.                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned to the XAIP / BIN. |              |  |
| 3.                  | Transfer the archival information package XAIP_OK<br>/<br>BIN<br>to the TOT using the interface function<br>"ArchiveSubmissionRequest"<br>or "RetrievePO" with<br>SubjectOfRetrieval "PO"" Request<br>pursuant to<br>S.4 or S.512. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | The call of the function with this XAIP / BIN as a parameter is<br>possible.                                      |              |  |
| 4.                  | Observe the output of the interface function                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | A positive feedback is received. No error message or error code                                                   |              |  |

## *4.5.4.1.2 S.4.1-02 – Archive Submission or PreservePO yields unique AOID*

| Identifier |                                                                                                                                                                                                                                                                                                              | S.4.1-02                                                                                                                                    |  |
|------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|--|
|            | "ArchiveSubmissionResponse"<br>or "RetrievePO"<br>Response.                                                                                                                                                                                                                                                  | occurs. An AOID is assigned to the XAIP.                                                                                                    |  |
| 5.         | Compare the AOIDs.                                                                                                                                                                                                                                                                                           | The AOIDs are not equal.                                                                                                                    |  |
| 6.         | Transfer the very same XAIP_OK<br>or BIN from step 1 to<br>the TOT using the interface function<br>"ArchiveSubmissionRequest"<br>or "RetrievePO" with<br>SubjectOfRetrieval "PO"" Request<br>pursuant to<br>S.4 or S.512.                                                                                    | The call of the function with this XAIP as a parameter is possible.                                                                         |  |
| 7.         | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "RetrievePO"<br>Response.                                                                                                                                                                                                  | A positive feedback is received. No error message or error code<br>occurs. Another AOID is assigned to the XAIP / BIN than in step<br>2.    |  |
| 8.         | Retrieve the XAIP_OK's with the AOID's from step 2<br>and 4<br>pursuant to S.4 or S.512.                                                                                                                                                                                                                     | Both XAIP's could be retrieved. They are identical except the<br>AOID (and maybe some other metadata like date and time of<br>archival).    |  |
| 9.         | Update one XAIP_OK<br>or XAIP(BIN)<br>by using the<br>"ArchiveUpdateRequest" "<br>or "UpdatePOC" Request<br>and the AOID from step 2<br>pursuant to S.4 or S.512.                                                                                                                                            | The update is successful.                                                                                                                   |  |
| 10.        | Retrieve the XAIP_OK's with the AOID's from step 2<br>and 7<br>pursuant to S.4 or S.512.                                                                                                                                                                                                                     | Both XAIPs could be retrieved. They are not identical. The second<br>XAIP includes the update whereas the first XAIP is still<br>unchanged. |  |
| 11.        | Transfer an XAIP_OK<br>or BIN to the TOT using the<br>interface function "ArchiveSubmissionRequest" or<br>"RetrievePO" with SubjectOfRetrieval<br>"PO"" Request<br>pursuant to S.4 or S.512<br>together with<br>another collision free AOID, created by the client<br>application, which was not used before | The call of the function with this XAIP / BIN as a parameter is<br>possible.                                                                |  |
| 12.        | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "RetrievePO"<br>Response.                                                                                                                                                                                                  | A positive feedback is received. No error message or error code<br>occurs. The AOID from step 11 is assigned to the XAIP / BIN.             |  |
| 13.        | Use the "ArchiveRetrievalRequest" or "RetrievePO"<br>with SubjectOfRetrieval<br>"PO"" Request<br>function with the AOID from step 11 to retrieve the<br>XAIP_OK<br>or XAIP(BIN) from the storage<br>pursuant to                                                                                              | The function call is possible without an error message. The stored<br>XAIP_OK<br>or XAIP(BIN)<br>will be returned in a XAIP format.         |  |

|         | Identifier                                                            |                                      | S.4.1-02                                                                  |
|---------|-----------------------------------------------------------------------|--------------------------------------|---------------------------------------------------------------------------|
|         | S.4 or S.512.                                                         |                                      |                                                                           |
| 14.     | Conditional: If<br>from No. 1 to No. 13 are to be repeated for LXAIP. | LXAIP is implemented, the test steps | See expected results of the test cases from No. 1 to No. 13 for<br>LXAIP. |
| Verdict |                                                                       |                                      |                                                                           |

|                     | Identifier<br>S.4.1-03 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |              |  |  |
|---------------------|------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|--|
|                     | Requirement            | MD:A5.1-4<br>M1:A4.1-2<br>M1:A4.1-8<br>M3:A4.2-2<br>PRP-8.1-05                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |              |  |  |
|                     | Test Purpose           | The test shall<br>verify that a binary document, restricted<br>to the preservation object formats<br>described in clause 2, Notice 4,<br>can be stored in the ECM/long-term storage<br>and the call returns a unique AOID.<br>Note: If the interface S.4 supports "ArchiveSubmissionRequests" or "PreservePO"<br>Request for (L)XAIPs only, the test will be considered as successfully passed.                                                                                                                                                             |              |  |  |
| Configuration       |                        | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |              |  |  |
| Pre-test conditions |                        | •<br>If required, establish a session with the TOT in order to perform the following tests<br>•<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F]<br>V1.2.2,<br>•<br>XAIP shall<br>be<br>supported,<br>"LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>shall<br>be configured.<br>[TR-ESOR-TRANS]<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |              |  |  |
| Step                | Test sequence          | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Observations |  |  |

*4.5.4.1.3 S.4.1-03 – Archive Submission or PreservePO with valid binary object is possible*

| Identifier |                                                                                                                                                                         |                                                                                                                                                              | S.4.1-03                                                                                                                        |
|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
| 1.         | Transfer several documents BIN<br>to the TOT using the<br>interface function "ArchiveSubmissionRequest"<br>" or<br>"PreservePO"<br>Request<br>pursuant to S.4 or S.512. |                                                                                                                                                              | The call of the function with this document as a parameter is<br>possible.                                                      |
| 2.         | Observe<br>the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                          |                                                                                                                                                              | A positive feedback is received. No error message or error code<br>occurs. An unique AOID is assigned to each and every object. |
| 3.         | Check the log files of the TOT for a<br>XML schema check.                                                                                                               | record about an                                                                                                                                              | There is no record about an XML schema validation of this<br>document.                                                          |
| 4.         | with SubjectOfRetrieval<br>object from the storage                                                                                                                      | Use the "ArchiveRetrievalRequest" or "RetrievePO"<br>"PO"" Request<br>function with the AOID from step 2 to retrieve the binary<br>pursuant to S.4 or S.512. | The function call is possible without an error message. The stored<br>binary object will be returned as an XAIP(BIN).           |
| 5.         | Conditional: If<br>from No. 1 to No. 4 are to be repeated for LXAIP.                                                                                                    | LXAIP is implemented, the test steps                                                                                                                         | See expected results of the test cases from No. 1 to No. 4 for<br>LXAIP.                                                        |
| Verdict    |                                                                                                                                                                         |                                                                                                                                                              |                                                                                                                                 |

|                     | Identifier    | S.4.1-04                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |              |  |  |
|---------------------|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|--|
|                     | Requirement   | MD:A5.1-2<br>PRP-8.1-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |              |  |  |
| Test Purpose        |               | The test shall<br>verify whether the storage of electronic documents and data from external IT applications is always possible via a secure communication channel.                                                                                                                                                                                                                                                                                                                                                                                                       |              |  |  |
|                     | Configuration | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |              |  |  |
| Pre-test conditions |               | •<br>The IT system documentation is available<br>•<br>If required, perform identification and authentication<br>•<br>Administration access to the IT systems is needed<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F]<br>V1.2.2,<br>•<br>XAIP shall<br>be<br>supported,<br>"LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |              |  |  |
| Step                | Test sequence | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Observations |  |  |

#### *4.5.4.1.4 S.4.1-04 – Archive Submission or PreservePO is always possible via a secure communication channel*

| Identifier |                                                                                                                                                                 |                                                                                          | S.4.1-04                                                                                                       |  |
|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--|
| 1.         | Check whether a secure communication channel between<br>upstream application and TOT is configured and<br>activated<br>by using the S.4 or S.512 interface only |                                                                                          | A secure communication channel is set up and active.<br>Only S.4 or<br>S. 512 is used.                         |  |
| 2.         | Start logging the data traffic between the external IT<br>application and the middleware<br>by using the S.4 or S.512<br>interface only                         |                                                                                          | The data logging process has been started.<br>Only S.4 or S. 512 is<br>used.                                   |  |
| 3.         | Store an XAIP_OK_SIG<br>or BIN<br>from the external IT<br>application via the middleware to the ECM<br>by using the<br>S.4 or S.512 interface only.             |                                                                                          | The function<br>call is possible.<br>Only S.4 or S. 512 is used.                                               |  |
| 4.         | Close the connection of the two components. Stop<br>logging the data traffic.                                                                                   |                                                                                          | The complete data exchange between the components has been<br>intercepted and logged.                          |  |
| 5.         | data.                                                                                                                                                           | Check the data traffic log file for unprotected document                                 | No document data can be accessed.                                                                              |  |
| 6.         | Store an XAIP_OK_SIG<br>S. 4 or S.512.                                                                                                                          | or BIN<br>from the external IT<br>application via the middleware to the ECM by not using | The request will be rejected by ArchiSafe-Module including an<br>error message documenting the failed request. |  |
| 7.         | Conditional: If<br>from No. 1 to No. 5 are to be repeated for LXAIP.                                                                                            | LXAIP is implemented, the test steps                                                     | See expected results of the test cases from No. 1 to No. 5 for<br>LXAIP.                                       |  |
| Verdict    |                                                                                                                                                                 |                                                                                          |                                                                                                                |  |

## *4.5.4.1.5 S.4.1-05 – Archive Submission or PresrevePO includes the validation of supplemental evidence data and evidence records validation and storage of results*

## **Attention:**

For usage of this TR-ESOR-Product by a Preservation Services pursuant to [ETSI TS 119 511] and for substituting equivalent **[ETSI TS 119 511]** - test cases by [TR-ESOR] test cases in an assessment, then this test case is to be replaced by the test case **[TR-ESOR-C.1-APP]** in clause 8, test case S.4.1-05.

| Identifier    | S.4.1-05                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement   | MD:A5.1-5<br>M1:A4.1-3<br>M1:A4.1-4<br>M2:A5.2-1<br>M2:A5.2-2<br>M2:A5.2-3<br>M3:A4.1-1<br>OVR-6.2-06<br>OVR-7.5-03<br>PRP-8.1-05<br>PRP-8.1-08                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               | OVR-9.3-01<br>OVR-9.3-02                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Test Purpose  | The test shall<br>verify that the ArchiSafe module is able to initiate the validation of the supplemental evidence data (e.g. signatures, seals, timestamps, certificates,<br>revocation lists, ocsp responses, etc.) and technical evidence records of the XAIPs or BINs before they are stored and that an error message is received in the case<br>of a failed validation of supplemental evidence data (e.g. signatures, seals, timestamps, certificates, revocation lists, ocsp responses, etc.) and/or technical evidence<br>records.<br>The test shall<br>verify that it is possible for the ArchiSafe module to enter all validation<br>results including the associated certificate information into the archive object.<br>The validation results<br>shall<br>be returned either in the form of a Verification Report pursuant to [TR-ESOR-VR]<br>or as a supplement of the XAIP container handed over<br>pursuant to [TR-ESOR-F]. |
| Configuration | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |

<span id="page-172-0"></span>

| Identifier                                             |                                                                                                                                                                                                                                                                                                       | S.4.1-05                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |              |  |
|--------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| •<br>Pre-test conditions<br>•<br>•<br>•<br>•<br>•<br>• |                                                                                                                                                                                                                                                                                                       | XAIP shall<br>be<br>•<br>BIN is restricted | "Signature Validation Policy" and "Time-Stamp Validation Policy"are present31.<br>Tester has Read/Write permissions on the system<br>Perform authentication if necessary<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>supported, "LXAIP" may be supported, if configured.<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>to the preservation object formats<br>described in clause 2, Notice 4. |              |  |
| Step                                                   | Test sequence                                                                                                                                                                                                                                                                                         |                                            | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Observations |  |
| 1.                                                     | Verify that the configuration of the ArchiSafe module<br>enables the automatic validation of the supplemental<br>evidence data (e.g. signatures, seals, timestamps,<br>certificates, revocation lists, OCSP responses, etc.) and<br>technical evidence records while submitting an archive<br>object. |                                            | The automatic validation of the supplemental evidence data (e.g.<br>signatures, seals, timestamps, certificates, revocation lists, OCSP<br>responses, etc.) and technical evidence records can be enabled and<br>is enabled.<br>The validation results<br>will be returned either in the form of a<br>Verification Report pursuant to [TR-ESOR-VR]<br>or as a<br>supplement<br>of the XAIP container.                                                                                                                                                           |              |  |
| 2.                                                     | Store an XAIP_OK_SIG<br>or BIN<br>to the TOT using the<br>interface function "ArchiveSubmissionRequest"<br>or<br>"PreservePO".                                                                                                                                                                        |                                            | The call of the function is possible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |              |  |
| 3.                                                     | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                                                                                                                                                           |                                            | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned to the stored archive object.                                                                                                                                                                                                                                                                                                                                                                                                                                    |              |  |
| 4.                                                     | Store an XAIP_NOK_SIG<br>or BIN_NOK_SIG<br>to the<br>TOT using the interface function<br>"ArchiveSubmissionRequest"<br>or "PreservePO".                                                                                                                                                               |                                            | The call of the function is possible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |              |  |
| 5.                                                     | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                                                                                                                                                           |                                            | A negative feedback will be received. An error message or error<br>code occurs. The log file contains an error message.<br>The archive object may be stored and an AOID may be returned.                                                                                                                                                                                                                                                                                                                                                                        |              |  |
| 6.                                                     | Retrieve the XAIP_OK_SIG<br>by using the                                                                                                                                                                                                                                                              |                                            | The XAIP_OK_SIG<br>is retrieved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |              |  |

<sup>31</sup> Se[e http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-xaip](http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-xaip) and http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-timestamp.

| Identifier |                                                                                                                                                                                             | S.4.1-05                                                                                                                                                 |                                                                                                                                                                                                                                                                                              |  |
|------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|            | "ArchiveRetrievalRequest" or "RetrievePO"<br>the AOID from step 3.                                                                                                                          | with<br>SubjectOfRetrieval "PO"" Request function and                                                                                                    |                                                                                                                                                                                                                                                                                              |  |
| 7.         | Check the XAIP_OK_SIG, especially the credential<br>signatures, seals, timestamps, certificates, revocation<br>lists, OCSP responses, etc.) and technical evidence<br>records are included. | section, whether the supplemental evidence data (e.g.                                                                                                    | The certificates, certification validation information and if existent,<br>further supplemental evidence data (e.g. signatures, seals,<br>timestamps, certificates, revocation lists, OCSP responses, etc.) and<br>technical evidence records are included in the retrieved<br>XAIP_OK_SIG.  |  |
| 8.         | If archived/stored, retrieve the XAIP_NOK_SIG<br>using the "ArchiveRetrievalRequest" or<br>"RetrievePO"<br>"PO"" Request function and the AOID from step 5.                                 | by<br>with SubjectOfRetrieval                                                                                                                            | The XAIP_NOK_SIG<br>is retrieved.                                                                                                                                                                                                                                                            |  |
| 9.         | signatures, seals, timestamps, certificates, revocation<br>lists, OCSP responses, etc.) and technical evidence<br>records are included.                                                     | Check the XAIP_NOK_SIG, especially the credential<br>section, whether the supplemental evidence data (e.g.                                               | The certificates, certification validation information and if existent,<br>further supplemental evidence data (e.g. signatures, seals,<br>timestamps, certificates, revocation lists, OCSP responses, etc.) and<br>technical evidence records are included in the retrieved<br>XAIP_NOK_SIG. |  |
| 10.        | Retrieve the XAIP(BIN)<br>"ArchiveRetrievalRequest" or "RetrievePO"<br>the AOID from step 7.                                                                                                | by using the<br>with<br>SubjectOfRetrieval "PO"" Request function and                                                                                    | The XAIP(BIN)<br>is retrieved in the XAIP format including all<br>assigned metadata and the BIN data as content.                                                                                                                                                                             |  |
| 11.        | timestamps, certificates, revocation lists, OCSP<br>responses, etc.) and technical evidence<br>included.                                                                                    | Check the retrieved XAIP and all the metadata whether<br>the supplemental evidence data (e.g. signatures, seals,<br>records are                          | The certificates, certification validation information and the<br>supplemental evidence data (e.g. signatures, seals, timestamps,<br>certificates, revocation lists, OCSP responses, etc.) and technical<br>evidence records<br>are included in the retrieved XAIP                           |  |
| 12.        | the "ArchiveRetrievalRequest" or "RetrievePO"<br>the AOID from step 9.                                                                                                                      | If archived/stored, retrieve the BIN_NOK_SIG by using<br>with<br>SubjectOfRetrieval "PO"" Request function and                                           | The BIN_NOK_SIG is retrieved in the XAIP format including all<br>assigned metadata and the BIN data as content.                                                                                                                                                                              |  |
| 13.        | timestamps,<br>responses, etc.) and technical evidence records are<br>included.                                                                                                             | Check the retrieved XAIP and all the metadata whether<br>the supplemental evidence data (e.g. signatures, seals,<br>certificates, revocation lists, OCSP | The certificates, certification validation information and the<br>supplemental evidence data (e.g. signatures, seals, timestamps,<br>certificates, revocation lists, OCSP responses, etc.) and technical<br>evidence records<br>are included in the retrieved XAIP                           |  |

|     | Identifier                                                                                                                                                                                       |                                                                                                                  | S.4.1-05                                                                                                                                                                                                                                                                                        |
|-----|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 14. | Store an XAIP_OK_SIG_OK_ER<br>interface function "ArchiveSubmissionRequest"<br>"PreservePO".                                                                                                     | to the TOT using the<br>or                                                                                       | The call of the function is possible.                                                                                                                                                                                                                                                           |
| 15. | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>Response.                                                                                                         | or "PreservePO"                                                                                                  | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned to the stored archive object.                                                                                                                                                                    |
| 16. | Retrieve the XAIP_OK_SIG_OK_ER<br>by using the<br>"ArchiveRetrievalRequest" or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" Request function and<br>the AOID from step 15.                   |                                                                                                                  | The XAIP_OK_SIG_OK_ER<br>is retrieved.                                                                                                                                                                                                                                                          |
| 17. | Check the XAIP_OK_SIG_OK_ER, especially the<br>data (e.g. signatures, seals, timestamps, certificates,<br>revocation lists, OCSP responses, etc.)<br>record validation information are included. | credential section, whether the supplemental evidence<br>and evidence                                            | The certificates, certification validation information and the<br>supplemental evidence data (e.g. signatures, seals, timestamps,<br>certificates, revocation lists, OCSP responses, etc.)<br>and evidence<br>record validation information are included in the retrieved<br>XAIP_OK_SIG_OK_ER. |
| 18. | the interface function "ArchiveSubmissionRequest"<br>"PreservePO".                                                                                                                               | Store an XAIP_NOK_SIG_OK_ER to the TOT using<br>or                                                               | The call of the function is possible.                                                                                                                                                                                                                                                           |
| 19. | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                                                      |                                                                                                                  | A negative feedback will be received. An error message or error<br>code occurs. The log file contains an error message with a digital<br>signature and an evidence record.<br>The archive object may be stored and an AOID may be returned.                                                     |
| 20. | If archived/stored, retrieve the<br>XAIP_NOK_SIG_OK_ER<br>"ArchiveRetrievalRequest" or "RetrievePO"<br>the AOID from step 19.                                                                    | by using the<br>with<br>SubjectOfRetrieval "PO"" Request function and                                            | The XAIP_NOK_SIG_OK_ER<br>is retrieved in the XAIP format.                                                                                                                                                                                                                                      |
| 21. | timestamps, certificates, revocation lists, OCSP<br>responses, etc.) and the evidence record validation<br>information are included.                                                             | Check the retrieved XAIP and all the metadata whether<br>the supplemental evidence data (e.g. signatures, seals, | The certificates, certification validation information and the<br>supplemental evidence data (e.g. signatures, seals, timestamps,<br>certificates, revocation lists, OCSP responses, etc.)<br>and the<br>evidence record validation information are included in the retrieved<br>XAIP           |
| 22. | function "ArchiveSubmissionRequest"                                                                                                                                                              | Store an XAIP_NOK_ER to the TOT using the interface<br>or                                                        | The call of the function is possible.                                                                                                                                                                                                                                                           |

| Identifier |                                                                                                                                                                                                                                                                                 | S.4.1-05                                                                                                                                                                                                                                                                                                     |  |
|------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|            | "PreservePO".                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                              |  |
| 23.        | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                                                                                                                                     | A negative feedback will be received. An error message or error<br>code occurs. The log file contains an error message with an<br>evidence record.<br>The archive object may be stored and an AOID may be returned.                                                                                          |  |
| 24.        | If archived/stored, retrieve the XAIP_NOK_ER<br>by using<br>the "ArchiveRetrievalRequest" or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" Request function and<br>the AOID from step 23.                                                                                    | The XAIP_NOK_ER<br>is retrieved in the XAIP format.                                                                                                                                                                                                                                                          |  |
| 25.        | Check the retrieved XAIP and all the metadata whether<br>the supplemental evidence data (e.g. signatures, seals,<br>timestamps, certificates, revocation lists, OCSP<br>responses, etc.) and technical evidence and the evidence<br>record validation information are included. | The certificates, certification validation information and the<br>supplemental evidence data (e.g. signatures, seals, timestamps,<br>certificates, revocation lists, OCSP responses, etc.) and technical<br>evidence<br>and the evidence record validation information are<br>included in the retrieved XAIP |  |
| 26.        | Repeat 2, 4, 6, 8, 10 12, 14, 16, 18, 20, 24 without using<br>S. 4 or S. 512.                                                                                                                                                                                                   | The request will be rejected by ArchiSafe-Module including an<br>error message documenting the failed request.                                                                                                                                                                                               |  |
| 27.        | Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No. 26 are to be repeated for LXAIP.                                                                                                                                                                       | See expected results of the test cases from No. 1 to No. 25 for<br>LXAIP.                                                                                                                                                                                                                                    |  |
| Verdict    |                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                              |  |

|      | Identifier          |                                                                     | S.4.1-06                                                                                                                                                                                                                                                                                                                                                                                                           |                         |
|------|---------------------|---------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|
|      | Requirement         | M1:A4.1-6<br>PRP-8.1-05                                             |                                                                                                                                                                                                                                                                                                                                                                                                                    |                         |
|      | Test Purpose        | The test shall                                                      | verify that the ArchiSafe module does not change the primary data objects within the XAIPs or BINs.                                                                                                                                                                                                                                                                                                                |                         |
|      | Configuration       | CONFIG_ArchiSafe                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                    |                         |
|      | Pre-test conditions | •<br>•<br>•<br>•<br>XAIP shall<br>be<br>•<br>•<br>BIN is restricted | If required, perform identification and authentication<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>supported, "LXAIP" may be supported, if configured.<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>to the preservation object formats<br>described in clause 2, Notice 4. | shall<br>be configured. |
| Step | Test sequence       |                                                                     | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                   | Observations            |

*4.5.4.1.6 S.4.1-06 – Archive Submission or PreservePO Request does not change the data objects within the XAIP or BIN*

| Identifier |                                                                                                                                                                                                      | S.4.1-06                                                                                                          |  |
|------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|--|
| 1.         | Store an XAIP_OK_SIG<br>or BIN<br>using the interface<br>function "ArchiveSubmissionRequest"<br>or<br>"PreservePO".                                                                                  | The call of the function is possible.                                                                             |  |
| 2.         | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                                                          | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned to the XAIP / BIN. |  |
| 3.         | Request the XAIP with the "ArchiveRetrievalRequest"<br>or "RetrievePO"<br>with SubjectOfRetrieval<br>"PO"" Request<br>function and the AOID from step 2.                                             | The call of the function is possible.                                                                             |  |
| 4.         | Compare the data objects of the retrieved XAIP with the<br>data objects of the XAIP / BIN that has originally been<br>stored in step 1.                                                              | The data objects are identical.                                                                                   |  |
| 5.         | Check vendor documentation whether ArchiSafe resp.<br>the TOT provides any function to modify the actual<br>primary data content or whether a conversion of the<br>primary data content is required. | No such function or requirement exists.                                                                           |  |
| 6.         | Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No. 5 are to be repeated for LXAIP.                                                                                             | See expected results of the test cases from No. 1 to No. 5 for<br>LXAIP.                                          |  |
| Verdict    |                                                                                                                                                                                                      |                                                                                                                   |  |

|      | Identifier          | S.4.1-07                                                                                                                                                                                                                                           |                         |
|------|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|
|      | Requirement         | MD:A5.1-4<br>M1:A4.1-2<br>PRP-8.1-05                                                                                                                                                                                                               |                         |
|      | Test Purpose        | The test shall<br>verify that it is not possible to store an archival information package with a wrong XML syntax.                                                                                                                                 |                         |
|      | Configuration       | CONFIG_ArchiSafe (includes XSD schema validation enabled).                                                                                                                                                                                         |                         |
|      | Pre-test conditions | •<br>If required, establish a session with the TOT in order to perform the following tests<br>•<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].                            |                         |
|      |                     | •<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS] | shall<br>be configured. |
| Step | Test sequence       | Expected Results                                                                                                                                                                                                                                   | Observations            |

## *4.5.4.1.7 S.4.1-07 – Archive Submission or PreservePO of invalid XML data is not possible*

|         | Identifier                                                                                               |                                                                        | S.4.1-07                                                                                |
|---------|----------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| 1.      | to the TOT using the interface function<br>"ArchiveSubmissionRequest"                                    | Transfer the archival information package XAIP_NOK<br>or "PreservePO". | The call of the function with this XAIP as a parameter is possible.                     |
| 2.      | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>Response.                 | or "PreservePO"                                                        | A clear and understandable error message or error code will be<br>received.             |
| 3.      | Check the log files of the TOT for an error record about<br>the XML schema check.                        |                                                                        | There is an error record showing that the XML schema validation<br>of this XAIP failed. |
| 4.      | Check whether the XAIP is stored.                                                                        |                                                                        | The XAIP is not stored.                                                                 |
| 5.      | Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No. 4 are to be repeated for LXAIP. |                                                                        | See expected results of the test cases from No. 1 to No. 4 for<br>LXAIP.                |
| Verdict |                                                                                                          |                                                                        |                                                                                         |
|         |                                                                                                          |                                                                        |                                                                                         |
|         |                                                                                                          |                                                                        |                                                                                         |

| Identifier          |                                                                                                              | S.4.1-08                                                                                                                                                                                             |                                                                                   |              |  |  |
|---------------------|--------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|--------------|--|--|
| Requirement         |                                                                                                              | AF:A5.6-7<br>PRP-8.1-05                                                                                                                                                                              |                                                                                   |              |  |  |
| Test Purpose        |                                                                                                              | The test shall<br>verify that a protocol within the secure Communication Channel is used by which, among other things, the technical confirmation of the receipt of a<br>client request is realised. |                                                                                   |              |  |  |
| Configuration       |                                                                                                              | CONFIG_ArchiSafe                                                                                                                                                                                     |                                                                                   |              |  |  |
| Pre-test conditions |                                                                                                              | •<br>The IT system documentation is available<br>•<br>If required, perform identification and authentication<br>•<br>Administration access to the IT systems is needed                               |                                                                                   |              |  |  |
| Step                | Test sequence                                                                                                |                                                                                                                                                                                                      | Expected Results                                                                  | Observations |  |  |
| 1.                  | Check the IT system documentation for the used protocol<br>within the secure communication channel protocol. |                                                                                                                                                                                                      | The documentation states which protocol is used (e.g. HTTP, RPC,<br>RMI,).        |              |  |  |
| 2.                  | Check the documentation for this protocol whether<br>technical confirmations of receipts are implemented.    |                                                                                                                                                                                                      | The protocol implements such confirmations (e.g. TCP ACK,<br>HTTP Return codes,). |              |  |  |
| Verdict             |                                                                                                              |                                                                                                                                                                                                      |                                                                                   |              |  |  |

| Identifier          |                                                                                      | S.4.1-10                                                                                                                                                        |                                                                                      |              |  |  |
|---------------------|--------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------|--------------|--|--|
| Requirement         |                                                                                      | MD:A7.2-8<br>PRP-8.1-05                                                                                                                                         |                                                                                      |              |  |  |
| Test Purpose        |                                                                                      | The test shall<br>verify whether SOAP Document Literal Encoding is used and if the external interfaces of all archive system components are published via WSDL. |                                                                                      |              |  |  |
| Configuration       |                                                                                      | CONFIG_ArchiSafe                                                                                                                                                |                                                                                      |              |  |  |
| Pre-test conditions |                                                                                      | •<br>The middleware documentation is available.<br>•<br>The application documentation is available.                                                             |                                                                                      |              |  |  |
| Step                | Test sequence                                                                        |                                                                                                                                                                 | Expected Results                                                                     | Observations |  |  |
| 1.                  | Check the middleware documentation for the use of<br>WSDL.                           |                                                                                                                                                                 | WSDL is used to publish the external interfaces of all archive<br>system components. |              |  |  |
| 2.                  | Check the middleware documentation for the use of<br>SOAP Document Literal Encoding. |                                                                                                                                                                 | SOAP Document Literal Encoding is used.                                              |              |  |  |
| Verdict             |                                                                                      |                                                                                                                                                                 |                                                                                      |              |  |  |

*4.5.4.1.9 S.4.1-09 – WSDL and Document literal encoding for SOAP should be used*

## **4.5.4.2 ArchiveUpdate or UpdatePOC Request**

<span id="page-182-0"></span>

| Identifier          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | S.4.2-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |              |  |  |
|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|--|
|                     | Requirement                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | MD:A5.1-4<br>MD:A5.1-11<br>MD:A4.3-1<br>MD:A6.1-1<br>MD:A6.1-2<br>MD:A6.2-1<br>MD:A6.3-3<br>M1:A3.2-1<br>M1:A3.2-2<br>M1:A4.0-1<br>M1:A4.1-8<br>M1:A4.2-1<br>M1:A4.2-8<br>PRP-8.1-14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |              |  |  |
|                     | The test shall<br>verify that an XAIP with a correct XML structure or a BIN archive object are correctly stored in the ECM/long-term storage.<br>Test Purpose<br>The test shall<br>check that an XAIP / BIN will be send to the ArchiSig module before it will be stored in the ECM/long-term storage. (Archive Submission & Archive<br>Update).<br>The test shall<br>check, if for each XAIP / BIN stored in the ECM/long-term storage a unique AOID will be generated and returned. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |              |  |  |
| Configuration       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |              |  |  |
| Pre-test conditions |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | •<br>If required, establish a session with<br>the TOT in order to perform the following tests<br>•<br>If required, perform identification and authentication<br>•<br>The test dispenses if the pre-supposition is not valid.<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP"" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |              |  |  |
| Step                | Test sequence                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Observations |  |  |

| Identifier |                                                                                                                                                                                                                                                                                                                                                                                                                                                               | S.4.2-01                                                                                                                                                                              |  |
|------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 1.         | Transfer several XAIP_OK / BIN<br>to the TOT using the<br>interface function "ArchiveSubmissionRequest"<br>or<br>"PreservePO".                                                                                                                                                                                                                                                                                                                                | The call of<br>the function with this XAIP / BIN as a parameter is<br>possible.                                                                                                       |  |
| 2.         | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                                                                                                                                                                                                                                                                                                                   | A positive feedback is received. No error message or error code<br>occurs. A unique AOID is assigned to each and every XAIP / BIN.                                                    |  |
| 3.         | Check the log files of the TOT for a record about the<br>XML schema check.<br>In the case of storing BINs skip this step.                                                                                                                                                                                                                                                                                                                                     | There is a record showing the positive XML schema validation of<br>the XAIP.                                                                                                          |  |
| 4.         | Use a number of "ArchiveRetrievalRequest" or<br>"RetrievePO"<br>with SubjectOfRetrieval<br>"PO"" Request functions with the AOIDs from step 2 as<br>parameters.                                                                                                                                                                                                                                                                                               | The call of the functions with this AOIDs as parameters is possible.                                                                                                                  |  |
| 5.         | Observe the output of the interface functions<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                                                                                                                                                                                                                                                                                                   | A positive feedback is received. No error message or error code<br>occurs. The originally stored XAIPs or XAIPs which embody the<br>BINs were retrieved XAIP(BIN)s).                  |  |
| 6.         | Compare the retrieved XAIPs and the XAIPs, resp. the<br>embodied BINs and the BINs stored in step 1.                                                                                                                                                                                                                                                                                                                                                          | The contents are identical. The retrieved XAIPs contain<br>additionally the respective AOID.<br>The original XAIPs do not contain this AOID.                                          |  |
| 7.         | Between execution of step 1 and step 7 must be less time<br>as ArchiSig is configured to perform automated<br>Timestamp Renewalrenewal because it should<br>be<br>checked whether newly submitted archive objects run<br>through the ArchiSig module and initial Archive<br>Timestamps will be generated immediately.<br>Using several calls, request the ERS records for the<br>XAIPs / BINs stored in step 1 using the AOIDs from<br>step 2 as a parameter. | The ERS records can be received, even if the archive object was<br>submitted just very shortly before this test step.                                                                 |  |
| 8.         | Check whether the hash values in the ERs for the XAIPs<br>/ BINs refer to the XAIPs/BINs with the AOID included.<br>In case of doubt, recalculate the hash values for the<br>XAIPs / BINs with the AOID (see M.3 sec. 2.4.1 for<br>details) and compare that with the<br>hash values listed in<br>the ERS records.                                                                                                                                            | The hash values listed in the ERS records refer to the XAIPs / BINs<br>with the AOIDs included.<br>The hash values for this XAIPs/BINs are correctly mentioned in<br>the ERS records. |  |

|         | Identifier                                                                                                                                  |                                                 | S.4.2-01                                                                                                                                                                                                                                                                                                                                                                            |
|---------|---------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 9.      | Repeat the steps 1-8 immediately in order to be sure that<br>ArchiSig did not perform an Archive Timestamp<br>Renewal between step 1 and 7. |                                                 | Same results as expected above.                                                                                                                                                                                                                                                                                                                                                     |
| 10.     | Repeat the steps 1-9 but instead of submit use the                                                                                          | "ArchiveUpdateRequest" or "UpdatePOC" function. | Update is successful, a version ID will be issued and returned.<br>The log records show the XML schema check for storing each<br>XAIP/XAIP(BIN)<br>The updated XAIPs will be retrieved.<br>The retrieved XAIPs contain the requested changes/updates.<br>The ERSs can be retrieved. The hash values identifie the updated<br>XAIPs / XAIP(BIN)s.<br>Same results in the repetition. |
| 11.     | Repeat 1 and 4 without using S. 4 or S. 512.                                                                                                |                                                 | The request will be rejected by ArchiSafe-Module including an<br>error message documenting the failed request.                                                                                                                                                                                                                                                                      |
| 12.     | Conditional: If<br>No. 1 to No. 10 are to be repeated for LXAIP.                                                                            | LXAIP is implemented, test steps from           | See expected results of the test cases from No. 1 to No. 10 for<br>LXAIP.                                                                                                                                                                                                                                                                                                           |
| Verdict |                                                                                                                                             |                                                 |                                                                                                                                                                                                                                                                                                                                                                                     |

## *4.5.4.2.2 S.4.2-02 – Archive Update or UpdatePOC requires existing AOID*

| Identifier          |                                                                                                     | S.4.2-02                                                                                                                                                                                       |                                             |              |  |
|---------------------|-----------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|--------------|--|
| Requirement         |                                                                                                     | M1:A4.2-1<br>PRP-8.1-14                                                                                                                                                                        |                                             |              |  |
| Test Purpose        |                                                                                                     | The test shall<br>verify that the ArchiSafe module can only update an archive data object when a valid and existing AOID is part of the update request.                                        |                                             |              |  |
| Configuration       |                                                                                                     | CONFIG_ArchiSafe                                                                                                                                                                               |                                             |              |  |
| Pre-test conditions |                                                                                                     | •<br>If required, perform identification and authentication<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>shall<br>be configured.<br>[TR-ESOR-TRANS] |                                             |              |  |
| Step                | Test sequence                                                                                       |                                                                                                                                                                                                | Expected Results                            | Observations |  |
| 1.                  | Try to issue an "ArchiveUpdateRequest" or<br>"UpdatePOC" with an AOID that does not exist.          |                                                                                                                                                                                                | The function call is possible.              |              |  |
| 2.                  | Observe the output of the interface function<br>"ArchiveUpdateResponse"<br>or "UpdatePOC" Response. |                                                                                                                                                                                                | An error message or error code is received. |              |  |
|                     | Verdict                                                                                             |                                                                                                                                                                                                |                                             |              |  |

| Identifier          |                                                                                                                                                            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | S.4.2-03                                                                                        |              |  |  |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|--------------|--|--|
|                     | Requirement                                                                                                                                                | MD:A5.1-11<br>MD:A5.1-14<br>M1:A4.2-5<br>M1:A4.2-9<br>PRP-8.1-14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                 |              |  |  |
| Test Purpose        |                                                                                                                                                            | The test shall<br>verify whether it is possible to change documents and data including the associated meta data.<br>If archive objects are updated, a new version ID is to be issued.                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                 |              |  |  |
|                     | Configuration                                                                                                                                              | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                 |              |  |  |
| Pre-test conditions |                                                                                                                                                            | •<br>Tester has read / write permissions on the Middleware<br>•<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP"" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |                                                                                                 |              |  |  |
| Step                | Test sequence                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Expected Results                                                                                | Observations |  |  |
| 1.                  | Check if the interface function "ArchiveUpdateRequest"<br>or "UpdatePOC" exists.                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | The function exists.                                                                            |              |  |  |
| 2.                  | Submit an XAIP_OK<br>or BIN<br>with data to the TOT<br>using<br>the interface function "ArchiveSubmissionRequest"<br>or<br>"PreservePO".                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | The call of the function with this XAIP / BIN as a parameter is<br>possible.                    |              |  |  |
| 3.                  | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned. |              |  |  |
| 4.                  | Using the interface function "ArchiveUpdateRequest"<br>or<br>"UpdatePOC"<br>and the AOID from step 3 to add<br>additional content to the XAIP / XAIP(BIN). |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | The call of the function with this binary data and the AOID as<br>parameters is possible.       |              |  |  |
| 5.                  | Observe the output of the interface function                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | A positive feedback is received. No error message or error code                                 |              |  |  |

## *4.5.4.2.3 S.4.2-03 – Archive Update or UpdatePOC results in a new version ID*

<span id="page-187-0"></span>

|     | Identifier                                                                                                                                                                                       |                                                                                                                                                                                                                          | S.4.2-03                                                                                                                                                   |  |
|-----|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|     | "ArchiveUpdateResponse"                                                                                                                                                                          | or "UpdatePOC" Response.                                                                                                                                                                                                 | occurs. A new Version ID is received.                                                                                                                      |  |
| 6.  | Using the interface function "ArchiveUpdateRequest"<br>or<br>"UpdatePOC"<br>and the AOID from step 3 and the<br>Version ID from step 5 to add<br>additional metadata to the<br>XAIP / XAIP(BIN). |                                                                                                                                                                                                                          | The call of the function with this data and the AOID as parameters<br>is possible.                                                                         |  |
| 7.  | Observe the output of the interface function<br>"ArchiveUpdateResponse"                                                                                                                          | or "UpdatePOC" Response.                                                                                                                                                                                                 | A positive feedback is received. No error message or error code<br>occurs. A new Version ID is received.                                                   |  |
| 8.  | "UpdatePOC"<br>Version ID from step 7 to update<br>XAIP(BIN).                                                                                                                                    | Using the interface function "ArchiveUpdateRequest"<br>or<br>and the AOID from step 3 and the<br>content of the XAIP /                                                                                                   | The call of the function with this data and the AOID as parameters<br>is possible.                                                                         |  |
| 9.  | Observe the output of the interface function<br>"ArchiveUpdateResponse"                                                                                                                          | or "UpdatePOC" Response.                                                                                                                                                                                                 | A positive feedback is received. No error message or error code<br>occurs. A new Version ID is received.                                                   |  |
| 10. | Version ID from step 9 to update<br>XAIP(BIN).                                                                                                                                                   | Using the interface function "ArchiveUpdateRequest" or<br>"UpdatePOC" and the AOID from step 3 and the new<br>metadata of the XAIP /                                                                                     | The call of the function with this data and the AOID as parameters<br>is possible.                                                                         |  |
| 11. | Observe the output of the interface function<br>"ArchiveUpdateResponse"                                                                                                                          | or "UpdatePOC" Response.                                                                                                                                                                                                 | A positive feedback is received. No error message or error code<br>occurs. A new Version ID is received.                                                   |  |
| 12. |                                                                                                                                                                                                  | Using the interface function "ArchiveUpdateRequest" or<br>"UpdatePOC" and the AOID from step 3 and the new<br>Version ID from step 11 to remove32 one piece of data<br>from the XAIP / XAIP(BIN), not the complete XAIP. | The call of the function with this data and the AOID as parameters<br>is possible.                                                                         |  |
| 13. | Version ID from step 7 to update<br>XAIP(BIN).                                                                                                                                                   | Using the interface function "ArchiveUpdateRequest" or<br>"UpdatePOC" and the AOID from step 3 and the new<br>metadata of the XAIP /                                                                                     | The call of the function with this data and the AOID as parameters<br>is possible.                                                                         |  |
| 14. | Observe the output of the interface function<br>"ArchiveUpdateResponse"                                                                                                                          | or "UpdatePOC" Response.                                                                                                                                                                                                 | A negative feedback will be received. An error message or error<br>code occurs. The log file contains an error message indicating the<br>wrong Version ID. |  |

<sup>32</sup> This "remove" means that the element is not longer part of the most current version of the XAIP. Nevertheless, the element is still stored in the XAIP for evidence purposes. If an older version of the XAIP would be requested, the element would be included and available.

| Identifier |                                                                                                           | S.4.2-03                                                                                                                                      |
|------------|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|
|            |                                                                                                           | The updated archive object is not stored.                                                                                                     |
| 15.        | Observe the output of the interface<br>function<br>"ArchiveUpdateResponse"<br>or "UpdatePOC" Response.    | A positive feedback is received. No error message or error code<br>occurs. A new Version ID is received.                                      |
| 16.        | Retrieve the XAIP using the the AOID from step 3 and<br>check whether all changes are reflected.          | The retrieved versions of the XAIP reflect all changes made in the<br>XAIP or XAIP(BIN). Especially a version manifest per version<br>exists. |
| 17.        | Check the log file for logs of the changes and update<br>procedures.                                      | The log files contain messages about all<br>the changes.                                                                                      |
| 18.        | Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No. 17 are to be repeated for LXAIP. | See expected results of the test cases from No. 1 to No. 17 for<br>LXAIP.                                                                     |
| Verdict    |                                                                                                           |                                                                                                                                               |

## *S.4.2-04 – Archive Update or UpdatePOC requires data and creates new version*

| Identifier          |                                                                                                                                                                              | S.4.2-04                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                            |              |  |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                                                                                              | MD:A5.1-14<br>M1:A4.2-2<br>M1:A4.2-5<br>M1:A4.2-7<br>PRP-8.1-14                                                                                                                                                                                                                                                                                                                    |                                                                                                                            |              |  |
| Test Purpose        |                                                                                                                                                                              | The test shall<br>verify that the ArchiSafe module can only update an archive data object when the data object or meta data that should<br>be updated are part of the<br>request and not empty and that the original data object is not changed but a new version of the XAIP is created.                                                                                          |                                                                                                                            |              |  |
| Configuration       |                                                                                                                                                                              | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                            |              |  |
| Pre-test conditions |                                                                                                                                                                              | •<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].                                                                                                                                                                                                                                                          |                                                                                                                            |              |  |
|                     |                                                                                                                                                                              | •<br>DXAIP means "DXAIP" or "DLXAIP"" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |                                                                                                                            |              |  |
| Step                | Test sequence                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                    | Expected Results                                                                                                           | Observations |  |
| 1.                  | Store an XAIP_OK_SIG or BIN<br>function "ArchiveSubmissionRequest"<br>"PreservePO".                                                                                          | using the interface<br>or                                                                                                                                                                                                                                                                                                                                                          | The call of the function is possible.                                                                                      |              |  |
| 2.                  | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                                  |                                                                                                                                                                                                                                                                                                                                                                                    | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned to the archived XAIP / BIN. |              |  |
| 3.                  | Try to update this XAIP or BIN using the interface<br>function "ArchiveUpdateRequest" or "UpdatePOC"<br>with the AOID from step 2 without any data object as a<br>parameter. |                                                                                                                                                                                                                                                                                                                                                                                    | The call of the function should<br>be possible.                                                                            |              |  |
| 4.                  | Observe the output of the interface function<br>"ArchiveUpdateResponse"<br>or "UpdatePOC" Response.                                                                          |                                                                                                                                                                                                                                                                                                                                                                                    | An error message or error code will be received.                                                                           |              |  |
| 5.                  | Try to update the archived data object using the interface<br>function "ArchiveUpdateRequest" or "UpdatePOC"                                                                 |                                                                                                                                                                                                                                                                                                                                                                                    | The call of the function should<br>be possible.                                                                            |              |  |

| Identifier |                                                                                                                                                                                                                          | S.4.2-04                                                                                                           |  |
|------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------|--|
|            | with the AOID from step 2 with an empty<br>DXAIP_NOK                                                                                                                                                                     |                                                                                                                    |  |
| 6.         | Observe the output of the interface function<br>"ArchiveUpdateResponse"<br>or "UpdatePOC" Response.                                                                                                                      | An error message or error code will be received.                                                                   |  |
| 7.         | Try to update the archived data object using the interface<br>function "ArchiveUpdateRequest" or "UpdatePOC"<br>on<br>with the AOID from step 2 with a valid DXAIP_OK<br>base of a valid XAIP_OK/ XAIP(BIN).             | The call of the function should<br>be possible.                                                                    |  |
| 8.         | Observe the output of the interface function<br>"ArchiveUpdateResponse"<br>or "UpdatePOC" Response.                                                                                                                      | A positive feedback is received. No error message or error code<br>occurs. A new Version ID is received.           |  |
| 9.         | Retrieve the originally stored version by issuing an<br>"ArchiveRetrievalRequest" or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" Request with the<br>AOID from step 2 with the very first version ID (e.g.<br>v1 ). | The call of the function is possible.                                                                              |  |
| 10.        | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "UpdatePOC"<br>Response.                                                                                                                | The original, unchanged version of the XAIP / BIN (embedded in<br>an XAIP (XAIP(BIN)) ) is successfully retrieved. |  |
| 11.        | Retrieve the originally stored version by issuing an<br>"ArchiveRetrievalRequest"<br>or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" Request<br>with the<br>AOID from step 2 without a version ID.                   | The call of the function is possible.                                                                              |  |
| 12.        | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                                                               | The most current, changed version of the XAIP/ XAIP(BIN)<br>(embedded in an XAIP) is successfully retrieved.       |  |
| 13.        | Retrieve all stored versions by issuing an<br>"ArchiveRetrievalRequest" or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" Request with the<br>AOID from step 2 with the version ID "all".                              | The call of the function is possible.                                                                              |  |
| 14.        | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                                                               | All versions of the XAIP/ XAIP(BIN) (embedded in an XAIP) is<br>successfully retrieved.                            |  |

|         | Identifier                                                       |                                       | S.4.2-04                                                                  |  |
|---------|------------------------------------------------------------------|---------------------------------------|---------------------------------------------------------------------------|--|
| 15.     | Conditional: If<br>No. 1 to No. 14 are to be repeated for LXAIP. | LXAIP is implemented, test steps from | See expected results of the test cases from No. 1 to No. 14 for<br>LXAIP. |  |
| Verdict |                                                                  |                                       |                                                                           |  |
|         |                                                                  |                                       |                                                                           |  |

| 4.5.4.2.4 | S.4.2-05 – |  |  | Only authorised entities can change data |
|-----------|------------|--|--|------------------------------------------|
|-----------|------------|--|--|------------------------------------------|

| Identifier                                                                                                                                                                          |                                                                                                                                                                                     | S.4.2-05                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                                                                                                                                      |  |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement                                                                                                                                                                         |                                                                                                                                                                                     | MD:A5.1-12<br>PRP-8.1-01<br>PRP-8.1-14                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                                                                                                                                      |  |
| Test Purpose                                                                                                                                                                        |                                                                                                                                                                                     | The test shall                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | verify that changes to documents and data including the associated meta data is not possible for unauthorised users or applications. |  |
|                                                                                                                                                                                     | Configuration                                                                                                                                                                       | CONFIG_ArchiSafe                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                                                                                                                                      |  |
| Pre-test conditions                                                                                                                                                                 |                                                                                                                                                                                     | •<br>•<br>•<br>•<br>•<br>XAIP shall<br>be<br>•<br>•<br>BIN is restricted | Tester has no read/write permissions on the middleware<br>Do not perform any authentication against ArchiSafe<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>supported, "LXAIP" may be supported, if configured.<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>to the preservation object formats<br>described in clause 2, Notice 4. |                                                                                                                                      |  |
| Step                                                                                                                                                                                | Test sequence                                                                                                                                                                       |                                                                          | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Observations                                                                                                                         |  |
| 1.                                                                                                                                                                                  | Submit a XAIP_OK<br>or BIN<br>to the middleware using an<br>account A<br>from a client A (if TOT is multi-client<br>capable). Perform authentication when required.                 |                                                                          | The XAIP / BIN was archived. An AOID was returned.                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                      |  |
| 2.                                                                                                                                                                                  | Retrieve a XAIP using the AOID and an account A<br>from<br>a client A (if TOT is multi-client-capable). Perform<br>authentication when required.                                    |                                                                          | XAIP could be retrieved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                      |  |
| 3.<br>Update the XAIP / XAIP(BIN) several times using the<br>AOID and an account A<br>from a client A (if TOT is<br>multi-client-capable). Perform authentication when<br>required. |                                                                                                                                                                                     |                                                                          | All updates are successfully performed.                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                      |  |
| 4.                                                                                                                                                                                  | Disconnect from the TOT.                                                                                                                                                            |                                                                          | Any existing secure channels are terminated.                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                      |  |
| 5.                                                                                                                                                                                  | Reconnect to the TOT and try to retrieve a XAIP using<br>the AOID and an account B<br>from a client A (if TOT is<br>multi-client-capable). Perform authentication when<br>required. |                                                                          | Access denied.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                      |  |

|         | Identifier                                                                                     |                                                                                              | S.4.2-05                                                                 |  |
|---------|------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|--|
| 6.      | account B<br>capable). Perform authentication when required.                                   | Update the XAIP / XAIP(BIN) using the AOID and an<br>from a client A (if TOT is multi-client | Access denied.                                                           |  |
| 7.      | Retrieve a XAIP using the AOID and an account A<br>a client B<br>authentication when required. | from<br>(if TOT is multi-client-capable). Perform                                            | Access denied.                                                           |  |
| 8.      | from a client B<br>account A<br>capable). Perform authentication when required.                | Update the XAIP / XAIP(BIN) using the AOID and an<br>(if TOT is multi-client                 | Access denied.                                                           |  |
| 9.      | Conditional: If<br>No. 1 to No. 8 are to be repeated for LXAIP.                                | LXAIP is implemented, test steps from                                                        | See expected results of the test cases from No. 1 to No. 8 for<br>LXAIP. |  |
| Verdict |                                                                                                |                                                                                              |                                                                          |  |

| Identifier          |                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                       | S.4.2-06                                                                       |              |  |
|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                                                                                                                                                                               | MD:A5.1-13<br>M1:A4.2-3<br>M1:A4.2-4<br>M1:A4.2-7<br>PRP-8.1-14                                                                                                                                                                                       |                                                                                |              |  |
| Test Purpose        |                                                                                                                                                                                                                                                               | The test shall<br>verify that the same data format and digital signature and time stamp validations that are performed for the archival of documents and XAIPs are also<br>performed when already archived XAIPs are changed.                         |                                                                                |              |  |
|                     | Configuration                                                                                                                                                                                                                                                 | CONFIG_ArchiSafe                                                                                                                                                                                                                                      |                                                                                |              |  |
| Pre-test conditions |                                                                                                                                                                                                                                                               | •<br>Tester has write permissions on the Middleware<br>•<br>If required, perform identification and authentication<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured. |                                                                                |              |  |
| Step                | Test sequence                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                       | Expected Results                                                               | Observations |  |
| 1.                  | Perform test case S.4.1-07 but with<br>"ArchiveUpdateRequest" or "UpdatePOC" Request<br>instead of "ArchiveSubmissionRequest"<br>or<br>"PreservePO" Request.                                                                                                  |                                                                                                                                                                                                                                                       | For updates also the XML schema validation will be performed.                  |              |  |
| 2.                  | Perform test case S.4.1-05 but with<br>"ArchiveUpdateRequest" or "UpdatePOC" Request<br>instead of "ArchiveSubmissionRequest"<br>or<br>"PreservePO" Request.<br>Add a digitally signed and electronic timestamped data<br>object to an already archived XAIP. |                                                                                                                                                                                                                                                       | The added digital signatures of signed data objects will also be<br>validated. |              |  |
|                     | Verdict                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                       |                                                                                |              |  |

*4.5.4.2.5 S.4.2-06 – Digital Signature, electronic time stamp and data format validation are also performed on update*

| Identifier          |                                                                                                                                                                                                                       | S.4.2-07                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                          |              |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                                                                                                                                       | MD:A5.1-14<br>M1:A4.2-7<br>PRP-8.1-14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                          |              |  |
| Test Purpose        |                                                                                                                                                                                                                       | The test shall<br>verify whether all changes are traceable and that changes to archived XAIPs/BINs are only applied to the new versions while leaving the existing<br>versions untouched.                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                          |              |  |
| Configuration       |                                                                                                                                                                                                                       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                          |              |  |
| Pre-test conditions |                                                                                                                                                                                                                       | •<br>The tester has read/write permissions<br>on the middleware<br>•<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>•<br>XAIP shall<br>be<br>supported, "LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |                                                                                                          |              |  |
| Step                | Test sequence                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Expected Results                                                                                         | Observations |  |
| 1.                  | Store an XAIP_OK_SIG<br>/ BIN with data to the TOT<br>using the interface function<br>"ArchiveSubmissionRequest"<br>or "PreservePO"                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | The call of the function with this XAIP / BIN as a parameter is<br>possible.                             |              |  |
| 2.                  | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned.          |              |  |
| 3.                  | Using the interface function "ArchiveUpdateRequest"<br>or<br>"UpdatePOC" Request<br>and the AOID from step 2, add<br>a few changes to the XAIP_OK_SIG<br>/ XAIP(BIN) .                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | The call of the function with this XAIP / XAIP(BIN) and the<br>AOID as parameters is possible.           |              |  |
| 4.                  | Observe the output of the interface function<br>"ArchiveUpdateResponse"<br>or "UpdatePOC" Response.                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | A positive feedback is received. No error message or error code<br>occurs. A new Version ID is received. |              |  |
| 5.                  | Request a XAIP from the TOT using the interface<br>function "ArchiveRetrievalRequest"<br>or "RetrievePO"<br>with SubjectOfRetrieval<br>"PO"" Request<br>with<br>the AOID from step 2 and the version ID as parameters |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | The call of the function with this AOID and the Version ID as<br>parameters is possible.                 |              |  |

| Identifier |                                                                                                                                                                                                                                                                                |                                                         | S.4.2-07                                                                                                                                                                                                       |  |
|------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|            | which indicates the very first version.                                                                                                                                                                                                                                        |                                                         |                                                                                                                                                                                                                |  |
| 6.         | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                                                                                                                     |                                                         | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                                                                                                |  |
| 7.         | Compare the retrieved XAIP with the XAIP stored in<br>step 1.                                                                                                                                                                                                                  |                                                         | The XAIP, resp. the BIN embedded in the retrieved XAIP, is the<br>same file that was stored in step 1.                                                                                                         |  |
| 8.         | Request the XAIP from the TOT using the interface<br>function "ArchiveRetrievalRequest"<br>or "RetrievePO"<br>with SubjectOfRetrieval<br>"PO"" Request<br>with<br>the AOID from step 2 and a valid version ID which is<br>not the very first and not the very last version ID. |                                                         | The call of the function with this AOID as a parameter is possible.                                                                                                                                            |  |
| 9.         | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>Response.                                                                                                                                                                                        | or "RetrievePO"                                         | A positive feedback is received. No error message or error<br>code<br>occurs. An XAIP is received.                                                                                                             |  |
| 10.        | step 1 and all the changes done in step 3.                                                                                                                                                                                                                                     | Compare the retrieved XAIP with the XAIP stored in      | The XAIP reflects all changes done in step 3 as appropriate for the<br>selected version ID.<br>Especially, XAIP does not contain the changes which are applied<br>to newer versions that the version selected. |  |
| 11.        | Request the XAIP from the TOT using the interface<br>function "ArchiveRetrievalRequest"<br>with SubjectOfRetrieval<br>the AOID from step 2 and without a                                                                                                                       | or "RetrievePO"<br>"PO"" Request<br>with<br>version ID. | The call of the function with this AOID as a parameter is possible.                                                                                                                                            |  |
| 12.        | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>Response.                                                                                                                                                                                        | or "RetrievePO"                                         | A positive feedback is received. No error message or error code<br>occurs. An<br>XAIP is received.                                                                                                             |  |
| 13.        | step 1 and all the changes done in step 3.                                                                                                                                                                                                                                     | Compare the retrieved XAIP with the XAIP stored in      | The XAIP reflects all changes done in step 3.                                                                                                                                                                  |  |
| 14.        | Conditional: If<br>No. 1 to No. 13 are to be repeated for LXAIP.                                                                                                                                                                                                               | LXAIP is implemented, test steps from                   | See expected results of the test cases from No. 1 to No. 13 for<br>LXAIP.                                                                                                                                      |  |
| Verdict    |                                                                                                                                                                                                                                                                                |                                                         |                                                                                                                                                                                                                |  |

| Identifier          |                                                                                              | S.4.2-08                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |              |  |  |
|---------------------|----------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|--|
| Requirement         |                                                                                              | MD:A5.1-15<br>M1:A4.2-7<br>PRP-8.1-14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |              |  |  |
| Test Purpose        |                                                                                              | The test shall<br>verify that the probative value is not compromised by changes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |              |  |  |
| Configuration       |                                                                                              | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |              |  |  |
| Pre-test conditions |                                                                                              | •<br>Tester has read/write and administrative permissions on the Middleware<br>•<br>Test S.4.2-07 has been performed successfully<br>•<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>•<br>XAIP shall<br>be<br>supported, "LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>The BSI-ERVerifyTool is accessible<br>and the tester<br>has access rights to it.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |              |  |  |
| Step                | Test sequence                                                                                | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Observations |  |  |
| 1.                  | Store an XAIP_OK<br>or BIN<br>interface function "ArchiveSubmissionRequest"<br>"PreservePO". | to the TOT<br>using the<br>The call of the function with this XAIP / BIN as a parameter is<br>or<br>possible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |              |  |  |
| 2.                  | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>Response.     | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned.<br>or "PreservePO"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |              |  |  |
| 3.                  | "RetrievePO" with SubjectOfRetrieval<br>"Evidence".                                          | Request Evidence Records using the AOID from step 2<br>The call of the function with this AOID as a parameter is possible.<br>and the interface function "ArchiveEvidenceRequest"<br>or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |              |  |  |
| 4.                  | Observe the output of the interface function<br>"ArchiveEvidenceResponse"<br>Response.       | A positive feedback is received. No error message or error code<br>occurs. An Evidence Record is received for the first version ID<br>or "RetrievePO"<br>(e.g. "v1").                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |              |  |  |

*4.5.4.2.7 S.4.2-08 – Update shall not impair the probative value*

| Identifier |                                                                                                                                                                   |                                                                      | S.4.2-08                                                                                                                                                   |  |
|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 5.         | Verify the retrieved ERs by using the BSI<br>ERVerifyTool.                                                                                                        |                                                                      | The<br>tool shows that the ERs is upright.                                                                                                                 |  |
| 6.         | Change the hash algorithm.                                                                                                                                        |                                                                      | The hash algorithm is changed.                                                                                                                             |  |
| 7.         | Initiate the Hash-tree Renewal process.                                                                                                                           |                                                                      | The re-hash process is initiated.                                                                                                                          |  |
| 8.         | Using the interface function "ArchiveUpdateRequest"<br>or<br>"UpdatePOC" Request<br>and the AOID from step 2 add<br>additional changes to XAIP_OK<br>/ XAIP(BIN). |                                                                      | The call of the function<br>with this AOID and binary data as<br>parameters is possible.                                                                   |  |
| 9.         | Observe the output of the interface function<br>"ArchiveUpdateResponse"                                                                                           | or "UpdatePOC" Response.                                             | A positive feedback is received. No error message or error code<br>occurs. A new augmented Version ID is assigned (e.g. "v2").                             |  |
| 10.        | Request the XAIP using the AOID from step 2 and the<br>interface function "ArchiveRetrievalRequest"<br>"RetrievePO"<br>with SubjectOfRetrieval<br>"PO"" Request.  | or                                                                   | The call of the function with this AOID as a parameter is possible.                                                                                        |  |
| 11.        | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>Response.                                                                           | or "RetrievePO"                                                      | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                                            |  |
| 12.        | Request Evidence Records using the AOID from step 2<br>and the interface function "ArchiveEvidenceRequest"<br>"RetrievePO" with SubjectOfRetrieval<br>"Evidence". | or                                                                   | The call of the function with this AOID as a parameter is possible.                                                                                        |  |
| 13.        | Observe the output of the interface function<br>"ArchiveEvidenceResponse"<br>Response.                                                                            | or "RetrievePO"                                                      | A positive feedback is received. No error message or error code<br>occurs. An Evidence Record is received for the new augmented<br>version ID (e.g. "v2"). |  |
| 14.        | Verify the retrieved ERs by using the BSI<br>ERVerifyTool.                                                                                                        |                                                                      | The tool shows that the ERs are upright.                                                                                                                   |  |
| 15.        | Using the interface function "ArchiveUpdateRequest"<br>"UpdatePOC" Request<br>change the XAIP_OK<br>DXAIP_OK.                                                     | or<br>and the AOID from step 2 to<br>/XAIP(BIN) (add metadata) using | The call of the function with this AOID and the DXAIP_OK as<br>parameters is possible.                                                                     |  |
| 16.        | Observe the output of the interface function<br>"ArchiveUpdateResponse"                                                                                           | or "UpdatePOC" Response.                                             | A positive feedback is received. No error message or error code<br>occurs. A new Version ID is assigned.                                                   |  |

|     | Identifier                                                                                                                                                                         | S.4.2-08                                                                                                                                                   |  |
|-----|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 17. | Request the XAIP with the AOID from step 2 and the<br>interface function "ArchiveRetrievalRequest"<br>or<br>"RetrievePO"<br>with SubjectOfRetrieval<br>"PO""<br>Request.           | The call of the function with this AOID as a parameter is possible.                                                                                        |  |
| 18. | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                         | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                                            |  |
| 19. | Request Evidence Records using the AOID from step 2<br>and the interface function "ArchiveEvidenceRequest"<br>or<br>"RetrievePO" with SubjectOfRetrieval<br>"Evidence".            | The call of the function with this AOID as a parameter is possible.                                                                                        |  |
| 20. | Observe the output of the interface function<br>"ArchiveEvidenceResponse"<br>or "RetrievePO"<br>Response.                                                                          | A positive feedback is received. No error message or error code<br>occurs. An Evidence Record is received for the new augmented<br>version ID (e.g. "v3"). |  |
| 21. | Verify the retrieved ERs by using the BSI<br>ERVerifyTool.                                                                                                                         | The tool shows that the ERs are integer.                                                                                                                   |  |
| 22. | Compare the ERs from step 17 with the ERs from step<br>10.                                                                                                                         | The evidence data from step 17 differs from the evidence data<br>retrieved in step 10.                                                                     |  |
| 23. | Using the interface function "ArchiveUpdateRequest"<br>or<br>"UpdatePOC" Request<br>and the AOID from step 2 to<br>delete the changes to XAIP_OK<br>/XAIP(BIN) added in<br>step 5. | The call of the function with this AOID and binary data as<br>parameters is possible.                                                                      |  |
| 24. | Observe the output of the interface function<br>"ArchiveUpdateResponse"<br>or "UpdatePOC" Response.                                                                                | A positive feedback is received. No error message or error code<br>occurs. A new Version ID is assigned.                                                   |  |
| 25. | Request the XAIP with the AOID from step 2 and the<br>interface function "ArchiveRetrievalRequest"<br>or<br>"RetrievePO"<br>with SubjectOfRetrieval<br>"PO"" Request.              | The call of the function with this AOID as a parameter is possible.                                                                                        |  |
| 26. | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                         | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                                            |  |
| 27. | Request Evidence Records using the AOID from step 2                                                                                                                                | The call of the function with this AOID as a parameter is possible.                                                                                        |  |

| Identifier |                                                                                                                                                                                                                      | S.4.2-08                                                                                                                                                  |  |
|------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|            | and the interface function "ArchiveEvidenceRequest"<br>or<br>"RetrievePO" with SubjectOfRetrieval<br>"Evidence".                                                                                                     |                                                                                                                                                           |  |
| 28.        | Observe the output of the interface function<br>"ArchiveEvidenceResponse"<br>or "RetrievePO"<br>Response.                                                                                                            | A positive feedback is received. No error message or error code<br>occurs. An Evidence Record is received for new augmented<br>version ID (e.g. "v4").    |  |
| 29.        | Calculate manually the evidence data for the updated<br>XAIP / XAIP(BIN). For this purpose use the time stamp<br>information provided in the ERs retrieved in the previous<br>step.                                  | The evidence data has been calculated.                                                                                                                    |  |
| 30.        | Compare the manually calculated evidence data with the<br>evidence data of the requested Evidence Record.                                                                                                            | The evidence data is equal but differs from the evidence data<br>retrieved in step 18.                                                                    |  |
| 31.        | Request Evidence Records using the AOID from step 2<br>and the interface function "ArchiveEvidenceRequest"or<br>"RetrievePO" with SubjectOfRetrieval<br>"Evidence" for all Version Ids (e.g. Version ID =<br>"all"). | The call of the function with this AOID as a parameter is possible.                                                                                       |  |
| 32.        | Observe the output of the interface function<br>"ArchiveEvidenceResponse"<br>or "RetrievePO"<br>Response.                                                                                                            | A positive feedback is received. No error message or error code<br>occurs. The Evidence Records for the previously created four<br>versions are received. |  |
| 33.        | Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No. 32 are to be repeated for LXAIP.                                                                                                            | See expected results of the<br>test cases from No. 1 to No. 32 for<br>LXAIP.                                                                              |  |
| Verdict    |                                                                                                                                                                                                                      |                                                                                                                                                           |  |

## *4.5.4.2.8 S.4.2-09 – Update cannot delete data / Versions can be retrieved separately*

| Identifier          |                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | S.4.2-09                                                                                                     |              |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------|--------------|
| Requirement         |                                                                                                                                                                                         | MD:A5.1-16<br>MD:A5.1-20<br>M1:A4.2-2<br>M1:A4.2-7<br>PRP-8.1-14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                              |              |
| Test Purpose        |                                                                                                                                                                                         | The test shall<br>verify that the update function cannot be used to completely and ultimately delete any data, meta data or complete XAIPs/BINs.<br>The test shall<br>verify that it is possible to retrieve each version of a changed data structure individually by using the version<br>ID as a parameter when issuing the<br>archive retrieval request.                                                                                                                                                                                                                      |                                                                                                              |              |
| Configuration       |                                                                                                                                                                                         | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                              |              |
| Pre-test conditions |                                                                                                                                                                                         | •<br>Tester has read/write permissions on the Middleware<br>•<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>•<br>XAIP shall<br>be<br>supported, "LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |                                                                                                              |              |
| Step                | Test sequence                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Expected Results                                                                                             | Observations |
| 1.                  | Store an XAIP_OK<br>or BIN<br>with data to the TOT<br>using<br>the interface function "ArchiveSubmissionRequest"<br>or<br>"PreservePO".                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | The call of the function with this XAIP / BIN as a parameter is<br>possible.                                 |              |
| 2.                  | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned and returned. |              |
| 3.                  | Using the interface function "ArchiveUpdateRequest" or<br>"UpdatePOC" Request and the AOID from step 2 add<br>an additional data element to the already existing archive<br>data object |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | The call of the function with a data element and the AOID as<br>parameters is possible.                      |              |
| 4.                  | Observe the output of the interface function<br>"ArchiveUpdateResponse"<br>or "UpdatePOC" Response.                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | A positive feedback is received. No error message or error code<br>occurs. A new Version ID <n> is assigned. |              |

|         | Identifier                                                                                                                                                                          | S.4.2-09                                                                                                                    |  |
|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|--|
| 5.      | By using the interface function "ArchiveUpdateRequest"<br>or "UpdatePOC" Request<br>and the AOID from step 2,<br>try to replace the existing data element with an empty<br>element. | The call of the function with this AOID and the empty data element<br>as parameters is possible.                            |  |
| 6.      | Observe the output of the interface function<br>"ArchiveUpdateResponse"<br>or "UpdatePOC" Response.                                                                                 | A positive feedback is received. No error message or error code<br>occurs. A new Version ID <n+1> is assigned and returned. |  |
| 7.      | Using the interface function<br>"ArchiveRetrievalRequest"<br>or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" Request, the AOID<br>from step 2 and the Version ID from step 6.   | The call of the function with this AOID and Version ID as<br>parameters is possible.                                        |  |
| 8.      | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                          | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                             |  |
| 9.      | Check whether the data element is included and whether<br>this data element is identical to the data element used in<br>step 3.                                                     | The data element is not included.                                                                                           |  |
| 10.     | Using the interface function<br>"ArchiveRetrievalRequest"<br>or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" Request, the AOID<br>from step 2 and the Version ID from step 4.   | The call of the function with this AOID and Version ID as<br>parameters is possible.                                        |  |
| 11.     | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                          | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                             |  |
| 12.     | Check whether the<br>data element is included and whether<br>this data element is identical to the data element used in<br>step 3.                                                  | The data element is included and is identical to the data element<br>used in step 3.                                        |  |
| 13.     | Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No.<br>12 are to be repeated for LXAIP.                                                                        | See expected results of the test cases from No. 1 to No. 12 for<br>LXAIP.                                                   |  |
| Verdict |                                                                                                                                                                                     |                                                                                                                             |  |

#### *4.5.4.2.9 S.4.2-10 – All updates are logged*

| Identifier          |                                                                                     | S.4.2-10                                                                                                                                                         |                                                                                                                                                                           |              |  |
|---------------------|-------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                     | MD:A5.1-17<br>OVR-7.10-02<br>PRP-8.1-01<br>PRP-8.1-06<br>PRP-8.1-14                                                                                              |                                                                                                                                                                           |              |  |
| Test Purpose        |                                                                                     | The test shall<br>verify that all changes are logged to a log file.                                                                                              |                                                                                                                                                                           |              |  |
| Configuration       |                                                                                     | CONFIG_ArchiSafe                                                                                                                                                 |                                                                                                                                                                           |              |  |
| Pre-test conditions |                                                                                     | •<br>Tester has read permissions on the file system<br>•<br>Test case S.4.2-03 has been performed<br>•<br>If required, perform identification and authentication |                                                                                                                                                                           |              |  |
| Step                | Test sequence                                                                       |                                                                                                                                                                  | Expected Results                                                                                                                                                          | Observations |  |
| 1.                  | Check the vendor documentation how and where the<br>middleware records the updates. |                                                                                                                                                                  | A log file exists, the updates are recorded directly within the<br>XAIPs or there is any other type of records,<br>especially for the<br>BINs.                            |              |  |
| 2.                  | Check the log records for update events triggered in test<br>case S.4.2-09.         |                                                                                                                                                                  | All the updates have been logged, incl. the time when the updates<br>were performed, the changed data and the user name of the<br>person/account who updated the<br>data. |              |  |
| Verdict             |                                                                                     |                                                                                                                                                                  |                                                                                                                                                                           |              |  |

## **4.5.4.3 Archive Retrieval or RetrievePO Request**

#### *4.5.4.3.1 S.4.3-01 – AOID and secure channel is required for retrieval*

|                     | Identifier                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | S.4.3-01                                                                                                          |              |
|---------------------|----------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|--------------|
| Requirement         |                                                                                                                | MD:A5.1-19<br>MD:A5.1-18<br>M1:A4.0-5<br>M1:A4.3-1<br>M1:A4.3-2<br>PRP-8.1-01<br>PRP-8.1-10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                   |              |
| Test Purpose        |                                                                                                                | The test shall<br>verify that the upstream IT applications can send and retrieve any data only through a secure communication channel and only if a valid AOID (if<br>required) is used as a parameter.                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                                   |              |
| Configuration       |                                                                                                                | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                   |              |
| Pre-test conditions |                                                                                                                | •<br>Tester has read permissions on the Middleware<br>•<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>•<br>XAIP shall<br>be<br>supported, "LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |                                                                                                                   |              |
| Step                | Test sequence                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Expected Results                                                                                                  | Observations |
| 1.                  | Start a data traffic capture tool to monitor the traffic<br>between upstream client application and ArchiSafe. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Data traffic capturing is started.                                                                                |              |
| 2.                  | Store some XAIP_OKs or BINs using the interface<br>function "ArchiveSubmissionRequest"<br>or<br>"PreservePO".  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | The calls of the function with this XAIP / BIN as a parameter are<br>possible.                                    |              |
| 3.                  | Observe the output of the interface functions<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned per stored object. |              |
| 4.                  | Use the interface function "ArchiveRetrievalRequest"                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | or The call of the function with this AOID as a parameter is possible.                                            |              |

|     | Identifier                                                                                                                                                                             |                                                                                                  | S.4.3-01                                                                                                                       |
|-----|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------|
|     | "RetrievePO"<br>"PO"" Request<br>XAIP.                                                                                                                                                 | with SubjectOfRetrieval<br>and one AOID from step 2 to request the                               |                                                                                                                                |
| 5.  | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                             |                                                                                                  | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                |
| 6.  | Use several interface functions<br>"ArchiveRetrievalRequest"<br>or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" Request<br>and several<br>AOIDs from step 2 to request some XAIPs. |                                                                                                  | The calls of the function with these AOIDs as a parameter are<br>possible.                                                     |
| 7.  | Observe the output of the interface functions<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                            |                                                                                                  | A positive feedback is received. No error message or error code<br>occurs. All the requested XAIPs are received.               |
| 8.  | Use the interface function "ArchiveRetrievalRequest"<br>or<br>"RetrievePO"<br>with SubjectOfRetrieval<br>"PO"" Request<br>and an AOID which does not exist to<br>request an XAIP.      |                                                                                                  | The call of the function with this AOID as a parameter is possible.                                                            |
| 9.  | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                             |                                                                                                  | A negative feedback will be received. An error message or error<br>code occurs. No XAIP is received.                           |
| 10. | Use<br>several "ArchiveUpdateRequests"or<br>"UpdatePOC" Requests"<br>functions with the AOIDs<br>from step 2 to change the data contained within all the<br>XAIP or XAIP(BIN).         |                                                                                                  | The function calls are possible.                                                                                               |
| 11. | Check the output of the "ArchiveUpdateResponse" or<br>"UpdatePOC" Response functions.                                                                                                  |                                                                                                  | A new version ID per XAIP / XAIP(BIN) is received.                                                                             |
| 12. | Use several interface functions<br>"ArchiveRetrievalRequest"<br>SubjectOfRetrieval "PO"" Request<br>IDs from step 11 to request some XAIPs.                                            | or "RetrievePO"<br>with<br>and several<br>AOIDs from step 2 together with the respective version | The calls of the function with these AOIDs as a parameter are<br>possible.                                                     |
| 13. | Observe the output of the interface functions<br>"ArchiveRetrievalResponse"                                                                                                            | or "RetrievePO"                                                                                  | A positive feedback is received. No error message or error code<br>occurs. The correct versions of all the requested XAIPs are |

|     | Identifier                                                                                                                                                                                                                                                   | S.4.3-01                                                                                                                                                                                                         |  |
|-----|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|     | Response.                                                                                                                                                                                                                                                    | received.                                                                                                                                                                                                        |  |
| 14. | Use the "ArchiveUpdateRequest"<br>or "UpdatePOC"<br>Request" function with an AOID which does not exist.                                                                                                                                                     | The function call is possible.                                                                                                                                                                                   |  |
| 15. | Check the output of the "ArchiveUpdateResponse" or<br>"UpdatePOC" Response function.                                                                                                                                                                         | A negative feedback will be received. An error message or error<br>code occurs.                                                                                                                                  |  |
| 16. | Use the interface function "ArchiveRetrievalRequest" or<br>"RetrievePO"<br>with SubjectOfRetrieval<br>"PO"" Request using the AOID from step 4 for all<br>versions (e.g. with Version ID = "all").                                                           | The call of the function with this AOID as a parameter is possible.                                                                                                                                              |  |
| 17. | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                                                                                                   | A positive feedback is received. No error message or error code<br>occurs. The XAIP with the AOID of step 4 with all versions is<br>received.                                                                    |  |
| 18. | Use"ArchiveEvidenceRequest" or "RetrievePO" with<br>SubjectOfRetrieval "Evidence" function<br>with the AOID from step 4 to check the XAIP /<br>XAIP(BIN) authenticity and integrity for all versions<br>(e.g. with Version ID = "all").                      | The function call is possible.                                                                                                                                                                                   |  |
| 19. | Check the output of the "ArchiveEvidenceResponse"<br>or<br>"RetrievePO" Response<br>functions.                                                                                                                                                               | For each existing version of this AOID an Evidence Record is<br>received.                                                                                                                                        |  |
| 20. | Use the interface function "ArchiveRetrievalRequest" or<br>"RetrievePO"<br>with SubjectOfRetrieval<br>"PO"" Request using the AOID from step 4 for all<br>versions (e.g. with Version ID = "all") demanding also<br>all Evidence Records (e.g. "IncludeERS") | The call of the function with this AOID as a parameter is possible.                                                                                                                                              |  |
| 21. | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                                                                                                   | A positive feedback is received. No error message or error code<br>occurs. The XAIP with the AOID of step 4 with all versions is<br>received. Furthermore for each Version ID an Evidence Record is<br>received. |  |
| 22. | Check the output of the "ArchiveEvidenceResponse" or<br>"RetrievePO" Response.functions.                                                                                                                                                                     | For each version of the archive data object, one Evidence Record<br>is received. The Evidence Records of this step are equal to the<br>Evidence Records of step 19.                                              |  |
| 23. | Use the "ArchiveEvidenceRequest" or "RetrievePO" The function call is possible.                                                                                                                                                                              |                                                                                                                                                                                                                  |  |

|     | Identifier                                                                                                                                                                                                                 | S.4.3-01                                                                                                                |
|-----|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
|     | with SubjectOfRetrieval<br>"Evidence"<br>function with an AOID,<br>which does not exist.                                                                                                                                   |                                                                                                                         |
| 24. | Check the output of the "ArchiveEvidenceResponse" or<br>"RetrievePO" Response.function.                                                                                                                                    | A negative feedback will be received. An error message or error<br>code occurs.                                         |
| 25. | If supported, use the "ArchiveDataRequest" or the<br>"Search"<br>Request<br>function with one AOID from step 2<br>and the dataLocation parameter to identify an individual<br>data element within the XAIP<br>/ XAIP(BIN). | The function call is possible.                                                                                          |
| 26. | Check the output of the "ArchiveDataResponse" or the<br>"Search"<br>Response<br>function.                                                                                                                                  | The requested data value and the original locationValue are<br>received.                                                |
| 27. | If supported, use the "ArchiveDataRequest" or the<br>"Search"<br>Request<br>function with an AOID which does<br>not exist.                                                                                                 | The function call is possible.                                                                                          |
| 28. | Check the output of the "ArchiveDataResponse" or the<br>"Search"<br>Response<br>function.                                                                                                                                  | A negative feedback will be received. An error message or error<br>code occurs.                                         |
| 29. | Use the "ArchiveDeletionRequest" or "DeletePO"<br>Request function with an AOID which does not exist.                                                                                                                      | The function call is possible.                                                                                          |
| 30. | Check the output of the "ArchiveDeletionResponse" or<br>"DeletePO" Response function.                                                                                                                                      | A negative feedback will be received. An<br>error message or error<br>code occurs.                                      |
| 31. | Use the "ArchiveDeletionRequest" or "DeletePO"<br>Request function with one AOID from step 2 to delete<br>the XAIP / BIN.                                                                                                  | The function call is possible.                                                                                          |
| 32. | Check the output of the "ArchiveDeletionResponse" or<br>"DeletePO" Response function.                                                                                                                                      | The XAIP / BIN has been deleted from the storage.                                                                       |
| 33. | Stop the data traffic capture tool.                                                                                                                                                                                        | Data traffic capturing is stopped.                                                                                      |
| 34. | Check the captured data.                                                                                                                                                                                                   | The captured data is encrypted or otherwise protected. No<br>references to the previous access procedures can be found. |
| 35. | Repeat 2,3, 4,<br>5, 8, 12, 16, 20, 23 without using S. 4 or S.<br>512.                                                                                                                                                    | The request will be rejected by ArchiSafe-Module including an<br>error message documenting the failed request.          |
| 36. | Conditional: If<br>LXAIP is implemented, test steps from                                                                                                                                                                   | See expected results of the test cases from No. 1 to No. 34 for                                                         |

|         | Identifier                                    |  |        | S.4.3-01 |  |
|---------|-----------------------------------------------|--|--------|----------|--|
|         | No. 1 to No. 34 are to be repeated for LXAIP. |  | LXAIP. |          |  |
| Verdict |                                               |  |        |          |  |

## *4.5.4.3.2 S.4.3-02 – Archive Retrieval or RetrievePO returns XAIP or LXAIP*

| Identifier            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | S.4.3-02         |              |
|-----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------|--------------|
| Requirement           | MD:A4.3-1<br>MD:A6.1-1<br>MD:A6.1-2<br>MD:A6.3-2<br>M1:A4.0-1<br>M1:A3.2-1<br>M1:A3.2-2<br>M1:A4.3-3<br>PRP-8.1-09<br>PRP-8.1-10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                  |              |
| Test Purpose          | The test shall<br>verify that requested data is always returned in an XAIP-based container.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                  |              |
| Configuration         | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                  |              |
| Pre-test conditions   | •<br>Middleware documentation is available<br>•<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>•<br>XAIP shall<br>be<br>supported, "LXAIP"<br>may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>shall<br>be configured.<br>[TR-ESOR-TRANS]<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4.<br>The following steps must be accomplished before starting the test:<br>•<br>The call of the function "ArchiveSubmissionRequest" or "PreservePO" with a XAIP_OK as a parameter is possible. A positive feedback is received. No<br>error message or error code occurs. An AOID is assigned.<br>•<br>The call of the function "ArchiveSubmissionRequest" or "PreservePO"with a XAIP_OK_Sig as a parameter is possible. A positive feedback is received.<br>No error message or error code occurs. An AOID is assigned.<br>•<br>The call of the function "ArchiveSubmissionRequest" or "PreservePO"with a BIN_OK as a parameter is possible. A positive feedback is received. No<br>error message or error code occurs. An AOID is assigned.<br>•<br>The call of the function "ArchiveSubmissionRequest" or "PreservePO"with a BIN_OK_Sig as a parameter is possible. A positive feedback is received.<br>No error message or error code occurs. An AOID is assigned. |                  |              |
| Step<br>Test sequence |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Expected Results | Observations |

| Identifier |                                                                                                            |                                                                                              | S.4.3-02                                                                                                                            |  |
|------------|------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------|--|
| 1.         | Using the interface function<br>"ArchiveRetrievalRequest"<br>SubjectOfRetrieval "PO"" Request<br>the XAIP. | or "RetrievePO"<br>with<br>and the<br>AOID from step 1 in the pre-test conditions to request | The call of the function with this AOID as a parameter is possible.                                                                 |  |
| 2.         | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>Response.                    | or "RetrievePO"                                                                              | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                     |  |
| 3.         | Using the interface function<br>"ArchiveRetrievalRequest"<br>SubjectOfRetrieval "PO"" Request<br>the XAIP. | or "RetrievePO"<br>with<br>and the<br>AOID from step 2 in the pre-test conditions to request | The call of the function with this AOID as a parameter is possible.                                                                 |  |
| 4.         | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>Response.                    | or "RetrievePO"                                                                              | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                     |  |
| 5.         | Using the interface function<br>"ArchiveRetrievalRequest"<br>SubjectOfRetrieval "PO"" Request<br>the XAIP. | or "RetrievePO"<br>with<br>and the<br>AOID from step 3 in the pre-test conditions to request | The call of the function with this AOID as a parameter is possible.                                                                 |  |
| 6.         | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>Response.                    | or "RetrievePO"                                                                              | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                     |  |
| 7.         | Using the interface function<br>"ArchiveRetrievalRequest"<br>SubjectOfRetrieval "PO"" Request<br>the XAIP. | or "RetrievePO"<br>with<br>and the<br>AOID from step 4 in the pre-test conditions to request | The call of the function with this AOID as a parameter is possible.                                                                 |  |
| 8.         | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>Response.                    | or "RetrievePO"                                                                              | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                     |  |
| 9.         | Check the retrieved XAIPs.                                                                                 |                                                                                              | All data objects can successfully be retrieved from the archive<br>system, encapsulated in valid XAIPs as defined in the middleware |  |

|     | Identifier                                                                                                | S.4.3-02                                                                                                       |  |  |  |
|-----|-----------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--|--|--|
|     |                                                                                                           | documentation.                                                                                                 |  |  |  |
| 10. | Check the XML schema of the retrieved XAIPs.                                                              | The XML schema of all the XAIPs must comply with an XSD<br>configured by the user or a default XSD of the TOT. |  |  |  |
| 11. | Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No. 10 are to be repeated for LXAIP. | See expected results of the test cases from No. 1 to No. 10 for<br>LXAIP.                                      |  |  |  |
|     | Verdict                                                                                                   |                                                                                                                |  |  |  |

## **4.5.4.4 Archive Evidence Request or RetrivePO Request with SubjectOfRetrieval "Evidence"**

<span id="page-212-0"></span>

| Identifier          |                                                                                                                                                                                | S.4.4-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                 |              |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|--------------|
| Requirement         |                                                                                                                                                                                | MD:A6.1-2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                 |              |
| Test Purpose        |                                                                                                                                                                                | The test shall<br>verify that the procedures used for the preservation of evidence of signed electronic documents do not impair the ability to continue using the<br>electronic documents from the archive.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                 |              |
| Configuration       |                                                                                                                                                                                | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                 |              |
| Pre-test conditions |                                                                                                                                                                                | •<br>If required, perform identification and authentication<br>•<br>The call of the function "ArchiveSubmissionRequest" or "PreservePO" with a XAIP_OK _Sig as a parameter is possible. A positive feedback is received.<br>No error message or error code occurs. An AOID is assigned.<br>•<br>The call of the function "ArchiveSubmissionRequest" or "PreservePO" with a BIN_OK_Sig as a parameter is possible. A positive feedback is received.<br>No error message or error code occurs. An AOID is assigned.<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>•<br>XAIP shall<br>be<br>supported, "LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured. |                                                                                                 |              |
| Step                | Test sequence                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Expected Results                                                                                | Observations |
| 1.                  | Start the Timestamp Renewal process.                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | The Timestamp Renewal is in process.                                                            |              |
| 2.                  | Use the interface function "ArchiveRetrievalRequest"<br>or<br>"RetrievePO"<br>with SubjectOfRetrieval<br>"PO"" Request<br>to request an XAIP.                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | The call of the function is possible.                                                           |              |
| 3.                  | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received. |              |
| 4.                  | Using the interface function<br>"ArchiveRetrievalRequest"<br>or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" Request<br>to request<br>the binary object in form of a XAIP. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | The call of the function is possible.                                                           |              |
| 5.                  | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received. |              |

|         | Identifier                                                                                                                                                | S.4.4-01                                                                                                                                                                                                                   |
|---------|-----------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|         | Response.                                                                                                                                                 |                                                                                                                                                                                                                            |
| 6.      | Check the retrieved XAIPs and especially the content<br>data.                                                                                             | All data objects can successfully be retrieved from the archive<br>system, encapsulated in valid XAIPs as defined in the middleware<br>documentation.<br>The actual content data is not modified and can be used as usual. |
| 7.      | Start the Hash-tree Renewal process.                                                                                                                      | The Hash-tree Renewal is in process.                                                                                                                                                                                       |
| 8.      | Using the interface function<br>"ArchiveRetrievalRequest"<br>or "RetrievePO"<br>SubjectOfRetrieval "PO"" Request<br>an XAIP.                              | The call of the function is possible.<br>with<br>to request                                                                                                                                                                |
| 9.      | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                                                                                                            |
| 10.     | Using the interface function<br>"ArchiveRetrievalRequest"<br>or "RetrievePO"<br>SubjectOfRetrieval "PO"" Request<br>the binary object in form of an XAIP. | The call of the function is possible.<br>with<br>to request                                                                                                                                                                |
| 11.     | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                                                                                                            |
| 12.     | Check the retrieved XAIPs and especially the content<br>data.                                                                                             | All data objects can successfully be retrieved from the archive<br>system, encapsulated in valid XAIPs as defined in the middleware<br>documentation.<br>The actual content data is not modified and can be used as usual. |
| 13.     | Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No. 12 are to be repeated for LXAIP.                                                 | See expected results of the test cases from No. 1 to No. 12 for<br>LXAIP.                                                                                                                                                  |
| Verdict |                                                                                                                                                           |                                                                                                                                                                                                                            |

| Identifier                        |                                                                                                                                                                              |                                                                                                                   | S.4.4-02                                                                                                                                                                                                                                                                                                                 |                         |
|-----------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|
|                                   | Requirement                                                                                                                                                                  | MD:A4.3-1<br>MD:A6.1-1<br>MD:A6.1-2<br>M1:A3.2-1<br>M1:A3.2-2<br>M1:A4.0-1<br>M1:A4.5-1<br>M1:A4.5-2<br>M1:A4.5-3 |                                                                                                                                                                                                                                                                                                                          |                         |
| The test shall<br>Test Purpose    |                                                                                                                                                                              |                                                                                                                   | verify that requesting Evidence Records for a valid AOID the Evidence Records are<br>correct, i. e. conform with ERs specified in RFC 4998 or RFC<br>6283 and for each Version ID of an AOID there is an Evidence Record assigned to the AOID.                                                                           |                         |
| CONFIG_ArchiSafe<br>Configuration |                                                                                                                                                                              |                                                                                                                   |                                                                                                                                                                                                                                                                                                                          |                         |
| Pre-test conditions               |                                                                                                                                                                              | •<br>•<br>•<br>•<br>The BSI-ERVerifyTool is accessible<br>•                                                       | Tester has read/write permissions on the Middleware<br>If required, perform identification and authentication<br>Test case M.3-06 has already been successfully checked<br>and the tester<br>has access rights to it.<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS] | shall<br>be configured. |
| Step                              | Test sequence                                                                                                                                                                |                                                                                                                   | Expected Results                                                                                                                                                                                                                                                                                                         | Observations            |
| 1.                                | Using several interface functions<br>"ArchiveEvidenceRequest"<br>or "RetrievePO" with<br>SubjectOfRetrieval "Evidence" with valid<br>AOIDs without Version IDs as parameter. |                                                                                                                   | The calls of the function with an AOID as a parameter are possible.                                                                                                                                                                                                                                                      |                         |
| 2.                                | Observe the output of the interface function<br>"ArchiveEvidenceResponse"<br>or "RetrievePO"<br>Response.                                                                    |                                                                                                                   | A positive feedback is received. No error message or error code<br>occurs. Evidence Records per AOID are received.                                                                                                                                                                                                       |                         |
| 3.                                | Check the retrieved Evidence Records with the<br>ERVerifyTool.                                                                                                               |                                                                                                                   | There are correct Evidence Records in ERS notation as specified in<br>RFC 4998 or RFC 6283 for the last Version ID of each<br>XAIP/AOID or BIN/AOID.<br>The AOIDs are exactly these AOIDs passed over as parameters.                                                                                                     |                         |
|                                   |                                                                                                                                                                              |                                                                                                                   |                                                                                                                                                                                                                                                                                                                          |                         |

*4.5.4.4.2 S.4.4-02 – Middleware returns correct Evidence Records for each requested AOID*

| Identifier |                                                                                                                                                                                                          | S.4.4-02                                                                                                                                                                                                                                                                                                                                                            |  |
|------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 4.         | Using several interface functions<br>"ArchiveEvidenceRequest"<br>or "RetrievePO" with<br>SubjectOfRetrieval "Evidence" with valid<br>AOIDs for all versions (e.g. Version ID ="all") as<br>parameters.   | The calls of the function with these AOIDs and Version IDs as<br>parameters are possible.                                                                                                                                                                                                                                                                           |  |
| 5.         | Observe the output of the interface function<br>"ArchiveEvidenceResponse"<br>or "RetrievePO"<br>Response.                                                                                                | A positive<br>feedback is received. No error message or error code<br>occurs. Evidence Records per AOID are received.                                                                                                                                                                                                                                               |  |
| 6.         | Check the retrieved Evidence Records with the BSI<br>ERVerifyTool.                                                                                                                                       | There is a correct Evidence Record in ERS notation as specified in<br>RFC 4998 or RFC 6283<br>for each Version ID of each XAIP/AOID<br>or BIN/AOID.<br>The AOIDs are exactly these AOIDs passed over as parameters.                                                                                                                                                 |  |
| 7.         | Using the interface function<br>"ArchiveEvidenceRequest"<br>or "RetrievePO" with<br>SubjectOfRetrieval "Evidence" with one<br>valid AOID and one valid Version ID as parameters in<br>one function call. | The call of the function with one AOID as a parameter is possible.                                                                                                                                                                                                                                                                                                  |  |
| 8.         | Observe the output of the interface function<br>"ArchiveEvidenceResponse"<br>or "RetrievePO"<br>Response.                                                                                                | A positive feedback is received. No error message or error code<br>occurs. An Evidence Record is received.                                                                                                                                                                                                                                                          |  |
| 9.         | Check the retrieved Evidence Record by the BSI<br>ERVerifyTool.                                                                                                                                          | There is a correct Evidence Record in ERS notation as specified in<br>RFC 4998 or RFC 6283 and contains one Evidence Records in<br>ERS notation associated to the valid Version ID of the valid AOID<br>of step 7.<br>The AOID and Version ID are exactly the AOID and Version ID<br>passed over as parameter.<br>The tool shows that the ERs are formed correctly. |  |
| 10.        | Use the interface function "ArchiveEvidenceRequest"<br>or<br>"RetrievePO" with SubjectOfRetrieval<br>"Evidence" and an AOID which does not exist to<br>request an Evidence Record.                       | The call of the function with this AOID as a parameter is possible.                                                                                                                                                                                                                                                                                                 |  |
| 11.        | Observe the output of the interface function<br>"ArchiveEvidenceResponse"<br>or "RetrievePO"<br>Response.                                                                                                | A negative feedback is received. An error message or error code<br>occurs. No Evidence Record is received.                                                                                                                                                                                                                                                          |  |

|         | Identifier                                                                                  |                                                                                                               | S.4.4-02                                                                                                   |  |
|---------|---------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|--|
| 12.     | "RetrievePO" with SubjectOfRetrieval<br>which does not exist to request an Evidence Record. | Use the interface function "ArchiveEvidenceRequest"<br>or<br>"Evidence" and an existing AOID and a Version ID | The call of the function with this AOID as a parameter is possible.                                        |  |
| 13.     | Observe the output of the interface function<br>"ArchiveEvidenceResponse"<br>Response.      | or "RetrievePO"                                                                                               | A negative feedback is received. An error message or error code<br>occurs. No Evidence Record is received. |  |
| Verdict |                                                                                             |                                                                                                               |                                                                                                            |  |

| Identifier          |                                                                                                                                                                                                                                                                        | S.4.4-03                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |              |  |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                                                                                                                                                                                        | MD:A5.1-26<br>M1:A4.5-4                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |              |  |
| Test Purpose        |                                                                                                                                                                                                                                                                        | The test shall<br>verify that the middleware is able to create correct electronic Evidence Records for each version of an XAIP or BIN so that their authenticity and<br>integrity since the time of archiving is ensured even if changes were performed in the meantime. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |              |  |
| Configuration       |                                                                                                                                                                                                                                                                        | CONFIG_ArchiSafe                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |              |  |
| Pre-test conditions |                                                                                                                                                                                                                                                                        | •<br>•<br>•<br>•<br>•<br>XAIP shall<br>be<br>•<br>•<br>•                                                                                                                                                                                                                 | Tester has read/write permissions on the Middleware<br>If required, perform identification and authentication<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>supported, "LXAIP" may be supported, if configured.<br>The call of the function "ArchiveSubmissionRequest" or "PreservePO" with a XAIP_OK_Sig as a parameter is possible. A positive feedback is received.<br>No error message or error code occurs. An AOID A1 is assigned.<br>The call of the function "ArchiveUpdateRequest" or "UpdatePOC" with a valid AOID and for adding a DXAIP_OKas a parameter is possible. A positive<br>feedback is received. No error message or error code occurs. A new Version ID is received.<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured. |              |  |
| Step                | Test sequence                                                                                                                                                                                                                                                          |                                                                                                                                                                                                                                                                          | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Observations |  |
| 1.                  | Using the interface<br>function<br>"ArchiveEvidenceRequest"<br>or "RetrievePO" with<br>SubjectOfRetrieval "Evidence" and a valid<br>AOID to request the Evidence Records for the<br>XAIP/BIN.                                                                          |                                                                                                                                                                                                                                                                          | The call of the function with this AOID as parameter is possible                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |              |  |
| 2.                  | Observe and check the output of the interface function<br>"ArchiveEvidenceResponse" or "RetrievePO"<br>Response<br>with the BSI-ERVerifyTool.                                                                                                                          |                                                                                                                                                                                                                                                                          | A positive feedback is received. No error message or error code<br>occurs. The correct Evidence Records in ERS as specified in<br>RFC<br>4998 or RFC 6283 is received.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |              |  |
| 3.                  | Using the interface function<br>"ArchiveEvidenceRequest"<br>or "RetrievePO" with<br>SubjectOfRetrieval "Evidence" with a valid<br>AOID and an assigned version ID indicating the very<br>first version to request the Evidence Record for<br>the<br>archived XAIP/BIN. |                                                                                                                                                                                                                                                                          | The call of the function with this AOID and the Version ID as<br>parameters is possible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |              |  |

#### *4.5.4.4.3 S.4.4-03 – Middleware creates correct Evidence Records for specific XAIP or BIN versions*

| Identifier |                                                                                                                                            | S.4.4-03                                                                                                                                                                                 |  |
|------------|--------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 4.         | Observe and check the output of the interface function<br>"ArchiveEvidenceResponse" or "RetrievePO"<br>Response.with the BSI-ERVerifyTool. | A positive<br>feedback will be received; no error message or error<br>code. A correct Evidence Record in ERS as specified in RFC 4998<br>or RFC 6283 is received.                        |  |
| 5.         | Evaluate the received Evidence Records from step 2 and<br>4 by using the BSI-ERVerifyTool.                                                 | The Evidence Records are valid with respect to specification in<br>RFC 4998 or RFC 6283, and contain the necessary data to prove<br>the integrity and authenticity of the XAIP versions. |  |
|            |                                                                                                                                            | The hash values of the Evidence Records from step 4 and one<br>Evidence Record of step 2 are equal and cover therefore the same<br>version of the XAIP/BIN.                              |  |
|            |                                                                                                                                            | In step 4 there is one Evidence Record for one Version ID.                                                                                                                               |  |
|            |                                                                                                                                            | In step 2 for each Version ID of the AOID, there is one Evidence<br>Record which contains evidences for this version of the XAIP/BIN.                                                    |  |
|            |                                                                                                                                            | The integrity and authenticity can be proven back to the time of<br>first archival.                                                                                                      |  |
| 6.         | Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No. 5 are to be repeated for LXAIP.                                   | See expected results of the test cases from No. 1 to No. 5 for<br>LXAIP.                                                                                                                 |  |
| Verdict    |                                                                                                                                            |                                                                                                                                                                                          |  |
|            |                                                                                                                                            |                                                                                                                                                                                          |  |

## **4.5.4.5 Archive Deletion or DeletePO Request**

## *4.5.4.5.1 S.4.5-01 – Deletion is only possible by authorised entities and with included reason*

| Identifier          |                                                                                                                                                                                                                 | S.4.5-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                                                                                                           |              |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                                                                                                                                 | MD:A5.1-29<br>MD:A5.1-30<br>M1:A4.4-3<br>M1:A5.0-3<br>PRP-8.1-11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                           |              |  |
| Test Purpose        |                                                                                                                                                                                                                 | The test shall<br>verify that deletion of data before their expiry date can only be performed by authorised users of an authorised IT application when the reason for<br>deletion is contained in the deletion request.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                           |              |  |
| Configuration       |                                                                                                                                                                                                                 | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                           |              |  |
| Pre-test conditions |                                                                                                                                                                                                                 | •<br>Tester has read/write permissions on the middleware<br>•<br>Authentication against the application with the credentials of a user who is authorised to access that just submitted XAIP/BIN but not authorised to delete<br>data before it is expired, is successfully.<br>•<br>XAIP<br>means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" may be supported, if configured.<br>•<br>The call of the function "ArchiveSubmissionRequest" or "PreservePO" with a XAIP_OK_Sig or BIN_OK_Sig as a parameter is possible. A positive<br>feedback is received. No error message or error code occurs. An AOID is assigned.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |                                                                                                           |              |  |
| Step                | Test sequence                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Expected Results                                                                                          | Observations |  |
| 1.                  | Using the interface function<br>"ArchiveDeletionRequest"<br>or "DeletePO" Request<br>and a valid AOID to request the deletion of an archived<br>XAIP_OK_SIG<br>or BIN. Do not provide a reason for<br>deletion. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | The call of the function with this AOID as a parameter is possible.                                       |              |  |
| 2.                  | Observe<br>the output of the interface function<br>"ArchiveDeletionResponse"<br>or "DeletePO"<br>Response.                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | A negative feedback is received. An error message or error code<br>occurs. The XAIP / BIN is not deleted. |              |  |
| 3.                  | Using the interface function<br>"ArchiveDeletionRequest"<br>or "DeletePO" Request<br>and the AOID to request the deletion of the archived<br>XAIP_OK_SIGorBIN<br>. Provide a reason for deletion.               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | The call of the function with this AOID as a parameter is possible.                                       |              |  |

|         | Identifier                                                                                                                                                                                              |                                       | S.4.5-01                                                                                                  |  |
|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|-----------------------------------------------------------------------------------------------------------|--|
| 4.      | Observe the output of the interface function<br>"ArchiveDeletionResponse"<br>or "DeletePO"<br>Response.                                                                                                 |                                       | A negative feedback is received. An error message or error code<br>occurs. The XAIP / BIN is not deleted. |  |
| 5.      | Authenticate against the application with the credentials<br>of a user who is authorised not only to access the XAIP<br>submitted but also to delete data before it is expired.                         |                                       | The user has been authenticated successfully.                                                             |  |
| 6.      | Using the interface function<br>"ArchiveDeletionRequest"<br>or "DeletePO" Request<br>and the AOID to request the deletion of the<br>XAIP_OK_SIG<br>or BIN<br>. Do not provide a reason for<br>deletion. |                                       | The call of the function with this AOID as a parameter is possible.                                       |  |
| 7.      | Observe the output of the interface function<br>"ArchiveDeletionResponse"<br>or "DeletePO"<br>Response.                                                                                                 |                                       | A negative feedback is received. An error message or error code<br>occurs. The XAIP / BIN is not deleted. |  |
| 8.      | Using the interface function<br>"ArchiveDeletionRequest"<br>or "DeletePO" Request<br>and the AOID to request the deletion of the<br>XAIP_OK_SIG<br>or BIN<br>. Provide a reason for deletion.           |                                       | The call of the function with this AOID as a parameter is possible.                                       |  |
| 9.      | Observe the output of the interface function<br>"ArchiveDeletionResponse"                                                                                                                               | or "DeletePO"<br>Response.            | A positive feedback is received. No error message or error code<br>occurs. The XAIP / BIN is deleted.     |  |
| 10.     | Conditional: If<br>No. 1 to No. 9 are to be repeated for LXAIP.                                                                                                                                         | LXAIP is implemented, test steps from | See expected results of the test cases from No. 1 to No. 9 for<br>LXAIP.                                  |  |
| Verdict |                                                                                                                                                                                                         |                                       |                                                                                                           |  |

| Identifier                                                                                                |                                                                                                                                                                             | S.4.5-02                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                                                                                                             |              |  |
|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|--------------|--|
| MD:A4.3-1<br>Requirement<br>MD:A6.1-1<br>MD:A6.1-2<br>M1:A3.2-1<br>M1:A3.2-2<br>M1:A4.0-1<br>MD:A5.1-30   |                                                                                                                                                                             | PRP-8.1-11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                             |              |  |
| Test Purpose                                                                                              |                                                                                                                                                                             | The test shall<br>verify that a deletion is always performed for the complete XAIP / BIN, including all versions of data objects.                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                             |              |  |
| Configuration                                                                                             |                                                                                                                                                                             | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                             |              |  |
| Pre-test conditions                                                                                       |                                                                                                                                                                             | •<br>Tester has read/write permissions on the middleware<br>•<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |                                                                                                             |              |  |
| Step                                                                                                      | Test sequence                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Expected Results                                                                                            | Observations |  |
| 1.                                                                                                        | Store an XAIP_OK<br>or BIN<br>using the interface function<br>"ArchiveSubmissionRequest"<br>or "PreservePO".                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | The call of the function with this XAIP / BIN as<br>a parameter is<br>possible.                             |              |  |
| 2.                                                                                                        | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned.             |              |  |
| 3.                                                                                                        | Using the interface function "ArchiveUpdateRequest" or<br>"UpdatePOC" Request and the AOID from step 2 add a<br>DXAIP_OK to the previously stored XAIP_OK<br>/<br>XAIP(BIN) |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | The call of the function with this DXAIP_OK and the AOID as<br>parameters is possible.                      |              |  |
| 4.<br>Observe the output of the interface function<br>"ArchiveUpdateResponse"<br>or "UpdatePOC" Response. |                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | A positive<br>feedback is received. No error message or error code<br>occurs. A new Version ID is received. |              |  |

|         | Identifier                                                                                                                                                                                                                                                                       | S.4.5-02                                                                                                              |  |
|---------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|--|
| 5.      | Using the interface function "ArchiveUpdateRequest"<br>or<br>"UpdatePOC" Request<br>and the AOID from step 2, to<br>change the XAIP_OK<br>or / XAIP(BIN)(e.g. changing<br>metadata).                                                                                             | The call of the function with this XAIP and the AOID as<br>parameters is possible.                                    |  |
| 6.      | Observe the output of the interface function<br>"ArchiveUpdateResponse"<br>or "UpdatePOC" Response.                                                                                                                                                                              | A positive feedback is received. No error message or error code<br>occurs. A new Version ID is received.              |  |
| 7.      | Using the interface function "ArchiveDeletionRequest"<br>or "DeletePO" Request and the AOID from step 2 to<br>delete the XAIP_OK<br>/ BIN.                                                                                                                                       | The call of the function with this AOID as a parameter is possible.                                                   |  |
| 8.      | Observe the output of the interface function<br>"ArchiveDeletionResponse"<br>or "DeletePO"<br>Response.                                                                                                                                                                          | A positive feedback is received. No error message or error code<br>occurs. The XAIP/BIN is deleted.                   |  |
| 9.      | Try to retrieve an earlier version of the XAIP / BIN by<br>using an "ArchiveRetrievalRequest" or "RetrievePO"<br>with SubjectOfRetrieval<br>"PO"" Request with<br>the AOID from step 2 without a Version ID and with all<br>possible and valid version ID's (see steps 4 and 6). | The call of the function is possible.                                                                                 |  |
| 10.     | Observe the output of the interface function<br>"ArchiveRetrievalResponse"<br>or "RetrievePO"<br>Response.                                                                                                                                                                       | A negative feedback will be received. An error message or error<br>code occurs. No XAIP/BIN is retrieved in any case. |  |
| 11.     | Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No. 10 are to be repeated for LXAIP.                                                                                                                                                                        | See expected results of the test cases from No. 1 to No. 10 for<br>LXAIP.                                             |  |
| Verdict |                                                                                                                                                                                                                                                                                  |                                                                                                                       |  |

| 4.5.4.5.3<br>S.4.5-03 – |  | Deletion requires reason, expiration and AOID |
|-------------------------|--|-----------------------------------------------|
|-------------------------|--|-----------------------------------------------|

| Identifier                                                                                                                                                                                                            |                                                                                                                     | S.4.5-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                 |              |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|--------------|
| Requirement                                                                                                                                                                                                           |                                                                                                                     | MD:A5.1-29<br>MD:A5.1-30<br>M1:A4.4-4<br>M1:A4.4-6<br>PRP-8.1-11<br>PRP-8.1-12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                 |              |
| Test Purpose                                                                                                                                                                                                          |                                                                                                                     | The test shall<br>verify that an "ArchiveDeletionRequest" or "DeletePO" will not delete an XAIP/BIN before its expiration, if the AOID is invalid or there is no reason<br>given for the deletion and that the log file will always log the deletion including the reason.                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                 |              |
| Configuration                                                                                                                                                                                                         |                                                                                                                     | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                 |              |
| Pre-test conditions                                                                                                                                                                                                   |                                                                                                                     | •<br>Tester has read/write permissions on the middleware<br>•<br>Tests S.4.5-01 and S.4.5-03 have been performed successfully<br>•<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>•<br>XAIP shall<br>be<br>supported, "LXAIP" may be supported, if configured<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>shall<br>be configured.<br>[TR-ESOR-TRANS]<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |                                                                                                 |              |
| Step                                                                                                                                                                                                                  | Test sequence                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Expected Results                                                                                | Observations |
| 1.                                                                                                                                                                                                                    | Store an XAIP_OK_SIG<br>or BIN<br>using the interface<br>function "ArchiveSubmissionRequest"<br>or<br>"PreservePO". |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | The call of the function with this XAIP / BIN as a parameter is<br>possible.                    |              |
| 2.                                                                                                                                                                                                                    | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned. |              |
| 3.<br>Using the interface function<br>"ArchiveDeletionRequest"<br>or "DeletePO" Request<br>and the AOID from step 2 to request the deletion of the<br>XAIP_OK_SIG<br>or BIN. Do not provide a reason for<br>deletion. |                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | The call of the function with this AOID as a parameter is possible.                             |              |

| Identifier |                                                                                                                                                                                                    | S.4.5-03                                                                                                       |  |
|------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--|
| 4.         | Observe the output of the interface function<br>"ArchiveDeletionResponse"<br>or "DeletePO" Response.                                                                                               | A negative feedback is<br>received. An error message or error code<br>occurs. The XAIP / BIN is not deleted.   |  |
| 5.         | Using the interface function<br>"ArchiveDeletionRequest"<br>or "DeletePO" Request<br>and an invalid AOID request the deletion of an XAIP or<br>BIN. Provide a reason for deletion.                 | The call of the function with this AOID as a parameter is possible.                                            |  |
| 6.         | Observe the output of the interface function<br>"ArchiveDeletionResponse"<br>or "DeletePO" Response.                                                                                               | A negative feedback is received. An error message or error code<br>occurs. No XAIP / BIN is deleted.           |  |
| 7.         | Using the interface function<br>"ArchiveDeletionRequest"<br>or "DeletePO" Request<br>and the AOID from step 2 request the deletion of the<br>XAIP_OK_SIG<br>or BIN. Provide a reason for deletion. | The call of the function with this AOID as a parameter is possible.                                            |  |
| 8.         | Observe the output of the interface function<br>"ArchiveDeletionResponse"<br>or "DeletePO" Response.                                                                                               | A positive feedback is received. No error message or error code<br>occurs. The XAIP / BIN is deleted.          |  |
| 9.         | Check the log file for the deletion procedure.                                                                                                                                                     | The log file contains all the data about the deletion of this XAIP /<br>BIN including the reason for deletion. |  |
| 10.        | Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No. 9 are to be repeated for LXAIP.                                                                                           | See expected results of the test cases from No. 1 to No. 9 for<br>LXAIP.                                       |  |
| Verdict    |                                                                                                                                                                                                    |                                                                                                                |  |

| Identifier            | S.4.5-04                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                  |              |
|-----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------|--------------|
| Requirement           | MD:A5.1-32<br>OVR-7.10-02<br>PRP-8.1-01<br>PRP-8.1-06<br>PRP-8.1-11<br>PRP-8.1-12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                  |              |
| Test Purpose          | The test shall<br>verify that every deletion is logged.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                  |              |
| Configuration         | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                  |              |
| Pre-test conditions   | •<br>Tester has read/write permissions on the middleware.<br>•<br>If required, perform identification and authentication.<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>•<br>XAIP shall<br>be<br>supported, "LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4. |                  |              |
| Step<br>Test sequence |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Expected Results | Observations |

| Identifier |                                                                                                                                                                                   | S.4.5-04                                                                                                       |  |
|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--|
| 1.         | Check for the existence of a log file or any other type of<br>records that is used by the middleware to log deletions.                                                            | There is such an event log.                                                                                    |  |
| 2.         | Store an XAIP_OK_SIG<br>or BIN<br>using the interface<br>function "ArchiveSubmissionRequest"<br>or<br>"PreservePO".                                                               | The call of the function with this XAIP / BIN as a parameter is<br>possible.                                   |  |
| 3.         | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                                       | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned.                |  |
| 4.         | Using the interface function "ArchiveDeletionRequest"<br>or "DeletePO" Request and the AOID from step 3,<br>delete the XAIP_OK_SIG<br>or theBIN<br>with a reason for<br>deletion. | The call of the function with this AOID as a parameter is possible.                                            |  |
| 5.         | Observe the output of the interface function<br>"ArchiveDeletionResponse"<br>or "DeletePO" Response.                                                                              | A positive feedback is received. No error message or error code<br>occurs. The XAIP / BIN is deleted.          |  |
| 6.         | Check the log for the log data of the deletion procedure.                                                                                                                         | The log contains all the data about the deletion of the XAIP / BIN<br>including the reason why it was deleted. |  |
| 7.         | Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No. 6 are to be repeated for LXAIP.                                                                          | See expected results of the test cases from No. 1 to No. 6 for<br>LXAIP.                                       |  |
| Verdict    |                                                                                                                                                                                   |                                                                                                                |  |

|                                                                   | Identifier                                                                                                                                                                         |                                          | S.4.5-05                                                                                                                                                                                                                                                                                                                                                                       |              |  |
|-------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|
| M1:A4.4-2<br>Requirement<br>PRP-8.1-11                            |                                                                                                                                                                                    |                                          |                                                                                                                                                                                                                                                                                                                                                                                |              |  |
| The test shall<br>Test Purpose                                    |                                                                                                                                                                                    |                                          | verify that the ArchiSafe module replies to an "ArchiveDeletionRequest" with an error message if the ECM/long-term storage has no deletion function<br>or the used storage media does not allow deletion.                                                                                                                                                                      |              |  |
| Configuration                                                     |                                                                                                                                                                                    | CONFIG_ArchiSafe                         |                                                                                                                                                                                                                                                                                                                                                                                |              |  |
| •<br>Pre-test conditions<br>•<br>•<br>•<br>•<br>BIN is restricted |                                                                                                                                                                                    | Tester has read/write/delete permissions | The user manual for the ECM/long-term storage is available<br>A storage system which supports deletion and a storage system which doesnt support deletion are present.<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured.<br>to the preservation object formats<br>described in clause 2, Notice 4. |              |  |
| Step                                                              | Test sequence                                                                                                                                                                      |                                          | Expected Results                                                                                                                                                                                                                                                                                                                                                               | Observations |  |
| 1.                                                                | Use a storage for the test,<br>which supports deletion.                                                                                                                            |                                          | ---                                                                                                                                                                                                                                                                                                                                                                            |              |  |
| 2.                                                                | Store an XAIP_OK_SIG<br>or BIN<br>using the interface<br>function "ArchiveSubmissionRequest"<br>or<br>"PreservePO".                                                                |                                          | The call of the function with this XAIP / BINas a parameter is<br>possible.                                                                                                                                                                                                                                                                                                    |              |  |
| 3.                                                                | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                                        |                                          | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned.                                                                                                                                                                                                                                                                                |              |  |
| 4.                                                                | Using the interface function "ArchiveDeletionRequest"33<br>or "DeletePO" Request<br>and the AOID from step 2<br>request the deletion of the XAIP_OK_SIG<br>or BIN<br>of<br>step 2. |                                          | The call of the function with this AOID as a parameter is possible.                                                                                                                                                                                                                                                                                                            |              |  |
| 5.                                                                | Observe the output of the interface function<br>"ArchiveDeletionResponse"<br>or "DeletePO"<br>Response.                                                                            |                                          | A positive feedback is received. No error message or<br>error code<br>occurs. The XAIP / BIN is deleted.                                                                                                                                                                                                                                                                       |              |  |
| 6.                                                                | Use a storage for the test which does not support                                                                                                                                  |                                          | ---                                                                                                                                                                                                                                                                                                                                                                            |              |  |

<span id="page-227-0"></span>

| 4.5.4.5.5 | S.4.5-05 – |  |  | Error message if deletion is not supported |
|-----------|------------|--|--|--------------------------------------------|
|-----------|------------|--|--|--------------------------------------------|

<sup>33</sup> The XAIP or BIN has become an expired XAIP or XAIP(BIN).

<span id="page-228-0"></span>

|         | Identifier                                                                               |                                                                               | S.4.5-05                                                                                        |  |
|---------|------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|--|
|         | deletion.                                                                                |                                                                               |                                                                                                 |  |
| 7.      | Store an XAIP_OK_SIG<br>function "ArchiveSubmissionRequest"<br>"PreservePO".             | or BIN<br>using the interface<br>or                                           | The call of the function with this XAIP / BIN as a parameter is<br>possible.                    |  |
| 8.      | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>Response. | or "PreservePO"                                                               | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned. |  |
| 9.      | Using the interface function<br>"ArchiveDeletionRequest"                                 | or "DeletePO" Request<br>and the AOID from step 8 to delete the XAIP / BIN34. | The call of the function with this AOID as a parameter is possible.                             |  |
| 10.     | Observe the output of the interface function<br>"ArchiveDeletionResponse"                | or "DeletePO"<br>Response.                                                    | An error message or error code is received.                                                     |  |
| Verdict |                                                                                          |                                                                               |                                                                                                 |  |

<sup>34</sup> The XAIP or BIN has become an expired XAIP or XAIP(BIN).

| Identifier          |                                                                                                                                                                      | S.4.5-06                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                       |              |  |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|--------------|--|
| Requirement         |                                                                                                                                                                      | M1:A4.4-5<br>PRP-8.1-11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                                                       |              |  |
|                     | Test Purpose                                                                                                                                                         | The test shall                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | verify that the ArchiSafe module is able to initiate a permanent deletion of XAIPs/BINs in the ECM/long-term storage. |              |  |
|                     | Configuration                                                                                                                                                        | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                       |              |  |
| Pre-test conditions |                                                                                                                                                                      | •<br>Tester has administration permissions on the file system<br>•<br>The middleware user manual is available<br>•<br>The user manual for the ECM/long-term storage is available<br>•<br>The ECM/long-term storage supports permanent deletion<br>•<br>Check the ArchiSafe documentation how the permanent deletion in the storage can be configured/initiated.<br>•<br>Configure ArchiSafe and the storage in such a way that the permanent deletion will be used.<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>•<br>XAIP shall<br>be<br>supported, "LXAIP" may be supported, if configured.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>shall<br>be configured. |                                                                                                                       |              |  |
| Step                | Test sequence                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Expected Results                                                                                                      | Observations |  |
| 1.                  | Store an XAIP_OK<br>or BIN<br>using the interface function<br>"ArchiveSubmissionRequest"<br>or "PreservePO".                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | The call of the function with this XAIP / BIN as a parameter is<br>possible.                                          |              |  |
| 2.                  | Observe the output of the interface function<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned.                       |              |  |
| 3.                  | Using the interface function<br>"ArchiveDeletionRequest"<br>or "DeletePO" Request<br>and<br>the AOID from step 2 to request the deletion of the<br>XAIP_OK<br>/ BIN. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | The call of the function with this AOID as a parameter is possible.                                                   |              |  |
| 4.                  | Observe the output of the interface function<br>"ArchiveDeletionResponse"<br>or "DeletePO" Response.                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | A positive feedback is received. No error message or error code<br>occurs. The XAIP / BIN is deleted.                 |              |  |
| 5.                  | Use all available (administration) functions of ArchiSafe<br>and the storage for attempting to recover the XAIP.                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | The deleted XAIPs / BINs cannot be recovered.                                                                         |              |  |

*4.5.4.5.6 S.4.5-06 – Deletion should be possible in an irreversible manner*

|         | Identifier                                                                                               | S.4.5-06                                                                 |  |
|---------|----------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|--|
| 6.      | Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No. 5 are to be repeated for LXAIP. | See expected results of the test cases from No. 1 to No. 5 for<br>LXAIP. |  |
| Verdict |                                                                                                          |                                                                          |  |

## **4.5.4.6 ArchiveData or Search Request**

## **Pre-supposition**:

A product which claims to to comply with the "ArchiveDataRequest/-Response" - or the "Search Request/Response" functionality according to M.1-04 of this TR has to pass the following test case or prove that it supports functional analogous functions.

| Identifier          |                                                                                                                                                                                                     | S.4.6-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |              |  |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|--|--|
|                     | Requirement                                                                                                                                                                                         | M1:A3.2-1<br>M1:A3.2-2<br>M1:A4.0-1<br>M1:A4.6-1<br>M1:A4.6-2<br>M1:A4.6-3<br>PRP-8.1-09<br>PRP-8.1-10                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |              |  |  |
| Test Purpose        |                                                                                                                                                                                                     | The test shall<br>verify that the "ArchiveDataRequest" or "Search" will retrieve and return a data element from an XAIP/BIN, if the request is performed with a valid<br>AOID and at least<br>one valid dataLocation parameter.<br>The test shall<br>verify that data elements that are retrieved with an "ArchiveDataRequest" or "Search" are returned as they have been stored originally without being<br>changed.<br>The test shall<br>verify that an "ArchiveDataRequest" or "Search" with an invalid AOID returns an understandable error code or error message.    |              |  |  |
| Configuration       |                                                                                                                                                                                                     | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |              |  |  |
| Pre-test conditions |                                                                                                                                                                                                     | •<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>•<br>XAIP shall<br>be<br>supported, "LXAIP" may be supported, if configured.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4.<br>•<br>Either the S.4 interface or the TS119512 interface S.512 pursuant to [TR-ESOR-TRANS]<br>shall<br>be configured.<br>•<br>The test dispenses if the pre-supposition is not valid. |              |  |  |
| Step                | Test sequence                                                                                                                                                                                       | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Observations |  |  |
| 1.                  | Store several XAIP_OK's or BIN's using the interface<br>The calls of the function with this XAIP as a parameter are<br>functions "ArchiveSubmissionRequest"or<br>possible.<br>"PreservePO"-Request. |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |              |  |  |

*4.5.4.6.1 S.4.6-01 – Archive Data or Search Request shall require valid AOID and dataLocation*

|     | Identifier                                                                                                                                                                                                                                                                                                                                          | S.4.6-01                                                                                                                                          |  |
|-----|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 2.  | Observe the output of the interface functions<br>"ArchiveSubmissionResponse"<br>or "PreservePO"<br>Response.                                                                                                                                                                                                                                        | Positive feedbacks are received. No error messages or error codes<br>are<br>returned. A list of AOIDs has been assigned.                          |  |
| 3.  | If the interface function "ArchiveDataRequest" or the<br>"Search"<br>Request<br>is implemented, use the interface<br>function "ArchiveDataRequest" or the "Search"<br>Request<br>with one<br>AOID from step 2 with one valid<br>dataLocation parameter to retrieve a data element that<br>has been stored in the XAIP_OK<br>/ BIN<br>in step 1.     | The call of the function with these parameters is possible.                                                                                       |  |
| 4.  | Observe the output of the interface function<br>"ArchiveDataResponse"<br>or the "Search"<br>Response.                                                                                                                                                                                                                                               | A positive feedback is received. No error message or error code is<br>returned. The intended data element is received.                            |  |
| 5.  | Compare the retrieved data element with the version that<br>has originally been stored in the XAIP / BIN in step 1.                                                                                                                                                                                                                                 | The data elements are equal.                                                                                                                      |  |
| 6.  | Use the interface function "ArchiveDataRequest" or the<br>"Search"<br>Request<br>with all<br>the AOIDs from step 2 with<br>one<br>valid dataLocation parameter to retrieve the data<br>elements that has been stored in the XAIP_OK's / BIN's<br>in step 1.                                                                                         | The call of the function with these parameters is not possible at all<br>or an error occurs.                                                      |  |
| 7.  | If the interface function "ArchiveDataRequest" or the<br>"Search"<br>Request<br>is implemented, use the interface<br>function "ArchiveDataRequest" or the "Search"<br>Request<br>with one<br>AOID from step 2 with two<br>valid<br>dataLocation parameters to retrieve a data element that<br>has been stored in the XAIP_OK<br>/ BIN<br>in step 1. | The call of the function with these parameters is possible.                                                                                       |  |
| 8.  | Observe the output of the interface function<br>"ArchiveDataResponse"<br>or the "Search"<br>Response.                                                                                                                                                                                                                                               | A positive feedback is received. No error message or error code is<br>returned. The data elements<br>of the addressed XAIP / BIN are<br>received. |  |
| 9.  | Compare the retrieved data element with the version that<br>has originally been stored in the XAIP / BIN in step 1.                                                                                                                                                                                                                                 | The<br>data elements are equal.                                                                                                                   |  |
| 10. | If the interface function "ArchiveDataRequest"<br>or the<br>"Search"<br>Request, use the interface function<br>"ArchiveDataRequest" or the "Search"<br>Request<br>with<br>an invalid AOID and an arbitrary dataLocation<br>parameter.                                                                                                               | The call of the function with these parameters is possible.                                                                                       |  |

|         | Identifier                                                                                                                                                                                                                                   |  | S.4.6-01                                                                                                     |  |
|---------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--------------------------------------------------------------------------------------------------------------|--|
| 11.     | Observe the output of the interface function<br>"ArchiveDataResponse"<br>or the "Search"<br>Response.                                                                                                                                        |  | A negative feedback is received. An error message or error code is<br>returned. No data element is received. |  |
| 12.     | If the interface function "ArchiveDataRequest"<br>or the<br>"Search"<br>Request, use the interface function<br>"ArchiveDataRequest"<br>or the "Search"<br>Request<br>with<br>one AOID from step 2 with an invalid dataLocation<br>parameter. |  | The call of the function with these parameters is possible.                                                  |  |
| 13.     | Observe the output of the interface function<br>"ArchiveDataResponse"<br>or the "Search"<br>Response.                                                                                                                                        |  | A negative feedback is received. An error message or error code is<br>returned. No data element is received. |  |
| 14.     | Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No. 13 are to be repeated for LXAIP.                                                                                                                                    |  | See expected results of the test cases from No. 1 to No. 13 for<br>LXAIP.                                    |  |
| Verdict |                                                                                                                                                                                                                                              |  |                                                                                                              |  |

| Identifier          |                                                                                                                                                     | S.4.7-01                                                                                                                                                                                                                                                                                                                                     |                                                                                                                           |              |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------|--------------|
| Requirement         |                                                                                                                                                     | M1:A4.0-2                                                                                                                                                                                                                                                                                                                                    |                                                                                                                           |              |
| Test Purpose        |                                                                                                                                                     | The test shall<br>verify that the ArchiSafe Module's functionality is not negatively affected by false or incorrectly parametrised requests.<br>Note: Keep in mind to skip any step which will not supported by the TOT, especially regarding the "ArchiveSubmissionRequests"<br>or "PreservePO" Request                                     |                                                                                                                           |              |
| Configuration       |                                                                                                                                                     | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                             |                                                                                                                           |              |
| Pre-test conditions |                                                                                                                                                     | •<br>If required, perform identification and authentication<br>•<br>Developer documentation is available, which contains information about existing restrictions for the length and admissible characters of an AOID<br>•<br>Either the S.4 interface or the TS119512 interface S.512 pursuant to [TR-ESOR-TRANS]<br>shall<br>be configured. |                                                                                                                           |              |
| Step                | Test sequence                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                              | Expected Results                                                                                                          | Observations |
| 1.                  | Use the interface function "ArchiveSubmissionRequest"<br>or "PreservePO" with no parameters.                                                        |                                                                                                                                                                                                                                                                                                                                              | The request is answered with a clear and understandable error<br>message or an error code.                                |              |
| 2.                  | Use the interface function "ArchiveSubmissionRequest"<br>or "PreservePO"<br>with a binary data object with 0<br>bytes length.                       |                                                                                                                                                                                                                                                                                                                                              | The request is performed correctly. An AOID is returned.<br>The object can be retrieved without errors and modifications. |              |
| 3.                  | Use the interface function "ArchiveSubmissionRequest"<br>or "PreservePO"<br>with a very large archive object<br>(several Gigabytes, at least four). |                                                                                                                                                                                                                                                                                                                                              | The request is performed correctly. An AOID is returned.<br>The object can be retrieved without errors and modifications. |              |
| 4.                  | Use the interface function "ArchiveSubmissionRequest"<br>or "PreservePO" with an archive object which<br>contains nested XAIPs (at least 5 levels). |                                                                                                                                                                                                                                                                                                                                              | The request is performed correctly. An AOID is returned.<br>The object can be retrieved without errors and modifications. |              |
| 5.                  | Use the interface function "ArchiveUpdateRequest" or<br>"UpdatePOC" Request with no parameters.                                                     |                                                                                                                                                                                                                                                                                                                                              | The request is answered with a clear and understandable error<br>message or an error code.                                |              |
| 6.                  | Use the interface function "ArchiveUpdateRequest" or<br>"UpdatePOC" Request with an AOID that contains<br>invalid characters.                       |                                                                                                                                                                                                                                                                                                                                              | The request is answered with a clear and understandable error<br>message or an error code.                                |              |
| 7.                  | Use the interface function "ArchiveUpdateRequest" or<br>"UpdatePOC" Request with an AOID that contains too<br>many characters.                      |                                                                                                                                                                                                                                                                                                                                              | The request is answered with a clear and understandable error<br>message or an error code.                                |              |

| Identifier |                                                                                                      | S.4.7-01                                                                                                                                     |                                                                                                                                             |  |
|------------|------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|--|
| 8.         | sections of an archived XAIP which do not exist yet.                                                 | Use the interface function "ArchiveUpdateRequest" or<br>"UpdatePOC" Request and try to update elements and                                   | The update will be performed. The elements and sections will<br>added only to the XAIP.<br>Existing elements/sections will not be modified. |  |
| 9.         | "RetrievePO"<br>"PO"" Request with no parameters.                                                    | Use the interface function "ArchiveRetrievalRequest" or<br>with SubjectOfRetrieval                                                           | The request is answered with a clear and understandable error<br>message or an error code.                                                  |  |
| 10.        | "RetrievePO"<br>"PO"" Request with an AOID that contains invalid<br>characters.                      | Use the interface function "ArchiveRetrievalRequest" or<br>with SubjectOfRetrieval                                                           | The request is answered with a clear and understandable error<br>message or an error code.                                                  |  |
| 11.        | "RetrievePO"<br>characters.                                                                          | Use the interface function "ArchiveRetrievalRequest" or<br>with SubjectOfRetrieval<br>"PO"" Request with an AOID that contains too many      | The request is answered with a clear and understandable error<br>message or an error code.                                                  |  |
| 12.        | "RetrievePO"<br>characters.                                                                          | Use the interface function "ArchiveRetrievalRequest" or<br>with SubjectOfRetrieval<br>"PO"" Request with a version ID that contains invalid  | The request is answered with a clear and understandable error<br>message or an error code.                                                  |  |
| 13.        | "RetrievePO"<br>characters.                                                                          | Use the interface function "ArchiveRetrievalRequest" or<br>with SubjectOfRetrieval<br>"PO"" Request with a version ID that contains too many | The request is answered with a clear and understandable error<br>message or an error code.                                                  |  |
| 14.        | "RetrievePO" with SubjectOfRetrieval<br>"Evidence" with no parameters.                               | Use the interface function "ArchiveEvidenceRequest" or                                                                                       | The request is answered with a clear and understandable error<br>message or an error code.                                                  |  |
| 15.        | "RetrievePO" with SubjectOfRetrieval<br>"Evidence" with an AOID that contains invalid<br>characters. | Use the interface function "ArchiveEvidenceRequest" or                                                                                       | The request is answered with a clear and understandable error<br>message or an error code.                                                  |  |
| 16.        | "RetrievePO" with SubjectOfRetrieval<br>characters.                                                  | Use the interface function "ArchiveEvidenceRequest" or<br>"Evidence" with an AOID that contains too many                                     | The request is answered with a clear and understandable error<br>message or an error code.                                                  |  |

|     | Identifier                                                                                                                       |                                                                                                               | S.4.7-01                                                                                   |  |
|-----|----------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------|--|
| 17. | "RetrievePO" with SubjectOfRetrieval<br>characters.                                                                              | Use the interface function "ArchiveEvidenceRequest" or<br>"Evidence" with a version ID that contains invalid  | The request is answered with a clear and understandable error<br>message or an error code. |  |
| 18. | "RetrievePO" with SubjectOfRetrieval<br>characters.                                                                              | Use the interface function "ArchiveEvidenceRequest" or<br>"Evidence" with a version ID that contains too many | The request is answered with a clear and understandable error<br>message or an error code. |  |
| 19. | If implemented, use the interface function<br>"ArchiveDataRequest" or the "Search"<br>an AOID that contains invalid characters.  | Request<br>with                                                                                               | The request is answered with a clear and understandable error<br>message or an error code. |  |
| 20. | If implemented, use the interface function<br>"ArchiveDataRequest" or the "Search"<br>an AOID that contains too many characters. | Request<br>with                                                                                               | The request is answered with a clear and understandable error<br>message or an error code. |  |
| 21. | If implemented, use the interface function<br>"ArchiveDataRequest" or the "Search"<br>invalid characters.                        | Request<br>with a<br>valid AOID and a dataLocation parameter that contains                                    | The request is answered with a clear and understandable error<br>message or an error code. |  |
| 22. | If implemented, use the interface function<br>"ArchiveDataRequest" or the "Search"<br>too many characters.                       | Request<br>with a<br>valid AOID and a dataLocation parameter that contains                                    | The request is answered with a clear and understandable error<br>message or an error code. |  |
| 23. | "DeletePO" Request with no parameters.                                                                                           | Use the interface function "ArchiveDeletionRequest" or                                                        | The request is answered with a clear and understandable error<br>message or an error code. |  |
| 24. | "DeletePO" Request with an AOID that contains<br>invalid characters.                                                             | Use the interface function "ArchiveDeletionRequest" or                                                        | The request is answered with a clear and understandable error<br>message or an error code. |  |
| 25. | many characters.                                                                                                                 | Use the interface function "ArchiveDeletionRequest" or<br>"DeletePO" Request with an AOID that contains too   | The request is answered with a clear and understandable error<br>message or an error code. |  |
| 26. |                                                                                                                                  | Use the interface function "ArchiveDeletionRequest" or<br>"DeletePO" Request with an AOID that contains wild  | The request is answered with a clear and understandable error<br>message or an error code. |  |

| Identifier |                                  | S.4.7-01 |  |
|------------|----------------------------------|----------|--|
|            | card characters like "*" or "?". |          |  |
| Verdict    |                                  |          |  |

#### *4.5.4.6.3 S.4.8-01 – Performance Requirements*

| Identifier                                                                                                                                                                                                                                            |                                                                                                                                                                                                                                                                                                                                               | S.4.8-01                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                         |  |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|--|
| Requirement                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                               | There is actually no requirement in the TR, but the TOT shall<br>ensure a suitable performance while executing Archive Requests                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                         |  |
| Test Purpose                                                                                                                                                                                                                                          |                                                                                                                                                                                                                                                                                                                                               | The test shall<br>verify that the TOT is able to ensure a suitable performance while executing Archive Requests.                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                         |  |
|                                                                                                                                                                                                                                                       | Configuration                                                                                                                                                                                                                                                                                                                                 | CONFIG_ArchiSafe                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                         |  |
|                                                                                                                                                                                                                                                       | Pre-test conditions                                                                                                                                                                                                                                                                                                                           | •<br>•<br>•<br>•<br>•<br>XAIP shall<br>be<br>•<br>•<br>BIN is restricted<br>•<br>•<br>•<br>< 50 MB<br>< 100 MB<br>< 500 MB<br>< 1 GB MB<br>> 1 GB.<br>• | The middleware documentation /user manual is available<br>The documentation / user manual for the ECM/long-term storage is available<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].<br>supported, "LXAIP" may be supported, if configured.<br>Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>to the preservation object formats<br>described in clause 2, Notice 4.<br>The execution of the necessary Archive Requests is possible with the help of a configurable time control.<br>About 30 threads can be started for about 60 seconds.<br>There are 5 types of (L)XAIPs ready to be used for a PreservePO-Request (S512) or ArchiveSubmisseionRequest (S.4): | shall<br>be configured. |  |
| Step                                                                                                                                                                                                                                                  | Test<br>sequence                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                         | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Observations            |  |
| 1.                                                                                                                                                                                                                                                    | Check the documentation of the TOT and (optionally) of<br>the ECM/long-term storage, if there are any assertions<br>and related conditions or constraints regarding the<br>performance of the TOT while executing Archive<br>Requests (means for example: how long does proceeding<br>of a request with an archive object of the size x take) |                                                                                                                                                         | The documentation of ArchiSafe and (optional) of the ECM/long<br>term storage contain some assertions and related conditions or<br>constraints regarding the performance of the TOT while executing<br>Archive Requests                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                         |  |
| 2.<br>Store an XAIP_OK or BIN_OK using the interface<br>function "ArchiveSubmissionRequest" or<br>"PreservePO" and measure the assured performance<br>for executing the request, i.e. the time the<br>"ArchiveSubmissionRequest" or "PreservePO" will |                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                         | The measure confirms the assured performance                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                         |  |

| Identifier |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | S.4.8-01                                     |  |
|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|--|
|            | be answered by an "ArchiveSubmissionResponse"<br>or<br>"PreservePO" Response Please take care to just<br>measure the TOT performance, not other<br>modules/systems.                                                                                                                                                                                                                                                                                                                                                                                                   |                                              |  |
| 3.         | Store a<br>XAIP_OK_Sig or BIN_OK_Sig using the<br>interface function "ArchiveSubmissionRequest" or<br>"PreservePO" and measure the assured performance<br>to execute the request, i.e. the time the<br>"ArchiveSubmissionRequest" or "PreservePO" will<br>be answered by an "ArchiveSubmissionResponse"<br>or<br>"PreservePO" Response. Please take care to just<br>measure the TOT performance, not other<br>modules/systems.                                                                                                                                        | The measure confirms the assured performance |  |
| 4.         | Repeat steps 2 and 3 at least with the<br>5<br>data objects<br>which differ<br>types, defined in the pre-test-conditions<br>notably in the size.                                                                                                                                                                                                                                                                                                                                                                                                                      | The measure confirms the assured performance |  |
| 5.         | Use the AOID retrieved in step 2 for calling an<br>"ArchiveRetrievalRequest" or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" Request for the<br>retrieval of the corresponding XAIP_OK / BIN_OK<br>and measure the assured performance to execute the<br>request, i. e. measure the time the<br>"ArchiveRetrievalRequest" or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" Request will be<br>answered by an "ArchiveRetrievalResponse"<br>or<br>"RetrievePO" Response. Please take care to just<br>measure the TOT performance, not other<br>modules/systems. | The measure confirms the assured performance |  |
| 6.         | Use the AOID retrieved in step for calling an<br>"ArchiveRetrievalRequest" or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" Request for the<br>retrieval of the corresponding XAIP_OK_Sig or<br>BIN_OK_Sig and measure the assured performance to<br>execute the request, i. e. measure the time the<br>"ArchiveRetrievalRequest" or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" Request will be<br>answered by an "ArchiveRetrievalResponse"<br>or                                                                                                           | The measure confirms the assured performance |  |

|         | Identifier                                                                                                    | S.4.8-01                                                                    |  |
|---------|---------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|--|
|         | "RetrievePO" Response. Please take care to just<br>measure the TOT performance, not other<br>modules/systems. |                                                                             |  |
| 7.      | Repeat steps 5 and 6 with the AOID's retrieved in step 4                                                      | The measure confirms the assured performance                                |  |
| 8.      | Conditional: If<br>LXAIP is implemented, test steps from<br>No. 1 to No. 7<br>are to be repeated for LXAIP.   | See expected results of the test cases from No. 1 to No. 7<br>for<br>LXAIP. |  |
| Verdict |                                                                                                               |                                                                             |  |

#### **4.5.4.7 Verify Request or ValidateEvidence Request**

The test cases of the "VerifyRequest" or "ValidateEvidence Request"- function of the interface S.1 (sec. [4.5.1.1](#page-152-3) [VerifyRequest\)](#page-152-3) are also relevant here.

*4.5.4.7.1 S.4.9-01 – Verify or ValidateEvidence Request – Validation of digital signature, of Evidence Records and supplemented evidence data (including certificates, certificate status information and certificate path validation according to the signature validation policy) and of Archive Information Package (AIP)*

| Identifier          | S.1.1-01                                                                                                                                                                                                                                                                                                                |  |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|
| Requirement         | M1:A3.2-1                                                                                                                                                                                                                                                                                                               |  |  |
|                     | M1:A3.2-2                                                                                                                                                                                                                                                                                                               |  |  |
|                     | M1:A4.0-1                                                                                                                                                                                                                                                                                                               |  |  |
|                     | M2:A5.1-10                                                                                                                                                                                                                                                                                                              |  |  |
|                     | M2:A5.1-11                                                                                                                                                                                                                                                                                                              |  |  |
|                     | OVR-6.2-06                                                                                                                                                                                                                                                                                                              |  |  |
|                     | OVR-7.5-01                                                                                                                                                                                                                                                                                                              |  |  |
|                     | PRP-8.1-08                                                                                                                                                                                                                                                                                                              |  |  |
|                     | OVR-9.3-01                                                                                                                                                                                                                                                                                                              |  |  |
|                     | OVR-9.3-02                                                                                                                                                                                                                                                                                                              |  |  |
| Test Purpose        | The function is able to verify whether the user certificate used to generate the digital signature was valid at the time the digital signature was generated (see Chapter<br>5.1.3). Validity validation shall<br>be complete, i.e. it includes the entire certificate<br>chain back to a trustworthy root certificate. |  |  |
|                     | The Cryptographic Module shall<br>be able to verify digital signatures (advanced and qualified electronic signatures and seals).                                                                                                                                                                                        |  |  |
|                     | Qualified time stamps with digital signatures as well as Evidence Records as DXAIPs<br>shall<br>be verifiable, i.e. the validity of the time stamp digital signature at the<br>time of time stamp generation shall<br>be verified.                                                                                      |  |  |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                           |  |  |
| Pre-test conditions | •<br>An XAIP_OK_Sig_Q / BIN_OK_Sig_Q is present. XAIP_OK_Sig_Q / BIN_OK_Sig_Q is a XAIP_OK_SIG / BIN<br>with qualified<br>electronic signature<br>or seal or time stamp                                                                                                                                                 |  |  |
|                     | •<br>An XAIP_OK_Sig_A / BIN_OK_Sig_A is present. XAIP_OK_Sig_A / BIN_OK_Sig_A is a XAIP_OK_SIG / BIN<br>with advanced<br>electronic signature<br>or seal or time stamp                                                                                                                                                  |  |  |
|                     | •<br>An XAIP_OK_Sig_Q_ERS is present. XAIP_OK_Sig_Q_ERS is a XAIP_OK_SIG_OK_ER<br>with qualified<br>electronic signature or seal or time stamp<br>and at least one evidence record                                                                                                                                      |  |  |
|                     | •<br>An XAIP_OK_Sig_A_ERS is present. XAIP_OK_Sig_A_ERS is a XAIP_OK_SIG_OK_ER<br>with advanced<br>electronic signature or seal or time stamp<br>and at least one evidence record                                                                                                                                       |  |  |
|                     | •<br>An XAIP_NOK_Sig_Q / BIN_NOK_Sig_Q is present. XAIP_NOK_Sig_Q / BIN_NOK_Sig_Q is a XAIP_NOK_SIG<br>/ BIN_NOK_SIG<br>with qualified<br>electronic signature or seal or time stamp                                                                                                                                    |  |  |

|                                                                                                                                                                                                                                                                                                                    | Identifier                                                                                                                                                                                             |                                                                                                                                                                             | S.1.1-01                                                                                                                                                                                                                           |                         |  |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|--|
| •<br>•<br>stamp and at least one evidence record<br>•<br>stamp and at least one evidence record<br>•<br>evidence record<br>•<br>developer documents are present<br>•<br>referenced to an XAIP_OK<br>•<br>stamp referenced to an XAIP_OK<br>•<br>developer documents are present<br>•<br>•<br>•<br>XAIP shall<br>be |                                                                                                                                                                                                        | An XAIP_NOK_Sig_A / BIN_NOK_Sig_A is present. XAIP_NOK_Sig_A / BIN_NOK_Sig_A is a XAIP_NOK_SIG<br>/ BIN_NOK_SIG with advanced<br>electronic signature or seal or time stamp |                                                                                                                                                                                                                                    |                         |  |
|                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                        |                                                                                                                                                                             | An XAIP_NOK_Sig_Q_ERS is present. XAIP_NOK_Sig_Q_ERS is a XAIP_NOK_SIG_OK_ER<br>with qualified<br>electronic signature or seal or time                                                                                             |                         |  |
|                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                        |                                                                                                                                                                             | An XAIP_NOK_Sig_A_ERS is present. XAIP_NOK_Sig_A_ERS is a XAIP_NOK_SIG_OK_ER<br>with advanced<br>electronic signature or seal or time                                                                                              |                         |  |
|                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                        |                                                                                                                                                                             | An XAIP_NOK_ERS is present. XAIP_NOK_ERS is a XAIP_NOK_ER<br>with qualified<br>electronic signature or seal or time stamp and at least one                                                                                         |                         |  |
|                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                        |                                                                                                                                                                             |                                                                                                                                                                                                                                    |                         |  |
|                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                        |                                                                                                                                                                             | A DXAIP_OK_SIG is present. DXAIP_OK_SIG is a DXAIP_OK_SIG<br>with qualified<br>or advanced electronic signature or seal or (qualified) time stamp                                                                                  |                         |  |
|                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                        |                                                                                                                                                                             | A DXAIP_NOK_SIG is present. DXAIP_NOK_SIG is a DXAIP_NOK_SIG<br>with qualified<br>or advanced electronic signature or seal or (qualified) time                                                                                     |                         |  |
|                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                        |                                                                                                                                                                             |                                                                                                                                                                                                                                    |                         |  |
|                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                        | XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].                                                                                                                       |                                                                                                                                                                                                                                    |                         |  |
|                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                        | DXAIP means "DXAIP" or "DLXAIP" pursuant to<br>[TR-ESOR-F].                                                                                                                 |                                                                                                                                                                                                                                    |                         |  |
|                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                        | supported, "LXAIP" may be supported, if configured.                                                                                                                         |                                                                                                                                                                                                                                    |                         |  |
|                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                        | •<br>•<br>BIN is restricted                                                                                                                                                 | Either the S.4 interface or the TS119512 interface S.512 in the profiling of<br>[TR-ESOR-TRANS]<br>to the preservation object formats<br>described in clause 2, Notice 4.                                                          | shall<br>be configured. |  |
|                                                                                                                                                                                                                                                                                                                    | •                                                                                                                                                                                                      |                                                                                                                                                                             | if the Cryptographic Module isn't a certified signature product (e. g. according to BSI-TR-03112) a suitable test-bed should<br>be used to verify the<br>correctness of the implementation of the signature-related functionality. |                         |  |
| Step                                                                                                                                                                                                                                                                                                               | Test sequence                                                                                                                                                                                          |                                                                                                                                                                             | Expected Results                                                                                                                                                                                                                   | Observations            |  |
| 1.                                                                                                                                                                                                                                                                                                                 | Transfer the archival information package<br>XAIP_OK_Sig_Q / BIN_OK_Sig_Q (see pre-test<br>conditions)<br>to the TOT using the interface function<br>"VerifyRequest"<br>or "ValidateEvidence" Request. |                                                                                                                                                                             | The call of the function with this XAIP / BIN as parameter is<br>possible.                                                                                                                                                         |                         |  |
| 2.                                                                                                                                                                                                                                                                                                                 | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                                                 |                                                                                                                                                                             | A positive feedback will be received; no error message or error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response.                                                               |                         |  |
| 3.                                                                                                                                                                                                                                                                                                                 | Examine the Verification Report if the validity validation<br>would be done by the Cryptographic Module.                                                                                               |                                                                                                                                                                             | The validity validation shall<br>be correct and complete, i.e. it<br>includes the entire certificate chain back to a trustworthy root<br>certificate.                                                                              |                         |  |

|     | Identifier                                                                                                                                                                                                                                 | S.1.1-01                                                                                                                                                               |
|-----|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 4.  | Transfer the archival information package<br>XAIP_OK_Sig_A / BIN_OK_Sig_A (see pre-test<br>conditions)<br>to the TOT,<br>using the interface function<br>"VerifyRequest"<br>or "ValidateEvidence" Request.                                 | The call of the function with this XAIP / BIN as parameter is<br>possible.                                                                                             |
| 5.  | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                                                                                     | A positive feedback will be received; no error message or error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response.   |
| 6.  | Examine the Verification Report if the validity validation<br>would be done by the Cryptographic Module.                                                                                                                                   | The validity validation shall<br>be correct and complete, i.e. it<br>includes the entire certificate chain back to a trustworthy root<br>certificate.                  |
| 7.  | Transfer the archival information package<br>XAIP_NOK_Sig_Q / BIN_NOK_Sig_Q (see pre-test<br>conditions)<br>to the TOT using the interface function<br>"VerifyRequest" or "ValidateEvidence"<br>Request.asking for a Validation Report.    | The call of the function with this XAIP<br>/ BIN as parameter is<br>possible.                                                                                          |
| 8.  | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                                                                                     | A negative feedback will be received with error message and error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response. |
| 9.  | Examine the Verification Report if the validity validation<br>would be done by the Cryptographic Module.                                                                                                                                   | The Verification Reports includes Verification Report structures<br>for the digital signatures, time stamps, Evidence Records and the<br>XAIP.                         |
| 10. | Transfer the archival information package<br>XAIP_NOK_Sig_A / BIN_NOK_Sig_A (see pre-test<br>conditions)<br>to the TOT using<br>the interface function<br>"VerifyRequest" or "ValidateEvidence"<br>Request.asking for a Validation Report. | The call of the function with this XAIP / BIN as parameter is<br>possible.                                                                                             |
| 11. | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                                                                                     | A negative feedback will be received with error message and error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response. |
| 12. | Examine the Verification Report if the validity validation<br>would be<br>done by the Cryptographic Module.                                                                                                                                | The Verification Reports includes verification report structures for<br>the digital signatures, time stamps, Evidence Records and the<br>XAIP.                         |
| 13. | Transfer the archival information package                                                                                                                                                                                                  | The call of the function with this XAIP as parameter is possible.                                                                                                      |

|     | Identifier                                                                                                                                                                                                                       |                       | S.1.1-01                                                                                                                                                                                                                 |  |
|-----|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|     | XAIP_OK_Sig_Q_ERS (see pre-test<br>conditions)<br>to the<br>TOT using the interface function "VerifyRequest"<br>or<br>"ValidateEvidence" Request.                                                                                |                       |                                                                                                                                                                                                                          |  |
| 14. | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                                                                           |                       | A positive feedback will be received; no error message or error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response. The validation of the ER was<br>also successful.    |  |
| 15. | Examine the Verification Report if the validity validation<br>would be done by the Cryptographic Module.                                                                                                                         |                       | The validity validation shall<br>be correct and complete, i.e. it<br>includes the entire certificate chain back to a trustworthy root<br>certificate.                                                                    |  |
| 16. | Transfer the archival information package<br>XAIP_OK_Sig_A_ERS (see pre-test<br>conditions)<br>to the<br>TOT,<br>using the interface function "VerifyRequest"<br>or<br>"ValidateEvidence" Request.                               |                       | The call of the function with this XAIP as parameter is possible.                                                                                                                                                        |  |
| 17. | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                                                                           |                       | A positive feedback will be received; no error message or error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response. The validation of<br>the ER was<br>also successful. |  |
| 18. | Examine the Verification Report if the validity validation<br>would be done by the Cryptographic Module.                                                                                                                         |                       | The validity validation shall<br>be correct and complete, i.e. it<br>includes the entire certificate chain back to a trustworthy root<br>certificate.                                                                    |  |
| 19. | Transfer the archival information package<br>XAIP_NOK_Sig_Q_ERS (see pre-test<br>conditions)<br>to the<br>TOT using the interface function "VerifyRequest" or<br>"ValidateEvidence" Request asking for a<br>Verification Report. |                       | The call of the function with this XAIP as parameter is possible.                                                                                                                                                        |  |
| 20. | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                                                                           |                       | A negative feedback will be<br>received with error message and error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response.                                                |  |
| 21. | Examine the Verification Report if the validity validation<br>would be done by the Cryptographic Module.                                                                                                                         |                       | The Verification Reports includes verification report structures for<br>the digital signatures, time stamps, Evidence Records and the<br>XAIP.                                                                           |  |
| 22. | Transfer the archival information package<br>XAIP_NOK_Sig_A_ERS (see pre-test                                                                                                                                                    | conditions)<br>to the | The call of the function with this XAIP as parameter is possible.                                                                                                                                                        |  |

|     | Identifier                                                                                                                                                                                                                | S.1.1-01                                                                                                                                                                                                                        |  |
|-----|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|     | TOT using the interface function "VerifyRequest" or<br>"ValidateEvidence" Request asking for a<br>Vvalidation Report.                                                                                                     |                                                                                                                                                                                                                                 |  |
| 23. | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                                                                    | A negative feedback will be received with error message and error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response.                                                          |  |
| 24. | Examine the Verification Report if the validity validation<br>would be<br>done by the Cryptographic Module.                                                                                                               | The Verification Reports includes verification report structures for<br>the digital signatures, time stamps, Evidence Records and the<br>XAIP.                                                                                  |  |
| 25. | Transfer the archival information package<br>XAIP_NOK_ERS (see pre-test<br>conditions)<br>to the TOT<br>using the interface function "VerifyRequest" or<br>"ValidateEvidence" Request asking for a<br>Vvalidation Report. | The call of the function with this XAIP as parameter is possible.                                                                                                                                                               |  |
| 26. | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                                                                    | A negative feedback will be received with error message and error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response.                                                          |  |
| 27. | Examine the Verification Report if the validity validation<br>would be<br>done by the Cryptographic Module.                                                                                                               | The Verification Reports includes verification report structures for<br>the digital signatures, time stamps, Evidence Records and the<br>XAIP.                                                                                  |  |
| 28. | Transfer the archival information package<br>DXAIP_OK_SIG (see pre-test<br>conditions)<br>to the TOT,<br>using the interface function "VerifyRequest"<br>or<br>"ValidateEvidence" Request.                                | The call of the function with this DXAIP_OK_SIG as parameter is<br>possible.                                                                                                                                                    |  |
| 29. | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response.                                                                                                                    | A positive feedback will be received; no error message or error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response. The validation of the<br>DXAIP_OK_SIG was also successful. |  |
| 30. | Examine the Verification Report if the validity validation<br>would be done by the Cryptographic Module.                                                                                                                  | The validity validation shall<br>be correct and complete, i.e. it<br>includes the entire certificate chain back to a trustworthy root<br>certificate.                                                                           |  |
| 31. | Transfer the archival information package<br>DXAIP_NOK_SIG (see pre-test<br>conditions)<br>to the TOT<br>using the interface function "VerifyRequest" or                                                                  | The call of the function with this DXAIP_NOK_OK as parameter<br>is possible.                                                                                                                                                    |  |

|         | Identifier                                                                                             |                                                            | S.1.1-01                                                                                                                                                               |
|---------|--------------------------------------------------------------------------------------------------------|------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|         | "ValidateEvidence" Request asking for a<br>Vvalidation Report                                          |                                                            |                                                                                                                                                                        |
| 32.     | Observe the output of the interface function<br>"VerifyResponse"<br>or "ValidateEvidence"<br>Response. |                                                            | A negative feedback will be received with error message and error<br>code. A Verification Report is included in "VerifyResponse"<br>or<br>"ValidateEvidence" Response. |
| 33.     | would be done by the Cryptographic Module.                                                             | Examine the Verification Report if the validity validation | The Verification Reports includes verification report structures for<br>the digital signatures, time stamps, Evidence Records and the<br>XAIP.                         |
| 34.     | Conditional: If<br>No. 1 to No. 33 are to be repeated for LXAIP.                                       | LXAIP is implemented, test steps from                      | See expected results of the test cases from No. 1 to No. 33 for<br>LXAIP.                                                                                              |
| Verdict |                                                                                                        |                                                            |                                                                                                                                                                        |

## <span id="page-247-3"></span><span id="page-247-0"></span>**4.5.5 Interface S.5**

The TR-ESOR-S.5 interface enables accesses from the ArchiSafe module to the ECM/long-term storage without technical dependence of the cryptographically secured Evidence Records.

This is an interface of a component not part of the TR-ESOR middleware. Therefore, no conformity tests can be specified here.

## <span id="page-247-1"></span>**4.5.6 Interface S.6**

The archiving of (new) archival information packages is possible with the TR-ESOR-S.6 interface described here, which can be used to include the ArchiSig-Module directly in the archiving procedure. This is a direct way to generate the securing hash values. Thus, it is impossible to circumvent this security function.

## **Pre-supposition**:

A product which claims to functionally comply with the Interface S.6 specification of this TR has to pass all test cases in this section or prove that it supports functional analogous interfaces.

#### **4.5.6.1 Archive Submission Request**

The test cases of the "ArchiveSubmissionRequest" - function of the interface S.4 (sec. [4.5.4.1](#page-160-1) [Archive](#page-160-1)  [Submission Request\)](#page-160-1) are also relevant here.

## **4.5.6.2 Archive Update Request**

The test cases of the "ArchiveUpdateRequest" - function of the interface S.4 (sec[. 4.5.4.2](#page-182-0) [Archive](#page-182-0)  [Update Request\)](#page-182-0) are also relevant here.

#### **4.5.6.3 Archive Evidence Request**

The test cases of the "ArchiveEvidenceRequest" - function of the interface S.4 (sec[. 4.5.4.4](#page-212-0) [Archive](#page-212-0)  [Evidence Request\)](#page-212-0) are also relevant here.

## <span id="page-247-2"></span>**4.6 Annex TR-ESOR-F**

All requirements of Annex TR-ESOR-F are tested at the respective modules or interfaces.