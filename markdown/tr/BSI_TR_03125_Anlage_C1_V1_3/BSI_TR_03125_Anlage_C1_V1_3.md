![](_page_0_Picture_0.jpeg)

# BSI Technical Guideline 03125 Preservation of Evidence of Cryptographically Signed Documents

#### Annex TR-ESOR-C.1:

Conformity Test Specification (Level 1 Functional Conformity)

| Designation  | Functional Conformity Test Specification (Level 1)                              |
|--------------|---------------------------------------------------------------------------------|
| Abbreviation | BSI TR-ESOR-C.1                                                                 |
| Version      | 1.3 (on base of the eIDAS-Regulation and ETSI Preservation Standards with a new |
|              | certification scheme)                                                           |
| Date         | 31.03.2022                                                                      |

# Document history

| Version | Date       | Editor | Description |
|---------|------------|--------|-------------|
| 1.3     | 31.03.2022 | BSI    | TR-ESOR-C.1 |
|         |            |        |             |

<span id="page-1-0"></span>Table 1: Document history

Federal Office for Information Security P.O. Box 20 03 63 53133 Bonn Phone: +49 229 99 9582-0 E-Mail: tresor@bsi.bund.de Internet: https://www.bsi.bund.de © Federal Office for Information Security 2022

# Table of Contents

| 1. |        | Introduction 7                                                                                                                                                                                                                                        |  |
|----|--------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 2. |        | Overview11                                                                                                                                                                                                                                            |  |
| 3. |        | Test Approach14                                                                                                                                                                                                                                       |  |
|    | 3.1    | Structure of the Test Case Specifications14                                                                                                                                                                                                           |  |
|    | 3.2    | Strictness of Test Result Assessment15                                                                                                                                                                                                                |  |
|    | 3.3    | Baseline for all Test Cases15                                                                                                                                                                                                                         |  |
|    | 3.3.1  | Standard Test Configurations 15                                                                                                                                                                                                                       |  |
|    | 3.3.2  | Standard Test Objects17                                                                                                                                                                                                                               |  |
|    | 3.4    | Occurring Abbreviations23                                                                                                                                                                                                                             |  |
| 4. |        | The Test Cases for Conformity Level 1 – Functional Conformity28                                                                                                                                                                                       |  |
|    | 4.1    | Tests for all products28                                                                                                                                                                                                                              |  |
|    | 4.1.1  | A-01 – Middleware modules should be realised as separate modules28                                                                                                                                                                                    |  |
|    | 4.1.2  | A-02 – The external upper interfaces (inbound and outbound) of the TR-ESOR<br>Middleware shall be either the TR-S.4- or TR-S.512-interface and in case of Upload-/Download<br>Module shall be based on open, standardised cryptographic protocols. 30 |  |
|    | 4.1.3  | A-03 – No access without mutual authentication32                                                                                                                                                                                                      |  |
|    | 4.1.4  | A-04 – Authentication procedure shall be resistant against replay attacks45                                                                                                                                                                           |  |
|    | 4.1.5  | A-05 – Protection of communication channel and interface shall be robust against DoS<br>attacks46                                                                                                                                                     |  |
|    | 4.1.6  | A-06 – A secure tunnel can be maintained after successful authentication48                                                                                                                                                                            |  |
|    | 4.1.7  | A-07 – Secure administration interfaces51                                                                                                                                                                                                             |  |
|    | 4.1.8  | A-08 – No security breach induced by administration interfaces or components53                                                                                                                                                                        |  |
|    | 4.1.9  | A-09 – Administration interfaces shall be available for authorised accounts only 54                                                                                                                                                                   |  |
|    | 4.1.10 | A-10 – Additional interfaces shall not compromise security56                                                                                                                                                                                          |  |
|    | 4.1.11 | A-11 – What happens to the data at the end of the preservation period shall be stated in<br>the Preservation Evidence Policy of the TR-ESOR Product-Manufacturer58                                                                                    |  |
|    | 4.1.12 | A-12 – The TOT shall support at least one Preservation Profile, which is publicly<br>published and can be retrieved as described in the User Manual and Preservation Evidence Policy<br>(PEP) of the TOT (TR-ESOR Product)60                          |  |
|    | 4.1.13 | A-13 – Each installed Preservation Profile shall contain an identifier which uniquely<br>identifies this Preservation Profile 63                                                                                                                      |  |
|    | 4.1.14 | A-14 – The Preservation Evidence Policy of the TR-ESOR-Product Manufacturer shall<br>contain the description of how the preservation evidence is created including, which<br>cryptographic algorithms are used. 64                                    |  |
|    | 4.2    | Module 1 – ArchiSafe66                                                                                                                                                                                                                                |  |
|    | 4.2.1  | M.1-01 Preservation Services conform to [eIDAS-VO], [ETSI TS 119 401], [ETSI TS 119 511]<br>and using the preservation product [TR-ESOR] should fulfil the security objectives and<br>requirements of [ASS 319 4011] and [ASS 119 511]66              |  |
|    | 4.2.2  | M.1-02 – ArchiSafe-Module shall be separated and deployed on a trustworthy IT system 67                                                                                                                                                               |  |

| 4.2.3  | M.1-03 – Access to ECM storage shall be claimed to be controlled by ArchiSafe-Module<br>and if existent, also by the Upload- and Download-Module 69                                                     |  |
|--------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 4.2.4  | M.1-04 – Support of specified functions71                                                                                                                                                               |  |
| 4.2.5  | M.1-05 – Using interfaces TR-S.1 and TR-S.6 is possible76                                                                                                                                               |  |
| 4.2.6  | M.1-06 – Comprehensive and configurable options for logging shall be offered78                                                                                                                          |  |
| 4.2.7  | M.1-07 – Access to log files shall be possible by authorized persons only82                                                                                                                             |  |
| 4.2.8  | M.1-09 – ArchiSafe-Module is capable of serving and separating multiple clients84                                                                                                                       |  |
| 4.2.9  | M.1-10 – ArchiSafe-Module shall be thread safe 87                                                                                                                                                       |  |
| 4.2.10 | M.1-11 – Access rights shall be enforced for individual archive objects90                                                                                                                               |  |
| 4.3    | Module 2 – Cryptographic-Module (Crypto-Module)94                                                                                                                                                       |  |
| 4.3.1  | M.2-01 – Crypto- Module may request digital signatures from a Trust Service Provider<br>according to [eIDAS-VO] 94                                                                                      |  |
| 4.3.2  | M.2-02 – Cryptographic algorithms shall be exchangeable 98                                                                                                                                              |  |
| 4.3.3  | M.2-03 – Crypto-Module should fulfil the requirements of TR-03112 as stated in [TR<br>ESOR-E] 100                                                                                                       |  |
| 4.3.4  | M.2-04 – Random number generators fulfil the BSI requirements 101                                                                                                                                       |  |
| 4.3.5  | M.2-05 – Support of Hash functions 102                                                                                                                                                                  |  |
| 4.3.6  | M.2-06 – Crypto-Module supports canonicalisation for the validation of XML digital<br>signatures 105                                                                                                    |  |
| 4.3.7  | M.2-07 – Canonicalisation procedures do not change the content data 107                                                                                                                                 |  |
| 4.3.8  | M.2-08 – Reliable validation of digital signatures by itself or by a Trust Service Provider<br>108                                                                                                      |  |
| 4.3.8  | M.2-09 – Crypto-Module shall have function to validate certificate chains or trust anchor<br>by itself or by a Trust Service Provider 114                                                               |  |
| 4.3.9  | M.2-10 – Validation of digital signatures and evidence records yields standardised and<br>comprehensive Verification Report 118                                                                         |  |
| 4.3.10 | M.2-11 – Suitable cryptographic algorithms should be defined by User Manual and the<br>Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-<br>[TR-ESOR-PEPT]  122 |  |
| 4.3.11 | M.2-12 – Protect its own security 123                                                                                                                                                                   |  |
| 4.3.12 | M.2-13 – Recording security functions 124                                                                                                                                                               |  |
| 4.3.13 | M.2-14 – Responsivity to unauthorized access 125                                                                                                                                                        |  |
| 4.3.15 | M.2-15 – Configuration of cryptographic functions  127                                                                                                                                                  |  |
| 4.3.16 | M.2-16 – Validation of certificates based on a standardized protocol 128                                                                                                                                |  |
| 4.3.17 | M.2-17 – Crypto-Module shall be able to request qualified Electronic Time-Stamps from<br>a qualified Trust Service Provider  130                                                                        |  |
| 4.3.18 | M.2-18 – Crypto-Module supports [RFC 3161], [RFC5816], [RFC5652] and [EN 319 422]<br>and suitable algorithms 133                                                                                        |  |
| 4.3.19 | M.2-19 – Qualified Electronic Time-Stamps shall fulfil the requirements of [eIDAS-VO],<br>Article 42  135                                                                                               |  |
| 4.3.20 | M.2-20 – Crypto-Module shall validate digital signatures of received Electronic Time<br>Stamps according to the Time-Stamp Validation Policy  138                                                       |  |

|     | 4.3.21 | M.2-21 – The Cryptographic-Module shall have a trustworthy communication channel<br>to a qualified Trust Service Provider in order to request qualified electronic time-stamps<br>according to [eIDAS-VO], Article 3 (34)  143                                                                                                                            |  |
|-----|--------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 4.4 |        | Module 3 – ArchiSig-Module  145                                                                                                                                                                                                                                                                                                                           |  |
|     | 4.4.1  | M.3-01 – ArchiSig-Module should be realised as a separate module 146                                                                                                                                                                                                                                                                                      |  |
|     | 4.4.2  | M.3-02 – Using interface TR-S.3 is possible 148                                                                                                                                                                                                                                                                                                           |  |
|     | 4.4.3  | M.3-04 – Creation of Initial Archive Timestamps according to [RFC4998]  149                                                                                                                                                                                                                                                                               |  |
|     | 4.4.4  | M.3-05 – AOID shall be unique 151                                                                                                                                                                                                                                                                                                                         |  |
|     | 4.4.5  | M.3-06 – ArchiSig-Module creates Evidence Records according to RFC4998 152                                                                                                                                                                                                                                                                                |  |
|     | 4.4.6  | M.3-07 – ArchiSig-Module must not implement cryptographic functions 155                                                                                                                                                                                                                                                                                   |  |
|     | 4.4.7  | M.3-08 – ArchiSig-Module shall be thread safe 157                                                                                                                                                                                                                                                                                                         |  |
|     | 4.4.8  | M.3-09 – Instances of ArchiSig-Module should be deployable on different machines 159                                                                                                                                                                                                                                                                      |  |
|     | 4.4.9  | M.3-11 – Canonicalisation of XML is performed prior to hashing and noted in (L)XAIP 160                                                                                                                                                                                                                                                                   |  |
|     | 4.4.10 | M.3-12 – Hashing of relevant parts is performed with suitable algorithms 162                                                                                                                                                                                                                                                                              |  |
|     | 4.4.11 | M.3-13 – ArchiSig-Module supports Timestamp Renewal and Hash-Tree Renewal  164                                                                                                                                                                                                                                                                            |  |
|     | 4.4.12 | M.3-14 – Timestamp Renewal 168                                                                                                                                                                                                                                                                                                                            |  |
|     | 4.4.13 | M.3-15 – ArchiSig-Module shall validate requested electronic time-stamps using the                                                                                                                                                                                                                                                                        |  |
|     |        | Crypto-Module 170                                                                                                                                                                                                                                                                                                                                         |  |
|     | 4.4.14 | M.3-16 – Time-Stamps shall be verified prior to renewal  173                                                                                                                                                                                                                                                                                              |  |
|     | 4.4.15 | M.3-17 – Timestamp Renewal can only be requested by authorised users through<br>administrative interfaces 176                                                                                                                                                                                                                                             |  |
|     | 4.4.16 | M.3-18 – Hash-tree Renewal can only be requested through administrative interface 178                                                                                                                                                                                                                                                                     |  |
|     | 4.4.17 | M.3-19 – Authenticity and integrity of ArchiSig-Module needs to be guaranteed 180                                                                                                                                                                                                                                                                         |  |
|     | 4.4.18 | M.3-20 – ArchiSig-Module should be able to maintain parallel hash-trees 181                                                                                                                                                                                                                                                                               |  |
|     | 4.4.19 | M.3-22 – Deletion of an archive object shall not impair the conclusiveness of others. 182                                                                                                                                                                                                                                                                 |  |
|     | 4.4.20 | M.3-23 – The Process of requesting Export-Import package(s) and the Production<br>Methods of the Export-Import Packages shall be stated in the User Manual and in the published<br>TR-ESOR-Product Preservation Evidence Policy (PEP) of the TOT, based on the BSI-[TR-ESOR<br>PEPT], and is allowed for authorized clients or preservation services  185 |  |
|     | 4.4.21 | M.3-24 – How the Request for an Export-Import Package can be done with standardised                                                                                                                                                                                                                                                                       |  |
|     |        | formats, shall be stated in the User Manual and in the published TR-ESOR-Product Preservation<br>Evidence Policy (PEP) of the TOT  188                                                                                                                                                                                                                    |  |
|     | 4.4.22 | M.3-25 – The TR-ESOR middleware shall keep records of all released export-import<br>packages and shall allow only authorized clients or preservation services to request export                                                                                                                                                                           |  |
|     |        | import packages 190                                                                                                                                                                                                                                                                                                                                       |  |
| 4.5 |        | Interface functions 192                                                                                                                                                                                                                                                                                                                                   |  |
|     | 4.5.1  | Interface TR-S.1  192                                                                                                                                                                                                                                                                                                                                     |  |
|     | 4.5.2  | Interface S.2 193                                                                                                                                                                                                                                                                                                                                         |  |
|     | 4.5.3  | Interface S.3 193                                                                                                                                                                                                                                                                                                                                         |  |
|     | 4.5.4  | TR-ESOR-Interface TR-S.4 or TR-S.512  194                                                                                                                                                                                                                                                                                                                 |  |
|     | 4.5.5  | Interface S.5 259                                                                                                                                                                                                                                                                                                                                         |  |
|     |        |                                                                                                                                                                                                                                                                                                                                                           |  |

| 4.5.6 | Interface S.6 260      |  |
|-------|------------------------|--|
| 4.6   | Annex [TR-ESOR-F]  260 |  |

| Figure 1: Schematic Depiction of the IT Reference Architecture with TR-S.4  8   |  |
|---------------------------------------------------------------------------------|--|
| Figure 2: Schematic Depiction of the IT Reference Architecture with TR-S.512  9 |  |

| Table 1: Document history  2                      |  |
|---------------------------------------------------|--|
| Table 2: Definition of test objects  17           |  |
| Table 3:<br>Definition of test data in detail  21 |  |
| Table 4: Occurring Abbreviations  23              |  |

# 1. Introduction

The goal of the Technical Guideline "Preservation of Evidence of Cryptographically Signed Documents" is to specify technical security requirements for the longterm preservation of evidence of cryptographically signed electronic documents and data along with associated electronic administrative data (meta data).

A Middleware defined for this purpose (TR-ESOR-Middleware) in the sense of this Guideline includes all of the modules (M) and interfaces (S) [for the German "Schnittstellen"] used for securing and preserving the authenticity and proving the integrity of the stored documents and data.

The Reference Architecture introduced in the Main Document of this Technical Guideline consists of the interfaces and logical units described in the following:

- the TR-S.4 and the TS119512 input interface TR-S.512 in the profiling [TR-ESOR-TRANS] of the TR-ESOR-Middleware, which serves to embed the TR-ESOR-Middleware in the existing IT and infrastructure landscape;
- the "ArchiSafe-Module" [TR-ESOR-M.1], which regulates the flow of information in the Middleware, implements the security requirements for the interfaces with the IT applications and ensures that the application systems are decoupled from the ECM-/Long-term storage;
- the "Cryptographic-Module" [TR-ESOR-M.2] and the associated interfaces S.1 and S.3 that provide the required functions for creating hash values and verifying electronic signatures or seals or time-stamps, verifying electronic certificates and for obtaining qualified electronic time-stamps or (optional) electronic signatures or seals for the Middleware. Furthermore, it can provide the functions for the encryption and decryption of data and documents;
- the "ArchiSig-Module" [TR-ESOR-M.3] with the S.6 interface that provides the required functions for the preservation of evidence of the digitally signed documents;
- <span id="page-6-0"></span>• an ECM-/Long-Term Storage with the S.2 and S.5 interfaces that assumes the physical archiving/storage and also the storage of the meta data that preserve evidence.

This ECM-/Long-Term Storage is no longer directly a part of the Technical Guideline, but requirements will be set for it through the two interfaces that are still part of the TR-ESOR-Middleware. The application layer that can include an XML-Adapter is not a direct part of this Technical Guideline, either, even though this XML-Adapter can be implemented as part of a Middleware.

The IT Reference Architecture depicted in Figure 1 and Figure 2 is based on the ArchiSafe Reference Architecture and is supposed to enable and support the logical (functional) interoperability of future products with the objectives and requirements of the Technical Guideline. In principle, the upper interface of the TR-ESOR-Middleware is either the S.4-Interface (TR-S.4) pursuant to [TR-ESOR-E], according to Figure 1, or the TR-S.512-Interface (TR-S.512) pursuant to [ETSI TS 119 512] in the profiling of [TR-ESOR-TRANS], according to Figure 2.

![](_page_7_Figure_1.jpeg)

<span id="page-7-0"></span>Figure 1: Schematic Depiction of the IT Reference Architecture with TR-S.4

<span id="page-8-1"></span>![](_page_8_Figure_1.jpeg)

Figure 2: Schematic Depiction of the IT Reference Architecture with TR-S.512

The optional XML-Adapter and/or the optional TR-ESOR-512-Transformato[r1](#page-8-1) may be integrated under the following circumstances:

- Both as separate components with two interfaces to the IT-application and the ArchiSafe-Module,
- Both as separate components, but as parts of the IT-application with interfaces to the ArchiSafe-Module,
- One common component, separate from the IT-application and including the XML-Adapter and TR-ESOR-512-Transformator as parts, with two interfaces to the IT-application and the ArchiSafe-Module,

<span id="page-8-0"></span><sup>1</sup> Se[e ETSI TS 119512 TR-ESOR Transformator unter einer Open Source Lizenz.](https://github.com/de-bund-bsi-tr-esor/tresor-ETSITS119512-transformator)

<span id="page-9-0"></span>- One common component including the XML-Adapter and TR-ESOR-512-Transformator as parts, which is part of the IT-application, with an interface to the ArchiSafe-Module.

The ["TS119512 TR-ESOR Transformator"](https://github.com/de-bund-bsi-tr-esor/tresor-ETSITS119512-transformator) enables preservation services pursuant to [\[eIDAS-](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32014R0910)VO] to transform incomin[g ETSI TS119512 \(V1.1.2\)](https://www.etsi.org/deliver/etsi_ts/119500_119599/119512/01.01.01_60/ts_119512v010101p.pdf) messages[2](#page-9-0) TR-S.512 into [TR-S4](https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/TechGuidelines/TR03125/TR-03125_E_v1_2_2.pdf) messages. These messages can be sent to an attached http://www.bsi.bund.de/EN/tr-esor system without any need for changing the system.

The usage of the ["ETSI TS119512 TR-ESOR Transformator"](https://github.com/de-bund-bsi-tr-esor/tresor-ETSITS119512-transformator) is recommended in case that a TR-ESOR-Product with a TR-S.4-Interface should be used in Europe supporting interoperability with other European (qualified) Preservation Services or Preservation Products.

This Technical Guideline is modularly structured, and the individual annexes to the Main Document specify the functional and technological security requirements for the needed IT components and interfaces of the TR-ESOR-Middleware. The specifications are strictly platform, product, and manufacturer independent.

The document at hand bears the designation "Annex TR-ESOR-C.1" and describes and specifies the conformity tests for the conformity level 1 "Functional Conformity" for TR-ESOR V1.3 supporting also the archive information package LXAIP, ASiC-AIP (not yet ready for certification), the Upload- and Downloadinterface and the upper ETSI TS119512-interface TR-S.512 in the profiling of [TR-ESOR-TRANS], alternatively to the TR-ESOR upper interface TR-S.4.

Products that want to be certified pursuant to the Technical Guideline 03125 TR-ESOR shall prove their conformity pursuant to this document [TR-ESOR-C.2] and [TR-ESOR-C.1].

<sup>2</sup> In the profiling of [TR-ESOR-TRANS].

# 2. Overview

Products or systems, which want to get certified according to this Technical Guideline have to demonstrate their conformance to the specifications. There are two defined conformance levels, which mainly differ in the technical detail specifications of interfaces and data formats used:

- Conformity Level 1 Functional Conformity,
- Conformity Level 2 Technical Conformity.

This document specifies the functional conformity criteria (tests) derived from the requirements specified in the documents of the Technical Guideline.

The technical test criteria (tests) for reaching "Conformity Level 2 – Technical Conformity" are to be found in [TR-ESOR-C.2].

In order to become certified according to "TR 03125 TR-ESOR", a product shall pass all mandatory conformity criteria (tests) pursuant to [TR-ESOR-C.1] and [TR-ESOR-C.2]. If one or more mandatory tests are not successful, the conformity cannot be certified.

In the following chapter, the test criteria will be derived from the requirements defined of the TR. Furthermore, the requirements and therefore also the test criteria are assigned to Conformity Level 1 or Conformity Level 2.

Based on two assignments the subsequent chapters define the test cases for Conformity Level 1 (Functional Conformity) in detail. Red headlined (marked) test cases MUST be passed for fulfilling the conformity criteria.

<span id="page-10-0"></span>The test case specifications are written in such a way that this document (or the respective parts of it) could be used as template for the documentation of the final results of actual testing.

Because [TR-ESOR-C.2] extends [TR-ESOR-C.1], it is necessary for the testing body to assess the assessment criteria of [TR-ESOR-C.1] beforehand.

#### NOTICE 1:

In TR-ESOR-Version1.3 the three terms "Archive Information Package (AIP)", "Archive Information Container" and "Archive Data Object" are used synonymously. 

#### NOTICE 2:

The TR-ESOR input interface TR-S.4 or the TS119512 input interface TR-S.512 pursuant to the preservation-API of [ETSI TS 119 512] in the profiling of [TR-ESOR-TRANS] shall be used which logically corresponds to the input-interface TR-S.4 of the TR-ESOR-Middleware [TR-ESOR-E], as shown in the table 2 of [TR-ESOR-E], clause 4.1. Another input interface instead of TR-S.4 or TR-S.512 is not allowed. To improve readability, the insertion of the TS119512-function calls, equivalent to TR-S.4, is renounced, at several places in this document and the footnote "Either TR-S.4 or TR-S.512 shall be supported." is added to each test case concerning "TR-S.4" or "TR-S.512".

#### NOTICE 3:

In this TR-ESOR- Version, the word "AIP" means in all TR-ESOR-Annexes :

a) the XML-based archival information package "XAIP" pursuant to [TR-ESOR-F], clause 3.1 as well as 

b) the logical XAIP "LXAIP" pursuant to [TR-ESOR-F], clause 3.2 as well as 

c) the "ASiC-AIP" pursuant to [TR-ESOR–F], clause 3.3 on base of [ETSI EN 319162-1]. 

In general, this TR-ESOR Version differentiates in detail between "XAIP", "LXAIP" and "ASiC-AIP".

To improve readability, at several places in this document, the insertion of "LXAIP" and "ASiC-AIP" is renounced, and the footnote ""XAIP" shall be supported, "LXAIP" and "ASiC-AIP, if implemented" may be supported" is added to each "XAIP".

#### NOTICE 4:

In this TR-ESOR- Version, BIN is restricted to the following preservation object formats: 

-ASiC-ERS (in TR-ESOR v1.3 called ASiC-AIP) pursuant to [ETSI TS 119 512], Annex A.3.1 and A.3.1.3 [\(http://uri.etsi.org/ades/ASiC/type/ASiC-ERS\)](http://uri.etsi.org/ades/ASiC/type/ASiC-ERS) and pursuant to [TR-ESOR-F], Clause 3.3); 

-CAdES pursuant to [ETSI TS 119 512] Annex A.1.1 [\(http://uri.etsi.org/ades/CAdES\)](http://uri.etsi.org/ades/CAdES). If there is no MIME type filled, then the default application/cms is used; 

-XAdES pursuant to [ETSI TS 119 512] Annex A.1.2 [\(http://uri.etsi.org/ades/XAdES\)](http://uri.etsi.org/ades/XAdES). If there is no MIME type filled, then the default application/xml is used; 

-PAdES pursuant to [ETSI TS 119 512] Annex A.1.3 [\(http://uri.etsi.org/ades/PAdES\)](http://uri.etsi.org/ades/PAdES). If there is no MIME Type filled, then the default application/pdf is used; 

-ASiC-E pursuant to [ETSI TS 119 512] Annex A.1.4 [\(http://uri.etsi.org/ades/ASiC/type/ASiC-E\)](http://uri.etsi.org/ades/ASiC/type/ASiC-E). If there is no MIME type filled, then the default application/vnd.etsi.asic-e+zip is used; 

-ASiC-S pursuant to [ETSI EN 319 162] [\(http://uri.etsi.org/ades/ASiC/type/ASiC-S\)](http://uri.etsi.org/ades/ASiC/type/ASiC-S). If there is no MIME type filled, then the default application/vnd.etsi.asic-s+zip is used,

-DigestList pursuant to [ETSI TS 119 512] Annex A.1.6 [\(http://uri.etsi.org/19512/format/DigestList\)](http://uri.etsi.org/19512/format/DigestList). If there is no MIME Type filled, then the default application/xml is used; 

In case of Upload- and Download-function the following format is allowed additionally:

-Binary Data (BIN) as Octet Stream, which is stored in the ECM-/Long-Term Storage by an "Upload-Request", – but only, 

if connected with a corresponding LXAIP and referenced there acc. to [TR-ESOR-F], Sec. 3.2,

 if appropriate, retrieved by a "Download-Request" – linked to a corresponding LXAIP or embedded in a XAIP and retrieved by an ArchiveRetrieval-Request, – and, neither Upload of XAIP nor LXAIP, nor ASiC-AIP is possible.. 

#### ATTENTION 1:

If implemented, an ASiC-AIP-Container pursuant to clause 3.3 in [TR-ESOR-F] shall be inserted in the TS119152-intefrace as a base64Binary-coded ASiC-AIP-Container with the Type[=http://uri.etsi.org/ades/ASiC/type/ASiC-ERS](http://uri.etsi.org/ades/ASiC/type/ASiC-ERS) Attribute (se[e https://www.w3.org/TR/xmlschema-2/#base64Binary\)](https://www.w3.org/TR/xmlschema-2/#base64Binary).

In TR-ESOR V1.3, actually, ASiC-AIP is announced but it is still not released and does not lead to a certification.

#### NOTICE 5:

In the following text the term "digital signature" covers "advanced electronic signatures" pursuant to [eIDAS-VO], Article 3(11), "qualified electronic signatures" pursuant to [eIDAS-VO], Article 3(12), "advanced electronic seals" pursuant to [eIDAS-VO], Article 3(26) and "qualified electronic seals" pursuant to [eIDAS-VO], Article 3(27). Insofar, the term "digital signed document" covers as well documentssigned by advanced electronic signatures or seals as documents signed by qualified electronic signatures or seals. 

In this TR the term "cryptographic signed documents" covers not only qualified signed documents pursuant to [eIDAS-VO], Article 3(12) or qualified sealed documents pursuant to [eIDAS-VO], Article 3(27) or qualified time-stamped documents pursuant to [eIDAS-VO], Article 3(34) (within the meaning of the eIDAS regulation) ) but also documents with advanced electronic signatures pursuant to [eIDAS-VO], Article 3(11) or with advanced electronic seals pursuant to [eIDAS-VO], Article 3(26) or with electronic time-stamps pursuant to [eIDAS-VO], Article 3(33), as they are often used in the internal communication of public authorities. The documents with simple signatures or seals based on other (e.g. non-cryptographic) technologies are not meant here.

# 3. Test Approach

The following test specifications are based on the recommended reference architecture in chapter 7.1 of [TR-ESOR]. Thus, in the following differences between expected and observed test results should be carefully interpreted by the testers respecting the fact that actual implementations of components and / or modules of the middleware may deviate from the recommended reference architecture. This may result also in different characteristics of implemented and provided interfaces.

Besides this testing the conformity to this guideline may refer to a single module only. This may result also in different characteristics and expected results of implemented and provided features and interfaces.

The TR-ESOR interfaces S.2 and S.5 are actually not part of the TR-ESOR middleware because they will be provided by the storage system. Therefore, no conformity tests will be specified here.

For fulfilling the required conformity in general, the red marked test specifications in this document shall be tested and passed.

For fulfilling the required conformity in compliance with the pre-suppositions written down before the test cases, the yellow marked test specifications in this document shall be tested and passed.

All other test specifications shall be passed or the non-fulfilment must be justified.

## 3.1 Structure of the Test Case Specifications

<span id="page-13-0"></span>Some test cases are ordered according to the modules M.1 – M.3 and "all products". These test cases cannot be assigned to the certain interface of the module but check general properties of the module.

The other test cases are ordered according to the interface specifications S.1 – S.6. The reason for that is that these tests will only be performed on the level of external interfaces of a certain product. If a product claims compliance with the module specified in the Technical Guideline, the respective interfaces of the module (product) will be tested.

Below this structural level, the test cases are ordered according to the logical functions of this interface, e.g. "ArchiveSubmission" or "ArchiveDeletion". For each logical function of the interface a set of test cases test all relevant requirements.

Each test case is identified by a unique ID. The test case description also refers to the respective requirements, which will be (partly) tested with this test case. The test case also states the purpose of the test as a summary of the test case. The baseline configuration of the test system will be stated as well as all pre-conditions, which must exist prior performance of the test. The test case defines the single test steps, which must be performed in the given order. Per test step the expected result is defined and there is space that the tester could document the actual findings. Finally, the tester can state the final verdict of the test case (PASS/FAIL).

<span id="page-13-1"></span>FAIL shall be assigned if any of the test steps does not match the expected result and a justification for this difference is not possible.

## <span id="page-14-3"></span>3.2 Strictness of Test Result Assessment

The Technical Guideline differs between three major classes of requirements (cf. [RFC 2119])

- CAN (or synonymously MAY, COULD): These requirements are just hints or optional features. These requirements will not be tested.
- SHOULD: These requirements are strong recommendations. Respective test cases should demonstrate the specified behaviour. Alternatively, the vendor explains why its product uses another approach and why the resulting security level is equal to the security level described in the Technical Guideline.
- MUST (or synonymously SHALL): These are strict requirements. It is not allowed to use another approach or alternative techniques.

Test cases, which test MUST requirements, are identified with a red coloured title line. The expected results of these test cases must exactly be the actual results.

Test cases identified by a grey coloured title line are pure SHOULD requirements. The expected test results may differ from the actual test results, if the vendor can demonstrate the same or higher security level.

## 3.3 Baseline for all Test Cases

This section describes the basics valid and usable for all test cases.

### 3.3.1 Standard Test Configurations

<span id="page-14-0"></span>Here, a set of standard configurations of the test setup will be described. These setups are referenced in the test cases and should be used to actually perform the tests.

#### 3.3.1.1 CONFIG\_Common

This is the standard configuration for all tests.

- The test setup shall contain the TR-ESOR-Middleware as the TR-ESOR product to be tested (Target of Testing, TOT).
- The user manual in the test setup shall refer at least to one Preservation Profile pursuant to [ETSI TS 119 512], clause 5.4.7[3](#page-14-3) , to one actual Preservation Evidence Policy pursuant to [ETSI TS 119 511], clause 6.5 and to one actual signature validation policy and time-stamp validation policy pursuant to [ETSI TS 119 511], clause 6.6.
- The test setup shall contain all other modules of the reference architecture (including the storage) functionally not covered by the TOT. The purpose is that a functionally complete system can be tested.
- The TOT and all other modules required shall be installed and configured according to the respective guidance including all security recommendations.
- <span id="page-14-1"></span>• The TOT and all other modules shall be physically and logically interconnected. The connections shall be secured as described in the respective guidance documents (e.g. enabling encryption, explicit physical connection).

<span id="page-14-2"></span> <sup>3</sup> The provided profile shall describe the interface of TOT to be tested, either TR-S.4 or TR-S.512.

<span id="page-15-3"></span><span id="page-15-2"></span><span id="page-15-1"></span><span id="page-15-0"></span>• The test system shall be connected to an external Trust Service Provider as required by the TOT or the tests.

• At least it is recommended to install three separated client application instances for using and testing the multi-client-capability of the middleware (if the TOT supports/provides a multi-client-capability). In this case, the middleware in turn shall be configured to handle these three applications as different clients (multi-client-capability). Per client application, at least two user accounts and an administrator account shall be configured.

- The BSI "ERVerifyTool"[4](#page-15-0) is installed together with an integrated validator and running in a proper working mode.
- The BSI-Tool "AIPeIDASValidator"[5](#page-15-1) is installed together with an integrated validator and running in a proper working mode.

The complete test setup shall be started and running in a proper operational and working mode.

### 3.3.1.2 CONFIG\_ArchiSafe

This configuration includes CONFIG\_Common.

Additionally, the ArchiSafe-Module (as part of the TOT) shall be configured as follows:

- XAIP shall be mandatory.
	- The default value in case of "no-input of the PO-Format" is "XAIP".
	- If configurable, LXAIP or ASiC-AIP (not yet ready for certification) shall be optional and may be enabled and used in parallel with XAIP.
- A XSD defining the XAIPs or LXAIPs pursuant to [TR-ESOR-F], chapter 8 shall be configured.
- The XSD verification of (L)XAIP containers during ArchiveSubmission and ArchiveUpdate shall be enabled.
- The validation of digital signatures and electronic time-stamps[6](#page-15-2) , (L)XAIP (and in future ASiC-AI[P7](#page-15-3) ) during ArchiveSubmission and ArchiveUpdate shall be enabled.
- The requesting of qualified time-stamps from a qualified Trust Service Provider and of verification of (qualified) time-stamps (doing by itself or upon request from an external Trust Service Provider) shall be enabled.
- Either the interface TR-S.4 pursuant to [TR-ESOR-E], chapter 3 or the interface TR-S.512 pursuant to [TR-ESOR-E], chapter 4 and especially [TR-ESOR-TRANS] shall be configured.
	- The default value in case of "no interface configuration" is the interface "TR-S.4".
- Either the interface TR-S.4 pursuant to [TR-ESOR-E], chapter 3 or the interface TR-S.512 pursuant to [TR-ESOR-E], chapter 4 and especially [TR-ESOR-

 <sup>4</sup> Se[e Free Verification Testtool for Evidence Records under an Open Source License.](https://github.com/de-bund-bsi-tr-esor/ERVerifyTool) <sup>5</sup> See Fre[e tr-esor-AIP-eIDAS-SigValidator](https://github.com/de-bund-bsi-tr-esor/tr-esor-AIP-eIDAS-SigValidator)

<sup>6</sup> The validation of digital signatures or electronic time-stamps of documents included in the XAIP or passed over as binary data.

<sup>7</sup> The ASiC-AIP is passed over as binary data pursuant to [TR-ESOR-E], chapter 3.1.1.

TRANS] shall only be accessible using a "secure Channel" (e.g. TLS tunnel) with certificate-based mutual authentication.

- If configurable, OptionalInput and OptionalOutput pursuant to [TR-ESOR-E] may be supported. 3.3.1.3 CONFIG\_Upload
- If configurable, CONFIG\_Upload is defined and Upload shall be enabled, but only usable for BIN linked to a corresponding LXAIP and referenced there acc. to [TR-ESOR-F], Sec. 3.2, , and only, if CONFIG\_Download is also defined.
- 3.3.1.4 CONFIG\_Download

If configurable, CONFIG\_Download is defined and Download shall be enabled, but only, if CONFIG\_Upload is also defined.

### 3.3.2 Standard Test Objects

For most of the tests test data is required. In order to make the tests repeatable, this section defines some standard test objects.

#### NOTICE 6:

The word "XAIP" in the following table names represents "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F]. The word "DXAIP" in the following container names represents "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].

#### The following test objects are available for the two Conformity Levels 1 and 2.

Table 2: Definition of test objects

<span id="page-16-3"></span><span id="page-16-2"></span><span id="page-16-1"></span><span id="page-16-0"></span>

| No | Container<br>Name | Used<br>in<br>Conformity<br>Level | Description                                                                                                                                     |
|----|-------------------|-----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| 1  | XAIP_OK           | 1                                 | The XAIP is syntactically correct and passes the defined consistency checks.                                                                    |
| 2  | LXAIP_OK          | 1                                 | The LXAIP is syntactically correct and passes the defined consistency checks.                                                                   |
| 3  | XAIP_OK_SIG       | 1                                 | The XAIP is syntactically correct and passes the defined consistency checks and there is a valid digital<br>signature or electronic time-stamp. |

| No | Container<br>Name                 | Used<br>in<br>Conformity<br>Level | Description                                                                                                                                                                                                                                                                                                                     |
|----|-----------------------------------|-----------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 4  | LXAIP_OK_SIG                      | 1                                 | The LXAIP is syntactically correct and passes the defined consistency checks and there is a valid digital<br>signature or electronic time stamp.                                                                                                                                                                                |
| 5  | (L)XAIP_OK_SIG                    | 1                                 | A XAIP_OK_SIG or a LXAIP_OK_SIG.                                                                                                                                                                                                                                                                                                |
| 6  | XAIP_NOK                          | 1                                 | The schema validation of the XAIP fails.                                                                                                                                                                                                                                                                                        |
| 7  | LXAIP_NOK                         | 1                                 | The schema validation of the LXAIP fails.                                                                                                                                                                                                                                                                                       |
| 8  | XAIP_NOK_SIG                      | 1                                 | The XAIP is syntactically correct and passes the defined consistency checks, but the XAIP contains an<br>invalid digital signature or electronic time-stamp.                                                                                                                                                                    |
|    |                                   |                                   | Invalid digital signature or electronic time-<br>stamp means that the digital signature or electronic time-stamp<br>is syntactically not correct or at least one of the evidence relevant data, for example a digital signature or<br>electronic time-stamp or certificate or revocation list or OCSP-response, etc., is wrong. |
| 9  | XAIP_NOK_SIGSHELL_OK_S<br>IGCHAIN | 1                                 | The XAIP is syntactically correct and passes the defined consistency checks, but the XAIP contains a digital<br>signature or electronic time-stamp, which only passes the digital signature validation on base of the chain<br>model, but not on base of the shell model.                                                       |
| 10 | XAIP_NOK_TSPSHELL_OK_<br>TSPCHAIN | 1                                 | The XAIP is syntactically correct and passes the defined consistency checks, but the XAIP contains an<br>electronic timestamp, which only passes the time-stamp validation on base of the chain model, but not on<br>base of the shell model.                                                                                   |
| 11 | XAIP_NOK_ER                       | 1                                 | The XAIP is syntactically correct and passes the defined consistency checks, but the XAIP contains an<br>invalid Evidence Record.                                                                                                                                                                                               |
|    |                                   |                                   | Invalid Evidence Record means, that the Evidence Record is syntactically not correct or does not pass the<br>defined consistency checks according to annex TR-ESOR-C.2, chapter 4.1. or annex TR-ESOR-ERS.                                                                                                                      |

<span id="page-18-0"></span>

| No | Container<br>Name  | Used<br>in<br>Conformity<br>Level | Description                                                                                                                                                                                                                                                                                                                                                       |
|----|--------------------|-----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 12 | XAIP_NOK_SIG_OK_ER | 1                                 | The XAIP is syntactically correct and passes the defined consistency checks and there is a correct Evidence<br>Record or a number of correct Evidence Records, but the XAIP contains a digital signature or electronic<br>time-stamp, which was not correct at the time of its archiving.                                                                         |
| 13 | XAIP_OK_SIG_OK_ER  | 1                                 | The XAIP is syntactically correct and passes the defined consistency checks and there is a valid digital<br>signature or electronic time-stamp and a valid Evidence Record or a number of correct Evidence Records.                                                                                                                                               |
| 14 | BIN                | 1                                 | This test object is a binary document, restricted<br>to the<br>described in clause 2,<br>preservation<br>object<br>formats<br>Notice 4, which is provided in the ArchiveData-element.<br>, BIN may<br>be an ASiC-AIP.<br>If<br>implemented                                                                                                                        |
| 15 | XAIP(BIN)          | 1                                 | The XAIP(BIN) is a XAIP, which is part of the response of a successful interface function,<br>either<br>or RetrievePO,<br>concerning an archive data object, which was previously inserted<br>ArchiveRetrieval<br>as a BIN in the long-term storage by an ArchiveSubmissionRequest<br>or a PreservePO-Request ([TR<br>ESOR-E]<br>and especially [TR-ESOR-TRANS]). |
| 16 | DXAIP              | 1                                 | The DXAIP represents an update container ("Delta XAIP") for XAIP_OK, which contains the corresponding<br>AOID.                                                                                                                                                                                                                                                    |
| 17 | DLXAIP             | 1                                 | The DLXAIP represents an update container ("Delta LXAIP") for LXAIP_OK, which contains the<br>corresponding AOID.                                                                                                                                                                                                                                                 |
| 18 | DXAIP_OK           | 1                                 | The DXAIP is syntactically correct and represents a valid update container ("Delta XAIP") for XAIP_OK,<br>which contains the corresponding AOID.                                                                                                                                                                                                                  |
| 19 | DXAIP_OK_SIG       | 1                                 | The DXAIP is syntactically correct and represents a valid update container ("Delta XAIP") for XAIP_OK,<br>which contains the corresponding AOID and contains a valid digital signature or electronic time-stamp.                                                                                                                                                  |
| 20 | DXAIP_NOK          | 1                                 | The DXAIP is syntactically not correct because the schema validation fails.                                                                                                                                                                                                                                                                                       |

| No | Container<br>Name                  | Used<br>in<br>Conformity<br>Level | Description                                                                                                                                                                                                                                                                                    |
|----|------------------------------------|-----------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 21 | DXAIP_NOK_SIG                      | 1                                 | The schema validation for the Delta XAIP succeeds, but the XAIP contains an invalid digital signature or<br>electronic time-stamp.                                                                                                                                                             |
| 22 | DXAIP_NOK_SIGSHELL_OK_SIG<br>CHAIN | 1                                 | The DXAIP is syntactically correct and passes the defined consistency checks, but the DXAIP contains a<br>digital signature, which only passes the digital signature validation on base of the chain model, but not on<br>base of the shell model.                                             |
| 23 | DXAIP_NOK_TSPSHELL_OK_TSP<br>CHAIN | 1                                 | The DXAIP is syntactically correct and passes the defined consistency checks, but the DXAIP contains an<br>electronic time-stamp, which includes a digital signature, which only passes the digital signature validation<br>on base of<br>the chain model, but not on base of the shell model. |

These test objects are referred in the test cases by their unique name.

The actual test objects (the files) for this annex are provided as appendix to this document.

- "Container Name" contains the unique name of the container and is identical to the file name.
- "XML Schema"
	- "valid" means that a XML-based object conforms with the specified XML Schema.
	- "not valid" means that a XML-based object does not conform with the specified XML Schema.
	- "---" means that this is a binary object which does not claim conformance to a XML schema.
- "Binary"
	- "no" means that this is an XML object.
	- "yes" means that this is a binary (a non-XML) object.
- "Preservation Time"
	- "Future" means that the minimum retention date is somewhere in the future (e.g. 01.01.2100).
	- "Past" means that the minimum retention date is somewhere in the past (e.g. 01.01.2000).
- "Signature"
	- "No signature" means that the user data contained in the test object does not contain a digital signature or electronic time-stamp.
- "Valid" means that the user data contained in the test object contains a digital signature/seal or electronic time-stamp which is mathematically correct, produced with an approved algorithm and with a valid (neither expired nor revoked) certificate issued by a known and trustworthy Trust Service Provider. It does not need to be a qualified electronic signature or seal or time-stamp.
- "Not Valid" means that the user data contained in the test object contains a digital signature or electronic time-stamp which is mathematically not correct but produced with an approved algorithm and with a valid (neither expired nor revoked) certificate issued by a known and trustworthy Trust Service Provider. It does not need to be a qualified electronic signature or seal or time-stamp.
- "undefined".

<span id="page-20-4"></span><span id="page-20-3"></span><span id="page-20-2"></span><span id="page-20-1"></span><span id="page-20-0"></span>

| Container<br>Name | Schema<br>XML | Binary | Preservation<br>Time | Digital<br>Signature<br>or<br>electronic<br>Time-stamp    |
|-------------------|---------------|--------|----------------------|-----------------------------------------------------------|
| XAIP_OK           | Valid         | No     | Future               | No digital signature<br>and no<br>Electronic time-stamp   |
| XAIP_OK_SIG       | Valid         | No     | Future               | Valid                                                     |
| XAIP_NOK_EXPIRED  | Valid         | No     | Past                 | undefined                                                 |
| XAIP_NOK          | Not Valid     | No     | Future               | undefined                                                 |
| XAIP_NOK_SIG      | Valid         | No     | Future               | Not Valid                                                 |
| XAIP_NOK_ER       | Valid         | No     | Future               | Evidence Record NOT Valid                                 |
|                   |               |        |                      | Digital Signature /<br>Electronic time-stamp<br>undefined |

#### Table 3: Definition of test data in detail

<span id="page-21-2"></span><span id="page-21-1"></span><span id="page-21-0"></span>

| Container<br>Name  | Schema<br>XML | Binary | Preservation<br>Time | Digital<br>Signature<br>or<br>electronic<br>Time-stamp    |
|--------------------|---------------|--------|----------------------|-----------------------------------------------------------|
| XAIP_NOK_SIG_OK_ER | Valid         | No     | Future               | Evidence Record Valid                                     |
|                    |               |        |                      | Digital Signature /<br>Electronic time-stamp Not<br>Valid |
| XAIP_OK_SIG_OK_ER  | Valid         | No     | Future               | Evidence Record Valid                                     |
|                    |               |        |                      | Digital Signature /<br>Electronic time-stamp Valid        |
| XAIP(BIN)          | Valid         | No     | Future               | Evidence Record Valid                                     |
|                    |               |        |                      | Digital Signature /<br>Electronic time-stamp Valid        |

<span id="page-22-4"></span><span id="page-22-2"></span>

| Container<br>Name                                                                                          | Schema<br>XML | Binary | Preservation<br>Time | Digital<br>Signature<br>or<br>electronic<br>Time-stamp             |
|------------------------------------------------------------------------------------------------------------|---------------|--------|----------------------|--------------------------------------------------------------------|
| BIN restricted<br>to the<br>formats<br>preservation<br>object<br>described in clause 2, Notice<br>4        | ---           | Yes    | undefined            | If existing, Digital Signature<br>/ Electronic time-stamp<br>valid |
| BIN_NOK_SIG restricted to<br>the<br>object<br>preservation<br>pursuant to clause<br>formats<br>2, Notice 4 | ---           | Yes    | undefined            | Digital Signature /<br>Electronic time-stamp Not<br>Valid          |
| DXAIP_OK                                                                                                   | Valid         | No     | Future               | No Digital Signature and no<br>Electronic time-stamp               |
| DXAIP_OK_SIG                                                                                               | Valid         | No     | Future               | Valid Digital Signature /<br>Electronic time-stamp                 |
| DXAIP_NOK                                                                                                  | Not Valid     | No     | Future               | Undefined                                                          |
| DXAIP_NOK_SIG                                                                                              | Valid         | No     | Future               | Not Valid                                                          |

## <span id="page-22-5"></span><span id="page-22-3"></span>3.4 Occurring Abbreviations

Table 4: Occurring Abbreviations

<span id="page-22-1"></span><span id="page-22-0"></span>

| Abbreviation | Meaning                                 |
|--------------|-----------------------------------------|
| AES-128      | Advanced Encryption Standard (128 bits) |

| Abbreviation | Meaning                                 |
|--------------|-----------------------------------------|
| AOID         | Archive Object Identifier               |
| ATS          | Archive Time-Stamp                      |
| BIN          | Binary                                  |
| BSI          | Federal Office for Information Security |
| C14N         | Canonical XML Version 1.0               |
| C14N11       | Canonical XML Version 1.1               |
| C14N20       | Canonical XML Version 2.0               |
| CMS          | Cryptographic Message Syntax            |
| CRL          | Certificate Revocation List             |
| DES          | Data Encryption Standard                |
| DoS          | Denial of Service                       |
| DLXAIP       | Delta-LXAIP                             |
| DXAIP        | Delta-XAIP                              |
| e.g.         | for example (exempli gratia)            |
| EC14N        | Exclusive XML Canonicalization          |
| ECM          | Enterprise Content Management           |

| Abbreviation | Meaning                                       |
|--------------|-----------------------------------------------|
| ERS          | Evidence Record Syntax                        |
| ETSI         | European Telecommunication Standard Institute |
| HTTP         | Hypertext Transfer Protocol                   |
| i.e.         | in other words (id est)                       |
| ID           | Identifier                                    |
| IT           | Information Technology                        |
| LXAIP        | Logical XAIP                                  |
| (L)XAIP      | XAIP or LXAIP                                 |
| M            | Modules                                       |
| MER          | Merkle hash trees                             |
| n/a          | not applicable                                |
| No.          | Number                                        |
| OCSP         | Online Certificate Status Protocol            |
| Par.         | Paragraph                                     |
| PKCS         | Public Key Cryptographic Standard             |
| PKI          | Public Key Infrastructure                     |

| Abbreviation | Meaning                                                  |
|--------------|----------------------------------------------------------|
| RC2          | Rivest Cipher 2                                          |
| resp.        | respectively                                             |
| RFC          | Request for Comments                                     |
| RMI          | Remote Method Invocation                                 |
| RPC          | Remote Procedure Call                                    |
| S            | Interfaces                                               |
| SASL         | Simple Authentication and Security Layer                 |
| SCVP         | Server-based Certification Validation Protocol           |
| Sig          | Signature                                                |
| SOAP         | Simple Object Access Protocol                            |
| SQL          | Structured Query Language                                |
| ST           | Security Target                                          |
| TCP          | Transmission Control Protocol                            |
| TLS          | Transport Layer Security                                 |
| TSP          | Trust Service Provider                                   |
| TOT          | Target of Testing, here the to be tested TR-ESOR Product |

| Abbreviation | Meaning                                             |
|--------------|-----------------------------------------------------|
| TR           | Technical Guideline (German: Technische Richtlinie) |
| Transformer  | "ETSI TS119512 TR-ESOR Transformator"               |
| TSP          | Time-Stamp Protocol                                 |
| USB          | Universal Serial Bus                                |
| WSDL         | Web Services Description Language                   |
| XAIP         | XML-based Archive Information Package               |
| XML          | Extensible Markup Language                          |
| XSD          | XML Schema Description                              |

# 4. The Test Cases for Conformity Level 1 – Functional Conformity

## 4.1 Tests for all products

### 4.1.1 A-01 – Middleware modules should be realised as separate modules

| Identifier          | A-01                                                                                                                                                                                                                                                                                                                                                                              |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | M1:A3.2-1, M1:A3.1-1                                                                                                                                                                                                                                                                                                                                                              |
|                     | M2:A3.2-1                                                                                                                                                                                                                                                                                                                                                                         |
|                     | M3:A3.1-4                                                                                                                                                                                                                                                                                                                                                                         |
| Test Purpose        | The test shall verify that the middleware or middleware components runs as independent applications or independent (functionally delimited) parts of an<br>application on a trustworthy IT system. They are neither a logical nor functional component of upstream IT specialist applications and can be replaced by<br>new, functionally compatible implementations at any time. |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                                     |
| Pre-test conditions | •<br>The middleware documentation is available.<br>•<br>User manual is present.                                                                                                                                                                                                                                                                                                   |

<span id="page-27-2"></span><span id="page-27-1"></span><span id="page-27-0"></span>

| Step | Test sequence of A-01                                 | Expected Results                                                 | Observations |
|------|-------------------------------------------------------|------------------------------------------------------------------|--------------|
| 1.   | Check the definition of the modules in the            | The middleware is based on modular components, which can         |              |
|      | middleware documentation. Check especially the        | be replaced by new implementations or there are explanations     |              |
|      | interface definitions and whether there is a guidance | why this is not necessary. The interfaces and upgrade strategies |              |
|      | for upgrading the modules to a new product version.   | are documented.                                                  |              |
|      |                                                       |                                                                  |              |

<span id="page-28-0"></span>

| Step | Test sequence of A-01                                                                                                                                                                                                                                                                                                     | Expected Results                                                                                                             | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------|--------------|
| 2.   | Check, whether the IT system is trustworthy, on<br>which the module is implemented.<br>For this purpose, the vendor could<br>provide an<br>especially hardened system or could<br>assume an<br>especially hardened system.<br>The test fails, if no settings for the baseline system are<br>assumed or already provided.8 | There are vendor statements about the trustworthy IT system,<br>which serves as a platform for the execution of the modules. |              |
| 3.   | Check the TOT and/or the user manual, whether the<br>Modules are neither a logical or a functional<br>component of an upstream IT specialized<br>applications.                                                                                                                                                            | The Modules are neither a logical nor a functional component<br>of upstream IT specialist applications.                      |              |

#### Verdict of A-01

<sup>8</sup> For example, if the vendor just states that the product runs on the platform XYZ, the test fails. If the vendor states that the products runs on the platform XYZ and a security white paper of the vendor of this platform may be considered, the test passes.

### 4.1.2 A-02 – The external upper interfaces (inbound and outbound) of the TR-ESOR-Middleware shall be either the TR-S.4- or TR-S.512-interface and in case of Upload-/Download-Module shall be based on open, standardised cryptographic protocols.

<span id="page-29-0"></span>

| Identifier          | A-02                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | MD:A4.3-1                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|                     | MD:A6.1-1, :A6.1-2, MD:A6.2-1, MD:A6.3-3                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                     | MD:A7.2-7, MD:A7.2-8                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                     | M1:A3.2-1, M1:A3.2-2                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Test Purpose        | The test shall verify that the interfaces for the exchange of data between                                                                                                                                                                                                                                                                                                                                                                                        |
|                     | -<br>client application or<br>XML-Adapter or Transformer Module and<br>-<br>the TR-ESOR-Middleware<br>are generally described in the user manual and realised as either XML-based TR-S.4- or TR-S.512-interfaces and<br>corresponding schema definitions.<br>If the<br>Upload- and Download-Modules are also implemented, it shall also to be checked whether these interfaces are also based on open, standardised protocols<br>and data formats and interfaces. |
| Configuration       | CONFIG_Common,                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|                     | Conditional: CONFIG_Uplaod,                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                     | Conditional: CONFIG_Download.                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Pre-test conditions | •<br>Test user has user manual and user guide.<br>•<br>Conditional: If existent, the Upload- and Download-Module are installed and configured. Upload-Module shall be configured in such a way that<br>only Upload of BIN, linked to a LXAIP and referenced there acc. to [TR-ESOR-F], Sec. 3.2, is possible. The Upload-/Download-Module shall use<br>standardised, non-proprietary and published cryptographic protocols only.                                  |

| Step | Test sequence of A-02                                                                                                                                                                                                                                                                  | Expected Results                                                                                                                                                                                                         | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check in the user manual, whether the TOT external<br>upper interface for data exchange is<br>described and<br>defined pursuant to either TR-S.4- or TR-S.512 (e.g.<br>take a look at the interface definitions within the<br>annex [TR-ESOR-E]).                                      | The<br>interface is<br>defined pursuant to either TR-S.4- or TR-S.512<br>(c.f. [TR-ESOR-E]).                                                                                                                             |              |
| 2.   | Compare the implemented data exchange interface<br>with their definitions described in the user manual.                                                                                                                                                                                | The interface is<br>implemented the way it has been defined and<br>fulfils the requirements of the [TR-ESOR-E]                                                                                                           |              |
| 3.   | Conditional:<br>If<br>the<br>Upload-<br>and<br>Download-Module<br>, check in the user manual, whether<br>are implemented<br>the interfaces of the Upload- and Download-Module,<br>use<br>open, standardised interfaces of standardised<br>and interfaces19.<br>cryptographic protocols | The interfaces of the Upload- and Download-Module<br>are<br>standardised and published interfaces of standardised<br>cryptographic protocols. The used standards are documented in<br>the user manual of the middleware. |              |
| 4.   | Conditional:<br>If<br>the<br>Upload-<br>and<br>Download-Module<br>, compare the implemented data<br>are implemented<br>exchange of the<br>with<br>Upload-<br>and<br>Download-Module<br>their definitions described in the user manual.                                                 | The interfaces and protocols are implemented the way they<br>have been defined and fulfil the requirements of the [TR-ESOR<br>E].                                                                                        |              |

|  | Verdict of A-02 |
|--|-----------------|
|--|-----------------|

#### <span id="page-31-1"></span>4.1.3 A-03 – No access without mutual authentication[9](#page-31-1)

| Identifier          | A-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A7.2-2, MD:A7.2-4, MD:A7.2-5, MD:A7.2-6, MD:A7.2-7, MD:A7.2-11                                                                                                                                                                                                                                                                                                                                                                                                                            |  |
|                     | MD:A7.4-23, MD:A7.4-24                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |  |
|                     | M1:A4.0-5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |
|                     | M3:A5.1-1, M3:A5.1-2                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
|                     | OVR-7.16-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
|                     | PRP-8.1-01,<br>PRP-8.1-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |
| Test Purpose        | The test shall verify (i) that any access from a source module to a target module can only take place via defined interfaces and is impossible without prior<br>mutual authentication, (ii) that the mutual authentication between source and target module is cryptographically sufficient so that it is impossible to<br>exchange individual components without being noticed and (iii) that it is impossible to bypass authentication mechanisms of two components by a replay<br>attack. |  |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  |
| Pre-test conditions | •<br>Source and target module are not mutually authenticated.<br>•<br>User manual is present.                                                                                                                                                                                                                                                                                                                                                                                                |  |

<span id="page-31-0"></span>

| Step | Test sequence of A-03                                                   | Expected Results                                                                                           | Observation |
|------|-------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|-------------|
| 1.   | Check the user manual for information about<br>standardised interfaces. | The list of interfaces and authentications possibilities pursuant<br>to a standardised protocol is stated. |             |

<sup>9</sup> The following test course assumes that the mutual authentication of the entities can be separated. In fact, there are situations where for security reasons such a separation isn't possible. In such cases the test course shall be anticipated.

<span id="page-32-0"></span>

| Step | Test sequence of A-03                                                                                                                                                                 | Expected Results                                                                                                                                                                                                       | Observation |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|
| 2.   | Check the user manual for information about the used<br>standard, which is fulfilled by the protocol between the<br>source and target module.                                         | A standardised protocol is in usage.                                                                                                                                                                                   |             |
| 3.   | the target module (the TOT10) without<br>Send requests to<br>any identification or authentication at all.                                                                             | One of the following results is expected:<br>-<br>A response is given that the request couldn't be executed.                                                                                                           |             |
| 4.   | Send requests to the target module (the TOT) after the<br>valid authentication of the source module only.                                                                             | One of the following results is expected:<br>-<br>A response is given that the request couldn't be executed.                                                                                                           |             |
| 5.   | Send requests to the target module (the TOT) after the<br>valid authentication of source and target module.                                                                           | A valid response is sent back by the target module.                                                                                                                                                                    |             |
| 6.   | After step 4 send another request to the target module<br>(the TOT) without mutual authentication.                                                                                    | If there is no secured tunnel established:<br>-<br>A response is given that the request couldn't be executed.<br>If there is a secured tunnel established:<br>-<br>A valid response is sent back by the target module. |             |
| 7.   | Replace the source module by a fake. Do not take over<br>the authentication credentials of the source module.                                                                         | The replacement took place.                                                                                                                                                                                            |             |
| 8.   | Try to establish a connection between source and target<br>component (the TOT) without authentication.                                                                                | -<br>A response is given that the request couldn't be executed.                                                                                                                                                        |             |
| 9.   | Try to establish a connection between source and target<br>component (the TOT) with authentication.<br>Try to also fake the authentication credentials of the<br>faked source module. | -<br>A response is given that the request couldn't be executed.                                                                                                                                                        |             |

10 TOT means here ArchiSafe or Upload-Module or Download-Module (see also A-03.1 and A-03.2).

| Step | Test sequence of A-03                                                                                                                                                                                                            | Expected Results                                                                      | Observation |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|-------------|
| 10.  | Start logging the data traffic between the TOT and<br>another component.                                                                                                                                                         | The data logging process has been started.                                            |             |
| 11.  | Establish a valid and mutually authenticated<br>connection between the two components and place<br>more than one request from source to target module<br>(TOT) and more than one response from target module<br>(TOT) to source. | A valid connection is established and a valid answer from the<br>TOT is received.     |             |
| 12.  | Close the connection of the two components.                                                                                                                                                                                      | The complete data exchange between the components has been<br>intercepted and logged. |             |

| Verdict of A-03 |
|-----------------|
|                 |
|                 |

<span id="page-34-0"></span>4.1.3.1 A-03.1 – Mutual authenticated secure communication channel between client application and ArchiSafe-Module or (conditional) Upload-Module or Download-Module[11](#page-34-0)

| Identifier          | A-03.1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | MD:A.5.1-28                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|                     | MD:A.7.2-2, MD:A.7.2-5, MD:A.7.2-6, MD:A.7.2-7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|                     | M.1:A.4.0-5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|                     | PRP-8.1-01,<br>PRP-8.1-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Test Purpose        | The test shall<br>verify whether a secure communication channel with certificate-based, mutual authentication and data encryption is used for each<br>transmission between the ArchiSafe-Module or (conditional) Upload-Module or Download-Module and the client application.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Configuration       | CONFIG_ArchiSafe (includes secure Channel enforcement by ArchiSafe) if an ArchiSafe-Module is present                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                     | Conditional: CONFIG_Upload ( with secure Channel, e.g. TLS or other standardized enforcement by Upload) if an Upload-Module is present                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                     | Conditional: CONFIG_Download ( with secure Channel, e.g. TLS or other standardized enforcement by Download) if an Download-Module is present                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Pre-test conditions | •<br>The IT system documentation is available.<br>•<br>If required, perform identification and authentication.<br>•<br>Administration access to the IT systems is needed.<br>•<br>"XAIP" shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>BIN<br>•<br>shall be restricted<br>to the<br>described in clause<br>2, Notice 4.<br>object<br>formats<br>preservation<br>•<br>Conditional: If existent, the Upload-<br>and Download-Module are installed and configured. Upload-Module is configured in such a way that only<br>Upload of BIN linked to a LXAIP and referenced there acc. to [TR-ESOR-F], Sec. 3.2 is possible. The Upload-/Download-Modules use standardised<br>and published cryptographic protocols only.<br>•<br>The test dispenses if the pre-supposition is not valid. |

 <sup>11</sup> The following test course assumes that the mutual authentication of the entities can be separated. In fact, there are situations where for security reasons such a separation isn't possible. In such cases the test course shall be anticipated.

<span id="page-35-2"></span><span id="page-35-1"></span><span id="page-35-0"></span>

| Step | Test sequence of A-03.1                                                                                                                                                                                                                                                                                         | Expected Results                                                                                                                                                                                                                                                                                                                                                         | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Verify that the client application also use a secure<br>channel for the communication with either the TR<br>S.412 or TR-S.512 interface of ArchiSafe or the Upload<br>Module or the Download-Module.                                                                                                            | The client application is configured in such a way that a secure<br>channel with certificate-based mutual authentication will be<br>used.                                                                                                                                                                                                                                |              |
|      | The Upload-Module is usable only<br>If<br>implemented<br>for Upload BIN linked to a LXAIP and referenced<br>there acc. to [TR-ESOR-F], Sec. 3.2; no Upload of XAIP<br>nor LXAIP is possible. The Upload-and Download<br>Module use standardised, non-proprietary and<br>published cryptographic protocols only. | The client application and the Upload-Module,<br>if<br>implemented,<br>are configured in such a way that only Upload of BIN linked to<br>a LXAIP and referenced there acc. to [TR-ESOR-F], Sec. 3.2 is<br>possible. Upload-/Download-Module uses standardised, non<br>proprietary and published cryptographic protocols only<br>No Upload of XAIP nor LXAIP is possible. |              |
| 2.   | Try to store a XAIP_OK_SIG or LXAIP_OK_SIG or BIN<br>and then retrieve a new (L)XAIP_OK_SIG<br>or<br>XAIP(BIN).                                                                                                                                                                                                 | Data can be transmitted and the function be called. The<br>XAIP/BIN can be stored. Only TR-ESOR TR-S.4 or the TR-S.512<br>of [ETSI TS 119 512]<br>13 -<br>interface is used.                                                                                                                                                                                             |              |
| 3.   | Disable the authentication on the client application<br>site.                                                                                                                                                                                                                                                   | Authentication<br>is not active any more on client application site.<br>ArchiSafe or the equivalent middleware interface still requires a<br>mutual authentication.                                                                                                                                                                                                      |              |
| 4.   | Try to store a XAIP_OK_SIG<br>or LXAIP_OK_SIG or BIN<br>and then retrieve a new XAIP_OK_SIG or XAIP(BIN).<br>Try to update an existing archive object.<br>Try to delete an existing archive object.                                                                                                             | No data is transmitted because no encryption tunnel with<br>authentication is active. ArchiSafe or the equivalent<br>middleware interface does not accept any connection<br>without<br>authentication.<br>14 -<br>Only TR-ESOR TR-S.4 or the TR-S.512 of [ETSI TS 119 512]<br>interface of ArchiSafe is used.                                                            |              |

 <sup>12</sup> Either S.4 or S.512 shall be supported.

<sup>13</sup> Either S.4 or S.512 shall be supported.

<sup>14</sup> Either S.4 or S.512 shall be supported.

<span id="page-36-0"></span>

| Step | Test sequence of A-03.1                                                                                                                                                                                                                               | Expected Results                                                                                                                                                                                                                                                         | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 5.   | Create a new secure channel und then disable Data<br>encryption on the client application site.                                                                                                                                                       | Data encryption s not active any more on client application site.<br>ArchiSafe or the equivalent middleware interface still requires<br>data encryption                                                                                                                  |              |
| 6.   | Try to store a XAIP_OK_SIG<br>or LXAIP_OK_SIG or BIN<br>and then retrieve a new XAIP_OK_SIG or XAIP(BIN).<br>Try to update an existing archive object.<br>Try to delete an existing archive object.                                                   | No data is transmitted because no encryption tunnel is active.<br>ArchiSafe or the equivalent middleware interface does not<br>accept any unencrypted connection.<br>15 -<br>Only TR-ESOR TR-S.4 or the TR-S.512 of [ETSI TS 119 512]<br>interface of ArchiSafe is used. |              |
| 7.   | Conditional:<br>the test steps<br>If<br>implemented,<br>LXAIP<br>is<br>from No. 2 to No. 4 are to be repeated for LXAIP.                                                                                                                              | See expected results of the test cases<br>from No. 2 to No. 4 for<br>LXAIP.                                                                                                                                                                                              |              |
| 8.   | Conditional:<br>test<br>If<br>implemented,<br>the<br>ASiC-AIP<br>is<br>steps from No. 2 to No. 4 are to be repeated for ASiC<br>AIP.                                                                                                                  | See expected results of the test cases from No. 2 and No. 4 for<br>ASiC-AIP.                                                                                                                                                                                             |              |
| 9.   | Conditional:<br>If<br>the<br>Upload-Module<br>and<br>the<br>verify that the<br>Download-Module<br>are implemented,<br>client application also use a secure channel for the<br>communication with the Upload<br>–Module<br>and the<br>Download-Module. | The client application is configured in such a way that a secure<br>channel with certificate-based mutual authentication will be<br>used. No XAIP or LXAIP is transmitted by Upload-Module,<br>because no XAIP nor LXAIP are allowed to be stored by Upload<br>Module.   |              |
| 10.  | Conditional:<br>If<br>the<br>Upload-Module<br>and<br>the<br>verify that the<br>Download-Module<br>are implemented,<br>client application also use a secure channel for the<br>communication with the Upload-<br>and Download<br>Module.               | The client application is configured in such a way that a secure<br>channel with certificate-based mutual authentication will be<br>used.                                                                                                                                |              |

 <sup>15</sup> Either S.4 or S.512 shall be supported.

| Step | Test sequence of A-03.1                                                                                                                                                                                                                                               | Expected Results                                                                                                                                                                                                    | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 11.  | Conditional:<br>If<br>the<br>Upload-Module<br>and<br>the<br>try to upload a<br>Download-Module<br>are implemented,<br>BIN<br>linked to a LXAIP and referenced there acc. to<br>[TR-ESOR-F], Sec. 3.2 and then to download this BIN<br>and to retrieve XAIP(BIN).      | Data can be transmitted and the function be called. The BIN can<br>be stored. Then, the BIN is downloaded successfully and the<br>XAIP(BIN) is also retrieved successfully.                                         |              |
| 12.  | Conditional:<br>If<br>the<br>Upload-Module<br>and<br>the<br>disable the<br>Download-Module<br>are implemented,<br>authentication on the client application site.                                                                                                      | Authentication<br>is not active any more on client application site.<br>Upload Module and Download-Module still require a mutual<br>authentication.                                                                 |              |
| 13.  | Conditional:<br>If<br>the<br>Upload-Module<br>and<br>the<br>try to store a<br>Download-Module<br>are implemented,<br>BIN<br>linked to a<br>LXAIP and referenced there acc. to<br>[TR-ESOR-F], Sec. 3.2 and then to download this BIN<br>and retrieve a new XAIP(BIN). | No data is transmitted by Upload-<br>or Download-Module,<br>because no tunnel with authentication is active. The Upload<br>Module and the Download-Module do not accept any<br>connection<br>without authentication |              |
| 14.  | Conditional:<br>If<br>the<br>Upload-Module<br>and<br>the<br>disable data<br>Download-Module<br>are implemented,<br>encryption<br>on the client application site.                                                                                                      | Data encryption is not active any more on client application<br>site. Upload Module and Download-Module still require data<br>encryption.                                                                           |              |
| 15.  | Conditional:<br>If<br>the<br>Upload-Module<br>and<br>the<br>try to store a<br>Download-Module<br>are implemented,<br>BIN<br>linked to a<br>LXAIP and referenced there acc. to<br>[TR-ESOR-F], Sec. 3.2 and then to download this BIN<br>and retrieve a new XAIP(BIN). | No data is transmitted by Upload-<br>or Download-Module,<br>because no encryption tunnel is active. The Upload-Module<br>and the Download-Module do not accept any unencrypted<br>connection.                       |              |

#### Verdict of A-03.1

4.1.3.2 A-03.2 – Mutual authenticated secure communication between (XML-Adapter or Transformer-Module) and (ArchiSafe-Module or Upload-Module or Download-Module) and (if existing) between (Upload- or Download-Module) and the ECM-/Long-Term Storage

#### Pre-supposition:

• An ArchiSafe-Module or (conditional) Upload- or Download-Module, which has an interface to an XML-Adapter or Transformer-Module. and/or

• An Upload- or Download-Module, which has an interface to the ECM-/Long-Term Storage.

| Identifier          | A-03.2                                                                                                                                                                                                                                                                                                                                                                   |  |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A.7.2-2, MD:A.7.2-3, MD:A.7.2-4, MD:A.7.2-5, MD:A.7.2-6, MD:A.7.2-7                                                                                                                                                                                                                                                                                                   |  |
|                     | PRP-8.1-01,<br>PRP-8.1-03                                                                                                                                                                                                                                                                                                                                                |  |
| Test Purpose        | The test shall<br>verify that when using a secure communication channel without certificate-based authentication, a transmission between the ArchiSafe<br>Module or Upload-<br>or Download-Module<br>and the XML-Adapter or Transformer-Module is not possible.                                                                                                          |  |
| Configuration       | CONFIG_ArchiSafe (includes secure Channel enforcement by ArchiSafe) if an ArchiSafe-Module is present                                                                                                                                                                                                                                                                    |  |
|                     | Conditional: CONFIG_Upload (includes e.g. TLS or other standardized enforcement by Upload) if an Upload-Module is present                                                                                                                                                                                                                                                |  |
|                     | Conditional: CONFIG_Download (includes e.g. TLS or other standardized enforcement by Download) if an Download-Module is present                                                                                                                                                                                                                                          |  |
| Pre-test conditions | •<br>The IT system documentation is available.                                                                                                                                                                                                                                                                                                                           |  |
|                     | •<br>If required, perform identification and authentication.                                                                                                                                                                                                                                                                                                             |  |
|                     | •<br>Administration access to the IT systems is needed.                                                                                                                                                                                                                                                                                                                  |  |
|                     | •<br>This test dispenses if neither a XML-Adapter nor a Transformer-Module nor an Upload-/Download-Module is implemented<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.                                                                                                              |  |
|                     | •<br>Conditional: If existent, the Upload-<br>and Download-Module are installed and configured.<br>Upload-Module is configured in such a way that only<br>Upload of BIN linked to LXAIP and referenced there acc. to [TR-ESOR-F],<br>Sec. 3.2 is possible. The Upload-/Download-Module uses standardised,<br>non-proprietary and published cryptographic protocols only. |  |
|                     | •<br>The test dispenses if the pre-supposition is not valid.                                                                                                                                                                                                                                                                                                             |  |

<span id="page-39-1"></span><span id="page-39-0"></span>

| Step | Test sequence of A-03.2                                                                                                                                                                                                                                                                                                                   | Expected Results                                                                                                                                                                                                                                                                   | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Verify that, if existent, the XML-Adapter and if<br>existent, the Transformer-Module<br>uses a secure<br>channel tunnel for the communication with the TR<br>S.4 or TR-S.512 of [ETSI TS119512]<br>16 interface of<br>ArchiSafe.                                                                                                          | If existent, the XML-Adapter and if existent, the Transformer<br>Module is configured in such a way that a communication<br>channel with certificate-based mutual authentication with the<br>TR-S.4 or TR-S.512 of [ETSI TS 119 512]<br>17 interface of<br>ArchiSafe will be used. |              |
| 2.   | Establish a communication channel without using a<br>certificate on client application site.                                                                                                                                                                                                                                              | A secure channel cannot be established.                                                                                                                                                                                                                                            |              |
| 3.   | Establish a communication channel without using a<br>valid<br>certificate on client application site.                                                                                                                                                                                                                                     | A channel cannot be established.                                                                                                                                                                                                                                                   |              |
| 4.   | Conditional:<br>If<br>the<br>Upload-Module<br>and<br>the<br>verify that the<br>Download-Module<br>are implemented,<br>Upload-Module or Download-Module<br>also use a<br>secure channel tunnel for the communication with<br>the ECM-/Long-Term Storage by using standardised,<br>non-proprietary and published cryptographic<br>protocols | Upload-Module or Download-Module<br>are configured in such<br>a way that a secure channel enforcement will be used by using<br>standardised, non-proprietary and published cryptographic<br>protocols.                                                                             |              |
| 5.   | Conditional:<br>If<br>the<br>Upload-Module<br>and<br>the<br>Download-Module<br>or Transformer-Module<br>are<br>establish a communication channel by<br>implemented,<br>using<br>standardised, non-proprietary and published<br>cryptographic protocols without using a certificate on<br>client application site.                         | A secure channel cannot be established.                                                                                                                                                                                                                                            |              |

 <sup>16</sup> Either S.4 or S.512 shall be supported.

<sup>17</sup> Either S.4 or S.512 shall be supported.

| Step | Test sequence of A-03.2                                  | Expected Results                 | Observations |
|------|----------------------------------------------------------|----------------------------------|--------------|
| 6.   | Conditional:<br>If<br>the<br>Upload-Module<br>and<br>the | A channel cannot be established. |              |
|      | Download-Module<br>or Transformer-Module<br>are          |                                  |              |
|      | establish a communication channel<br>implemented,        |                                  |              |
|      | standardised, non-proprietary and published              |                                  |              |
|      | cryptographic protocols without using a valid            |                                  |              |
|      | certificate on client application site.                  |                                  |              |
|      |                                                          |                                  |              |

| Verdict of A-03.2 |
|-------------------|
|                   |
|                   |

#### 4.1.3.3 A-03.3 – secure communication channels are based on suitable cryptographic procedures

| Identifier          | A-03.3                                                                                                                                                                                                                       |  |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A7.2-3<br>PRP-8.1-01                                                                                                                                                                                                      |  |
| Test Purpose        | The test shall<br>verify that secure communication channels use cryptographic procedures that are strong enough to ensure data integrity and confidentiality.                                                                |  |
| Configuration       | CONFIG_ArchiSafe (includes secure channel (e.g. TLS) enforcement by ArchiSafe) if an ArchiSafe-Module is present                                                                                                             |  |
| Pre-test conditions | •<br>The middleware documentation is available.<br>•<br>The IT system documentation is available.<br>•<br>If required, perform identification and authentication.<br>•<br>Administration access to the IT systems is needed. |  |

<span id="page-42-2"></span><span id="page-42-1"></span><span id="page-42-0"></span>

| Step | Test sequence of A-03.3                                                                                                                                 | Expected Results                                                                                                                                                                                                                                                                                                                        | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Verify that the client application also uses an<br>encrypted communication tunnel for the<br>communication with the TR-S.418 interface of<br>ArchiSafe. | The client application is configured in such a way that an<br>encrypted communication tunnel with certificate-based<br>mutual authentication will be used. The used algorithms are<br>sufficiently strong cryptographic procedures pursuant to the<br>19 including [TR 02102]<br>BSI Minimum Standard [BSIMindTLS]<br>and [TR 03116-4]. |              |
| 2.   | Try to establish an encrypted communication tunnel<br>using a weak encryption algorithm (e.g. RC2, DES) on<br>client application site.                  | A communication tunnel cannot be established.                                                                                                                                                                                                                                                                                           |              |
| 3.   | Try to establish an encrypted communication tunnel<br>using a strong encryption algorithm (e.g. AES-128) on<br>client application site.                 | A communication tunnel can be established.                                                                                                                                                                                                                                                                                              |              |
| 4.   | Try to establish an encrypted tunnel with illegal<br>parameters in the handshake message                                                                | A tunnel cannot be established.                                                                                                                                                                                                                                                                                                         |              |
| 5.   | Try to establish an encrypted tunnel with a wrong or<br>incomplete certificate                                                                          | A tunnel cannot be established.                                                                                                                                                                                                                                                                                                         |              |
| 6.   | Try to establish an encrypted tunnel with a certificate<br>expired.                                                                                     | A tunnel cannot be established.                                                                                                                                                                                                                                                                                                         |              |

 <sup>18</sup> Either S.4 or S.512 shall be supported.

<sup>19</sup> Se[e https://www.bsi.bund.de/DE/Themen/Oeffentliche-Verwaltung/Mindeststandards/TLS-Protokoll/TLS-Protokoll\\_node.html](https://www.bsi.bund.de/DE/Themen/Oeffentliche-Verwaltung/Mindeststandards/TLS-Protokoll/TLS-Protokoll_node.html)

| Step | Test sequence of A-03.3                                             | Expected Results                | Observations |
|------|---------------------------------------------------------------------|---------------------------------|--------------|
| 7.   | Try to establish an encrypted tunnel with a wrong<br>MAC algorithm. | A tunnel cannot be established. |              |

| Verdict of A-03.3 |
|-------------------|
|                   |
|                   |

| Identifier          | A-04                                                                                                                     |  |  |  |
|---------------------|--------------------------------------------------------------------------------------------------------------------------|--|--|--|
| Requirement         | MD:A7.2-11                                                                                                               |  |  |  |
|                     | MD:A7.4-25, MD:A7.4-26                                                                                                   |  |  |  |
| Test Purpose        | The test shall<br>verify that it is impossible to bypass authentication mechanisms of two components by a replay attack. |  |  |  |
| Configuration       | CONFIG_Common                                                                                                            |  |  |  |
| Pre-test conditions |                                                                                                                          |  |  |  |

### 4.1.4 A-04 – Authentication procedure shall be resistant against replay attacks

<span id="page-44-0"></span>

| Step | Test sequence of A-04                                                                                                                            | Expected Results                                                                      | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|--------------|
| 1.   | Start logging the data traffic between the TOT and<br>another component.                                                                         | The data logging process has been started.                                            |              |
| 2.   | Establish a valid and mutually authenticated<br>connection between the two components and place a<br>request from source to target module (TOT). | A valid connection is established and a valid answer from the<br>TOT is received.     |              |
| 3.   | Close the connection of the two components.                                                                                                      | The complete data exchange between the components has been<br>intercepted and logged. |              |
| 4.   | Replay the intercepted data in order to establish a<br>valid authenticated connection between the attacker<br>and the TOT.                       | No connection is established.                                                         |              |

#### Verdict of A-04

### **4.1.5** A-05 – Protection of communication channel and interface shall be robust against DoS-attacks

<span id="page-45-0"></span>

| Identifier          | A-05                                                                                                                                                                                                                                                                                                                          |  |  |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|--|
| Requirement         | MD:A7.2-12                                                                                                                                                                                                                                                                                                                    |  |  |  |
|                     | MD:A7.4-26                                                                                                                                                                                                                                                                                                                    |  |  |  |
| Test Purpose        | The test shall<br>verify that any unauthorised access to authentication or payload data during communication is reliably prevented and that the<br>interface is<br>implemented in such a way that denial of service (DoS) or consequential errors, such as buffer overflow or SQL injections are not possible.                |  |  |  |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                                 |  |  |  |
| Pre-test conditions | •<br>If required, perform identification and authentication.<br>•<br>About 30 threads can be started for about 60 seconds.<br>•<br>There are 5 types of (L)XAIPs ready to be used for a PreservePO-Request<br>(TR-S.512) or ArchiveSubmisseionRequest<br>(TR-S.4):<br>< 50 MB<br>< 100 MB<br>< 500 MB<br>< 1 GB MB<br>> 1 GB. |  |  |  |

| Step | Test sequence of A-05                                                                                                                                                                                                                                                                                                          | Expected Results                                                                                                                                                   | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Start logging the data traffic between the TOT and<br>another component.                                                                                                                                                                                                                                                       | The data logging process has been started.                                                                                                                         |              |
| 2.   | Establish a valid and mutually authenticated<br>connection between the two components and place a<br>request from source to target module (TOT).                                                                                                                                                                               | A valid connection is established and a valid answer from the<br>TOT is received.                                                                                  |              |
| 3.   | Close the connection of the two components.                                                                                                                                                                                                                                                                                    | The complete data exchange between the components has been<br>intercepted and logged.                                                                              |              |
| 4.   | Check if the logged traffic data reveals any<br>authorisation or payload data.                                                                                                                                                                                                                                                 | No authorisation or payload data is revealed.                                                                                                                      |              |
| 5.   | Automatically send a large amount of small requests<br>to the TOT interface in a short period of time and<br>check if its availability is affected (DoS). Use several<br>client applications on several computers in parallel in<br>order to completely fill the network bandwidth of at<br>least 10 Mbit provided to the TOT. | The availability is not affected in a negative way. The TOT<br>responses to all the requests or identify the DoS targets and<br>block<br>them.                     |              |
| 6.   | Establish a valid connection between the components<br>and place requests to the TOT with large amounts of<br>data to provoke buffer overflows.                                                                                                                                                                                | -<br>The sent data is properly processed and checked for<br>plausibility.<br>-<br>Invalid data is rejected<br>-<br>No buffer overflow will occur                   |              |
| 7.   | Establish a valid connection between the components<br>and place requests to the TOT with included database<br>command sequences.                                                                                                                                                                                              | -<br>The sent data is properly processed and checked for<br>plausibility.<br>-<br>Invalid data is rejected<br>-<br>The included database commands are not executed |              |

| Verdict of A-05 |  |  |  |  |
|-----------------|--|--|--|--|
|                 |  |  |  |  |
|                 |  |  |  |  |

### 4.1.6 A-06 – A secure tunnel can be maintained after successful authentication

<span id="page-47-0"></span>

| Identifier          | A-06                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |  |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M2:A6.2-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
|                     | MD:7.2-4, MD:7.2-6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
| Test<br>Purpose     | A secure tunnel can be maintained after successful authentication                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |  |
| Pre-test conditions | •<br>Tester has access rights to the Cryptographic-Module.<br>•<br>No mutual authentication between the Cryptographic-Module and the interface partner was made.<br>•<br>M.2 is configured to use a secure tunnel.<br>•<br>The hash of XAIP_OK_SIG or XAIP(BIN)<br>or BIN<br>is present.<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.<br>•<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>be configured.<br>•<br>BIN<br>shall be restricted<br>to the preservation object formats<br>described in clause<br>2, Notice 4. |  |

| Step | Test sequence of A-06                                                                                                                                                                                                                                                                                                                                                               | Expected Results                                                                                                                                                                                                                                     | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Transfer the archival information package<br>XAIP_OK_SIG<br>or<br>XAIP(BIN)<br>or BIN<br>or DXAIP_OK_SIG<br>to the TOT using the interface (TR-S.4 function either<br>"Verify" or "ValidateEvidence" [TS 119 512]<br>(TR-S.512).<br>Observe either the output "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                    | The call of the function with this XAIP / XAIP(BIN) / BIN /<br>DXAIP_OK_SIG<br>as parameter is possible but a negative feedback<br>will be received or the call of the function is not possible at all<br>because Crypto-Module declined connection. |              |
| 2.   | Establish a valid connection between the components<br>and perform the mutual authentication.                                                                                                                                                                                                                                                                                       | A valid connection is established and performing of the<br>authentication is possible.                                                                                                                                                               |              |
| 3.   | Transfer the archival information package<br>XAIP_OK_SIG<br>or<br>XAIP(BIN)<br>or BIN<br>to the TOT using<br>the interface function either "Verify" or<br>"ValidateEvidence" in case of (TR-S.4) -<br>or TR<br>S.512-interfaces.                                                                                                                                                    | The call of the function with this XAIP / XAIP(BIN) / BIN<br>/XAIP_OK_SIG<br>as parameter is possible.                                                                                                                                               |              |
| 4.   | Observe either the output of "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                                                                                                                                                                                                                     | A positive feedback will be received; no error message or error<br>code.                                                                                                                                                                             |              |
| 5.   | Conditional:<br>Sign<br>([TR-ESOR-E],<br>If<br>the<br>function<br>"<br>"<br>5.1.2)<br>clause<br>exists<br>and<br>a valid<br>connection<br>is<br>ArchiSafe<br>established<br>between<br>and<br>Crypto-Module,<br>transfer the archival information package XAIP_OK<br>or<br>XAIP(BIN)<br>or BIN<br>or<br>DXAIP_OK_SIG<br>to the TOT<br>using the interface (TR-S.1) function "Sign". | If the function exists, the call of the function with this XAIP /<br>X(BIN)/ BIN/DXAIP_OK_SIG as parameter is possible.                                                                                                                              |              |
| 6.   | Observe the output of "SignResponse".                                                                                                                                                                                                                                                                                                                                               | A positive feedback will be received; no error message or error<br>code.                                                                                                                                                                             |              |

| Step | Test sequence of A-06                                                                                                                                                                                                                                                                                                                    | Expected Results                                                                                | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|--------------|
| 7.   | Establish a valid connection between ArchiSafe and<br>Crypto-Module and transfer the hash of the archival<br>information package XAIP_OK<br>or XAIP(BIN)<br>or BIN<br>or<br>DXAIP_OK_SIG<br>to the TOT using the interface (TR<br>S.3) function "Sign<br>([TR-ESOR-E], clause 5.3.1)<br>requesting a timestamp" as a TimestampRequest34. | The call of the function with this hash as parameter is possible.                               |              |
| 8.   | Observe the output of the interface function<br>"SignResponse<br>with timestamp".                                                                                                                                                                                                                                                        | A positive feedback will be received; no error message or error<br>code.                        |              |
| 9.   | Transfer the archival information package XAIP_OK<br>or XAIP(BIN)<br>or BIN<br>or DXAIP_OK_SIG<br>to the TOT<br>using the interface (TR-S.3) function "Hash"<br>([TR<br>ESOR-E], clause 5.3.3).                                                                                                                                          | The call of the function with this XAIP / X(BIN)/<br>BIN/DXAIP_OK_SIG as parameter is possible. |              |
| 10.  | Observe the output of "HashResponse".                                                                                                                                                                                                                                                                                                    | A positive feedback will be received; no error message or error<br>code.                        |              |
| 11.  | Conditional:<br>the test steps<br>If<br>LXAIP<br>is<br>implemented,<br>No. 1 to No. 10 are repeated for LXAIP.                                                                                                                                                                                                                           | See expected results of No. 1 to No. 10.                                                        |              |
| 12.  | Conditional:<br>the<br>test<br>If<br>ASiC-AIP<br>is<br>implemented,<br>steps from No. 1 to No. 10 are to be repeated for ASiC<br>AIP.                                                                                                                                                                                                    | See expected results of the test case from No. 1 and No. 10 for<br>ASiC-AIP.                    |              |

Verdict of A-01

### 4.1.7 A-07 – Secure administration interfaces

| Identifier          | A-07                                                                                                                                                          |  |
|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A6.1-5                                                                                                                                                     |  |
| Test Purpose        | The test shall<br>verify that the middleware supports secure administration and configuration.                                                                |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                              |  |
| Pre-test conditions | •<br>The middleware is installed and configured.<br>•<br>The middleware documentation is available.<br>•<br>The user has administration rights on the system. |  |

<span id="page-50-0"></span>

| Step | Test sequence of A-07                                                                                                           | Expected Results                                                                                              | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the middleware documentation for the<br>possibilities of administration and configuration.                                | The documentation states that secure administration and<br>configuration is possible.                         |              |
| 2.   | Check the middleware's administration and<br>configuration features.                                                            | The middleware supports secure<br>administration and<br>configuration.                                        |              |
| 3.   | Start a data traffic capture tool to record the data<br>between client application and middleware.                              | Data traffic capturing is started.                                                                            |              |
| 4.   | Try to connect remotely to the middleware<br>administration and configuration interface.                                        | The credentials of an authorised user are needed to access the<br>administration and configuration interface. |              |
| 5.   | Try to log in to the middleware administration and<br>configuration interface using the credentials of an<br>unauthorised user. | Access is denied.                                                                                             |              |

| Step | Test sequence of A-07                                                                                                         | Expected Results                                                                        | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|--------------|
| 6.   | Try to log in to the middleware administration and<br>configuration interface using the credentials of an<br>authorised user. | Access is granted.                                                                      |              |
| 7.   | Change several options and save the current settings.                                                                         | It is possible to change the configuration and save the new<br>settings.                |              |
| 8.   | Stop the data traffic capture tool.                                                                                           | Data traffic capturing is stopped.                                                      |              |
| 9.   | Check the captured traffic log file.                                                                                          | All the data that was transmitted<br>during the administration<br>process is encrypted. |              |

Verdict of A-07

### 4.1.8 A-08 – No security breach induced by administration interfaces or components

| Identifier          | A-08                                                                                                                                                                                                                                                                                                                      |
|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | MD:A7.4-22                                                                                                                                                                                                                                                                                                                |
|                     | M2:A6.3-4                                                                                                                                                                                                                                                                                                                 |
| Test Purpose        | The test shall<br>verify, that security characteristics of the middleware overall and of individual components, as well as the integrity and the authenticity of the<br>stored data and documents can not compromised by an administration interface of the middleware or individual<br>components without being noticed. |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                             |
| Pre-test conditions |                                                                                                                                                                                                                                                                                                                           |

<span id="page-52-0"></span>

| Step | Test sequence of A-08                                                                                                                                          | Expected Results                                                                                   | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check whether the access to administration interfaces<br>is possible without any means of identification and<br>authentication.                                | When accessing the administration interfaces, the user is asked<br>for authentication.             |              |
| 2.   | Check whether any archive data can be accessed using<br>the administrative interfaces that should<br>not be<br>accessible for the authenticated administrator. | No unauthorised access to any documents is possible.                                               |              |
| 3.   | Check whether any administration settings can be<br>accessed that should<br>not be accessible for an<br>authenticated non-administrative user.                 | No unauthorised access to any administration setting is<br>possible.                               |              |
| 4.   | Check whether the administrative interface can still<br>be used for administration after logging out.                                                          | After logging out of any administration interface none of its<br>functions are available any more. |              |

| Step | Test sequence of A-08                                                                                                                             | Expected Results                                                                                                 | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|--------------|
| 5.   | Check whether the actions performed by the<br>administration interfaces are recorded in a log file.                                               | The log file shows the performed administrative actions.                                                         |              |
| 6.   | Check whether the administration interfaces allow<br>altering digitally signed documents while bypassing<br>the required cryptographic functions. | It is not possible to alter a digitally signed document while<br>bypassing the required cryptographic functions. |              |

| Verdict of A-08 |  |  |  |  |
|-----------------|--|--|--|--|
|                 |  |  |  |  |
|                 |  |  |  |  |

### 4.1.9 A-09 – Administration interfaces shall be available for authorised accounts only

<span id="page-53-0"></span>

| Identifier          | A-09                                                                                                                                                      |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | MD:A7.4-22, MD:A7.4-23                                                                                                                                    |
|                     | M1:A4.0-4                                                                                                                                                 |
|                     | PRP-8.1-01                                                                                                                                                |
|                     | PRP-8.1-03                                                                                                                                                |
| Test Purpose        | The test shall<br>verify that any administration interfaces of the middleware or of any individual components are accessible to authorised accounts only. |
| Configuration       | CONFIG_Common                                                                                                                                             |
| Pre-test conditions | •<br>The middleware is installed and configured.                                                                                                          |
|                     | •<br>The middleware documentation is available.                                                                                                           |

| Step | Test sequence of A-09                                                                                                            | Expected Results                                                                      | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|--------------|
| 1.   | Check if there is an official definition of an authorised<br>account.                                                            | The authorised accounts are defined.                                                  |              |
| 2.   | Try to access the administration interfaces without<br>authentication.                                                           | It is not possible to access the administration interfaces without<br>authentication. |              |
| 3.   | Try to intercept the authentication of an authorised<br>person to perform a replay attack.                                       | The administration interfaces cannot be accessed.                                     |              |
| 4.   | Try to access the administration interfaces by<br>guessing administrator credentials or unchanged<br>system default credentials. | The administration interfaces cannot be accessed.                                     |              |

Verdict of A-09

<span id="page-55-1"></span>

| 4.1.10 A-10 – Additional interfaces20 shall not compromise security |  |
|---------------------------------------------------------------------|--|
|---------------------------------------------------------------------|--|

| Identifier          | A-10                                                                                                                                                                  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | M1:A3.2-3                                                                                                                                                             |
| Test Purpose        | The test shall<br>verify that the implementation of additional interfaces do not compromise the guarantee of basic security-relevant requirements (see Chapter<br>5). |
| Configuration       | CONFIG_Common                                                                                                                                                         |
| Pre-test conditions | •<br>The test dispenses if no additional interfaces are implemented.<br>•<br>User manual is present.                                                                  |

<span id="page-55-0"></span>

| Step | Test sequence of A-10                                                                                                                                                                                          | Expected Results                                                                                                                          | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Perform test cases A-4 and A-5, and check whether<br>the additional interfaces of the TOT enables an<br>attacker to spoof another secure module (e.g.<br>ArchiSafe or the storage).                            | The additional interfaces do not provide such a capability or do<br>even not provide the property to connect from or to other<br>modules. |              |
| 2.   | Perform test cases A-4 and A-5, and check whether<br>the additional interfaces of the TOT enables an<br>attacker to submit a data object or to request Evidence<br>Records by circumventing security features. | The additional interfaces do not provide such a capability or do<br>even not provide the property to connect from or to other<br>modules. |              |

 <sup>20</sup> Other than either the S.4- or S.512 interface

| Step | Test sequence of A-10                                                                                                                                  | Expected Results                                            | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|--------------|
| 3.   | Perform test cases A-4 and A-5, and check whether<br>the additional interfaces of the TOT enables an<br>attacker to circumvent the self-test function. | The additional interfaces do not provide such a capability. |              |

| Verdict of A-10 |
|-----------------|
|                 |
|                 |

### <span id="page-57-1"></span>4.1.11 A-11 – What happens to the data at the end of the preservation period shall be stated in the Preservation Evidence Policy of the TR-ESOR Product-Manufacturer[21](#page-57-1)

<span id="page-57-0"></span>

| Identifier          | A-11                                                                                                                                                                                                                          |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | MD:A4.1-1                                                                                                                                                                                                                     |
|                     | MD:A5.1-29                                                                                                                                                                                                                    |
|                     | OVR-6.1-09                                                                                                                                                                                                                    |
| Test Purpose        | The test shall<br>verify that in the Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT], is described<br>what happens to the data at the end of the preservation period. |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                              |
| Pre-test conditions | •<br>Preservation Evidence Policy (PEP)<br>of the TR-ESOR-Product-Manufacturer, based on the BSI-[TR-ESOR-PEPT], is present and published.                                                                                    |

 <sup>21</sup> New requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

| Step | Test sequence of A-11                                                                                                                                                                         | Expected Results                                                                                                                                            | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the Preservation Evidence Policy for<br>information about what happens to the data at the<br>end of the preservation period.                                                            | The necessary details of what happens to the data at the end of<br>the preservation period<br>are<br>stated.                                                |              |
| 2.   | Check onsite<br>and verify:<br>-<br>whether what happens to the data at the end of the<br>preservation period, takes place as documented                                                      | What happens to the data at the end of the preservation period,<br>takes place as documented in the Preservation Evidence Policy<br>of the TR-ESOR product. |              |
| 3.   | Conditional: In case of federal and state public bodies,<br>check, whether the requirement (A4.1-1) pursuant to<br>[TR-ESOR], clause 4 is fulfilled at the end of the<br>preservation period. | What happens to the data at the end of the preservation period,<br>takes place as documented in [TR-ESOR], clause 4, (A4.1-1).                              |              |

| Verdict of A-11 |  |
|-----------------|--|
|                 |  |
|                 |  |

### <span id="page-59-1"></span>4.1.12 A-12 – The TOT shall support at least one Preservation Profile, which is publicly published and can be retrieved as described in the User Manual and Preservation Evidence Policy (PEP) of the TOT (TR-ESOR Product)[22](#page-59-1)

<span id="page-59-0"></span>

| Identifier          | A-12                                                                                                                                                       |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | MD:A6.1-6                                                                                                                                                  |
|                     | b)<br>OVR-6<br>OVR-6<br>.4-01,<br>.4-04                                                                                                                    |
|                     | PRP-8.1-04                                                                                                                                                 |
| Test Purpose        | The test shall<br>verify that how to retrieve the Preservation Profile is described in the User Manual.                                                    |
|                     | The test shall<br>verify that the supported input formats and conditionally additional output formats are contained or referred in each publicly published |
|                     | Preservation Profile.                                                                                                                                      |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                           |
| Pre-test conditions | •<br>User manual is present.                                                                                                                               |
|                     | •<br>Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT], is present and published.                    |
|                     | •<br>Preservation Profile is present and published.                                                                                                        |
|                     | •<br>The middleware is installed and configured.                                                                                                           |
|                     | Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.                            |

 <sup>22</sup> New requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

| Step | Test sequence of A-12                                                                                                                                                                                                                                                                                                                    | Expected Results                                                                                                                                                                                                                                                       | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check whether at least one Preservation Profile is<br>published and supported by the TOT.                                                                                                                                                                                                                                                | At least one Preservation Profile is published and is supported<br>by the TOT.                                                                                                                                                                                         |              |
| 2.   | Check the user manual and Preservation Evidence<br>Policy for information about how to retrieve the<br>Preservation Profile.                                                                                                                                                                                                             | The necessary details, how to retrieve the Preservation Profile,<br>are<br>stated.                                                                                                                                                                                     |              |
| 3.   | Retrieve the published Preservation Profiles and<br>check, whether the supported input formats and<br>output formats and operations are contained or<br>referred in each received Preservation Profile<br>described in a documentation referenced by the<br>Preservation Profile.                                                        | For<br>each operation the Preservation Profile contains:<br>•<br>The supported operations<br>•<br>and supported input and<br>output parameter,<br>•<br>incl. used data formats.                                                                                        |              |
| 4.   | Use the interface function "RetrieveInfo" to<br>receive a Preservation Profile.                                                                                                                                                                                                                                                          | The call of the function is<br>possible.                                                                                                                                                                                                                               |              |
| 5.   | Observe the output of "RetrieveInfoResponse".                                                                                                                                                                                                                                                                                            | A positive feedback is received. No error message or error code<br>occurs. At least one Preservation Profile is received, which is<br>also publicly published.                                                                                                         |              |
| 6.   | Observe the received Preservation Profiles and verify,<br>whether the supported operations, input formats and<br>output formats in each received Preservation Profile<br>are described in the Preservation Evidence Policy<br>(PEP) of the TR-ESOR-Product Manufacturer<br>referenced by the Preservation Profile (e.g. [TR<br>ESOR-E]). | The supported operations, input formats and output formats in<br>each received Preservation Profile are described in the<br>Preservation Evidence Policy (PEP) of the TR-ESOR-Product<br>Manufacturer<br>referenced by the Preservation Profile (e.g. [TR<br>ESOR-E]). |              |

Verdict of A-12

### <span id="page-62-1"></span>4.1.13 A-13 – Each installed Preservation Profile shall contain an identifier which uniquely identifies this Preservation Profile [23](#page-62-1)

| Identifier          | A-13                                                                                                                                                                                                                                                                          |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A6.1-6                                                                                                                                                                                                                                                                     |  |
|                     | OVR-6.4-04<br>a                                                                                                                                                                                                                                                               |  |
| Test Purpose        | The test shall<br>verify that each installed Preservation Profile contains an identifier, which uniquely identifies this Preservation Profile.                                                                                                                                |  |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                 |  |
| Pre-test conditions | •<br>Preservation Profile is present.<br>•<br>User has administrator rights on the system.<br>•<br>If required, perform identification and authentication.<br>•<br>Test case A-12 was performed successful and the identifiers of the active Preservation Profiles are known. |  |

<span id="page-62-0"></span>

| Step | Test sequence of A-13                                          | Expected Results                                   | Observations |
|------|----------------------------------------------------------------|----------------------------------------------------|--------------|
| 1.   | Compare on-site the known Preservation Profile<br>identifiers. | No two Preservation Profile identifiers are equal. |              |

| Verdict of A-13 |  |
|-----------------|--|
|                 |  |
|                 |  |

 <sup>23</sup> New requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

### <span id="page-63-1"></span>4.1.14 A-14 – The Preservation Evidence Policy of the TR-ESOR-Product Manufacturer shall contain the description of how the preservation evidence is created including, which cryptographic algorithms are used.[24](#page-63-1)

| Identifier          | A-14                                                                                                                                                                                                                                                                                                                    |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A6.1-7<br>OVR-6.5-03                                                                                                                                                                                                                                                                                                 |  |
| Test Purpose        | The test shall<br>verify that each installed<br>(PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT],<br>Preservation<br>Evidence<br>Policy<br>shall<br>contain the description of how the preservation evidence is created including which cryptographic algorithms are supported.               |  |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                           |  |
| Pre-test conditions | •<br>Preservation Evidence Policy<br>(PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT], is present and published.<br>•<br>Preservation Profile is present and published.<br>•<br>Test case A-12 was performed successful and<br>the identifiers of the active Preservation Profiles are known. |  |

<span id="page-63-0"></span> <sup>24</sup> New requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

| Step | Test sequence of A-14                                                                                                                                                                                 | Expected Results                                                                                                                                                                                                             | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the Preservation Evidence Policy, which is<br>referenced by the Preservation Profile.                                                                                                           | This Preservation Evidence Policy<br>contains<br>or references the<br>description of how the preservation evidence is created and<br>describes which cryptographic algorithms are used.                                      |              |
| 2.   | Check and compare on-site<br>-<br>how the preservation evidence is created and<br>-<br>which cryptographic algorithms are supported<br>with the documentation in the Preservation Evidence<br>Policy. | The result of the comparison is that<br>•<br>how the preservation evidence is created and<br>which cryptographic algorithms are used,<br>•<br>are implemented and work as documented in the Preservation<br>Evidence Policy. |              |

Verdict of A-14

## 4.2 Module 1 – ArchiSafe

#### Pre-supposition:

A product which claims to comply with the M.1 ArchiSafe specification of this TR (Conformity level 1 – Functional Conformity) has to pass

- all test cases in this section and
- all test cases for the interface TR-S.4 specified in Section 4.5.4.

### 4.2.1 M.1-01 Preservation Services conform to [eIDAS-VO], [ETSI TS 119 401], [ETSI TS 119 511] and using the preservation product [TR-ESOR] should fulfil the security objectives and requirements of [ASS 319 4011] and [ASS 119 511]

#### *NOTICE 7:*

The following assessment-criteria for ETSI 319 401 and ETSI TS 119 511 are developed as **Assessment/Audit Manuals for Conformity Assessment Bodies (CABs), see:**

<span id="page-65-0"></span>

| Short Name    | Title                                                                                                                                                                                                                                                     |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [ASS 319 401] | BSI,<br>Criteria for Assessing Trust Service Providers against ETSI Policy<br>Requirements, Part 1: Assessment Criteria for all TSP -<br>ETSI EN 319 401                                                                                                  |
| [ASS 119 511] | BSI, Criteria for Assessing Trust Service Providers against ETSI Policy<br>Requirements, Part 2: Assessment Criteria providing long-term preservation of<br>digital signatures or general data using digital signature techniques -<br>ETSI TS<br>119 511 |

<span id="page-65-1"></span>and are to be found under the link [https://www.bundesnetzagentur.de/cln\\_121/EVD/DE/Fachkreis/Empfehlungen/Empfehlungen-node.html](https://www.bundesnetzagentur.de/cln_121/EVD/DE/Fachkreis/Empfehlungen/Empfehlungen-node.html)

#### NOTICE 8:

"If the PSP claims to use a certified TR-ESOR product [TR-ESOR] of version V1.2.1 or higher and the claimed [TR-ESOR] certified product is in fact deployed for providing this service, proved e.g. by comparing the digital fingerprint of relevant executables, then the assessment result of the equivalent [ETSI TS 119 511] - test case is substituted by the TR-ESOR-certification result and this [ETSI TS 119 511] - assessment test step SHALL be omitted." (see [ASS 119 511], clause 3.4.1)

The Federal Office for Information Security **recommends** that the certification of Preservation Services pursuant to **[eIDAS-VO]**, **[ETSI TS 119 401]**, **[ETSI TS 119 511]** is based on these Criteria for Assessing Trust Service Providers **[ASS 319 401]** and **[ASS 319 401]** including the **Integration of TR-ESOR Products in the ETSI TS 119 511 certification process, as described in [ASS 119 511]**.

## 4.2.2 M.1-02 – ArchiSafe-Module shall be separated and deployed on a trustworthy IT system

<span id="page-66-0"></span>

| Identifier          | M.1-02                                                                                                                                                                                                                         |  |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M1:A3.1-2                                                                                                                                                                                                                      |  |
|                     |                                                                                                                                                                                                                                |  |
| Test Purpose        | The test shall<br>verify that the ArchiSafe-Module is a component of the middleware and runs as an independent application or as an independent<br>(functionally separated) part of an application on a trustworthy IT system. |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                               |  |
| Pre-test conditions | •<br>The middleware documentation is available.<br>•<br>The IT system documentation is available.                                                                                                                              |  |

| Step | Test sequence of M.1-02                                                                                        | Expected Results                                                                                                                                                                                 | Observations |
|------|----------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the IT system documentation about the<br>implemented security mechanisms for the underlying<br>platform. | There are recommendations or requirements to ensure the<br>trustworthiness of the platform ArchiSafe is running on.<br>Alternatively, ArchiSafe is delivered on a security enhanced<br>platform. |              |
| 2.   | Check the middleware documentation for a<br>description of the design of<br>the ArchiSafe-Module.              | The ArchiSafe-Module is designed as an independent module<br>or is at least functionally separated from other parts of the<br>product.                                                           |              |

Verdict of M.1-02

### 4.2.3 M.1-03 – Access to ECM storage shall be claimed to be controlled by ArchiSafe-Module and if existent, also by the Upload- and Download-Module

<span id="page-68-0"></span>

| Identifier          | M.1-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A7.4-1, MD:A7.4-2, MD:A7.4-15, MD:A7.4-16                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |  |
|                     | M1:A3.1-1, M1:A3.1-3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  |
|                     | M1:A5.0-2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |  |
| Test Purpose        | The test shall<br>verify that any application access to the data on the ECM-/Long-Term Storage via the TOT (TR-ESOR Middleware) is claimed to be controlled<br>and performed by the ArchiSafe-Module and if existent, also by the Upload-<br>or Download-Module.                                                                                                                                                                                                                                                                                    |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |
|                     | Conditional: CONFIG_Upload                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  |
|                     | Conditional: CONFIG_Download                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| Pre-test conditions | •<br>The ArchiSafe-Module is installed and configured.<br>•<br>The middleware documentation is available.<br>•<br>The user has administration rights on the system.<br>•<br>Conditional:<br>the Upload-<br>and Download-Module are installed and configured. Upload-Module is configured in such a way that only<br>If<br>existent,<br>Upload of BIN linked to a LXAIP and referenced there acc. to [TR-ESOR-F], Sec. 3.2 is possible. The Upload-/Download-Module use standardised,<br>non-proprietary and published cryptographic protocols only. |  |

| Step | Test sequence of M.1-03                                                                  | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Observations |
|------|------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the middleware documentation for the<br>description of the data storage process.   | New data objects are not sent to the ECM-/Long-Term Storage<br>directly but only by using the middleware function calls either<br>"ArchiveSubmission" or "PreservePO" of the ArchiSafe<br>Module or,<br>the protocols and<br>interfaces of the<br>if<br>existent,<br>Upload-<br>and Download-Module.<br>Upload-Module is only allowed to upload BIN linked to a<br>LXAIP and referenced there acc. to [TR-ESOR-F], Sec. 3.2 by<br>using<br>standardised, non-proprietary and published<br>cryptographic protocols only. |              |
| 2.   | Check the<br>middleware documentation for the<br>description of the data change process. | Existing data objects are not changed on the ECM-/Long-Term<br>Storage directly but only by using the middleware function<br>calls of the ArchiSafe-Module.                                                                                                                                                                                                                                                                                                                                                             |              |
| 3.   | Check the middleware documentation for the<br>description of the data deletion process.  | Existing data objects are not deleted from the ECM-/Long<br>Term Storage directly but only by using the middleware<br>function calls either "ArchiveDeletion" or the "DeletePO"<br>of the ArchiSafe-Module.                                                                                                                                                                                                                                                                                                             |              |

| Verdict of M.1-03 |  |  |  |  |  |
|-------------------|--|--|--|--|--|
|                   |  |  |  |  |  |
|                   |  |  |  |  |  |

### 4.2.4 M.1-04 – Support of specified functions

<span id="page-70-0"></span>

| Identifier    | M.1-04                                                                                                                                                                                                                                                                                                                                                                  |
|---------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement   | MD:<br>A5.1-1, MD:<br>A5.1-2, MD:<br>A5.1-3, MD:<br>A5.1-4; MD: A5.1-5                                                                                                                                                                                                                                                                                                  |
|               | MD:<br>A5.1-11, MD:<br>A5.1-13, MD:<br>A5.1-16, MD:<br>A5.1-17                                                                                                                                                                                                                                                                                                          |
|               | MD:<br>A5.1-20, MD:<br>A5.1-22, MD:<br>A5.1-25, MD:<br>A5.1-26, MD:<br>A5.1-27, MD:<br>A5.1-29                                                                                                                                                                                                                                                                          |
|               | MD:<br>A5.1-31, MD:<br>A5.1-32, MD:<br>A5.1-34, MD: A5.1-37, MD: A5.1-38, MD: A5.1-39                                                                                                                                                                                                                                                                                   |
|               | MD: A5.1-40, MD: A5.1-41, MD: A5.1-42                                                                                                                                                                                                                                                                                                                                   |
|               | MD:A6.1-1, MD:A6.2-1, MD:A6.3-1, MD:A6.3-2, MD A7.4-1, MD A7.4-2                                                                                                                                                                                                                                                                                                        |
|               | M1:A4.0-1                                                                                                                                                                                                                                                                                                                                                               |
|               | AF:A3-1                                                                                                                                                                                                                                                                                                                                                                 |
|               | PRP-8.1-02,<br>PRP-8.1-05,<br>PRP-8.1-08,<br>PRP-8.1-09,<br>PRP-8.1-10,<br>PRP-8.1-11,<br>PRP-8.1-12,<br>PRP-8.1-14                                                                                                                                                                                                                                                     |
| Test Purpose  | verify that only the interface TR--S.4 or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] provides at least the following<br>The test shall<br>functions:                                                                                                                                                                                           |
|               | •<br>A function for the secure and reliable storage of archival information packages<br>•<br>A function for retrieving archival information packages (in (L)XAIP format)                                                                                                                                                                                                |
|               | •<br>A function for retrieving technical (cryptographic) Evidence Records<br>•<br>A function for deleting archived data                                                                                                                                                                                                                                                 |
|               | •<br>A function for updating archival information packages that have already been archived<br>•<br>A function for retrieving Preservation Profile(s)                                                                                                                                                                                                                    |
|               | verify that the interface TR--S.4 or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] provides the following<br>The test should<br>functions, if implemented:                                                                                                                                                                                        |
|               | •<br>A function for retrieving data elements of individual archival information packages<br>•<br>A function to verify an archive data object with evidence relevant data (digital signature, electronic time-stamp,<br>certificate, revocation lists,<br>OCSP-responses, ) and technical evidence data (evidence record)<br>•<br>A function for retrieving audit traces |
| Configuration | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                        |

| Identifier          | M.1-04                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Pre-test conditions | •<br>Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT], is present and published.<br>•<br>Either the S.4 or S.512 Preservation Profile is present and published.<br>User manual for TR-S.4 interface or for the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] is accessible<br>•<br>Developer documents of TR-S.4 interface or of the of TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] are accessible<br>•<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F], |
|                     | •<br>DXAIP means "DXAIP" or "DLXAIP"" pursuant to<br>[TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>BIN<br>•<br>shall be restricted<br>to the<br>described in clause2, Notice 4.<br>preservation<br>object<br>formats                                                                                                                                                      |

| Step | Test Sequence of M.1-04                                                                                                                                                                                                                                                                                               | Expected Results                                                                                                                                                                                                                           | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check if the middleware documentation contains the<br>description of the necessary functions either pursuant<br>to either TR-S.4 or TR-S.512<br>and that this description<br>corresponds with the interface specification of the<br>Preservation Profile, also included in the Preservation<br>Evidence Policy (PEP). | The necessary functions are defined in the documentation.<br>This description corresponds with the interface specification of<br>the published Preservation Profile, also included in the<br>published Preservation Evidence Policy (PEP). |              |
| 2.   | Store anXAIP_OK_SIG<br>or BIN<br>using either the<br>"ArchiveSubmission" or the "PreservePO"<br>function pursuant to either TR-S.4 or TR-S.512.                                                                                                                                                                       | The function<br>call is possible, the corresponding AOID will be<br>returned.                                                                                                                                                              |              |
| 3.   | Check the output of the<br>"ArchiveSubmissionResponse" or the<br>"PreservePOResponse".                                                                                                                                                                                                                                | The XAIP/BIN object is assigned to an AOID and returned<br>successfully.<br>The AOID can be used to retrieve the<br>corresponding XAIP/BIN.                                                                                                |              |

| Step | Test Sequence of M.1-04                                                                                                                                                                                                                                  | Expected Results                                                                                                                                                                                | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 4.   | Use<br>either the "ArchiveUpdate" or the<br>"UpdatePOC"<br>function with the AOID from step 3<br>and a DXAIP_OK<br>to change the<br>data stored within the<br>XAIP/ XAIP(BIN) pursuant to either TR-S.4 or TR<br>S.512.                                  | The function call is possible.                                                                                                                                                                  |              |
| 5.   | Check the output of the<br>"ArchiveUpdateResponse" or the<br>"UpdatePOCResponse".                                                                                                                                                                        | A new version ID is received.                                                                                                                                                                   |              |
| 6.   | Use either the "ArchiveRetrieval" or the<br>"RetrievePO with SubjectOfRetrieval<br>"PO"" function with the AOID from step 3 to retrieve<br>a XAIP with all versions (e.g. Version Id = "all") from<br>the storage pursuant to TR-S.4 or TR-S.512.        | The function call is possible.                                                                                                                                                                  |              |
| 7.   | Check the output of the<br>"ArchiveRetrievalResponse" or the<br>"RetrievePOResponse".                                                                                                                                                                    | The archive data object is received in XAIP format.                                                                                                                                             |              |
| 8.   | Use either the "ArchiveEvidence" or the<br>"RetrievePO<br>with SubjectOfRetrieval<br>"Evidence" " function with the AOID from step 3<br>to check the XAIP / BIN authenticity and integrity<br>concerning all versions pursuant to TR-S.4 or TR<br>S.512. | The function call is possible.                                                                                                                                                                  |              |
| 9.   | Check the output of the<br>"ArchiveEvidenceResponse" or the<br>"RetrievePOResponse".                                                                                                                                                                     | If there exist only one version of the archive data object, one<br>Evidence Record is received. Otherwise,<br>the Evidence Record of<br>the actual version of the XAIP or LXAIP<br>is received. |              |

| Step | Test Sequence of M.1-04                                                                                                                                                                                                                                                                                                                              | Expected Results                                                                                                | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|--------------|
| 10.  | ArchiveData<br>Search<br>If<br>either<br>the<br>"<br>"<br>or the<br>"<br>"<br>, use the "ArchiveData" or<br>function<br>is<br>implemented<br>the "Search<br>"<br>function with the AOID from step 3<br>and a valid dataLocation parameter to identify an<br>individual data element within the XAIP or BIN<br>pursuant to either TR-S.4 or TR-S.512. | The function call is possible.                                                                                  |              |
| 11.  | ArchiveData<br>or the<br>If<br>either<br>the<br>"<br>"<br>"Search"<br>, check the output<br>function<br>implemented<br>is<br>of the "ArchiveDataResponse" or the<br>"SearchResponse".                                                                                                                                                                | The requested data value and the original location value are<br>received.                                       |              |
| 12.  | Use either the "ArchiveDeletion" or the<br>"DeletePO" function with the AOID from step 3 to<br>delete the XAIP or the BIN pursuant to TR-S.4 or TR<br>S.512.                                                                                                                                                                                         | The function call is possible.                                                                                  |              |
| 13.  | Check the output of the<br>"ArchiveDeletionResponse" or the<br>"DeletePOResponse".                                                                                                                                                                                                                                                                   | The XAIP or BIN has been deleted from the storage.                                                              |              |
| 14.  | Use either the "Verify" or the "ValidateEvidence"<br>function with the XAIP/BIN from step 3 and the<br>evidence records from step 9 to check the XAIP, the<br>evidence relevant data and the evidence record(s)<br>pursuant to TR-S.4 or TR-S.512.                                                                                                   | The function call is possible.                                                                                  |              |
| 15.  | Check the output of the "VerifyResponse"<br>or the<br>ValidateEvidenceResponse.                                                                                                                                                                                                                                                                      | The "Verify"<br>function call<br>is possible and returns a return code<br>or a verification report, if ordered. |              |

| Step | Test Sequence of M.1-04                                                                                                                                             | Expected Results                                                                                                                                        | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 16.  | Use either the TR-S.4-"RetrieveInfo" or TR-S.512-<br>"RetrieveInfo" function to retrieve the actual<br>Preservation Profile.                                        | The function call is possible.                                                                                                                          |              |
| 17.  | Check the output of the TR-S.4-"RetrieveInfo" or<br>TR-S.512-"RetrieveInfo"<br>function.                                                                            | The actual Preservation Profile is received.                                                                                                            |              |
| 18.  | use either the TR-S.4-"ArchiveTrace"<br>If<br>implemented,<br>or TR-S.512-"RetrieveTrace" function to request<br>an audit trail element for a specific AOID.        | The function call is possible.                                                                                                                          |              |
| 19.  | heck the output of the TR-S.4-<br>If<br>implemented,<br>c<br>"ArchiveTrace" or TR-S.512-"RetrieveTrace"<br>function.                                                | The received Trace contains information with respect to the<br>relevant events, which happened within a preservation service<br>for the specified AOID. |              |
| 20.  | Conditional:<br>test steps<br>If<br>LXAIP<br>is<br>implemented,<br>the<br>from No. 1 to No. 15<br>are to be repeated for LXAIP.                                     | See expected results of the test cases from No. 1 to No. 15<br>for<br>LXAIP.                                                                            |              |
| 21.  | Conditional:<br>the test<br>If<br>ASiC-AIP<br>is<br>implemented,<br>steps from No. 1 to No. 15<br>except test steps No. 4 and 5<br>are to be repeated for ASiC-AIP. | See expected results of the test cases from No. 1 to No. 15<br>for<br>ASiC-AIP.                                                                         |              |

|  | Verdict of M.1-04 |  |  |  |
|--|-------------------|--|--|--|
|--|-------------------|--|--|--|

## 4.2.5 M.1-05 – Using interfaces TR-S.1 and TR-S.6 is possible

#### Pre-supposition:

A product, which claims to functionally comply with the interfaces specification TR-S.1 and TR-S.6 of this TR or part of it, has to pass the following test case or part of it or prove that it supports functional analogous interfaces.

| Identifier          | M.1-05                                                                                                                                                                                                                                           |  |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M1:A3.2-2                                                                                                                                                                                                                                        |  |
|                     | M1:A3.1-4                                                                                                                                                                                                                                        |  |
|                     | M1:A4.1-6                                                                                                                                                                                                                                        |  |
| Test Purpose        | The test shall<br>verify that the ArchiSafe-Module is able to access the other modules of the middleware via dedicated interfaces as described in the annexes<br>[TR-ESOR-M.2], [TR-ESOR-M.3]<br>and [TR-ESOR-E]<br>of this technical guideline. |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                 |  |
| Pre-test conditions | •<br>The tests of test case M.1-01 have been successfully completed.<br>•<br>The middleware documentation is available.                                                                                                                          |  |
|                     | •<br>The test dispenses if the pre-supposition is not valid.                                                                                                                                                                                     |  |

<span id="page-75-0"></span>

| Step | Test sequence of M.1-05                                                                                                | Expected Results                                 | Observations |
|------|------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|--------------|
| 1.   | Check if the ArchiSafe documentation contains the<br>description of how to connect to the interface TR-S.1.            | The interface is described in the documentation. |              |
| 2.   | Check if the ArchiSafe documentation contains the<br>description of how to connect to the interface TR-S.6.            | The interface is described in the documentation. |              |
| 3.   | Check if it is possible for the ArchiSafe-Module to<br>communicate with the Crypto-Module via the TR-S.1<br>interface. | Communication is possible.                       |              |

| Step | Test sequence of M.1-05                                                                                                  | Expected Results           | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------|----------------------------|--------------|
| 4.   | Check if it is possible for the ArchiSafe-Module to<br>communicate with the ArchiSig-Module via the TR<br>S.6 interface. | Communication is possible. |              |

| Verdict of M.1-05 |  |  |  |
|-------------------|--|--|--|
|                   |  |  |  |
|                   |  |  |  |

| 4.2.6 | M.1-06 – Comprehensive and configurable options for logging shall be offered |  |  |  |
|-------|------------------------------------------------------------------------------|--|--|--|
|       |                                                                              |  |  |  |

| Identifier          | M.1-06                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |  |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|--|
| Requirement         | MD:A5.1-1, MD:A5.1-17, MD:A5.1-33, MD:<br>A5.1-41, MD:<br>A5.1-42, MD:A5.2-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |  |  |
|                     | M1:A4.0-3, M1:A4.4-6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |  |  |
|                     | OVR-7.10-02                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |  |  |  |
|                     | OVR-7.16-04                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |  |  |  |
|                     | PRP-8.1-06                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  |  |  |
| Test Purpose        | The test shall<br>verify that the ArchiSafe-Module offers comprehensive and configurable options for logging any access to the archive.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |  |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  |  |  |
| Pre-test conditions | •<br>User manual is present.<br>•<br>Preservation Profile is present and published.<br>•<br>The ArchiSafe-Module is installed and configured.<br>•<br>The user has administration rights on the system.<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>BIN<br>•<br>shall be restricted<br>to the preservation object formats<br>escribed in clause2, Notice 4.<br>d |  |  |  |

<span id="page-77-0"></span>

| Step | Test sequence of M.1-06                                       | Expected Results                                                                    | Observations |
|------|---------------------------------------------------------------|-------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual of the software for logging<br>options. | Comprehensive and configurable logging options are described<br>in the user manual. |              |

| Step | Test sequence of M.1-06                                                                                                                                                                                                                                | Expected Results                                                                                                                                                                                             | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 2.   | Configure the log function to the most<br>comprehensive level.                                                                                                                                                                                         | Any kind of access to the archive will be logged to the log file.                                                                                                                                            |              |
| 3.   | Use the "RetrieveInfo" function in the context<br>of either the TR-S.4 or TR-S.512 interface.                                                                                                                                                          | The function call is possible. The RetrieveInfoResponse<br>may<br>contain the following sub-components:<br>-<br>Zero or one or more Profile elements.                                                        |              |
| 4.   | Store an XAIP_OK_SIG<br>or BIN<br>using either the<br>"ArchiveSubmission"<br>or "PreservePO"<br>function pursuant to TR-S.4 or TR-S.512.                                                                                                               | The function call is possible. The XAIP / BIN object is assigned<br>an AOID and stored successfully.                                                                                                         |              |
| 5.   | Use<br>either the "ArchiveUpdate" or "UpdatePOC"<br>function with the AOID from step 4 and a<br>DXAIP_OK_SIG or DXAIP_OK<br>to change the data<br>contained within the XAIP or XAIP(BIN) pursuant to<br>TR-S.4 or TR-S.512.                            | The function call is possible. A new version ID is received.                                                                                                                                                 |              |
| 6.   | Use either the "ArchiveRetrieval" or<br>"RetrievePO with SubjectOfRetrieval<br>"PO""<br>function with the AOID from step 3 and<br>SubjectOfRetrieval "PO" to retrieve the<br>XAIP/XAIP(BIN) from the storage pursuant to either<br>TR-S.4 or TR-S.512. | The function call is possible. The archive data object is received<br>in XAIP format.                                                                                                                        |              |
| 7.   | Use either the "ArchiveEvidence" or<br>"RetrievePO<br>with SubjectOfRetrieval<br>"Evidence" " function with the AOID from step 3<br>to check the XAIP / BIN authenticity and integrity for<br>all versions pursuant to either TR-S.4 or TR-S.512.      | The function call is possible. If there exist only one version of<br>the archive data object, one Evidence Record<br>is received.<br>Otherwise, for each existing version an Evidence Record is<br>received. |              |
| 8.   | Conditional:<br>If<br>implemented,<br>use either<br>the<br>ArchiveData<br>Search<br>with the<br>function<br>"<br>"<br>or "<br>"<br>AOID from step 3 and the dataLocation parameter to                                                                  | The function call is possible. The requested data value and the<br>original locationValue are received.                                                                                                      |              |

| Step | Test sequence of M.1-06                                                                                                                                                                                                                                                               | Expected Results                                                                                                                                   | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|      | identify an individual data element within the XAIP /<br>BIN pursuant to either TR-S.4 or TR-S.512.                                                                                                                                                                                   |                                                                                                                                                    |              |
| 9.   | Use either the "ArchiveDeletion" or "DeletePO"<br>function with the AOID from step 3 to delete the XAIP<br>/ BIN pursuant to either TR-S.4 or TR-S.512.                                                                                                                               | The function call is possible.                                                                                                                     |              |
| 10.  | Check the deletion by calling either the<br>"ArchiveRetrieval" or "RetrievePO<br>with<br>SubjectOfRetrieval "PO"" function<br>with AOID<br>from step 3 and SubjectOfRetrieval "PO".                                                                                                   | The "ArchiveRetrievalResponse" or<br>"RetrievePOResponse" indicates that no stored object with<br>corresponding AOID can be found in the storage   |              |
| 11.  | Use either the<br>Verify<br>or<br>ValidateEvidence<br>"<br>"<br>"<br>"-<br>function with the XAIP / BIN from step 3 and the<br>evidence records from step 7 to check the XAIP/BIN,<br>the evidence relevant data and the evidence record(s)<br>pursuant to either TR-S.4 or TR-S.512. | The function call is possible.                                                                                                                     |              |
| 12.  | Check the output "VerifyResponse" or<br>"ValidateEvidenceResponse" pursuant to<br>either TR-S.4 or TR-S.512.                                                                                                                                                                          | The "Verify" or<br>function<br>is possible<br>"<br>"-<br>ValidateEvidence<br>and returns a return code or a verification report, if ordered.       |              |
| 13.  | Check the log file for logs of all the access procedures<br>from the previous steps.                                                                                                                                                                                                  | The log file contains all the access procedures from the previous<br>steps and also the return codes (error, success) and actual return<br>values. |              |
| 14.  | use either the TR-S.4-"ArchiveTrace"<br>If<br>implemented,<br>or TR-S.512-"RetrieveTrace" function to request<br>an audit trail element for AOID from step 3.                                                                                                                         | The function call is possible.                                                                                                                     |              |

| Step | Test sequence of M.1-06                                                                                                      | Expected Results                                                                                                                                        | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 15.  | heck the output of either the TR<br>If<br>implemented,<br>c<br>S.4-"ArchiveTrace" or TR-S.512-"RetrieveTrace"<br>function.   | The received Trace contains information with respect to the<br>relevant events, which happened within a preservation service<br>for the specified AOID. |              |
| 16.  | Conditional:<br>the<br>test steps<br>If<br>is<br>implemented,<br>LXAIP<br>from No. 1 to No. 13 are to be repeated for LXAIP. | See expected results of the test cases from No. 1 to No. 13 for<br>LXAIP.                                                                               |              |
| 17.  | Conditional:<br>test steps<br>If<br>ASiC-AIP<br>is<br>implemented,<br>from No. 1 to No. 13 are to be repeated for ASiC-AIP.  | See expected results of the test cases from No. 1 to 13 for ASiC<br>AIP.                                                                                |              |

Verdict of M.1-06

### 4.2.7 M.1-07 – Access to log files shall be possible by authorized persons only

<span id="page-81-0"></span>

| Identifier          | M.1-07                                                                                                                                 |  |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A5.1-1                                                                                                                              |  |
|                     | M1:A4.0-4                                                                                                                              |  |
|                     | PRP-8.1-03                                                                                                                             |  |
| Test Purpose        | The test shall<br>verify that only authorised persons are able to access the log files that have been created by the ArchiSafe-Module. |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                       |  |
| Pre-test conditions | •<br>The ArchiSafe-Module is installed and configured.                                                                                 |  |
|                     | •<br>The user has administration rights on the system.                                                                                 |  |

| Step | Test sequence of M.1-07                                                                                                                                                                        | Expected Results                                                                                                                                                                                                                                                                                  | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the vendor documentation whether there is a<br>description how to restrict the access to the log<br>records.                                                                             | There is such a description or the documentation refers to the<br>access<br>control mechanism of the underlying platform.                                                                                                                                                                         |              |
| 2.   | Check the vendor documentation whether there are<br>recommendations regarding the access control<br>restrictions for the log files.                                                            | There are such recommendations. It is recommended that only<br>the authorized persons shall<br>be able to access (read) the log files.<br>Nobody shall<br>be able to modify the log files. Only<br>administrators are allowed to delete the log files after archiving<br>or after the end of use. |              |
| 3.   | Configure access restrictions as recommended in the<br>guidance.                                                                                                                               | Successfully possible.                                                                                                                                                                                                                                                                            |              |
| 4.   | Verify that an unauthorized person is not able to<br>access the log records.<br>Please take all recommended security mechanisms<br>into account, also the organizational and physical<br>ones. | Access is not possible.                                                                                                                                                                                                                                                                           |              |
| 5.   | use either the TR-S.4-"ArchiveTrace"<br>If<br>implemented,<br>or TR-S.512-"RetrieveTrace" function to request<br>an audit trail element for a specific AOID.                                   | The function call is possible.                                                                                                                                                                                                                                                                    |              |

| Verdict of M.1-07 |
|-------------------|
|                   |
|                   |

### 4.2.8 M.1-09 – ArchiSafe-Module is capable of serving and separating multiple clients

#### Pre-supposition:

An ArchiSafe-Module, which is capable of serving and separating multiple clients (multi-client-capability).

<span id="page-83-0"></span>

| Identifier          | M.1-09                                                                                                                       |  |
|---------------------|------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A6.1-3                                                                                                                    |  |
|                     | MD:A7.4-19                                                                                                                   |  |
| Test Purpose        | The test shall<br>check whether the middleware is able to manage multiple clients and separate the different clients' data.  |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                             |  |
|                     | Conditional: CONFIG_Upload                                                                                                   |  |
|                     | Conditional: CONFIG_Download                                                                                                 |  |
| Pre-test conditions | •<br>The middleware documentation is available.                                                                              |  |
|                     | •<br>If required, perform identification and authentication.                                                                 |  |
|                     | •<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].                                                     |  |
|                     | •<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.                               |  |
|                     | Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall be configured.<br>• |  |
|                     | BIN<br>•<br>shall be restricted<br>to the<br>described in clause<br>2, Notice 4.<br>preservation<br>object<br>formats        |  |
|                     | •<br>Conditional: If existent, the Upload-<br>and Download-Module are installed and configured.                              |  |
|                     | •<br>The test dispenses if the pre-supposition is not valid.                                                                 |  |

<span id="page-84-0"></span>

| Step | Test sequence of M.1-09                                                                                                                                                                                                                                                | Expected Results                                                                                     | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the middleware documentation for the<br>management of multiple clients.                                                                                                                                                                                          | It is possible to manage multiple clients simultaneously while<br>storing their data separately.     |              |
| 2.   | Authenticate with valid user credentials of client A.                                                                                                                                                                                                                  | The authentication<br>is successful.                                                                 |              |
| 3.   | Store an XAIP_OK<br>or BIN25<br>using either the<br>interface function "ArchiveSubmission" or<br>"PreservePO" or,<br>if the Upload-Module is<br>implemented,<br>a BIN,<br>using the Upload-Function.                                                                   | The call of the function with this XAIP / BIN as a parameter is<br>possible.                         |              |
| 4.   | Observe the output of<br>"ArchiveSubmissionResponse" or<br>"PreservePOResponse".                                                                                                                                                                                       | A positive feedback is received. No error message or error code<br>is returned. An AOID is assigned. |              |
| 5.   | Authenticate with valid user credentials of client B.                                                                                                                                                                                                                  | The authentication is successful.                                                                    |              |
| 6.   | Attempt to get either a<br>positive<br>"ArchiveRetrievalResponse" or<br>"RetrievePOResponse"<br>with<br>SubjectOfRetrieval "PO" with the AOID from<br>client A<br>(step 4).                                                                                            | A negative feedback is received (e.g. unknownAOID or<br>noPermision error code).                     |              |
| 7.   | Repeat the test sequence storing first an XAIP_OK<br>or<br>BIN<br>assigned to client B and then attempt to access<br>stored data (by either the "ArchiveRetrieval" or<br>"RetrievePO<br>with SubjectOfRetrieval<br>"PO"" function) with an authentication of client A. | A negative feedback is received (e.g. unknownAOID or<br>noPermision error code).                     |              |
| 8.   | Conditional:<br>the test steps<br>If<br>LXAIP<br>is<br>implemented,<br>from No. 3 to No. 7 are to be repeated for LXAIP.                                                                                                                                               | See expected results from test case No. 3 to No. 7 for LXAIP.                                        |              |

 <sup>25</sup> BIN restricted to the preservation object formatsdescribed in clause Notice 4.

| Step | Test sequence of M.1-09                                                                                                    | Expected Results                                                        | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------|--------------|
| 9.   | Conditional:<br>test steps<br>If<br>ASiC-AIP<br>is<br>implemented,<br>from No. 3 to No. 7 are to be repeated for ASiC-AIP. | See expected results from test case No. 3 to and No. 7 for ASiC<br>AIP. |              |

| Verdict of M.1-09 |
|-------------------|
|                   |
|                   |

### 4.2.9 M.1-10 – ArchiSafe-Module shall be thread safe

| Identifier          | M.1-10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A7.2-9                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
|                     | MD:A7.2-13                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| Test Purpose        | The test shall<br>verify that the ArchiSafe-Module can process several transactions simultaneously.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
|                     | Conditional: CONFIG_Upload                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |  |
|                     | Conditional: CONFIG_Download                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |
| Pre-test conditions | •<br>The middleware documentation is available.<br>•<br>The IT system documentation is available.<br>•<br>The application documentation is available.<br>•<br>If required, establish a session with the TOT in order to perform the following tests.<br>•<br>If required, perform identification and authentication.<br>•<br>A sufficient amount of XAIPs or BINs, restricted<br>to the<br>described in clause2, Notice 4, have already been stored on the<br>preservation<br>object<br>formats<br>ECM storage to<br>perform the technical tests.<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>"XAIP" shall<br>be, "LXAIP" and "ASiC-AIP" may<br>be supported, if configured.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>•<br>Conditional: If existent, the Upload-<br>and Download-Module are installed and configured. Upload-Module is configured in such a way that only<br>Upload of BIN linked to a LXAIP and referenced there acc. to [TR-ESOR-F], Sec.<br>3.2 is possible. The Upload-/Download-Module use standardised,<br>non-proprietary and published cryptographic protocols only. |  |

<span id="page-86-0"></span>

| Step | Test sequence of M1.-10                      | Expected Results                                      | Observations |
|------|----------------------------------------------|-------------------------------------------------------|--------------|
| 1.   | Use either a number of "ArchiveRetrieval" or | The function calls with the given AOIDs are possible. |              |
|      | "PreservePO" functions with valid AOIDs to   |                                                       |              |

| Step | Test sequence of M1.-10                                                                                                                                                                                                                                                                                                         | Expected Results                                                                                                                                                              | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|      | request a number (at least 20) of XAIPs from one<br>client application pursuant to TR-S.4 or TR-S.512.                                                                                                                                                                                                                          |                                                                                                                                                                               |              |
| 2.   | Observe the output of the severeal<br>"ArchiveRetrievalResponses" or<br>"RetrievePOResponses".                                                                                                                                                                                                                                  | Positive feedbacks are received. No error messages or error<br>codes occur. The requested XAIPs are retrieved successfully.                                                   |              |
| 3.   | If possible use either a number of<br>"ArchiveRetrieval" or "RetrievePO<br>with<br>SubjectOfRetrieval "PO"" functions<br>with valid<br>AOIDs to request a number (at least 20) of XAIPs from<br>at least 2 client applications simultaneously. (Request<br>the same XAIPs from both clients) pursuant to TR-S.4<br>or TR-S.512. | The function calls with the given AOIDs are possible.                                                                                                                         |              |
| 4.   | Observe the output of the several<br>"ArchiveRetrievalResponses" or<br>"PreservePOResponses".                                                                                                                                                                                                                                   | Positive feedbacks are received. No error messages or error<br>codes occur. The requested XAIPs are retrieved successfully by<br>both client applications.                    |              |
| 5.   | Conditional:<br>the<br>test steps<br>If<br>is<br>implemented,<br>LXAIP<br>from No. 1 to No. 4 are to be repeated for LXAIP.                                                                                                                                                                                                     | See expected results for the test cases from No. 1 to No. 4 for<br>LXAIP.                                                                                                     |              |
| 6.   | Conditional:<br>test<br>If<br>ASiC-AIP<br>is<br>implemented,<br>the<br>steps from No. 1 to No. 5 are to be repeated for ASiC<br>AIP.                                                                                                                                                                                            | See expected results of the test case from No. 1 and No. 5 for<br>ASiC-AIP.                                                                                                   |              |
| 7.   | Conditional:<br>If<br>the<br>Upload-Module<br>and<br>the<br>use a number of<br>Download-Module<br>are implemented,<br>"Download-Requests" with valid AOIDs to request a<br>number (at least<br>20) of BINs from one client<br>application.                                                                                      | The function calls with the given AOIDs are possible. The<br>Download-Module uses standardised, non-proprietary and<br>published cryptographic protocols and interfaces only. |              |

| Step | Test sequence of M1.-10                                                                                                                                                     | Expected Results                                                                                                           | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|--------------|
| 8.   | Conditional:<br>If<br>the<br>Upload-Module<br>and<br>the<br>observe the<br>Download-Module<br>are implemented,<br>outputs of the interface function "Download<br>Response". | Positive feedbacks are received. No error messages or error<br>codes occur. The requested BINs are retrieved successfully. |              |

| Verdict of M.1-10 |
|-------------------|
|-------------------|

## 4.2.10 M.1-11 – Access rights shall be enforced for individual archive objects

#### Pre-supposition:

• The TR-ESOR-Middleware supports Multi-Tenancy.

<span id="page-89-0"></span>

| Identifier          | M.1-11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |  |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD: A5.1-1<br>M1:A3.1-1, M1:A4.0-6, M1:A5.0-1, M1:A5.0-3<br>PRP-8.1-03<br>OVR-7.16-03,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |  |
| Test Purpose        | The test shall<br>verify that client software can only access archive objects for which it has access rights. This is also stringently enforced<br>when several archival<br>information packages are requested simultaneously and, as applicable, there are only access rights to a few of them.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
| Configuration       | CONFIG_ArchiSafe (including at least two different and separated clients configured)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |  |
| Pre-test conditions | •<br>If required, perform identification and authentication.<br>•<br>If required, the tester has to manually simulate access requests as if they were issued by client applications.<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F]<br>•<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.<br>BIN<br>•<br>shall be restricted<br>to the<br>described in clause2, Notice 4.<br>object<br>formats<br>preservation<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>The call of the function "ArchiveSubmission" or "PreservePO" by a client application A with a XAIP_OK<br>or BIN, restricted<br>•<br>to the preservation<br>object formats<br>described in clause<br>2, Notice 4,<br>as a parameter is possible. A positive feedback is received. No error message or error code occurs. An<br>AOID A1 is assigned.<br>The call of the function "ArchiveSubmission" or "PreservePO" by a client application A with another XAIP_OK<br>or BIN, restricted<br>•<br>to the<br>preservation object formats<br>described in clause<br>2, Notice 4,<br>as a parameter is possible. A positive feedback is received. No error message or error<br>code occurs. An AOID A2 is assigned.<br>The call of the function "ArchiveSubmission" or "PreservePO" by a client application B with a XAIP_OK<br>or BIN, restricted<br>•<br>to the preservation<br>object formats<br>described in clause<br>2, Notice 4,<br>as a parameter is possible. A positive feedback is received. No error message or error code occurs. An<br>AOID B1 is assigned.<br>•<br>The test dispenses if the pre-supposition is not valid. |  |

| Step | Test sequence of M.1-11                                                                                                                                                                                                                | Expected Results                                                                                                                                                                  | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | By using client application A: Using either the<br>interface function "ArchiveRetrieval" or<br>"RetrievePO with SubjectOfRetrieval<br>"PO""<br>and the AOID A1<br>to request the XAIP pursuant<br>to TR-S.4 or TR-S.512.               | The call of the function with this AOID as a parameter is<br>possible.                                                                                                            |              |
| 2.   | Observe the output of<br>"ArchiveRetrievalResponse" or<br>"RetrievePOResponse".                                                                                                                                                        | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                                                                   |              |
| 3.   | By using client application B: Using either the<br>interface function "ArchiveUpdate" or<br>"UpdatePOC" and the AOID A1<br>with any<br>DXAIP_OK<br>as update data to update the XAIP or<br>XAIP(BIN) pursuant to TR-S.4 or TR-S.512.   | The call of the function with this AOID as a parameter is<br>possible.                                                                                                            |              |
| 4.   | Observe the output of "ArchiveUpdateResponse"<br>or "UpdatePOCResponse".                                                                                                                                                               | A negative feedback is received. An error message or error code<br>(e.g. noPermission or parameterError) occurs because access is<br>denied. The XAIP / XAIP(BIN) is not updated. |              |
| 5.   | By using client application B: Using either the<br>interface function "ArchiveRetrieval" or<br>"RetrievePO<br>with SubjectOfRetrieval<br>"PO""<br>and the AOID A1.<br>to request the<br>XAIP/XAIP(BIN) pursuant to TR-S.4 or TR-S.512. | The call of the function with this AOID as a parameter is<br>possible.                                                                                                            |              |
| 6.   | Observe the output of<br>"ArchiveRetrievalResponse" or<br>"RetrievePOresponse".                                                                                                                                                        | A negative feedback is received. An error message or error code<br>(e.g. unknownAOID, noPermission) occurs because access is<br>denied. No XAIP is received.                      |              |
| 7.   | By using client application B: Using either the<br>interface function "ArchiveDeletion" or                                                                                                                                             | The call of the function with this AOID as a parameter is<br>possible.                                                                                                            |              |

| Step | Test sequence of M.1-11                                                                                                                                                                                                                                               | Expected Results                                                                                                                              | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|      | "DeletePO" and the AOID A1<br>to delete the XAIP or<br>BIN pursuant to TR-S.4 or TR-S.512.                                                                                                                                                                            |                                                                                                                                               |              |
| 8.   | Observe the output of<br>"ArchiveDeletionResponse" or<br>"DeletePOResponse".                                                                                                                                                                                          | A negative feedback is received. An error message or error code<br>occurs because access is denied. The XAIP / BIN is not deleted.            |              |
| 9.   | By using client application A: Using either the<br>interface function "ArchiveRetrieval" or<br>"RetrievePO<br>with SubjectOfRetrieval "PO""<br>and the AOID A1, A2<br>and B1<br>to request the XAIPs<br>pursuant to TR-S.4 or TR-S.512.                               | The call of the function with this AOID as a parameter is<br>possible.                                                                        |              |
| 10.  | Observe the output of<br>"ArchiveRetrievalResponse" or<br>"RetrievePOResponse".                                                                                                                                                                                       | A mixed feedback is received. The XAIP's A1<br>and A2<br>could<br>be<br>retrieved, for B1<br>an error was received.                           |              |
| 11.  | By using client application B: Using either the<br>interface function "ArchiveRetrieval" or<br>"RetrievePO<br>with SubjectOfRetrieval<br>"PO"" three times for the AOIDs A1, A2<br>and B1<br>to<br>request the XAIPs pursuant to TR-S.4 or TR-S.512.                  | The call of the function with this AOID as a parameter is<br>possible.                                                                        |              |
| 12.  | Observe the output of<br>"ArchiveRetrievalResponse" or<br>"RetrievePOResponse".                                                                                                                                                                                       | A mixed feedback is received. The XAIP B1<br>could<br>be retrieved,<br>for A1<br>and A2<br>an error was received.                             |              |
| 13.  | Try to use a client application C, which is not an<br>authorized archive application, to submit<br>a XAIP or<br>BIN,<br>a XAIP or XAIP(BIN), to retrieve<br>a XAIP<br>to update<br>or to delete<br>a XAIP or BIN of another client pursuant<br>to TR-S.4 or TR-S.512. | A negative feedback is received. An error message or error code<br>occurs. Access to the middleware and the storage is denied in<br>any case. |              |

| Step | Test sequence of M.1-11                                                                                                               | Expected Results                                                             | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------|--------------|
| 14.  | Conditional:<br>test steps from<br>If<br>is<br>implemented,<br>LXAIP<br>No. 1 to No. 13 are to be repeated for LXAIP.                 | See expected results of the test cases from No. 1 to No. 13 for<br>LXAIP.    |              |
| 15.  | Conditional:<br>test steps<br>If<br>implemented,<br>ASiC-AIP<br>is<br>from No. 1 to and No. 13 are to be repeated<br>for ASiC<br>AIP. | See expected results of the test cases from No. 1 to No. 13 for<br>ASiC-AIP. |              |

| Verdict of M.1-11 |
|-------------------|
|                   |
|                   |

## 4.3 Module 2 – Cryptographic-Module (Crypto-Module)

A product which claims to comply with the M.2 Crypto-Module specification of this TR (conformity level 1) has to pass

- all test cases in this section and
- the test cases for the interface TR-S.1 and TR-S.3 specified in section 4.5.1 and 4.5.3.

### <span id="page-93-2"></span>4.3.1 M.2-01 – Crypto- Module may request digital signatures from a Trust Service Provider according to [eIDAS-VO]

#### Pre-supposition:

<span id="page-93-1"></span><span id="page-93-0"></span>A product which claims to comply the M.2 Crypto-Module specification of this TR and which intends to request digital signatures from a trust service provider according to [eIDAS-VO], Article 3(19) or 3(20) has to pass the following test case.

| Identifier          | M.2-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A4.3-2, MD:<br>A4.3-3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |  |
|                     | M2:A3.4-2, M2:A3.4-3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |  |
|                     | M2:A5.1-1, M2:A5.1-2, M2:A5.1-3, M2:A5.1-4, M2:A5.1-5, M2:A5.1-6, M2:A5.1-7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |
| Test Purpose        | If the Crypto-Module intends to request digital signatures from a trust service provider according to [eIDAS-VO], Article 3(19) or 3(20), the Crypto<br>Module shall fulfil the requirements of [TR-ESOR-M2], A3.4-2<br>and [TR-ESOR-M2], A3.4-3.<br>The digital signature format generated by a trust service provider shall fulfil one of the following digital signature formats.<br>The trust service provider shall be able to generate the following digital signature formats.<br>•<br>XadES-signatures according to<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and<br>◦<br>◦<br>the requirements in [TR-ESOR-F], (A5.1-2);<br>•<br>CAdES-signatures according to<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and<br>◦<br>the requirements in [TR-ESOR-F], (A5.1-1);<br>◦<br>•<br>PAdES-signatures according to<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and<br>◦<br>the requirements in [TR-ESOR-F], (A5.1-3);<br>◦<br>•<br>ASiC-Container with AdES-signatures, time-stamps and Evidence Records according to<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and<br>◦<br>the requirements in [TR-ESOR-F], (A5.1-4).<br>◦ |  |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
| Pre-test conditions | User manual is present.<br>1.<br>2.<br>If the Crypto-Module requests digital signatures from a trust service provider, install a trustworthy communication channel to a trust service<br>provider, according to [BSIMindTLS] including [TR 03116], Part 4 and [TR 02102].<br>The test dispenses if the pre-supposition is not valid.<br>3.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |  |

| Step | Test sequence of M.2-01                                                                                                                                                                                                                                                       | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual and related documentation, if<br>there is described that the Cryptographic-Module<br>may<br>request a digital signature from a trust service<br>provider according to [eIDAS-VO], Article 3(19) or<br>3(20)<br>via a trustworthy communication channel. | In the user manual, there is a confirmation, that the Cryptographic<br>Module may<br>request a digital signature from a trust service<br>provider according to [eIDAS-VO], Article 3(19) or 3(20) via a<br>trustworthy communication channel according to [eIDAS-VO],<br>52 .and according to [BSIMindTLS]<br>including<br>[TR 03116], Part 4<br>and [TR 02102].                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |              |
| 2.   | Check the user manual for information about which<br>digital signature formats are supported by the<br>Cryptographic Module.                                                                                                                                                  | The Cryptographic-Module -<br>by requesting a signature<br>generation service from a trust service provider -<br>supports<br>•<br>XAdES-signatures according to<br>the actual COMMISSION IMPLEMENTING<br>◦<br>DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F], (A5.1-2);<br>◦<br>•<br>CAdES-signatures according to<br>the actual COMMISSION IMPLEMENTING<br>◦<br>DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F], (A5.1-1);<br>◦<br>•<br>PAdES-signatures according to<br>the actual COMMISSION IMPLEMENTING<br>◦<br>DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F], (A5.1-3);<br>◦<br>•<br>ASiC-Container with AdES-signatures, time-stamps<br>and Evidence Records according to<br>the actual COMMISSION IMPLEMENTING<br>◦<br>DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F], (A5.1-4).<br>◦ |              |
| 3.   | Check whether a secure communication channel,<br>according to [BSIMindTLS]<br>including<br>[TR 03116],<br>Part 4 and [TR 02102],<br>between the Cryptographic<br>Module and the trust service provider is configured<br>and activated.                                        | A secure communication channel,<br>according to [BSIMindTLS]<br>including<br>[TR 03116], Part 4 and [TR 02102], is set up and<br>active.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |              |

| Step | Test sequence of M.2-01                                                                                                                                                            | Expected Results                                                                                                                                      | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 4.   | Start logging the data traffic between the<br>Cryptographic-Module and the trust service provider.                                                                                 | The data logging process has been started.                                                                                                            |              |
| 5.   | Request a digital signature using the corresponding<br>interface functions from a (qualified) trust service<br>provider according to [eIDAS-VO].                                   | The request of a digital signature is possible.                                                                                                       |              |
| 6.   | Observe the output of the interface function.                                                                                                                                      | A positive feedback<br>will be received; no error message or error<br>code. The digital signature<br>shall<br>be received.                            |              |
| 7.   | Check the digital signature whether it is a valid one<br>using a common certified tool or product or a<br>validation function of a (qualified) trust service<br>provider.          | The digital signature is a valid signature.                                                                                                           |              |
| 8.   | Check that the generated digital signature fulfils one<br>of the digital signature formats according to test step<br>2.                                                            | The digital signature format of the received generated digital<br>signature fulfils one of the digital signature formats according<br>to test step 2. |              |
| 9.   | Check the IT system documentation for the used<br>protocol within the secure communication channel<br>protocol between the Cryptographic-Module and the<br>trust service provider. | The documentation states which protocol is used (e.g. HTTP, RPC,<br>RMI,).                                                                            |              |
| 10.  | Check the documentation for this protocol whether<br>technical confirmations of receipts are implemented.                                                                          | The protocol implements such confirmations (e.g. TCP ACK,<br>HTTP Return codes,).                                                                     |              |
| 11.  | Close the connection of the two components. Stop<br>logging the data traffic.                                                                                                      | The complete data exchange between the components has been<br>intercepted and logged.                                                                 |              |
| 12.  | Check the data traffic log file for unprotected<br>document data.                                                                                                                  | No document data (in clear text) can be accessed.                                                                                                     |              |

| Verdict of M.2-01 |
|-------------------|
|                   |
|                   |

#### 4.3.2 M.2-02 – Cryptographic algorithms shall be exchangeable

<span id="page-97-0"></span>

| Identifier          | M.2-02                                                                                                                                                 |  |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A7.4-6                                                                                                                                              |  |
|                     | M2:A3.2-1                                                                                                                                              |  |
|                     | M3:A5.3-1<br>OVR-7.14-01                                                                                                                               |  |
|                     | OVR-7.14-02                                                                                                                                            |  |
|                     | OVR-7.15-03                                                                                                                                            |  |
| Test Purpose        | The algorithms and parameters of the Cryptographic-Module that are suitable for security<br>shall<br>be exchanged in a quick and uncomplicated manner. |  |
| Configuration       | CONFIG_Common                                                                                                                                          |  |
| Pre-test conditions | •<br>User has administrator rights on the system.                                                                                                      |  |
|                     | •<br>User manual is present.                                                                                                                           |  |
|                     | •<br>Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT], is present and published.                |  |

| Step | Test sequence of M.2-02                                                                                                                                                                                                                                                                                                               | Expected Results                                                                                                                                                                                                                  | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual and Preservation Evidence<br>Policy PEP, clause 7.7.4, whether a hash-algorithm<br>and parameters can be changed in a quick and<br>uncomplicated manner, before the preservation<br>evidence cannot be used anymore to achieve the<br>corresponding preservation goal.                                          | The hash-algorithm and parameters can be changed in a quick<br>and uncomplicated manner, before the preservation evidence<br>cannot be used anymore to achieve the corresponding<br>preservation goal.                            |              |
| 2.   | Check the user manual and Preservation Evidence<br>Policy PEP, clause 7.7.4, whether a digital signature<br>or electronic time-stamp algorithm and parameters<br>can be changed in a quick and uncomplicated<br>manner, before the preservation evidence cannot be<br>used anymore to achieve the corresponding<br>preservation goal. | The digital signature-or time-stamp algorithm and parameters<br>can be changed in a quick and uncomplicated manner, before<br>the preservation evidence cannot be used anymore to achieve<br>the corresponding preservation goal. |              |

Verdict of M.2-02

### 4.3.3 M.2-03 – Crypto-Module should fulfil the requirements of TR-03112 as stated in [TR-ESOR-E]

| Identifier          | M.2-03                                                                                                                                                                     |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | MD:A7.4-7                                                                                                                                                                  |
| Test Purpose        | The interfaces of the Cryptographic-Module should<br>fulfil the requirements of the BSI Technical Guideline TR-03112 (eCard-API-Framework)<br>as stated in<br>[TR-ESOR-E]. |
| Configuration       | CONFIG_Common                                                                                                                                                              |
| Pre-test conditions | •<br>User manual is present.                                                                                                                                               |

<span id="page-99-0"></span>

| Step | Test sequence of M.2-03                                                                                   | Expected Results                                                                    | Observations |
|------|-----------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|--------------|
| 1.   | Check,<br>if at least the external interfaces of the<br>Cryptographic-Module are implemented in software. | The external interfaces may<br>be implemented in software (e.g.<br>libraries, API). |              |
| 2.   | If step 1 passed:                                                                                         | A conformity statement to TR-03112 exist.                                           |              |
|      | Check whether there is a conformity statement to TR<br>03112.                                             |                                                                                     |              |

| Verdict of M.2-03 |  |  |
|-------------------|--|--|
|                   |  |  |
|                   |  |  |

## 4.3.4 M.2-04 – Random number generators fulfil the BSI requirements

#### Pre-supposition:

A product, which claims to comply the M.2 Crypto-Module specification of this TR and which intends to generate random numbers, has to pass the following test case.

| Identifier          | M.2-04                                                                                                                                                                                                                                                                                                                                               |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | M2:A4.1-2                                                                                                                                                                                                                                                                                                                                            |
| Test Purpose        | The random number generators used by the Cryptographic-Module fulfil the requirements set forth in the BSI Minimum Standard [BSIMindTLS] including<br>the BSI Technical Guidelines [TR 03116]<br>and [TR 02102]<br>pursuant to [AIS 20]<br>for pseudo random number generators or according to [AIS 31]<br>for physical<br>random number generators. |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                                                        |
| Pre-test conditions | •<br>User manual are present.<br>•<br>The test dispenses if the pre-supposition is not valid.                                                                                                                                                                                                                                                        |

<span id="page-100-0"></span>

| Step | Test sequence of M.2-04                                                                                                                                                                                                                                                                                                 | Expected Results                                                     | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|--------------|
| 1.   | Check user manual and developer documents,<br>whether the random number generators fulfil the<br>requirements defined by set for the BSI Minimum<br>Standard [BSIMindTLS] including<br>the BSI Technical<br>Guidelines [TR 03116]<br>and [TR 02102]<br>pursuant to<br>[AIS20]<br>for pseudo random number generators or | The random number generators fulfil the defined requirements<br>set. |              |
|      | according to [AIS 31]<br>for physical random number<br>generators.                                                                                                                                                                                                                                                      |                                                                      |              |

<span id="page-101-2"></span><span id="page-101-1"></span>

| Verdict of M.2-04 |
|-------------------|
|                   |
|                   |

### <span id="page-101-3"></span>4.3.5 M.2-05 – Support of Hash functions[26](#page-101-1)

| Identifier          | M.2-05                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M2:A4.2-1, M2:A4.2-2, M2:A4.2-3, M2:A5.3-1<br>OVR-6.5-04<br>OVR-7.14-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
| Test Purpose        | The Cryptographic-Module shall<br>have functions to calculate hash values for information packages. In doing so, the requirements for hash procedures shall<br>be fulfilled.27                                                                                                                                                                                                                                                                                                                                                            |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  |
| Pre-test conditions | •<br>The list of hash algorithms and parameters recommended by [ETSI TS 119 312]<br>and [SOG-IS] is accessible.<br>•<br>User manual is present.<br>•<br>Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT], is present and published.<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured. |  |

<span id="page-101-0"></span> <sup>26</sup> Extended requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

<sup>27</sup> Exclusively those hash algorithms and parameters recommended by [ETSI TS 119 312] and [SOG-IS] shall be used to form hash values. However, the Cryptographic-Module shall continue to support all hash algorithms previously used by the Cryptographic-Module in order to enable validation of hash values generated in the past according to [ALGCAT], [ETSI TS 119 312]/[SOG-IS] and [TR-ESOR-ERS], chapter 5.2.1.

| Step | Test sequence of M.2-05                                                                                                                                                                                                                                                                                                                                                                                                                        | Expected Results                                                                                               | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual and Preservation Evidence<br>Policy of the TR-ESOR-Manufacturer for the hash<br>algorithms, which are used by the Cryptographic<br>Module. The Cryptographic-Module shall<br>support at<br>least two hash algorithms which have been assessed<br>by [ETSI TS 119 312] and [SOG-IS] and the<br>Minimum Standard [BSIMindTLS] including<br>the BSI<br>[TR 03116] and [TR 02102] as suitable for security<br>and published. | The used hash algorithms are in the list of the recommended<br>algorithms.                                     |              |
| 2.   | Check the user manual and Preservation Evidence<br>Policy of the TR-ESOR-Manufacturer whether the<br>Cryptographic-Module continues to support all hash<br>algorithms previously used pursuant [TR-ESOR<br>ERS], Chap. 5.2.1 in order to enable the validation of<br>hash values computed in the past.                                                                                                                                         | The used hash algorithms are in the list of the supported<br>algorithms.                                       |              |
| 3.   | Check the user manual and Preservation Evidence<br>Policy of the TR-ESOR-Manufacturer for the<br>supported hash algorithms.                                                                                                                                                                                                                                                                                                                    | The Cryptographic-Module supports all previously used hash<br>algorithms.                                      |              |
| 4.   | Transfer the BIN<br>to the Cryptographic-Module using<br>the interface function "Hash".                                                                                                                                                                                                                                                                                                                                                        | The call of the function with this BIN as parameter is possible.                                               |              |
| 5.   | Observe the output of the interface function "Hash".                                                                                                                                                                                                                                                                                                                                                                                           | A positive feedback and a HashResponse-Element will be<br>received.                                            |              |
| 6.   | Check the Hash-Element in the HashResponse<br>whether the Hash-value is correct by using a<br>Element<br>certified tool or product, e.g. a certified eCard<br>Crypto-Module, for comparison of the Hash-value<br>calculated on base of the BIN                                                                                                                                                                                                 | The received Hash-value was verified by comparison of the<br>hash calculations with a certified Crypto-Module. |              |

| Step | Test sequence of M.2-05                                                                                                                                                            | Expected Results                                                                                                                             | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 7.   | Conditional:<br>Transfer an<br>If<br>implemented:<br>LXAIP<br>is<br>instance of asic:DataObjectReference<br>to the<br>Cryptographic-Module using the interface function<br>"Hash". | The call of the function with this instance of<br>asic:DataObjectReference<br>as parameter is possible.                                      |              |
| 8.   | Conditional:<br>Observe the<br>If<br>implemented:<br>LXAIP<br>is<br>output of the interface function "Hash".                                                                       | A positive feedback and a HashResponse-Element,<br>containing the hash value computed on base of the referenced<br>data<br>will be received. |              |
| 9.   | Conditional:<br>test steps<br>If<br>ASiC-AIP<br>is<br>implemented,<br>from No. 1 to No. 6 are to be repeated for ASiC-AIP.                                                         | See expected results of the test cases from No. 1 to No. 6 for<br>ASiC-AIP.                                                                  |              |

| Verdict of M.2-05 |  |
|-------------------|--|
|                   |  |
|                   |  |
|                   |  |

### <span id="page-104-1"></span>4.3.6 M.2-06 – Crypto-Module supports canonicalisation for the validation of XML digital signatures

| Identifier          | M.2-06                                                                                                                  |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M2:A4.4-2                                                                                                               |  |
|                     | M2:A4.4-4                                                                                                               |  |
| Test Purpose        | Support of canonicalisation procedures for the validation of XML digital signatures.                                    |  |
|                     | The support of canonicalisation procedure C14N -<br>Canonical XML Version 1.0 [C14N]<br>-<br>is supported at a minimum. |  |
|                     | Note: If the TOT does not support XML digital signatures the test case can be passed as fulfilled.                      |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                        |  |
| Pre-test conditions | •<br>User manual is present.                                                                                            |  |
|                     | •<br>Security architecture design is present.                                                                           |  |
|                     | •<br>A valid signed XMLobject, e.g. XAIP or BIN, is present.                                                            |  |
|                     | •<br>XAIP means XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].                                                 |  |
|                     | •<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.                          |  |

<span id="page-104-0"></span>

| Step | Test sequence of M.2-06                                                                                                                                                                                                        | Expected Results                                                                                                                                  | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual and security architecture<br>design, whether the support of canonicalisation<br>procedures at least for the validation of digital<br>signatures of XML contents by the Cryptographic<br>Module is given. | The support of canonicalisation procedures for the validation<br>of digital signatures of XML contents by the Cryptographic<br>Module is present. |              |
| 2.   | Check the developer documents for information<br>about how the canonicalisation procedure was<br>implemented.                                                                                                                  | The implementation of the canonicalisation procedure support<br>C14N –<br>Canonical XML Version 1.0 [C14N]<br>at a minimum.                       |              |

| Step | Test sequence of M.2-06                                                                                                                                                                             | Expected Results                                                                                                                                                            | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|      |                                                                                                                                                                                                     | C14N11 – Canonical XML Version 1.1 [C14N11], C14N20 –<br>Canonical XML Version 2.0 [C14N20]<br>and EC14N - Exclusive<br>XML Canonicalization – should<br>also be supported. |              |
| 3.   | If the pre-supposition of chapter 4.3.1<br>is fulfilled, send<br>a request to a Trust Service Provider to generate a<br>signed XML, e.g. a signed XAIP or BIN.                                      | A positive feedback will be received; no error message or error<br>code. The signed XAIP or BIN with a valid digital signature shall<br>be received.                        |              |
| 4.   | Verify the digital signature of the XAIP / BIN.                                                                                                                                                     | The validation result should<br>show a positive result. Digital<br>signature is valid.                                                                                      |              |
| 5.   | Modify the signed XAIP/BIN in such a way so that it is<br>not canonicalised (e.g. by entering empty lines and<br>spaces between the XML tags).<br>Do not modify or remove the digital<br>signature. | ---                                                                                                                                                                         |              |
| 6.   | Verify the digital signature of the XAIP/BIN.                                                                                                                                                       | The validation result should<br>show a positive result. The digital<br>signature is valid.                                                                                  |              |
| 7.   | Conditional:<br>test steps from<br>If<br>implemented,<br>LXAIP<br>is<br>No. 1 to No. 5 are to be repeated for LXAIP.                                                                                | See expected results of the test cases from No. 1 to No. 5 for<br>LXAIP.                                                                                                    |              |
| 8.   | Conditional:<br>test steps<br>If<br>ASiC-AIP<br>is<br>implemented,<br>from No. 1 to No. 5 are to be repeated for ASiC-AIP.                                                                          | See expected results of the test cases from No. 1 to No. 5 for<br>ASiC-AIP.                                                                                                 |              |

| Verdict of M.2-06 |
|-------------------|
|                   |
|                   |

### <span id="page-106-1"></span>4.3.7 M.2-07 – Canonicalisation procedures do not change the content data

<span id="page-106-0"></span>

| Identifier          | M.2-07                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|
| Requirement         | M2:A4.4-3                                                                                                                                                                                                                                                                                                                                                                                                                               |  |  |
| Test Purpose        | The implemented canonicalisation procedures shall<br>not change the content data.<br>Note: if the TOT does not support "Verify" or "ValidateEvidence" functions<br>with XML data as parameters the test case can be passed as fulfilled.                                                                                                                                                                                                |  |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                        |  |  |
| Pre-test conditions | •<br>XML-data with empty tags, additional white spaces, wrong order of XML-tags and digital signature is present, e.g. from test case M.2-09.<br>•<br>XML_data means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" may<br>be supported, if configured.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>• |  |  |

| Step | Test sequence of M.2-07                                                                                                                                                  | Expected Results                                                                                                                                      | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Using either the interface function "Verify" or<br>"ValidateEvidence" send XML-data to the<br>Cryptographic-Module.                                                      | The sending of the XML-data is possible.                                                                                                              |              |
| 2.   | Observe the output of the "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                             | A positive feedback will be received; no error message or error<br>code.                                                                              |              |
| 3.   | Check the field "responseData".                                                                                                                                          | The field "responseData" contains<br>•<br>no XML-data<br>but only the results of the validation OR<br>•<br>XML-data and the results of the validation |              |
| 4.   | If XML-data are returned, compare the received XML<br>data with original XML data.                                                                                       | The contents of both XML-files are equal (unmodified) or the<br>XML-data is modified (assumed: canonicalised).                                        |              |
| 5.   | Check the result of canonicalisation whether the<br>unmodified and the modified XML-data is equal<br>related to the content and mappable for XML syntax<br>and XSD used. | The canonicalisation is correct.                                                                                                                      |              |
| 6.   | Conditional:<br>test steps from<br>If<br>LXAIP<br>is<br>implemented,<br>No. 1 to No. 5 are to be repeated for LXAIP.                                                     | See expected results of the test cases from No. 1 to No. 5 for<br>LXAIP.                                                                              |              |

| Verdict of M.2-07 |
|-------------------|
|                   |
|                   |

### <span id="page-107-1"></span><span id="page-107-0"></span>4.3.8 M.2-08 – Reliable validation of digital signatures by itself or by a Trust Service Provider

| Identifier          | M.2-08                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | M2:A5.1-8, M2:A5.1-9, M2:A5.1-11, M2:A5.1-13<br>M2:A3.4-2, M2:A3.4-3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Test Purpose        | The Cryptographic Module that conforms to this Guideline shall<br>provide functions<br>•<br>for the reliable validation of digital advanced and qualified signatures<br>by itself or<br>◦<br>by requesting the validation of digital signatures from a Trust Service Provider according to [eIDAS-VO], Article 3(19) or 3(20)<br>The digital<br>◦<br>signature validation function of the Cryptographic Module shall<br>support by itself or by the aid of a Trust Service Provider at least the<br>following signature formats<br>•<br>for XAdES-signatures according to<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and<br>◦<br>the requirements in [TR-ESOR-F], (A5.1-2);<br>◦<br>for CAdES-signatures according to<br>•<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and<br>◦<br>the requirements in [TR-ESOR-F], (A5.1-1);<br>◦<br>for PAdES-signatures according to<br>•<br>◦<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F], (A5.1-3);<br>◦<br>for ASiC-Container with AdES-signatures, time-stamps and Evidence Records according to<br>if<br>supported<br>•<br>,<br>the actual COMMISSION IMPLEMENTING DECISION (EU) [2015/1506/EU] and<br>◦<br>the requirements in [TR-ESOR-F], (A5.1-4).<br>◦ |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Pre-test conditions | •<br>User manual is present.<br>•<br>Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT] is present and published.<br>•<br>If the Crypto-Module requests the validation of digital signatures from a Trust Service Provider instead of doing it by itself, install an access to a<br>Trust Service Provider.<br>•<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |

| Step | Test sequence of M.2-08                                                                                                                                                                                                                                                                                                         | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual and Preservation Evidence<br>Policy (PEP), if the Cryptographic Module provides a<br>function for the reliable validation of digital<br>signatures by itself or if it requests the validation of a<br>digital signature from a Trust Service Provider<br>according to [eIDAS-VO], Article 3(19) or 3(20). | The Cryptographic Module provides such a function.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |              |
| 2.   | Check the user manual and Preservation Evidence<br>Policy (PEP), for information about which digital<br>signature formats are supported by the Cryptographic<br>Module.                                                                                                                                                         | The Cryptographic Module by itself or by requesting a<br>validation service from a Trust Service Provider supports at<br>least the following digital signature formats:<br>•<br>XAdES-signatures according to<br>the actual COMMISSION IMPLEMENTING<br>◦<br>DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F], (A5.1-2);<br>◦<br>•<br>CAdES-signatures according to<br>the actual COMMISSION IMPLEMENTING<br>◦<br>DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F], (A5.1-1);<br>◦<br>•<br>PAdES-signatures according to<br>◦<br>the actual COMMISSION IMPLEMENTING<br>DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F], (A5.1-3);<br>◦<br>•<br>and<br>conditional:<br>ASiC-Container<br>with<br>AdES<br>signatures, time-stamps and Evidence Records<br>according to<br>the actual COMMISSION IMPLEMENTING<br>◦<br>DECISION (EU) [2015/1506/EU] and<br>the requirements in [TR-ESOR-F], (A5.1-4).<br>◦ |              |

| Step | Test sequence of M.2-08                                                                                                                                                                                                                                                                                                                                                                                                                               | Expected Results                                                                                                                                   | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 3.   | If<br>the<br>Crypto-Module<br>requests the<br>validation<br>of<br>digital<br>signatures<br>from<br>Service<br>Provider<br>instead<br>of<br>a Trust<br>check whether a secure<br>doing<br>it<br>by<br>itself,<br>communication channel between the Cryptographic<br>Module and the Trust Service Provider according to<br>the BSI Minimum Standard [BSIMindTLS]<br>including<br>the [TR 03116], Part 4 and [TR 02102], is configured<br>and activated. | A secure communication channel according to [BSIMindTLS]<br>including<br>the BSI<br>[TR 03116], Part 4 and [TR 02102],<br>is set up<br>and active. |              |
| 4.   | If<br>the<br>Crypto-Module<br>requests the<br>validation<br>of<br>digital<br>from<br>Provider<br>instead<br>of<br>signatures<br>a Trust<br>Service<br>start logging the data traffic between<br>doing<br>it<br>by<br>itself,<br>the Cryptographic Module and the Trust Service<br>Provider.                                                                                                                                                           | The data logging process has been started.                                                                                                         |              |
| 5.   | Use either the "Verify" -<br>or<br>"ValidateEvidence"-<br>function to verify XML<br>signatures according to [2015/1506/EU]<br>and [TR<br>ESOR-F], A5.1-2, [TR-ESOR-M.2], A5.1-8.                                                                                                                                                                                                                                                                      | Validation of these XML signatures are supported by that<br>function.                                                                              |              |
| 6.   | Compare signature validation results of the<br>Cryptographic module with results of a common<br>certified tool or product.<br>Alternatively: the Crypto-Module is certified<br>according to BSI [TR-03112]. Then, this test step is<br>not required.                                                                                                                                                                                                  | The signature validations offer identical results<br>OR<br>the product is certified according to BSI TR-03112.                                     |              |
| 7.   | Use either the "Verify" or "ValidateEvidence"-<br>function to verify CMS signatures according to<br>[RFC3275], [2015/1506/EU]<br>and [TR-ESOR-F], A5.1-<br>1, [TR-ESOR-M.2], A5.1-8.                                                                                                                                                                                                                                                                  | Validation of these CMS signatures are supported by that<br>function.                                                                              |              |

| Step | Test sequence of M.2-08                                                                                                                                                                                                                            | Expected Results                                                                                                 | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|--------------|
| 8.   | Compare signature validation results of the<br>Cryptographic module with results of a common<br>certified tool or product.<br>Alternatively: the Crypto-Module is certified<br>according to BSI TR-03112. Then, this test step is not<br>required. | The signature validations offer identical results<br>OR<br>the product is certified according to BSI TR-03112.   |              |
| 9.   | Use either the "Verify" -<br>or<br>"ValidateEvidence"-<br>function to verify PAdES<br>signatures according to [RFC3275], [2015/1506/EU]<br>and [TR-ESOR-F], A5.1-3, [TR-ESOR-M.2], A5.1-8.                                                         | Validation of these PAdES signatures are supported by that<br>function.                                          |              |
| 10.  | Compare signature validation results of the<br>Cryptographic module with results of a common<br>certified tool or product.<br>Alternatively: the Crypto-Module is certified<br>according to BSI TR-03112. Then, this test step is not<br>required. | The signature validations offer identical results<br>OR<br>the product is certified according to BSI [TR-03112]. |              |
| 11.  | Use<br>either the "Verify" - or<br>"ValidateEvidence"-<br>function to verify ASIC<br>Container according to [RFC3275], [2015/1506/EU]<br>and [TR-ESOR-F], A5.1-4, [TR-ESOR-M.2], A5.1-8.                                                           | Validation of these ASiC containers are supported by that<br>function.                                           |              |
| 12.  | Compare signature validation results of the<br>Cryptographic module with results of a common<br>certified tool or product.<br>Alternatively: the Crypto-Module is certified<br>according to BSI TR-03112. Then, this test step is not<br>required. | The signature validations offer identical results<br>OR<br>the product is certified according to BSI [TR-03112]. |              |

| Step | Test sequence of M.2-08                                                                                                                                                                                                                                                                                                                                                      | Expected Results                                                                      | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|--------------|
| 13.  | If<br>the<br>Crypto-Module<br>requests the<br>validation<br>of<br>digital<br>from<br>of<br>signatures<br>a Trust<br>Service<br>Provider<br>instead<br>heck the IT system documentation<br>doing<br>by<br>itself,<br>it<br>c<br>for the used protocol within the secure<br>communication channel protocol between the<br>Cryptographic Module and the Trust Service Provider. | The documentation states which protocol is used (e.g. HTTP,<br>RPC, RMI,).            |              |
| 14.  | If<br>the<br>Crypto-Module<br>requests the<br>validation<br>of<br>digital<br>from<br>Provider<br>instead<br>of<br>signatures<br>a Trust<br>Service<br>heck the documentation for this<br>doing<br>it<br>by<br>itself,<br>c<br>protocol whether technical confirmations of receipts<br>are implemented.                                                                       | The protocol implements such confirmations (e.g. TCP ACK,<br>HTTP Return codes,).     |              |
| 15.  | If<br>the<br>Crypto-Module<br>requests the<br>validation<br>of<br>digital<br>signatures<br>from<br>Service<br>Provider<br>instead<br>of<br>a Trust<br>lose the connection of the two<br>doing<br>it<br>by<br>itself,<br>c<br>components. Stop logging the data traffic.                                                                                                      | The complete data exchange between the components has been<br>intercepted and logged. |              |
| 16.  | If<br>the<br>Crypto-Module<br>requests the<br>validation<br>of<br>digital<br>signatures<br>from<br>Service<br>Provider<br>instead<br>of<br>a Trust<br>heck the data traffic log file for<br>doing<br>it<br>by<br>itself,<br>c<br>unprotected document data.                                                                                                                  | No document data can be accessed.                                                     |              |

| Verdict of M.2-08 |  |
|-------------------|--|
|                   |  |
|                   |  |

### <span id="page-113-1"></span>**4.3.8** M.2-09 – Crypto-Module shall have function to validate certificate chains or trust anchor by itself or by a Trust Service Provider

<span id="page-113-0"></span>

| Identifier          | M.2-09                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |  |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A4.3-2, MD:A5.1-5, MD: A7.4-4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |  |
|                     | M2:A5.1-8, M2:A5.1-10, M2:A5.1-14, M2:A5.1-19                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  |
|                     | M2:A3.4-2, M2:A3.4-3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
|                     | OVR-9.3-01,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
|                     | OVR-9.3-02                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
| Test Purpose        | have a function to validate certificate chains or trust anchor28 by itself or by using a Trust Service Provider<br>The Cryptographic-Module shall<br>according to<br>[eIDAS-VO], Article 3(19) or 3(20), in order to verify the integrity of archived certificate chains and archived packages (see [RFC5280], Section 6<br>and [TR<br>ESOR-M.3]). The list of trusted certificates can be configurable.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |  |
| Pre-test conditions | •<br>User manual is present.<br>•<br>Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT] is present and published<br>•<br>If the Crypto-Module requests the validation of certificates from a Trust Service Provider instead of doing it by itself,<br>The Trust Service Provider shall<br>be listed in the trust list according to [TR-ESOR-M.2], chapter 33 and has the status "granted".<br>◦<br>The TOT shall<br>install an access to a Trust Service Provider<br>◦<br>•<br>XAIP means XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured. |  |

 <sup>28</sup> According to the preservation evidence policy (PEP)28 derived from [TR-ESOR-PEPT] of the TR-ESOR-Product Manufacturer or respectively of the preservation service.

| Step | Test sequence of M.2-09                                                                                                                                                                                                                                                                                                                                                                                                                  | Expected Results                                                                                                                     | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | A Trust Service Provider signs the XAIP_OK<br>or<br>DXAIP_OK<br>or BIN<br>archival information package<br>using a valid and not expired certificate issued by a<br>Trust Center.                                                                                                                                                                                                                                                         | The signed XAIP_OK<br>/ DXAIP_OK<br>/ BIN<br>was created<br>successfully.                                                            |              |
| 2.   | Conditional:<br>If<br>the<br>Crypto-Module<br>requests the<br>validation<br>of<br>certificates<br>from<br>a Trust<br>Service<br>Provider<br>check whether a secure<br>of<br>itself,<br>instead<br>doing<br>it<br>by<br>communication channel between the Cryptographic<br>Module and the Trust Service Provider, e.g. according<br>to [BSIMindTLS]<br>including<br>[TR 03116], Part 4<br>and<br>[TR 02102], is configured and activated. | A secure communication channel, . according to [BSIMindTLS]<br>including [TR 03116], Part 4 and [TR 02102], is set up and<br>active. |              |
| 3.   | Conditional:<br>If<br>the<br>Crypto-Module<br>requests the<br>validation<br>of<br>certificates<br>from<br>Service<br>Provider<br>a Trust<br>start logging the data<br>instead<br>of<br>doing<br>it<br>by<br>itself,<br>traffic between the Cryptographic-Module and the<br>Trust Service Provider.                                                                                                                                       | The data logging process has been started.                                                                                           |              |
| 4.   | Transfer the signed XAIP_OK<br>or DXAIP_OK<br>or<br>BIN<br>to the Crypto-Module or TOT using the<br>interface function "Verify" or<br>"ValidateEvidence".                                                                                                                                                                                                                                                                                | The call of the function with this XAIP / DXAIP_OK<br>/ BIN as<br>parameter is possible.                                             |              |
| 5.   | Observe the output "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                                                                                                                                                                                                                                                                                    | A positive feedback will<br>be received; the digital signature has<br>been verified.                                                 |              |
| 6.   | Check the validation results whether the certificate<br>used for the digital signature of the XAIP /<br>DXAIP_OK / BIN was verified.                                                                                                                                                                                                                                                                                                     | The certificate used for the digital signature was verified. The<br>validation results are included.                                 |              |

<span id="page-115-0"></span>

| Step | Test sequence of M.2-09                                                                                                                                                                                                                                                                                                                                                                | Expected Results                                                                                                                                                                                                                                                                                                                                                         | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 7.   | Check the validation results whether the CA<br>certificate used for the digital signature of the<br>certificate was verified.                                                                                                                                                                                                                                                          | The CA certificate was verified. The validation results are<br>included.<br>There shall<br>be an indication that this certificate is a trustworthy<br>root CA certificate or trust anchor according to the preservation<br>evidence policy (PEP)29 derived from [TR-ESOR-PEPT]<br>of the<br>TR-ESOR-Product Manufacturer or respectively of the<br>preservation service. |              |
| 8.   | Conditional:<br>If<br>the<br>Crypto-Module<br>requests the<br>validation<br>of<br>certificates<br>from<br>Service<br>Provider<br>a Trust<br>heck the IT system<br>instead<br>of<br>doing<br>it<br>by<br>itself,<br>c<br>documentation for the used protocol within the<br>secure communication channel protocol between the<br>Cryptographic-Module and the Trust Service<br>Provider. | The documentation states which protocol is used (e.g. HTTP,<br>RPC, RMI, etc.).                                                                                                                                                                                                                                                                                          |              |
| 9.   | Conditional:<br>If<br>the<br>Crypto-Module<br>requests the<br>of<br>certificates<br>from<br>validation<br>a Trust<br>Service<br>Provider<br>heck the documentation<br>instead<br>of<br>doing<br>by<br>itself,<br>it<br>c<br>for this protocol whether technical confirmations of<br>receipts are implemented.                                                                          | The protocol implements such confirmations (e.g. TCP ACK,<br>HTTP Return codes, etc.).                                                                                                                                                                                                                                                                                   |              |
| 10.  | Conditional:<br>If<br>the<br>Crypto-Module<br>requests the<br>validation<br>of<br>certificates<br>from<br>Provider<br>a Trust<br>Service<br>lose the connection of<br>instead<br>of<br>doing<br>it<br>by<br>itself,<br>c<br>the two components. Stop logging the data traffic.                                                                                                         | The complete data exchange between the components has been<br>intercepted and logged.                                                                                                                                                                                                                                                                                    |              |
| 11.  | Conditional:<br>If<br>the<br>Crypto-Module<br>requests the<br>validation<br>of<br>certificates<br>from<br>Provider<br>a Trust<br>Service                                                                                                                                                                                                                                               | No document data can be accessed.                                                                                                                                                                                                                                                                                                                                        |              |

<sup>29</sup> Siehe [TR-ESOR-PEPT], clause 7.7.2, Validation

| Step | Test sequence of M.2-09                                                                                                                                                                                            | Expected Results                                                                 | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|--------------|
|      | heck the data traffic log<br>of<br>itself,<br>instead<br>doing<br>it<br>by<br>c<br>file for unprotected document data.                                                                                             |                                                                                  |              |
| 12.  | Check the user manual and Preservation Evidence<br>Policy (PEP), if the list of trusted certificates may<br>be<br>configured.                                                                                      | The list of trusted certificates may<br>be configured.                           |              |
| 13.  | Perform a test with a configured list of trusted<br>certificates                                                                                                                                                   | The Cryptographic-Module can check a configured list of<br>trusted certificates. |              |
| 14.  | In case of a qualified certificate according to [eIDAS<br>VO], Article 3(15), check, whether the qualified<br>certificate used for signature or seal full-fills the<br>requirements of [eIDAS-VO], Annex I or III. | The certificate full-fills the requirements of [eIDAS-VO],<br>Annex I or III.    |              |
| 15.  | Conditional:<br>test steps from<br>If<br>is<br>implemented,<br>LXAIP<br>No. 1 to No. 14 are to be repeated for LXAIP.                                                                                              | See expected results of the test cases from No. 1 to No. 14 for<br>LXAIP.        |              |
| 16.  | Conditional:<br>test steps<br>If<br>ASiC-AIP<br>is<br>implemented,<br>from No. 1 to No. 14 are to be repeated for ASiC-AIP.                                                                                        | See expected results of the test cases from No. 1 to No. 14 for<br>ASiC-AIP.     |              |

### <span id="page-117-1"></span>4.3.9 M.2-10 – Validation of digital signatures and evidence records yields standardised and comprehensive Verification Report

<span id="page-117-0"></span>

| Identifier          | M.2-10                                                                                                                                                                                                                                                                                                                                                                                           |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | MD:A5.1-5, MD:A5.1-10                                                                                                                                                                                                                                                                                                                                                                            |
|                     | MD: A7.4-4                                                                                                                                                                                                                                                                                                                                                                                       |
|                     | M2:A5.1-10, M2:A5.1-11, M2:A5.1-12, M2:A5.2-1                                                                                                                                                                                                                                                                                                                                                    |
|                     | OVR-6.2-06                                                                                                                                                                                                                                                                                                                                                                                       |
|                     | OVR-9.3-01,<br>OVR-9.3-02                                                                                                                                                                                                                                                                                                                                                                        |
|                     | PRP-8.1-08                                                                                                                                                                                                                                                                                                                                                                                       |
| Test Purpose        | The Cryptographic Module is able to validate digital (advanced and qualified) signatures and evidence records generating digital signature validation results<br>in standardised formats by itself or by requesting a (qualified) Trust Service Provider with the status "granted".                                                                                                              |
|                     | The Cryptographic Module shall<br>be able to return digital signature and evidence record validation results, including related certificate information and<br>further supplemental evidence data including e.g. signatures, seals, time-stamps, CRLs, OCSP-Responses etc.                                                                                                                       |
|                     | The Cryptographic Module shall<br>offer a function that is able to validate user certificates for digital signatures. The validation shall<br>be complete up to a<br>trustworthy<br>root certificate or<br>trust anchor according to the preservation evidence policy (PEP)30 derived from [TR-ESOR-PEPT]<br>of the TR-ESOR-Product<br>Manufacturer or respectively of the preservation service. |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                 |
| Pre-test conditions | •<br>User manual is present.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>•<br>Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT] is present and published.                                                                                        |

 <sup>30</sup> Siehe [TR-ESOR-PEPT], clause 7.7.2, Validation

<span id="page-118-0"></span>

| Step | Test sequence of M.2-10                                                                                                                                                                                                                                                                                                                                                                                                                        | Expected Results                                                                                                                                              | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual and the PEP of the TR-ESOR<br>Product Manufacturer,<br>whether the cryptographic<br>module has a function that is able to demonstrably<br>verify the presence and validity status of user<br>certificates for digital advanced and qualified<br>signatures and time-stamps at the time of signature<br>creation by itself or by requesting a (qualified) trust<br>validation service provider with the status "granted". | The cryptographic module provides such a function.                                                                                                            |              |
| 2.   | Transfer the archival information package<br>XAIP_OK_SIG and / or BIN31 to the TOT using<br>either the interface function "Verify" or<br>"ValidateEvidence"<br>pursuant to TR-S.4 or TR<br>S.512.                                                                                                                                                                                                                                              | The call of the function with this signed object as parameter is<br>possible.                                                                                 |              |
| 3.   | Observe the output "VerifyResponse"<br>or<br>"ValidateEvidenceResponse".                                                                                                                                                                                                                                                                                                                                                                       | A positive feedback will be received; no error message or error<br>code.                                                                                      |              |
| 4.   | Check, whether validation information is missing.<br>The complete validation information of the digital<br>signature, the certificate and all certificates back to a<br>trustworthy root CA or trust anchor according to the<br>preservation evidence policy (PEP) derived from [TR<br>ESOR-PEPT]<br>of the TR-ESOR-Product Manufacturer<br>or respectively of the preservation service shall<br>be<br>present.                                | All the digital signature validation results, including related<br>certificate information, are returned without changes to the<br>module making the request. |              |

<sup>31</sup> See clause 2, Notice 4.

| Step | Test sequence of M.2-10                                                                                                                                                                                                                                                                                                                                                                                      | Expected Results                                                                                                                                                                                                                                                                         | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 5.   | Check the format for the validation results. Check the<br>user guidance to determine the format used.                                                                                                                                                                                                                                                                                                        | The results are documented in a standardized format. If<br>supported and requested pursuant to [TR-ESOR-E], clause 3.7.1,<br>the "VerificationReport" of the [OASIS-VR]<br>or [TR-ESOR-VR]<br>is used.                                                                                   |              |
| 6.   | Transfer the archival information package<br>XAIP_OK_SIG and / or BIN<br>(see clause 2, Notice 4)<br>to the TOT using either the interface function<br>"Verify" or "ValidateEvidence" and, if<br>supported, asking for a<br>ReturnVerificationReport pursuant to TR-S.4<br>or TR-S.512.                                                                                                                      | The call of the function with this signed object as parameter is<br>possible.                                                                                                                                                                                                            |              |
| 7.   | Observe the output "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                                                                                                                                                                                                                                                        | A positive feedback will be received; no error message or error<br>code.                                                                                                                                                                                                                 |              |
| 8.   | Check, whether validation information is missing.<br>The complete validation information of the digital<br>signature, the certificate and all certificates back to a<br>trustworthy root CA or trust anchor according to the<br>preservation evidence policy (PEP) derived from [TR<br>ESOR-PEPT]<br>of the TR-ESOR-Product Manufacturer<br>or respectively of the preservation service shall be<br>present. | All the digital signature validation results, including related<br>certificate information, are returned without changes to the<br>module making the request. If supported, a<br>ReturnVerificationReport-element according<br>[OASIS VR], [eCard-2]<br>and [TR-ESOR-VR]<br>is returned. |              |
| 9.   | Check the format for the validation results. Check the<br>user guidance to determine the format used.                                                                                                                                                                                                                                                                                                        | The results are documented in a standardized format, e.g.<br>of a<br>"VerificationReport" of the eCard-API-Framework ([OASIS<br>VR], [eCard-2]<br>and [TR-ESOR-VR]).                                                                                                                     |              |
| 10.  | Transfer the archival information package<br>XAIP_OK_SIG<br>and / or BIN<br>(see clause 2, Notice 4)<br>together with at least one evidence record to the TOT<br>using either the interface function "Verify" or                                                                                                                                                                                             | The call of the function with this signed object as parameter is<br>possible.                                                                                                                                                                                                            |              |

| Step | Test sequence of M.2-10                                                                                                                                                                                                                                                                                                                                                                                      | Expected Results                                                                                                                                                                                                                                                                                                                              | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|      | "ValidateEvidence" and, if supported,<br>asking for a<br>ReturnVerificationReport pursuant to TR-S.4 or TR<br>S.512.                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                               |              |
| 11.  | Observe the output "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                                                                                                                                                                                                                                                        | A positive feedback will be received; no error message or error<br>code.                                                                                                                                                                                                                                                                      |              |
| 12.  | Check, whether validation information is missing.<br>The complete validation information of the digital<br>signature, the certificate and all certificates back to a<br>trustworthy root CA or trust anchor according to the<br>preservation evidence policy (PEP) derived from [TR<br>ESOR-PEPT]<br>of the TR-ESOR-Product Manufacturer<br>or respectively of the preservation service shall be<br>present. | All the digital signature validation results, including related<br>certificate information, and evidence record validation results<br>are returned without changes to the module making the<br>request. If supported, at least one<br>ReturnVerificationReport-element according<br>[OASIS VR], [eCard-2]<br>and [TR-ESOR-VR]<br>is returned. |              |
| 13.  | Check the format for the validation results. Check the<br>user guidance to determine the format used.                                                                                                                                                                                                                                                                                                        | The results are documented in a standardized format, e.g.<br>of a<br>"VerificationReport" of the eCard-API-Framework ([OASIS<br>VR], [eCard-2]<br>and [TR-ESOR-VR]).                                                                                                                                                                          |              |

### <span id="page-121-1"></span>4.3.10 M.2-11 – Suitable cryptographic algorithms should be defined by User Manual and the Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT][32](#page-121-1)

| Identifier          | M.2-11                                                                                                                                                                   |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | M3:A5.3-2                                                                                                                                                                |
| Test Purpose        | Check whether the validity periods of hash and digital signature algorithms are stored and managed in the form of a Preservation Evidence Policy file.                   |
| Configuration       | CONFIG_Common                                                                                                                                                            |
| Pre-test conditions | •<br>User manual is present.<br>•<br>Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI- [TR-ESOR-PEPT], is present and published. |

<span id="page-121-0"></span>

| Step | Test sequence of M.2-11                                                                                                                                     | Expected Results                                                                                                                  | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual and the Preservation Evidence<br>Policy, how the validity periods of hash and digital<br>signature algorithms are stored and managed. | The validity periods of hash and digital signature<br>algorithms should<br>be stored and managed in the form<br>of a policy file. |              |

| Verdict of M.2-11 |  |  |  |
|-------------------|--|--|--|
|                   |  |  |  |
|                   |  |  |  |

 <sup>32</sup> Extended requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

### 4.3.11 M.2-12 – Protect its own security

| Identifier          | M.2-12                                                                                                                              |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M2:A6.2-2                                                                                                                           |  |
| Test<br>Purpose     | Check whether the Cryptographic-Module includes a function to verify its own integrity<br>as internal defence against manipulation. |  |
| Configuration       | CONFIG_Common                                                                                                                       |  |
| Pre-test conditions | •<br>Developer documents are present.<br>•<br>Design documents are present.                                                         |  |

<span id="page-122-0"></span>

| Step | Test sequence of M.2-12                                                                                                                | Expected Results                                                                                                                                                                              | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the middleware documentation for a<br>description of the design of the Cryptographic<br>Module<br>module.                        | The Cryptographic-Module<br>module is designed as an<br>independent module or is at least functionally separated from<br>other parts of the product pursuant to [TR-ESOR-M.2], clause<br>3.1. |              |
| 2.   | Check the vendor documentation for information<br>whether the Cryptographic-Module includes a<br>function to verify its own integrity. | The Cryptographic-Module includes a function to verify its<br>own integrity.                                                                                                                  |              |

| Verdict of M.2-12 |
|-------------------|
|                   |
|                   |

### 4.3.12 M.2-13 – Recording security functions

| Identifier          | M.2-13                                                                                                                      |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M2:A6.2-3                                                                                                                   |  |
|                     | OVR-7.10-02                                                                                                                 |  |
|                     | PRP-8.1-06                                                                                                                  |  |
| Test<br>Purpose     | Check whether the Cryptographic-Module has functions to record all security functions in a meaningful and traceable manner. |  |
| Configuration       | CONFIG_Common                                                                                                               |  |
| Pre-test conditions | •<br>Developer documents are present.                                                                                       |  |
|                     | •<br>Design documents are present.                                                                                          |  |

<span id="page-123-0"></span>

| Step | Test sequence of M.2-13                                                                                                                                                             | Expected Results                                                                                                                                               | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 3.   | Check the vendor documentation for information<br>whether the Cryptographic-Module includes a<br>function to record all security functions in a<br>meaningful and traceable manner. | The Cryptographic-Module includes a function which records<br>the administration and the exchange of software or keys in a<br>meaningful and traceable manner. |              |
| 4.   | Check the<br>log files (records) of the Cryptographic<br>Module.                                                                                                                    | The log files record the execution of the security functions in a<br>meaningful and traceable manner.                                                          |              |

#### Verdict of M.2-13

### 4.3.13 M.2-14 – Responsivity to unauthorized access

<span id="page-124-0"></span>

| Identifier          | M.2-14                                                                                                                                                                                                                    |
|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | M2:A6.2-4                                                                                                                                                                                                                 |
|                     | M2:A3.4-3                                                                                                                                                                                                                 |
|                     | PRP-8.1-01                                                                                                                                                                                                                |
|                     | PRP-8.1-03                                                                                                                                                                                                                |
| Test<br>Purpose     | Check whether the Cryptographic-Module is capable of cancelling the execution of a function with a meaningful and comprehensible error<br>message in the event of unauthorised access in the module's security functions. |
| Configuration       | CONFIG_Common                                                                                                                                                                                                             |
| Pre-test conditions | •<br>Developer documents are present.                                                                                                                                                                                     |
|                     | •<br>User manual is present.                                                                                                                                                                                              |

| Step | Test sequence of M.2-14                                                                                                                                                                                                                                     | Expected Results                                                                                                                                                                           | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the vendor documentation for information<br>whether the Cryptographic-Module is capable of<br>cancelling the execution of a function.                                                                                                                 | The Cryptographic-Module is capable of cancelling the<br>execution of functions.                                                                                                           |              |
| 2.   | Check the vendor documentation for information if<br>the capability<br>of cancelling the execution of a<br>function produces<br>a meaningful and comprehensible<br>error message in the event of unauthorised access in<br>the module's security functions. | of the execution of a function produces<br>a<br>The cancellation<br>meaningful and comprehensible error message in the event<br>of unauthorised access in the module's security functions. |              |
| 3.   | Check the error messages produced during test case<br>A-03<br>due to unauthorized access.<br>Are these error messages meaningful and<br>comprehensible?                                                                                                     | All these error messages are meaningful and comprehensible.                                                                                                                                |              |

#### Verdict of M.2-14

### 4.3.15 M.2-15 – Configuration of cryptographic functions

| Identifier          | M.2-15                                                                                                            |
|---------------------|-------------------------------------------------------------------------------------------------------------------|
| Requirement         | M2:A6.3-1, M2:A6.3-2, M2:A6.3-3                                                                                   |
|                     | OVR-6.5-04                                                                                                        |
|                     | OVR-7.14-01,<br>OVR-7.14-03                                                                                       |
|                     | OVR-7.15-01,<br>OVR-7.15-03                                                                                       |
| Test<br>Purpose     | Check whether the Cryptographic-Module has a central function to configure cryptographic functions.               |
|                     | Check whether the configuration is managed by a configuration file and whether this file complies with [RFC5698]. |
| Configuration       | CONFIG_Common                                                                                                     |
| Pre-test conditions | •<br>User manual is present.                                                                                      |
|                     | •<br>Product design documents are present.                                                                        |

<span id="page-126-0"></span>

| Step | Test sequence of M.2-15                                                                                                                                                                                                              | Expected Results                                                                                                                                                                                                                                                                                                                                            | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the vendor documentation and assess the<br>Crypto-Module to identify how the Cryptographic<br>Module realises the configuration of cryptographic<br>functions, especially the algorithms and parameters<br>used for operation. | The Cryptographic-Module has a central function to configure<br>cryptographic functions, preferably in a configuration file.<br>or<br>the Crypto-Module just supports those algorithms and<br>parameters assessed as suitable for [eIDAS-VO]<br>with [EN 119<br>312]<br>(hard-wired) and the Crypto-Modules needs to be updated<br>in order to change that. |              |
| 2.   | , check whether this files<br>If<br>a configuration<br>file<br>is<br>used<br>complies with [DSSC].                                                                                                                                   | The [DSSC]<br>format is used.                                                                                                                                                                                                                                                                                                                               |              |

| Verdict of M.2-15 |
|-------------------|
|                   |
|                   |

### 4.3.16 M.2-16 – Validation of certificates based on a standardized protocol

<span id="page-127-0"></span>

| Identifier          | M.2-16                                                                                                                  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------|
| Requirement         | M2:A5.1-16                                                                                                              |
|                     | OVR-6.2-06                                                                                                              |
|                     | OVR-9.3-01                                                                                                              |
|                     | OVR-9.3-02                                                                                                              |
| Test Purpose        | The validation of the validity of the certificate shall<br>occur based on a standardized protocol. (see A5.1-16 in M.2) |
| Configuration       | CONFIG_Common                                                                                                           |
| Pre-test conditions | •<br>User manual is present.                                                                                            |
|                     | •<br>Developer documents are present.                                                                                   |

| Step | Test sequence of M.2-16                                                                                                                                     | Expected Results                                                                                                         | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual and developer documents for<br>information about which protocols for the validation<br>of the validity of certificates are supported. | The list of supported protocols for the validation of the validity<br>of the certificate is given.<br>OCSP is supported. |              |
| 2.   | Check each other supported validation protocol, if it is<br>standardized.                                                                                   | All other supported protocols for the validation of the validity<br>of the certificate are standardized.                 |              |

| Verdict of M.2-16 |
|-------------------|
|                   |
|                   |

### 4.3.17 M.2-17 – Crypto-Module shall be able to request qualified Electronic Time-Stamps from a qualified Trust Service Provider

<span id="page-129-0"></span>

| Identifier          | M.2-17                                                                                                                                                               |  |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M2:A3.4-1                                                                                                                                                            |  |
|                     | M2:A5.4-1                                                                                                                                                            |  |
|                     | OVR-A-03                                                                                                                                                             |  |
| Test Purpose        | The Cryptographic-Module has a function to request a qualified electronic time-stamp according to [eIDAS-VO], Article 42 from a qualified Trust Service<br>Provider. |  |
| Configuration       | CONFIG_Common                                                                                                                                                        |  |
| Pre-test conditions | •<br>User manual is present.<br>•<br>The Cryptographic-Module is configured to request an electronic time-stamp by a qualified Trust Service Provider.               |  |

| Step | Test sequence of M.2-17                                                                                                                                                                                                    | Expected Results                                                                                                                                                                                                          | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual whether the Cryptographic<br>Module has a function to request a qualified<br>electronic time-stamp.                                                                                                  | The Cryptographic-Module has a function to request a qualified<br>electronic time-stamp.                                                                                                                                  |              |
| 2.   | Check whether a secure communication channel<br>between the Cryptographic-Module and the Trust<br>Service Provider is configured and activated.                                                                            | A secure communication channel is set up and active.                                                                                                                                                                      |              |
| 3.   | Start logging the data traffic between the<br>Cryptographic-Module and the Trust Service<br>Provider.                                                                                                                      | The data logging process has been started.                                                                                                                                                                                |              |
| 4.   | Request a qualified electronic time-stamp using the<br>corresponding interface function<br>from a qualified<br>Trust Service Provider according to [eIDAS-VO],<br>Article 42c.                                             | The request of the qualified electronic time-stamp is possible.                                                                                                                                                           |              |
| 5.   | Observe the output of the interface function.                                                                                                                                                                              | A positive feedback will be received; no error message or error<br>code. The electronic time-stamp shall<br>be received.                                                                                                  |              |
| 6.   | Check the electronic time-stamp whether it is a<br>qualified one.                                                                                                                                                          | The electronic time-stamp is a qualified electronic time-stamp.                                                                                                                                                           |              |
| 7.   | Check whether the Trust Service Provider is listed in<br>the trust list of the European Commission according<br>to [eIDAS-VO, Article 22 (4)] for providing qualified<br>electronic time-stamps with the status "granted". | The qualified Trust Service Provider is listed<br>in the trust list of<br>the European Commission according to [eIDAS-VO], Article<br>22 (4) for providing qualified electronic time-stamps with the<br>status "granted". |              |
| 8.   | heck the IT system documentation for the used<br>C<br>protocol within the secure communication channel<br>protocol between the Cryptographic-Module and the<br>Trust Service Provider.                                     | The documentation states which protocol is used (e.g. HTTP,<br>RPC, RMI,).                                                                                                                                                |              |

| Step | Test sequence of M.2-17                                                                                       | Expected Results                                                                      | Observations |
|------|---------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|--------------|
| 9.   | heck the documentation for this protocol whether<br>C<br>technical confirmations of receipts are implemented. | The protocol implements such confirmations (e.g. TCP ACK,<br>HTTP Return codes,).     |              |
| 10.  | lose the connection of the two components. Stop<br>C<br>logging the data traffic.                             | The complete data exchange between the components has been<br>intercepted and logged. |              |
| 11.  | heck the data traffic log file for unprotected<br>C<br>document data.                                         | No document data can be accessed.                                                     |              |

Verdict of M.2-17

### <span id="page-132-1"></span>4.3.18 M.2-18 – Crypto-Module supports [RFC 3161], [RFC5816], [RFC5652] and [EN 319 422] and suitable algorithms[33](#page-132-1)

| Identifier         | M.2-18                                                                                                                                                                                                                                                                                                                                                                                               |
|--------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement        | M2:A5.4-3                                                                                                                                                                                                                                                                                                                                                                                            |
|                    | M3:A4.7-4                                                                                                                                                                                                                                                                                                                                                                                            |
|                    | OVR-9.2-01                                                                                                                                                                                                                                                                                                                                                                                           |
| Test Purpose       | The Cryptographic-Module shall<br>check whether requested electronic time-stamp fulfils the requirements and specifications of the electronic time-stamp<br>protocol pursuant to [RFC3161], [RFC5816], [RFC5652] and [EN 319 422]]<br>and whether the limitations for algorithms and parameters assessed as suitable<br>for security according to [ETSI TS 119 312] and [SOG-IS]<br>are implemented. |
| Configuration      | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                                                        |
| Pre-test condition | •<br>Install an access to a qualified time-stamp Trust Service Provider, which accepts requests compliant with TSP (RFC 3161).<br>•<br>Configure the Crypto-Module to use this Time-Stamp Service.<br>•<br>Supply the list of algorithms and parameters assessed as suitable according to [ETSI TS 119 312]<br>and [SOG-IS].                                                                         |

<span id="page-132-0"></span>

| Step | Test sequence of M.2-18                                                                                                                                                                                                                                                                                                         | Expected Results                                                                                                                                                            | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Configure the Crypto-Module according to the<br>guidance; especially the protocol used to access the<br>qualified time-stamp trust service provider according<br>to [eIDAS-VO], Articel 42c.<br>Check also whether there are guidance hints<br>regarding the configuration of algorithms and other<br>cryptographic parameters. | It is expected that there are at least some hints regarding the<br>configuration of algorithms according to the eIDAS<br>recommendations of [ETSI TS 119 312] and [SOG-IS]. |              |

 <sup>33</sup> Extended requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

<span id="page-133-1"></span><span id="page-133-0"></span>

| Step | Test sequence of M.2-18                                                                                                                                                                                                                                                                              | Expected Results                                                                                                                                                                                                                                                                   | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 2.   | Request the qualified electronic time-stamp using the<br>interface function "Sign" requesting a timestamp"<br>as<br>TimestampRequest"34 for each hash algorithm<br>a<br>supported by the Cryptographic-Module. The<br>requestData contain the corresponding hash<br>algorithm-identifier.            | The request of the qualified electronic time-stamp with<br>algorithm-identifier in requestData as parameter is possible.<br>A positive feedback will be received; no error message or error<br>code. The electronic time-stamp shall<br>be received for at least<br>one algorithm. |              |
| 3.   | Check whether the<br>time-stamp protocol is pursuant<br>to [RFC3161], [RFC5816], [RFC5652]<br>and [EN 319<br>422].                                                                                                                                                                                   | The time-stamp protocol, used in step 2,<br>has an allowed format<br>pursuant to [RFC3161], [RFC5816], [RFC5652]<br>and [EN 319<br>422].                                                                                                                                           |              |
| 4.   | Check whether the<br>cryptographic algorithms and<br>parameters used in the time-stamp protocol are<br>suitable for security according to [ETSI TS 119 312]<br>and [SOG-IS].                                                                                                                         | The<br>cryptographic algorithms and parameters used in the time<br>stamp protocol in step 2 are suitable for security according to<br>[ETSI TS 119 312] and [SOG-IS].                                                                                                              |              |
| 5.   | Request a qualified electronic time-stamp using the<br>interface function "Sign" (TR-S.3) requesting a<br>timestamp" as a TimestampRequest"34 where the time<br>of the executing the request has been manipulated in<br>such a manner that it differs substantial from the<br>moment of the request. | The Crypto-Module returns an error message indicating that<br>the returned time is incorrect.                                                                                                                                                                                      |              |
| 6.   | Request an electronic time-stamp using the interface<br>function "Sign" (TR-S.3) requesting a timestamp" as a<br>TimestampRequest"34 where the digital signature of<br>the electronic time-stamp is invalid.                                                                                         | The Crypto-Module returns an error message indicating that<br>the digital signature of the electronic time-stamp is invalid.                                                                                                                                                       |              |

 <sup>34</sup> See [TR-ESOR-E], clause 5.3

| Verdict of M.2-18 |  |  |
|-------------------|--|--|
|                   |  |  |
|                   |  |  |

### 4.3.19 M.2-19 – Qualified Electronic Time-Stamps shall fulfil the requirements of [eIDAS-VO], Article 42

<span id="page-134-0"></span>

| Identifier          | M.2-19                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M2:A3.4-1                                                                                                                                                                                                                                                                                                                                                                                                                                                       |  |
|                     | M2:A3.4-3                                                                                                                                                                                                                                                                                                                                                                                                                                                       |  |
|                     | M2:A5.4-2                                                                                                                                                                                                                                                                                                                                                                                                                                                       |  |
|                     | OVR-7.14-0                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |
|                     | OVR-7.5-02                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |
|                     | OVR-7.15-01                                                                                                                                                                                                                                                                                                                                                                                                                                                     |  |
|                     | OVR-7.15-03                                                                                                                                                                                                                                                                                                                                                                                                                                                     |  |
|                     | OVR-A-03                                                                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| Test Purpose        | The Cryptographic-Module<br>shall check whether                                                                                                                                                                                                                                                                                                                                                                                                                 |  |
|                     | •<br>the qualified electronic time-stamp requested and received from a qualified Trust Service Provider with status "granted" on base of § 17 [VDG]<br>(see also [TR-ESOR-M.3]), including a valid digital signature created<br>by this qualified Trust Service Provider , fulfils the requirements of o<br>[eIDAS-VO], Article 42;                                                                                                                             |  |
|                     | •<br>requested qualified electronic time-stamps include an advanced electronic signature or an advanced electronic seal from the qualified Trust<br>Service Provider issuing qualified electronic time-stamp according to [eIDAS-VO], Article 42.                                                                                                                                                                                                               |  |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
| Pre-test conditions | •<br>User manuals are present<br>•<br>Install an access to a qualified Time-Stamp Trust Service Provider which accepts requests compliant with<br>TSP (RFC 3161)<br>•<br>Cryptographic-Module is configured (if possible) to check whether requested qualified electronic time-stamps for re-signing include an advanced<br>electronic signature or an advanced electronic seal from a qualified Trust Service Provider issuing qualified electronic time-stamp |  |

| Step | Test sequence of M.2-19                                                                                                                                                                                                                                                                                                                                                                                                                                   | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                            | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual and related documentation, if<br>there is described that the Cryptographic-Module has<br>a trustworthy communication channel, e.g. according<br>to [BSIMindTLS] including<br>[TR 03116], Part 4 and<br>[TR 02102],<br>to a qualified Trust Service Provider with<br>status "granted" according to [eIDAS-VO], Article 2<br>(20)<br>in order to request qualified electronic time<br>stamps according to [eIDAS-VO], Article 3 (34). | In the user manual there is a confirmation, that the<br>Cryptographic-Module has a trustworthy communication<br>channel, e.g. according to [BSIMindTLS] including<br>[TR 03116],<br>Part 4 and<br>[TR 02102],<br>to a qualified Trust Service Provider<br>with status "granted" according to [eIDAS-VO], Article 2 (20)<br>in order to request qualified electronic time-stamps according<br>to [eIDAS-VO], Article 3 (34). |              |
| 2.   | Check the user manual and related documentation, if<br>the qualified electronic time-stamp requested and<br>received from a qualified Trust Service Provider on<br>base of § 17 [VDG] (see also [TR-ESOR-M.3) fulfils the<br>requirements of o [eIDAS-VO], Article 42.                                                                                                                                                                                    | In the user manuals there is a confirmation, that the qualified<br>electronic time-stamp requested and received from a qualified<br>Trust Service Provider on base of § 17 [VDG] (see also [TR<br>ESOR-M.3) fulfils the requirements of o [eIDAS-VO], Article<br>42.                                                                                                                                                        |              |
| 3.   | If possible, configure the electronic Time-Stamp Trust<br>Service Provider in such a way that the electronic<br>time-stamps will be qualified signed.<br>Otherwise, use an electronic Time-Stamp Trust<br>Service Provider actually generating qualified signed<br>time-stamps.                                                                                                                                                                           | The<br>test set-up is possible.                                                                                                                                                                                                                                                                                                                                                                                             |              |
| 4.   | The Cryptographic-Module requests a qualified<br>electronic time-stamp from the qualified Time-Stamp<br>Trust Service Provider.                                                                                                                                                                                                                                                                                                                           | The Cryptographic-Module requests the qualified electronic<br>time-stamp.                                                                                                                                                                                                                                                                                                                                                   |              |
| 5.   | Observe the output of the Cryptographic-Module.                                                                                                                                                                                                                                                                                                                                                                                                           | A positive feedback will be received; no error message or error<br>code. The Cryptographic-Module accepts the qualified<br>electronic time-stamp.                                                                                                                                                                                                                                                                           |              |
| 6.   | If possible, configure the qualified Trust Service<br>Provider issuing qualified electronic time-stamps in                                                                                                                                                                                                                                                                                                                                                | The test set-up is possible.                                                                                                                                                                                                                                                                                                                                                                                                |              |

| Step | Test sequence of M.2-19                                                                                                                                           | Expected Results                                                                                                                                                                                                     | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|      | such a way that the electronic time-stamps will be not<br>qualified signed.                                                                                       |                                                                                                                                                                                                                      |              |
|      | Otherwise, use an electronic time-stamp service<br>provider actually generating signed electronic time<br>stamps but not qualified signed.                        |                                                                                                                                                                                                                      |              |
| 7.   | Let the Cryptographic-Module request an electronic<br>time-stamp from the Trust Service Provider issuing<br>electronic time-stamps.                               | The Cryptographic-Module requests the electronic time-stamp.                                                                                                                                                         |              |
| 8.   | Observe the output of the Cryptographic-Module.                                                                                                                   | A negative feedback will be received; an error message or error<br>code on display or in error log will appear. The Cryptographic<br>Module does not accept not qualified signed qualified<br>electronic time-stamp. |              |
| 9.   | If possible, configure the Time-Stamp Trust Service<br>Provider or the requesting middleware in such a way<br>that the electronic time-stamps will be not signed. | The test set-up is possible.                                                                                                                                                                                         |              |
|      | Otherwise, use a Time-Stamp Trust Service Provider<br>actually generating not signed electronic time<br>stamps.                                                   |                                                                                                                                                                                                                      |              |
| 10.  | Let the Cryptographic-Module request an electronic<br>time-stamp from the Time-Stamp Trust Service<br>Provider.                                                   | The Cryptographic-Module requests the electronic time-stamp.                                                                                                                                                         |              |
| 11.  | Observe the output of the Cryptographic-Module.                                                                                                                   | A negative feedback will be received; an error message or error<br>code on display or in error log will appear. The Cryptographic<br>Module doesn't accept not signed qualified electronic time<br>stamp.            |              |

<span id="page-137-1"></span>

| Verdict of M.2-19 |  |  |  |
|-------------------|--|--|--|
|                   |  |  |  |
|                   |  |  |  |

4.3.20 M.2-20 – Crypto-Module shall validate digital signatures of received Electronic Time-Stamps according to the Time-Stamp Validation Policy[35](#page-137-1)

| Identifier  | M.2-20      |
|-------------|-------------|
| Requirement | MD:A5.1-5   |
|             | MD: A7.4-4  |
|             | MD: A7.4-5  |
|             | MD: A7.4-6  |
|             | M2:A5.4-4   |
|             | M2:A5.4-5   |
|             | OVR-7.10-02 |
|             | PRP-8.1-06  |
|             | OVR-9.3-01  |
|             | OVR-9.3-02  |

<span id="page-137-0"></span> <sup>35</sup> Extended requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

<span id="page-138-0"></span>

| Identifier          | M.2-20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |  |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Test Purpose        | Check whether the Cryptographic-Module validates the authenticity and integrity of received qualified electronic time-stamps immediately upon receipt<br>and prior to further processing including the validation of the certificate chain back to a trustworthy root certificate or trust anchor according to the<br>preservation evidence policy (PEP)36 derived from [TR-ESOR-PEPT]<br>of the TR-ESOR-Product Manufacturer or respectively of the preservation service                                  |  |
|                     | -<br>according to the Time-Stamp Validation Policy supported by the Preservation Evidence Policy PEP, clause 7 and clause 7.7.5.2, (To-Do7.7.5-4) and<br>by the Preservation Profile of the TR-ESOR-Product Manufacturer, derived from the BSI-[TR-ESOR-PEPT]<br>or                                                                                                                                                                                                                                        |  |
|                     | -<br>by requesting a validation service from a Trust Service Provider according to the Time-Stamp Validation Policy supported by the Preservation<br>Profile and Preservation Evidence Policy<br>(PEP), clause 7.7.3.2 and clause 7.7.5.2 of the TR-ESOR-Product Manufacturer, derived from the BSI-[TR<br>ESOR-PEPT].                                                                                                                                                                                     |  |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |
| Pre-test conditions | •<br>User manual is present.<br>•<br>Preservation Evidence Policy<br>(PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT], is present and published.<br>•<br>Preservation Profile is present and published.<br>•<br>Signature and Time-Stamp Validation Policy is present and published.<br>•<br>Configure Crypto-Module to maximum verbose logging.<br>•<br>The Cryptographic-Module may<br>be configured to ask for a time-stamp validation service from a Trust Service Provider. |  |

| Step | Test sequence of M.2-20                                                                                                                                                                                                                                                               | Expected Results                                                                                                                                                                                                                                             | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the Preservation Evidence Policy<br>(PEP) of the<br>TR-ESOR-Product Manufacturer<br>where to find the<br>actual Preservation Profile. Check the Preservation<br>Profile in order to find a Time-Stamp Validation<br>Policy or a reference to a Time-Stamp Validation<br>Policy. | In the PEP of the TR-ESOR-Product Manufacturer, there is the<br>information, where to find the actual Preservation Profile. In<br>the actual profile, the Time-Stamp Validation Policy or a<br>reference to the Time-Stamp Validation Policy is to be found. |              |
| 2.   | Request a qualified electronic time-stamp using the<br>functions of the Crypto-Module.                                                                                                                                                                                                | The Crypto-Module performs the request.                                                                                                                                                                                                                      |              |

 <sup>36</sup> Siehe [TR-ESOR-PEPT], clause 7.7.2, Validation

| Step | Test sequence of M.2-20                                                                                                                                                                                                                                                                                                                                                                                                                              | Expected Results                                                                                                                                                       | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 3.   | Check log files or other evidences whether the<br>Crypto-Module has verified the authenticity and<br>integrity of the received qualified electronic time<br>stamp (the digital signature) by itself or by a<br>connected time-stamp validation service from a Trust<br>Service Provider.                                                                                                                                                             | The Crypto-Module or the connected Time-Stamp Validation<br>Trust Service Provider has successfully verified the<br>mathematical correctness of the digital signature. |              |
| 4.   | Check log files or other<br>evidences whether the<br>Crypto-Module or the connected Time-Stamp<br>Validation Trust Service Provider has verified the<br>certificate used for digital signature.                                                                                                                                                                                                                                                      | The Crypto-Module or the connected Time-Stamp Validation<br>Trust Service Provider has verified successfully the digital<br>signature certificate.                     |              |
| 5.   | Check log files or other evidences whether the<br>Crypto-Module or the connected Time-Stamp<br>Validation Trust Service Provider has verified the CA<br>certificate used to sign the certificate used for digital<br>signature.                                                                                                                                                                                                                      | The Crypto-Module or the connected Time-Stamp Validation<br>Trust Service Provider has verified successfully the CA<br>certificate                                     |              |
| 6.   | Emulate the check of invalid digital signatures and<br>certificates.                                                                                                                                                                                                                                                                                                                                                                                 | The Cryptographic-Module detects and logs the failures with<br>its reason codes.                                                                                       |              |
| 7.   | Check that the validation of the digital signatures of<br>the received electronic time-stamps and the<br>validation of the certificate chain back to a<br>trustworthy root certificate<br>or trust anchor according<br>to the preservation evidence policy (PEP) derived<br>from [TR-ESOR-PEPT]<br>of the TR-ESOR-Product<br>Manufacturer or respectively of the preservation<br>service.were done according to the Time-Stamp<br>Validation Policy. | The validation of the digital signatures and the certificate were<br>done according to the Time-Stamp Validation Policy.                                               |              |

| Step | Test sequence of M.2-20                                                                                                                                                                                                                                                                                                                                                            | Expected Results                                                                                                                                                                                                                                                                             | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 8.   | Conditional:<br>If<br>implemented:<br>LXAIP<br>is<br>Store an LXAIP_OK_SIG<br>using either the<br>"ArchiveSubmission" or the "PreservePO"<br>function.                                                                                                                                                                                                                             | The function call is possible.                                                                                                                                                                                                                                                               |              |
| 9.   | Conditional:<br>If<br>is<br>implemented:<br>LXAIP<br>Check the output<br>"ArchiveSubmissionResponse" or the<br>"PreservePOResponse".                                                                                                                                                                                                                                               | The LXAIP_OK_SIG<br>object is assigned to an AOID and returned<br>successfully.                                                                                                                                                                                                              |              |
| 10.  | Conditional:<br>If<br>LXAIP<br>is<br>implemented:<br>Check log files or other evidences whether the<br>Crypto-Module has retrieved the data object,<br>referenced in in the <asic:DataObjectReference> from<br>the ECM-/ Long-Term Storage and verified the hash<br>value (or another cryptographic security element) in<br>the <asic:DataObjectReference> of the<br>LXAIP_OK_SIG. | The Crypto-Module has retrieved the data object, referenced in<br>in the <asic:DataObjectReference> from the ECM-/Long-Term<br>Storage and has verified successfully the hash value (or another<br>cryptographic security element) in the<br><asic:DataObjectReference> of the LXAIP_OK_SIG. |              |
| 11.  | Conditional:<br>If<br>LXAIP<br>is<br>implemented:<br>Store an LXAIP_OK_SIG<br>using either the<br>"ArchiveSubmission" or the "PreservePO"<br>function, where the hash value or another<br>cryptographic security element in the<br><asic:DataObjectReference> of the LXAIP_OK_SIG<br>is<br>wrong.                                                                                  | The function call is possible.                                                                                                                                                                                                                                                               |              |

| Step | Test sequence of M.2-20                                                                                                                                                                                                                                                                                                                                                            | Expected Results                                                                                                                                                                                                                                                                                                                                             | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 12.  | Conditional:<br>If<br>is<br>implemented:<br>LXAIP<br>Check the output<br>"ArchiveSubmissionResponse" or the<br>"PreservePOResponse".                                                                                                                                                                                                                                               | The LXAIP_OK_SIG<br>object is not assigned to an AOID and a<br>negative feedback will be received with error message and error<br>code.                                                                                                                                                                                                                      |              |
| 13.  | Conditional:<br>If<br>LXAIP<br>is<br>implemented:<br>Check log files or other evidences whether the<br>Crypto-Module has retrieved the data object,<br>referenced in in the <asic:DataObjectReference> from<br>the ECM-/ Long-Term Storage and verified the hash<br>value (or another cryptographic security element) in<br>the <asic:DataObjectReference> of the<br>LXAIP_OK_SIG. | The Crypto-Module has retrieved the data object, referenced in<br>in the <asic:DataObjectReference> from the ECM-/ Long-Term<br>Storage and has not verified successfully the hash value (or<br>another cryptographic security element) in the<br><asic:DataObjectReference> of the LXAIP_OK_SIG.<br>The Cryptographic module detects and logs the failures. |              |

#### Verdict of M.2-20

4.3.21 M.2-21 – The Cryptographic-Module shall have a trustworthy communication channel to a qualified Trust Service Provider in order to request qualified electronic time-stamps according to [eIDAS-VO], Article 3 (34)

| Identifier          | M.2-21                                                                                                                                                                                                                                                                                                                      |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M2:A3.4-1                                                                                                                                                                                                                                                                                                                   |  |
|                     | M2:A3.4-3                                                                                                                                                                                                                                                                                                                   |  |
|                     | M2:A5.1-15                                                                                                                                                                                                                                                                                                                  |  |
|                     | OVR-7.5-02                                                                                                                                                                                                                                                                                                                  |  |
|                     | PRP-8.1-01                                                                                                                                                                                                                                                                                                                  |  |
| Test Purpose        | The Cryptographic-Module<br>shall have a trustworthy communication channel to a qualified Trust Service Provider according to [eIDAS-VO], Article 2 (20)<br>in order to request qualified electronic time-stamps according to [eIDAS-VO], Article 3 (34)                                                                    |  |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                               |  |
| Pre-test conditions | •<br>User manual is present.<br>•<br>Preservation Evidence Policy<br>(PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT], is present and published.<br>•<br>Install an access to two qualified Time-Stamp Trust Service Providers, which accepts requests compliant with TSP pursuant to [RFC 3161]. |  |

<span id="page-142-0"></span>

| Step | Test sequence of M.2-21                                                                                                                                                                                                                                                                                                                                                                                                    | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                         | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the Preservation Evidence Policy<br>(PEP) of the<br>TR-ESOR-Product Manufacturer and related<br>documentation, if there is described that the<br>Cryptographic-Module has a trustworthy<br>communication channel, e.g. according to<br>[BSIMindTLS] including.<br>[TR 03116], Part 4and<br>[TR<br>02102],<br>to a qualified Trust Service Provider according to<br>[eIDAS-VO], Article 2 (20)<br>in order to request | In the PEP of the TR-ESOR-Product Manufacturer<br>there is a<br>confirmation, that the Cryptographic-Module has a<br>trustworthy communication channel, e.g. according to<br>[BSIMindTLS] including.<br>[TR 03116], Part 4 and<br>[TR 02102],<br>to<br>a qualified Trust Service Provider according to [eIDAS-VO],<br>Article 2 (20)<br>in order to request qualified electronic time<br>stamps according to [eIDAS-VO], Article 3 (34). |              |

| Step | Test sequence of M.2-21                                                                                                                                                                                                                                            | Expected Results                                                                                                                                  | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|      | qualified electronic time-stamps according to<br>[eIDAS-VO], Article 3 (34).                                                                                                                                                                                       |                                                                                                                                                   |              |
| 2.   | If possible, configure the electronic Time-Stamp Trust<br>Service Provider or the requesting middleware in such<br>a way, that the qualified electronic time-stamps will<br>be used                                                                                | The test set-up is possible.                                                                                                                      |              |
|      | Otherwise, use an electronic Time-Stamp Trust<br>Service Provider actually generating qualified<br>electronic time-stamps.                                                                                                                                         |                                                                                                                                                   |              |
| 3.   | The Cryptographic-Module requests a qualified<br>electronic time-stamp from the qualified Time-Stamp<br>Trust Service Provider.                                                                                                                                    | The Cryptographic-Module receives the qualified electronic<br>time-stamp.                                                                         |              |
| 4.   | Observe the output of the Cryptographic-Module.                                                                                                                                                                                                                    | A positive feedback will be received; no error message or error<br>code. The Cryptographic-Module accepts the qualified<br>electronic time-stamp. |              |
| 5.   | Conditional:<br>he Cryptographic-Module<br>If<br>supported,<br>t<br>sends the received qualified electronic time-stamp to<br>an external (qualified) Validation Time-Stamp Trust<br>Service Provider<br>(VAL) to validate this qualified<br>electronic time-stamp. | The Cryptographic-Module receives a response of the qualified<br>Trust Service Provider.                                                          |              |
| 6.   | Observe the output from the qualified Trust Service<br>Provider.                                                                                                                                                                                                   | A positive feedback will be received; no error message or error<br>code. The qualified electronic time-stamp is valid.                            |              |

#### Verdict of M.2-21

## 4.4 Module 3 – ArchiSig-Module

#### Pre-supposition:

A product which claims to be conform to the M.3 ArchiSig specification of this TR (conformity level 1) has to pass

- all test cases in this section and
- <span id="page-144-0"></span>• all test cases for the interface S.6 specified in sectio[n 0.](#page-259-2)

### <span id="page-145-1"></span>4.4.1 M.3-01 – ArchiSig-Module should be realised as a separate module

<span id="page-145-0"></span>

| Identifier          | M.3-01                                                                                                                                                                                                                                                                           |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | MD:A7.4-9                                                                                                                                                                                                                                                                        |
|                     | MD:A7.4-12                                                                                                                                                                                                                                                                       |
|                     | M3:A3.1-1                                                                                                                                                                                                                                                                        |
|                     | M3:A3.1-4                                                                                                                                                                                                                                                                        |
| Test Purpose        | The test shall<br>verify that the ArchiSig-Module runs as an independent application or independent (functionally delimited) part of an application on a<br>trustworthy IT system37 and is neither a logical nor a functional component of upstream IT business<br>applications. |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                    |
| Pre-test conditions | •<br>User manual is present.                                                                                                                                                                                                                                                     |

<sup>37</sup> The term trustworthy has been applied to IT systems that are inherently secure, available and reliable.

<span id="page-146-0"></span>

| Step | Test sequence of M.3-01                                                                                                                                                                                                                                                                                                             | Expected Results                                                                                               | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check TOT and the user manual, whether the<br>ArchiSig-Module is an independent application or<br>independent (functionally delimited) part of an<br>application.                                                                                                                                                                   | The ArchiSig-Module is an independent application or<br>independent part of an application.                    |              |
| 2.   | Check,<br>whether the IT system is trustworthy,<br>on<br>which the module is implemented.<br>For this purpose,<br>the vendor could<br>provide an<br>especially hardened system or could<br>assume an<br>especially hardened system.<br>The test fails, if no settings for the baseline system are<br>assumed or already provided.38 | There are statements about the trustworthy IT system.                                                          |              |
| 3.   | Check the TOT and/or the user manual, whether the<br>ArchiSig-Module is either a logical or a functional<br>component of the upstream IT specialist applications.                                                                                                                                                                   | The ArchiSig-Module is neither a logical nor a functional<br>component of upstream IT specialist applications. |              |

Verdict of M.3-01

<sup>38</sup> For example, if the vendor just states that the product runs on the platform XYZ, the test fails.

If the vendor states that the products runs on the platform XYZ and the security white paper of the vendor of this platform have to be considers, the test passes.

### 4.4.2 M.3-02 – Using interface TR-S.3 is possible

#### Pre-supposition:

A product which claims to comply with the interfaces specification TR-S.3, of this TR or part of it has to pass the following test case or part of it or prove that they support functional analogous interfaces.

| Identifier          | M.3-02                                                                                                                                                                                                                           |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | M3:A3.2-2                                                                                                                                                                                                                        |
| Test Purpose        | The test shall<br>verify that the ArchiSig-Module is able to access the other modules of the middleware via dedicated interfaces as described in the annexes<br>[TR-ESOR-M.2]<br>and [TR-ESOR-E]<br>of this technical guideline. |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                    |
| Pre-test conditions | •<br>The middleware documentation is available.<br>•<br>The test dispenses if the pre-supposition is not valid.                                                                                                                  |

<span id="page-147-0"></span>

| Step | Test sequence of M.3-02                                                                                                       | Expected Results                                 | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|--------------|
| 1.   | Check whether the ArchiSig documentation contains<br>the description of how to connect to the interface TR<br>S.3 interface.  | The interface is described in the documentation. |              |
| 2.   | Check whether it is possible for the ArchiSig-Module<br>to communicate with the<br>Crypto-Module via the TR<br>S.3 interface. | Communication is possible.                       |              |

| Verdict of M.3-02 |  |
|-------------------|--|
|                   |  |

| Identifier          | M.3-04                                                                                                                                                                                                                                                                                                                                     |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | M3:A4.5-1, M3:A4.5-4                                                                                                                                                                                                                                                                                                                       |
|                     | OVR-9.3-03,<br>OVR-9.3-04                                                                                                                                                                                                                                                                                                                  |
| Test Purpose        | The test shall verify that the creation of the Initial Archive Timestamp is automated and take place according to configurable rules reliably stored in the<br>ArchiSig-Module.                                                                                                                                                            |
|                     | Conditional: In case of digitally signed or timestamped data, the test should<br>verify that the Initial Archive Timestamp.gives a proof of existence of the<br>signature or time-stamp and of the validation data needed to validate the signatures or time-stamp and on the other side gives a proof of existence of the<br>signed data. |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                                              |
| Pre-test conditions | •<br>User has administrator rights on the system.<br>•<br>If required, perform identification and authentication.<br>•<br>At least one archive object is already archived.                                                                                                                                                                 |

#### <span id="page-148-2"></span><span id="page-148-1"></span>4.4.3 M.3-04 – Creation of Initial Archive Timestamps according to [RFC4998][39](#page-148-1) [40](#page-148-2)

<span id="page-148-0"></span>39 Extended requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

<sup>40</sup> [RFC4998] shall be supported, [RFC6283] is not scope of this certification.

<span id="page-149-0"></span>

| Step | Test sequence of M.3-04                                                                                                                                                                                                                                                                                                                           | Expected Results                                                                                               | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the ArchiSig-Module, whether there are<br>configurable rules for the creation of<br>Initial Archive<br>Timestamps.                                                                                                                                                                                                                          | There are configurable rules for the creation of Initial Archive<br>Timestamps.                                |              |
| 2.   | Configure the ArchiSig-Module in such a way that<br>every 10 minutes (or another short time period) a new<br>Archive Timestamp will be created.                                                                                                                                                                                                   | Configuration is possible.                                                                                     |              |
| 3.   | Request every 10 minutes (or the configured period of<br>time) a new ER of an already archived object (3 or 4<br>times).                                                                                                                                                                                                                          | ER can be retrieved.                                                                                           |              |
| 4.   | Check the last Initial Archive Timestamp.                                                                                                                                                                                                                                                                                                         | The check is performed successfully. The Initial Archive<br>41.<br>Timestamp is created according to [RFC4998] |              |
| 5.   | Conditional: In case of digitally signed data or time<br>stamped data,<br>check,<br>that the Initial Archive Time-Stamp<br>.gives a<br>proof of existence of the signature or time-stamp and<br>of the validation data needed to validate the<br>signatures or time-stamp and on the other side gives a<br>proof of existence of the signed data. | The check is performed successfully                                                                            |              |

 <sup>41</sup> [RFC4998] shall be supported, [RFC6283] is not scope of this certification.

<span id="page-150-1"></span>

| Verdict of M.3-04 |  |
|-------------------|--|
|                   |  |
|                   |  |

### 4.4.4 M.3-05 – AOID shall be unique

| Identifier          | M.3-05                                                                                                                                                                                                                                   |  |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M3:A4.2-2                                                                                                                                                                                                                                |  |
| Test Purpose        | The test shall<br>verify that the generation of an AOID shall<br>be unique (collision free).                                                                                                                                             |  |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                            |  |
| Pre-test conditions | •<br>User has administrator rights on the system.<br>•<br>If required, perform identification and authentication.<br>•<br>Test case S.4.1-05 was performed successfully and the AOIDs were given back and are known in this test case.42 |  |

<span id="page-150-0"></span>

| Step | Test sequence of M.3-05  | Expected Results        | Observations |
|------|--------------------------|-------------------------|--------------|
| 1.   | Compare the known AOIDs. | No two AOIDs are equal. |              |

<sup>•</sup> <sup>42</sup> There are XAIPs or LXAIPs or BINs restricted to the preservation object formats described in clause Notice 4, which were successfully stored in the ECM-/Long-Term Storage and their AOID's were given back by the Response –Messages and therefore are "known" in this test case.

<span id="page-151-1"></span>

| Verdict of M.3-05 |  |
|-------------------|--|
|                   |  |
|                   |  |

### 4.4.5 M.3-06 – ArchiSig-Module creates Evidence Records according to RFC4998

| Identifier          | M.3-06                                                                                                                                                                                                                                                                                                                                                                                                                      |  |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|
| Requirement         | MD:A5.1-24, MD:A5.1-8                                                                                                                                                                                                                                                                                                                                                                                                       |  |  |
|                     | MD:A8.2-5, M3:A3.1-1, M3:A4.10-1                                                                                                                                                                                                                                                                                                                                                                                            |  |  |
|                     | OVR-6.5-08,<br>OVR-9.2-03,<br>OVR-9.3-03,<br>OVR-9.3-04                                                                                                                                                                                                                                                                                                                                                                     |  |  |
|                     | PRP-8.1-10                                                                                                                                                                                                                                                                                                                                                                                                                  |  |  |
| Test Purpose        | Check whether the Middleware is able to provide technical evidence for the authenticity and unsophisticatedness of the archival information packages<br>upon request as well as all electronic Evidence Records needed for this purpose.                                                                                                                                                                                    |  |  |
|                     | The function shall<br>calculate all Evidence Records (ERs) pursuant to the ERS standard for an Archival Information Package identified uniquely by the AOID,<br>and the result shall<br>be returned in an allowed format [RFC4998]<br>43 to the application or module making the request.                                                                                                                                   |  |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                            |  |  |
| Pre-test conditions | •<br>User manual is present.<br>•<br>Tester has read/write permissions on the Middleware.<br>•<br>If required, perform identification and authentication.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>•<br>The BSI-ERVerifyTool under an Open Source License<br>(Apache 2.0) is installed and the tester has access rights to it. |  |  |

<span id="page-151-0"></span><sup>43 [</sup>RFC4998] shall be supported, [RFC6283] is not scope of this certification.

| Step | Test sequence of M.3-06                                                                                                                                                                                                                                                                | Expected Results                                                                                                                                  | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual if an Evidence Record is<br>calculated pursuant to the ERS standard for an<br>Archival Information Package identified uniquely by<br>the AOID.                                                                                                                   | The Evidence Record is calculated pursuant to the ERS standard<br>[RFC4998].                                                                      |              |
| 2.   | Store an<br>XAIP_OK_SIG using either the<br>"ArchiveSubmission" or the "PreservePO"<br>function pursuant to either TR-S.4 or TR-S.512.                                                                                                                                                 | The function call is possible, the corresponding AOID will be<br>returned.                                                                        |              |
| 3.   | Check the output of the<br>"ArchiveSubmissionResponse" or the<br>"PreservePOResponse".                                                                                                                                                                                                 | The XAIP/BIN object is assigned to an AOID and returned<br>successfully.<br>The AOID can be used to retrieve the<br>corresponding XAIP/BIN.       |              |
| 4.   | Using either the interface function<br>"ArchiveEvidence" or the "RetrievePO<br>with<br>SubjectOfRetrieval "Evidence" " and an<br>existing AOID request all Evidence Records identified<br>uniquely by the AOID of the XAIP_OK_SIG<br>of Test<br>step 3 pursuant to TR-S.4 or TR-S.512. | The call of the function with this AOID as parameter is possible.                                                                                 |              |
| 5.   | Observe the output "ArchiveEvidenceResponse"<br>or the "RetrievePOResponse".                                                                                                                                                                                                           | A positive feedback will be received; no error message or error<br>code. All Evidence Records idenified uniquely by the AOID will<br>be received. |              |
| 6.   | Check<br>whether each Evidence Record contains the<br>hash values according to the version of the archive<br>object.                                                                                                                                                                   | Each Evidence Record contains the hash values according to the<br>version.                                                                        |              |
| 7.   | Check whether each Evidence Record contains an<br>Archive Timestamp Sequence, which demonstrates<br>the integrity of the archive object.                                                                                                                                               | Each Evidence Record contains such a sequence.                                                                                                    |              |

| Step | Test sequence of M.3-06                                                                                                                                                                                         | Expected Results                                                                                                                                                                            | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 8.   | Check whether the electronic time-stamps of the<br>Archive Timestamp Sequence are qualified electronic<br>time-stamps, which demonstrates the integrity and<br>possibly the authenticity of the archive object. | All electronic time-stamps are qualified electronic time-stamps,<br>i.e. time-stamps completed by an advanced digital signature<br>(signature or seal) according to [eIDAS-VO], Article 42. |              |
| 9.   | Check whether the Evidence Record has an allowed<br>format [RFC4998], using the BSI-ERVerifyTool.                                                                                                               | The BSI-ERVerifyTool returns a Verification Report with a<br>positive result. The Evidence Record has an allowed format:<br>[RFC4998].                                                      |              |

| Verdict of M.3-06 |
|-------------------|
|                   |
|                   |

| 4.4.6 |  |  | M.3-07 – ArchiSig-Module must not implement cryptographic functions |
|-------|--|--|---------------------------------------------------------------------|
|-------|--|--|---------------------------------------------------------------------|

<span id="page-154-0"></span>

| Identifier          | M.3-07                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |  |
|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M3:A3.1-5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
|                     | M3:A4.4-3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
| Test Purpose        | The test shall<br>verify that the ArchiSig-Module itself has not implemented cryptographic functions for the protection of the authenticity or validation of the<br>integrity and authenticity with the exception of the canonicalisation functions and the functions for generation of Merkle hash trees.                                                                                                                                                                                                                                                                                                                                        |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
| Pre-test conditions | •<br>Disconnect the Crypto-Module from the ArchiSig-Module.<br>•<br>User manual is present.<br>•<br>User has administrator rights on the system.<br>•<br>If required, perform identification and authentication.<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>BIN<br>•<br>shall be restricted<br>to the preservation object formats<br>described in clause<br>2, Notice 4. |  |

| Step | Test sequence of M.3-07                                                                                                                                                                                                                        | Expected Results                                                                                                                                                                                                                                              | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check, whether ArchiSig could be configured in such<br>a way that no Crypto-Module needs to be used.                                                                                                                                           | The TOT may<br>or may<br>not<br>have such a configuration option. If it<br>does not, this test case is finished and considered to be passed. If<br>it does, the security guidance of the vendor clearly states that<br>this configuration is not recommended. |              |
| 2.   | Call either the "ArchiveSubmission" or<br>"PreservePO" function of ArchiSafe using<br>XAIP_OK<br>or BIN<br>(see clause 2, Notice 4) as<br>parameter pursuant to TR-S.4 or TR-S.512.<br>If required, perform identification and authentication. | The call of the function with this XAIP / BIN as parameter is<br>possible.                                                                                                                                                                                    |              |
| 3.   | Observe the output<br>"ArchiveSubmissionResponse" or<br>"PreservePOResponse".                                                                                                                                                                  | A negative feedback will be received; an error message or error<br>code should<br>show that the digital signature or electronic time<br>stamp cannot be verified because a hash value for the XAIP /<br>BIN couldn't be calculated.                           |              |
| 4.   | Conditional:<br>test steps from<br>If<br>implemented,<br>LXAIP<br>is<br>No. 1 to No. 3 are to be repeated for LXAIP.                                                                                                                           | See expected results of the test cases from No. 1 to No. 3 for<br>LXAIP.                                                                                                                                                                                      |              |
| 5.   | Conditional:<br>test steps<br>If<br>implemented,<br>ASiC-AIP<br>is<br>from No. 1 to No. 3 are to be repeated for ASiC-AIP.                                                                                                                     | See expected results of the test cases from No. 1 to No. 3 for<br>ASiC-AIP.                                                                                                                                                                                   |              |

#### Verdict of M.3-07

### 4.4.7 M.3-08 – ArchiSig-Module shall be thread safe

| Identifier          | M.3-08                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A7.2-13, MD:A7.2-9                                                                                                                                                                                                                                                                                                                                                                                                                                     |  |
|                     | MD:A7.4-10, MD:A7.4-11, MD:A7.4-12                                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| Test Purpose        | The ArchiSig-Module shall<br>be able to work parallel in multiple entities, in particular with regard to the case when all archival information packages present<br>in the ECM-/Long-term storage have to be re-signed and/or to be re-hashed.                                                                                                                                                                                                            |  |
| Configuration       | CONFIG_ArchiSafe<br>If possible, configure ArchiSig to work parallel in multiple entities on one computer; consult the guidance for that purpose.                                                                                                                                                                                                                                                                                                         |  |
| Pre-test conditions | •<br>Test case S.4.1-06 was performed successful and the AOID is noted.<br>•<br>User has administrator rights on the system.<br>•<br>User manual is present.<br>•<br>If required, perform identification and authentication.<br>•<br>Ensure that there are a lot (several thousand) of archive objects in the archive.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured. |  |

<span id="page-156-0"></span>

| Step | Test sequence of M.3-08                                                                                                                                                                                                                                                                                 | Expected Results                                                                                                                | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Start a complete resigning of the archival information<br>packages.                                                                                                                                                                                                                                     | The resigning of the archival information packages starts.                                                                      |              |
| 2.   | This shall be done during the resigning<br>Request some archival information package from the<br>TOT using either the interface function<br>"ArchiveRetrieval" or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" and the noted AOID<br>from the test case S.4.1-06 pursuant to TR-S.4 or TR<br>S.512. | The call of the function with this AOID as parameter is possible.<br>The results were received in an acceptable amount of time. |              |

| Step | Test sequence of M.3-08                                                                                                                                                                                                                                                                                    | Expected Results                                                                                                                | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|--------------|
| 3.   | This shall be done during the resigning<br>Submit some archival information package to the<br>TOT using either the interface function<br>"ArchiveSubmission" or "PreservePO"<br>pursuant to TR-S.4 or TR-S.512.                                                                                            | The call of the function is possible. The results (the AOID) were<br>received in an acceptable amount of time.                  |              |
| 4.   | Start a complete rehashing of the archival<br>information packages.                                                                                                                                                                                                                                        | The rehashing of the archival information packages starts.                                                                      |              |
| 5.   | This shall be done during the rehashing<br>Request some archival information package from the<br>TOT using either the interface function<br>"ArchiveRetrieval" or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO""<br>and the noted AOID<br>from the test case S.4.1-06 pursuant to TR-S.4 or TR<br>S.512. | The call of the function with this AOID as parameter is possible.<br>The results were received in an acceptable amount of time. |              |
| 6.   | This shall be done during the rehashing<br>Submit some archival information package to the<br>TOT using either the interface function<br>"ArchiveSubmission" or "PreservePO"<br>pursuant to TR-S.4 or TR-S.512.                                                                                            | The call of the function<br>is possible. The results (the AOID) were<br>received in an acceptable amount of time (<= 2 Min).    |              |

#### Verdict of M.3-08

### 4.4.8 M.3-09 – Instances of ArchiSig-Module should be deployable on different machines

| Identifier          | M.3-09                                                                              |
|---------------------|-------------------------------------------------------------------------------------|
| Requirement         | MD:A7.4-10                                                                          |
|                     | MD:A7.4-11                                                                          |
| Test Purpose        | The individual entities of ArchiSig should<br>be able to run on different machines. |
| Configuration       | CONFIG_Common                                                                       |
| Pre-test conditions | •<br>If required, perform identification and authentication.                        |

<span id="page-158-0"></span>

| Step | Test sequence of M.3-09                                                                                                                         | Expected Results                                                              | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|--------------|
| 1.   | Perform test case M.3-01                                                                                                                        | This demonstrates that multiple entities of ArchiSig on one<br>computer work. |              |
| 2.   | Configure ArchiSig in such a way that the multiple<br>entities are running on different computers.<br>Consulting the guidance for that purpose. | That should<br>be possible.                                                   |              |
| 3.   | Perform test case M.3-01 again.                                                                                                                 | This demonstrates that multiple entities on different computers<br>work.      |              |

| Verdict of M.3-09 |
|-------------------|
|                   |
|                   |

### 4.4.9 M.3-11 – Canonicalisation of XML is performed prior to hashing and noted in (L)XAIP

<span id="page-159-0"></span>

| Identifier          | M.3-11                                                                                                                                                                                                                                 |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | M3:A4.3-1                                                                                                                                                                                                                              |
|                     | M3:A4.3-2                                                                                                                                                                                                                              |
| Test Purpose        | The test shall<br>verify that the algorithm used for the canonicalisation is entered into the corresponding field of the Package Headers of the XAIP before the<br>canonicalisation and hash value calculation.                        |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                       |
| Pre-test conditions | •<br>Developer documents are present.<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F],<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured. |

| Step | Test sequence of M.3-11                                                                                                                                                                                                                                                                   | Expected Results                                            | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|--------------|
| 1.   | Prepare an XAIP_OK in such a way that it is not<br>canonicalised (e.g. entering some blanks between<br>tags), has the canonicalization algorithm set to the<br>default one and versionMenifest secured by using a<br>protectedObjectPointer.<br>Check that no AOID is stated in the XAIP. | ---                                                         |              |
| 2.   | Submit this special XAIP_OK<br>to the archive using the<br>respective TR-S.4 or TS119512 function TR-S.512.                                                                                                                                                                               | This works without error.                                   |              |
| 3.   | Retrieve this special XAIP_OK<br>using the respective<br>TR-S.4 or TS119512 function TR-S.512.                                                                                                                                                                                            | This works. The XAIP_OK<br>is retrieved.                    |              |
| 4.   | Retrieve the corresponding evidence record, using the<br>respective function of either TR-S.4 or TR-S.512.                                                                                                                                                                                | Evidence record of submitted XAIP_OK<br>will be delivered.  |              |
| 5.   | In XAIP_OK delivered in step 3 remove the<br>canonicalization algorithm<br>from packageHeader.                                                                                                                                                                                            | Prepared XAIP_OK without stated canonicalization algorithm. |              |
| 6.   | Verify the prepared XAIP_OK from step 5 together<br>with evidence record from step 4<br>by using either<br>"verify" function of TR-S.4 or "validatePO" of TR<br>S.512.                                                                                                                    | A positive result will be returned.                         |              |
| 7.   | Conditional, if any other canonicalization algorithm<br>is supported: Replace the canonicalization algorithm<br>in result XAIP_OK from step 3 with the other<br>canonicalization algorithm                                                                                                | Prepared XAIP_OK with other canonicalization algorithm.     |              |

| 8. | Verify the prepared XAIP_OK from step 7 together<br>with evidence record from step 4 by using either<br>"verify" function of TR-S.4 or "validatePO" of TR<br>S.512. | A negative result will be returned.                                      |  |
|----|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|--|
| 9. | Conditional:<br>test steps<br>If<br>LXAIP<br>is<br>implemented,<br>the<br>from No. 1 to No. 5 are to be repeated for LXAIP.                                         | See expected results of the test cases from No. 1 to No. 5 for<br>LXAIP. |  |

| Verdict of M.3-11 |
|-------------------|
|                   |
|                   |

### 4.4.10 M.3-12 – Hashing of relevant parts is performed with suitable algorithms

<span id="page-161-0"></span>

| Identifier          | M.3-12                                                                                                                                                                                                                        |  |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|
| Requirement         | MD:A5.1-6                                                                                                                                                                                                                     |  |  |
|                     | MD:A6.1-8                                                                                                                                                                                                                     |  |  |
|                     | MD:A7.4-14                                                                                                                                                                                                                    |  |  |
|                     | M3:A4.4-1, M3:A4.4-2                                                                                                                                                                                                          |  |  |
| Test Purpose        | The test shall<br>verify that the calculation of the hash value for the relevant parts of the Archival Information Package is based on algorithms and parameters<br>which are capable to protect the security for long-terms. |  |  |
| Configuration       | Config_Common                                                                                                                                                                                                                 |  |  |
| Pre-test conditions | •<br>User manual is present<br>•<br>Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT], is present and published.                                                        |  |  |

| Step | Test sequence of M.3-12                                                                                                                                                                                                                                                                                                                                                  | Expected Results                                                                                                                                                                                                                                                         | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual and the Preservation Evidence<br>Policy (PEP), whether the calculation of<br>the hash<br>value, done by the Cryptographic Module in order of<br>the ArchiSafe-module or ArchiSig-Module, is done on<br>the basis of suitable algorithms and parameters as<br>recommended by [eIDAS-VO]<br>and [ETSI TS 119 312]<br>and [SOG-IS] and [TR-ESOR-ERS]. | The calculatation of the hash value is done on the basis of at<br>least one of the recommended algorithms and parameters<br>according to [eIDAS-VO]<br>and [ETSI TS 119 312] and [SOG-IS],<br>which can be configured in the ArchiSig-Module or<br>Cryptographic Module. |              |
| 2.   | Check whether in the Evidence Record of M.3-06, No.<br>7 whether the calculation of the hash value, done by<br>the Cryptographic Module in order of the ArchiSig<br>Module, is done on the basis of suitable algorithms<br>and parameters as recommended by [eIDAS-VO]<br>and<br>[ETSI TS 119 312] and [SOG-IS].                                                         | The calculatation of the hash value is done on the basis of at<br>least one of the recommended algorithms and parameters<br>according to [eIDAS-VO]<br>and [ETSI TS 119 312] and [SOG-IS],<br>which can be configured in the ArchiSig-Module or<br>Cryptographic Module. |              |

#### Verdict of M.3-12

### <span id="page-163-1"></span>4.4.11 M.3-13 – ArchiSig-Module supports Timestamp Renewal and Hash-Tree Renewal[44](#page-163-1)

| Identifier          | M.3-13                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|
| Requirement         | MD:A5.1-6, MD:A5.1-7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |  |
|                     | MD:A6.1-8, MD:A6.1-9                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |  |
|                     | MD:A7.4-12, MD:A8.2-6, MD:A8.2-7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |  |
|                     | OVR-6.5-08                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |  |  |
|                     | OVR-7<br>.14-01,<br>OVR-7.14-02,<br>OVR-7.14-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |  |  |
|                     | OVR-7.15-01,<br>OVR-7.15-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |  |  |
|                     | OVR-9.2-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |  |  |
| Test Purpose        | verify that pursuant to § 15 of the "Vertrauensdienstegesetz"the signed data can be re-signed and re-hashed by augmenting the<br>The test shall<br>preservation evidence in order to "achieve the corresponding preservation goal" (OVR-7.15-01, OVR-7.15-03).                                                                                                                                                                                                                                                                                                                                                                                        |  |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |  |
| Pre-test conditions | •<br>Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT], is present and published.<br>•<br>Preservation Profile is present and published.<br>•<br>Test user has administrative rights on the system.<br>•<br>There are XAIPs or LXAIPs or BINs, restricted<br>to the<br>described in clause<br>2, Notice 4,<br>which were successfully stored in<br>formats<br>preservation<br>object<br>the ECM-/Long-Term Storage and their AOID's were given back by the Response –Messages and therefore are now known in this test case.<br>•<br>If<br>required, perform identification and authentication. |  |  |
|                     | Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>•<br>The BSI-ERVerify-Tool is accessible and the tester has access rights to it.                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |  |
|                     | •<br>Conditional: The TR-ESOR-Product supports an automated monitoring of the strength of the used cryptographic algorithms on base of the ETSI<br>Algo Catalogue ETSI TS 119 312.                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |  |

<span id="page-163-0"></span> <sup>44</sup> Extended requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

| Step | Test sequence of M.3-13                                                                                                                                                                                                                                | Expected Results                                                                                                                                                                 | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Use either interface function "ArchiveEvidence"<br>or "RetrievePO"<br>with SubjectOfRetrieval<br>"Evidence" " with the known AOID pursuant to<br>TR-S.4 or TR-S.512.<br>If required, perform identification and authentication.                        | The call of the function with the AOID as parameter is possible.<br>Appropriate Evidence Record will be received.                                                                |              |
| 2.   | Change and publish the Preservation Evidence Policy<br>(PEP) of the TR-ESOR-Product Manufacturer<br>concerning the signature algorithm and start<br>the re<br>sign (Timestamp Renewal) process based on interfaces<br>provided by the ArchiSig-Module. | The initiation of the re-sign process is possible. No error is<br>indicated.                                                                                                     |              |
| 3.   | Check log for information about the re-sign process.                                                                                                                                                                                                   | No error messages or error codes<br>for the re-signing are in the<br>log.                                                                                                        |              |
| 4.   | Use either interface function "ArchiveEvidence"<br>or "RetrievePO"<br>with SubjectOfRetrieval<br>"Evidence" " with the AOID pursuant to TR-S.4 or<br>TR-S.512.                                                                                         | Appropriate Evidence Record will be received.                                                                                                                                    |              |
| 5.   | Compare the new Evidence Record with the old<br>Evidence Record of the XAIPs or BINs from step 1.                                                                                                                                                      | The new and the old Evidence Records are not equal. The new<br>Evidence Record base on the new digital signature algorithms<br>pursuant to the new Preservation Evidence Policy. |              |
| 6.   | Change old hash-algorithm against new one.                                                                                                                                                                                                             | The change of Hash-Algorithm is possible.                                                                                                                                        |              |
| 7.   | Change and publish the Preservation Evidence Policy<br>(PEP) of the TR-ESOR-Product Manufacturer,<br>concerning the hash algorithm and initiate<br>re-hash<br>(Hash-tree Renewal) process.                                                             | The initiation of the re-hash process is possible.                                                                                                                               |              |

| Step | Test sequence of M.3-13                                                                                                                                                                                                                                                                                             | Expected Results                                                                                                                                                                                                              | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 8.   | Check log for information about the re-hash process.                                                                                                                                                                                                                                                                | No error messages or error codes for the re-hashing are in the<br>log.                                                                                                                                                        |              |
| 9.   | Start<br>the re-sign (Timestamp Renewal) process based<br>on interfaces provided by the ArchiSig-Module.                                                                                                                                                                                                            | The initiation of the re-sign process is possible. No error is<br>indicated.                                                                                                                                                  |              |
| 10.  | Check log for information about the re-sign process.                                                                                                                                                                                                                                                                | No error messages or error codes<br>for the re-signing are in the<br>log.                                                                                                                                                     |              |
| 11.  | Use either interface function "ArchiveEvidence"<br>or "RetrievePO"<br>with SubjectOfRetrieval<br>"Evidence" " with the AOID<br>from step 1<br>pursuant<br>to TR-S.4 or TR-S.512.                                                                                                                                    | Appropriate Evidence Record will be received.                                                                                                                                                                                 |              |
| 12.  | Compare the new Evidence Record with the old<br>Evidence Records of the XAIP or BIN from step 1 and<br>step 4 and check whether there is a new Preservation<br>Evidence Policy (PEP).                                                                                                                               | The old Evidence Records from step 1, 4 and the new one from<br>step 12 are not equal. The new<br>Evidence Records base on the<br>new hash and digital signature algorithms on base of a new<br>Preservation Evidence Policy. |              |
| 13.  | Conditional, "tr:IncludeERS" in case of TR-S.4 or<br>"POwithEmbeddedEvidence" in case of TR-S.512 is<br>supported: Use either interface function<br>"ArchiveRetrieval" or "RetrievePO" with<br>SubjectOfRetrieval<br>"POwithEmbeddedEvidence"<br>with the AOID from<br>step 1 pursuant to eitherTR-S.4 or TR-S.512. | The XAIP with embedded EvidenceRecord from step 11 is<br>retrieved from the storage.                                                                                                                                          |              |
| 14.  | Check the credential section of the XAIP.                                                                                                                                                                                                                                                                           | The new Evidence Record from step 12 is embedded in the<br>credentialsSection-Element of given XAIP.<br>The old Evidence Records from step 1, 4 and the embedded new<br>one are not equal.                                    |              |

| Step | Test sequence of M.3-13                                                                                                                                                                                                                                                                                                         | Expected Results                                                                                                                                                                       | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 15.  | Conditional<br>(on-site): Check whether there exist an<br>automatic monitoring of the strength of every<br>cryptographic algorithm,<br>that is used in connection<br>with the actual Preservation Evidence Policy (PEP),<br>referenced by one of the actual profiles on base of an<br>ETSI Algorithm Catalogue ETSI TS 119 322. | On-Site: The automatic monitoring is activated and the<br>produced monitoring protocol shows whether the strength of<br>every cryptographic algorithm used is no longer<br>sufficient. |              |
| 16.  | Check the new Evidence Record of test step 4 with the<br>BSI-ERVerify-Tool.                                                                                                                                                                                                                                                     | The verification report, returned from the BSI-ERVerify-Tool,<br>shows no errors.                                                                                                      |              |
| 17.  | Check the new Evidence Record of test step 11 with<br>the BSI-ERVerify-Tool.                                                                                                                                                                                                                                                    | The verification report, returned from the BSI-ERVerify-Tool,<br>shows no errors.                                                                                                      |              |

#### Verdict of M.3-13

### <span id="page-167-1"></span>4.4.12 M.3-14 – Timestamp Renewal[45](#page-167-1)

| Identifier          | M.3-14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |  |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A6.1-8, MD:A7.4-12, MD:A8.2-6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |  |
|                     | M3:A4.7-1, M3:A4.7-3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
|                     | OVR-6.5-07                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
|                     | OVR-7.14-02,<br>OVR-7.15-01,<br>OVR-7.15-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
| Test Purpose        | The test shall<br>verify that when the function for renewal of the Archive Timestamp is requested, the latest Archive Timestamp will be renewed according to<br>a<br>new version of the Preservation Evidence Policy.                                                                                                                                                                                                                                                                                                                                                        |  |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  |
| Pre-test conditions | •<br>User manual is present.<br>•<br>The Preservation Profile is present and published.<br>•<br>The Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT], is present and published.<br>•<br>User has administrator rights on the system.<br>•<br>If required, perform identification and authentication.<br>•<br>There are already archived Archival Information Packages without Archive Timestamp<br>in the ECM-/Long-Term Storage.<br>•<br>The BSI-ERVerify-Tool is accessible and the tester has access rights to it. |  |

<span id="page-167-0"></span> <sup>45</sup> Extended requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

| Step | Test sequence of M.3-14                                                                                   | Expected Results                                                                                                                                                                                                        | Observations |
|------|-----------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Use the function for renewal of the Archive<br>Timestamp.                                                 | The renewal of the latest Archive Timestamps is done.                                                                                                                                                                   |              |
| 2.   | Request the ERs for the archive object archived or<br>updated at the very last.                           | The ERs shall<br>contain the hash value of the archive object<br>and an initial Archive Timestamp. The latest electronic<br>time-stamp should<br>show the time of calling the function in<br>step 1 or an earlier time. |              |
| 3.   | Check the new Evidence Record of test step 2 with the<br>BSI-ERVerify-Tool.                               | The verification report, returned from the BSI-ERVerify<br>Tool, shows no errors.<br>Therefore, the solution for re-signing is compatible with the<br>"Evidence Record Syntax" according to [RFC4998].                  |              |
| 4.   | Check, if the User manual and Preservation Profile<br>reference a new Preservation Evidence Policy (PEP). | There is a new published Preservation Evidence Policy,<br>documented in user manual of TOT (TR-ESOR-Product)<br>and referenced by the Preservation Profile.                                                             |              |
| 5.   | Disconnect the Crypto-Module from the ArchiSig<br>Module and perform this test case again.                | The calculation of the initial Archive Timestamp (the hash<br>value) is not possible because ArchiSig itself does not have<br>this functionality.                                                                       |              |

| Verdict of M.3-14 |  |
|-------------------|--|
|                   |  |
|                   |  |

### <span id="page-169-1"></span>4.4.13 M.3-15 – ArchiSig-Module shall validate requested electronic time-stamps using the Crypto-Module[46](#page-169-1)

| Identifier          | M.3-15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |  |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A5.1-26, MD:A7.4-14, M3:A4.5-3, M3:A4.7-5, M3:A4.8-2, M3:A4.8-5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
|                     | OVR-9.3-01,<br>OVR-9.3-02,<br>OVR-9.3-03,<br>OVR-9.3-04,<br>OVR-7.5-03,<br>OVR-7.15-03                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |  |
| Test Purpose        | The ArchiSig-Module shall<br>in case of generating new electronic time-stamps<br>ensure that the electronic time-stamp contains all information required for<br>validation of the electronic time-stamp, including the advanced digital signatures contained therein.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  |
|                     | In case of renewal of the hash trees the electronic time-stamp shall<br>contain all information required for validation of the electronic time-stamp, including<br>the advanced digital signatures contained therein.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  |
|                     | The concluding Archive Timestamp of the hash trees to be renewed will be re-verified for integrity and authenticity before these Archive Timestamps are<br>transferred into a new hash tree or included there. To do so, the digital signature of this Archive Timestamp and the associated certificate chain will be re<br>verified with the help of the functions of the TR-ESOR-M.2 Cryptographic-Module. An inclusion of this Archive Timestamp in the new hash tree only takes<br>place if this validation has had a positive result.                                                                                                                                                                                                                           |  |
|                     | If this validation has had a positive result, the renewed Archive Timestamp gives proof of existence of the digital signature of the previous Archive<br>Timestamp and of the validation data needed to validate the digital signature.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| Pre-test conditions | •<br>ECM-/Long-Term Storage contains already some objects and AOIDs are known.<br>•<br>The Preservation Profile is present and published.<br>•<br>The Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT], is present and published.<br>•<br>Tester emulate a TR-ESOR M.2 Cryptographic-Module.<br>•<br>Test case M.3-16 was performed successfully.<br>•<br>Some archive objects are already archived.<br>•<br>The Signature and Time-Stamp Validation Policy is present and published.<br>•<br>The Cryptographic-Module has a connection to a Trust Service Providers, in order to request the validation of certificates.<br>•<br>The BSI-ERVerify-Tool is accessible and the tester has access rights to it. |  |

<span id="page-169-0"></span>46 Extended requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

| Step | Test sequence of M.3-15                                                                                                                                            | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Ensure that ArchiSig creates a new Archive<br>Timestamp (e.g. by using a Crypto-Module).                                                                           | ATS is generated.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |              |
| 2.   | Request an Evidence Records for one known AOID.                                                                                                                    | Requesting of an Evidence Record was performed successfully.                                                                                                                                                                                                                                                                                                                                                                                                                                                 |              |
| 3.   | Check the Evidence Record for information about<br>time-stamps and validations (including OCSP<br>Responses, CRL-Reports) of digital signatures of time<br>stamps. | The information about the time-stamps, its digital signatures<br>and the validation information of the digital signatures are<br>present (including OCSP Responses with reason code, CRL<br>Reports) and show all information required for validation of the<br>time-stamp up to a trustworthy root certificate or trust anchor<br>according to the preservation evidence policy (PEP) derived<br>from [TR-ESOR-PEPT]<br>of the TR-ESOR-Product Manufacturer<br>or respectively of the preservation service. |              |
| 4.   | Start the Hash-tree Renewal process.                                                                                                                               | The<br>Hash-tree Renewal process was started successfully.                                                                                                                                                                                                                                                                                                                                                                                                                                                   |              |
| 5.   | Observe the requests of the ArchiSig-Module to the<br>Cryptographic-Module.                                                                                        | ArchiSig will request validation of the very last Archive<br>Timestamp with its digital signature.                                                                                                                                                                                                                                                                                                                                                                                                           |              |
| 6.   | Emulation: the Cryptographic-Module send negative<br>response.                                                                                                     | Sending of negative response was performed successfully.                                                                                                                                                                                                                                                                                                                                                                                                                                                     |              |
| 7.   | Check the log files of the ArchiSig-Module or observe<br>otherwise the reaction of ArchiSig.                                                                       | ArchiSig should<br>at least mention the failed validation of the<br>qualified time-stamp. The ArchiSig-Module shall<br>stop the hash<br>tree renewal and log an exception.                                                                                                                                                                                                                                                                                                                                   |              |
| 8.   | Request an Evidence Record for one known AOID.                                                                                                                     | Requesting of an Evidence Record was performed successfully.                                                                                                                                                                                                                                                                                                                                                                                                                                                 |              |

<span id="page-171-1"></span><span id="page-171-0"></span>

| Step | Test sequence of M.3-15                                                                                                                                                                                                                                | Expected Results                                                                                                                                                                                                                | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 9.   | Check the Evidence Records by the BSI test tool BSI<br>"ERVerifyTool"47 for information about the Archive<br>Timestamp and digital signature validation (OCSP<br>Responses, CRL-Reports).                                                              | The check of the tool shows that the ERs resp. the Archive<br>Timestamp Chain is not integer.                                                                                                                                   |              |
| 10.  | Start the Hash-tree Renewal process manually or wait<br>the preconfigured period of time till automatic<br>renewal process.                                                                                                                            | The Hash-tree Renewal process was started successfully.                                                                                                                                                                         |              |
| 11.  | Observe the requests of the ArchiSig-Module to the<br>Cryptographic-Module.                                                                                                                                                                            | ArchiSig will request validation of the very last Archive<br>Timestamp with its digital signature.                                                                                                                              |              |
| 12.  | Emulation: the Cryptographic-Module sends positive<br>response.                                                                                                                                                                                        | Sending of positive response was performed successfully.                                                                                                                                                                        |              |
| 13.  | Check the log files of the ArchiSig-Module or observe<br>otherwise the reaction of ArchiSig.                                                                                                                                                           | ArchiSig should<br>continue and finish the Hash-tree Renewal.                                                                                                                                                                   |              |
| 14.  | Request an Evidence Record for one known AOID.                                                                                                                                                                                                         | Requesting of an Evidence Record was performed successfully.                                                                                                                                                                    |              |
| 15.  | Check the Evidence Records by the BSI test tool<br>"ERVerify"47 for information about the Archive<br>Timestamp and the digital signature validation of<br>steps 11./12./13. (OCSP Responses, CRL-Reports)                                              | The check of the tool47 shows that the ERs resp. the Archive<br>Timestamp chain for the steps 11./12/13. is integer and for the<br>steps 5./6./7. is not integer.                                                               |              |
| 16.  | Check that the new Archive Timestamp of the<br>Evidence Records also covers the proof of existence of<br>the previous Archive Timestamps and of the<br>validation data needed to validate the digital signature<br>of the previous Archive Timestamps. | The ERs should<br>contain the new Archive Timestamp as a proof<br>of existence of the previous Archive Timestamps and of the<br>validation data needed to validate the digital signature of the<br>previous Archive Timestamps. |              |

 47 The only appropriate Evidence Record test tool is the ERVerifyTool from the Federal Office of Information Security see: https://github.com/de-bund-bsi-tresor/ERVerifyTool.

| Step | Test sequence of M.3-15                                                           | Expected Results                                                                                                                                                                                       | Observations |
|------|-----------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 17.  | Check the new Evidence Record of test step 2 and 8<br>with the BSI-ERVerify-Tool. | The verification report, returned from the BSI-ERVerify-Tool,<br>shows no errors.<br>Therefore, the solution for re-signing is compatible with the<br>"Evidence Record Syntax" according to [RFC4998]. |              |

| Verdict of M.3-15 |
|-------------------|
|                   |
|                   |

### 4.4.14 M.3-16 – Time-Stamps shall be verified prior to renewal

<span id="page-172-0"></span>

| Identifier          | M.3-16                                                                                                                                                                                                                                                                                                          |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | M3:A4.7-2                                                                                                                                                                                                                                                                                                       |
|                     | M3:A4.7-3                                                                                                                                                                                                                                                                                                       |
| Test Purpose        | Check, whether a complete Archive Timestamp Renewal verifies the integrity and authenticity of the Archive Timestamps to be renewed and whether the<br>hash values of these Archive Timestamps are included in the new Archive Timestamp.                                                                       |
|                     | Check, whether a renewed Archive Timestamp gives proof of existence of the digital signature of the previous Archive Timestamp and of the validation data<br>needed to validate the digital signature.                                                                                                          |
|                     | Check, whether an Archive Timestamp to be renewed gives proof of existence of the digital signature of the previous Archive Timestamp and of the<br>validation data needed to validate the digital signature of the Archive Timestamp to be renewed                                                             |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                   |
| Pre-test conditions | •<br>Submit several archive objects to the storage and configure the automatic Archive Timestamping in such a way, that several Archive Timestamps<br>will be generated in parallel and they are not "covered" by a superior Archive Timestamp.<br>•<br>If required, perform identification and authentication. |

<span id="page-173-0"></span>

| Identifier | M.3-16                                                                                                                                                                     |  |
|------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|            | •<br>The Time-stamp Validation Policy48 is present and published in the PEP of the TR-ESOR-Product Manufacturer (TR-ESOR-Product PEP), based on<br>the BSI-[TR-ESOR-PEPT]. |  |
|            | •<br>The BSI-ERVerify-Tool is accessible and the tester has access rights to it.                                                                                           |  |

| Step | Test sequence of M.3-16                                                                                                                                                     | Expected Results                                                                                                                | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Request the ERs of these archive objects which are<br>covered by<br>the mentioned parallel Archive<br>Timestamps.                                                           | The hash value of each of the parallel Archive Timestamps is<br>documented in one ERS.                                          |              |
| 2.   | Start the complete Archive Timestamp Renewal<br>process.                                                                                                                    | The complete Archive Timestamp Renewal process was started<br>successfully.                                                     |              |
| 3.   | Observe the requests of the ArchiSig-Module to the<br>Cryptographic-Module.                                                                                                 | ArchiSig will request validation of the very last Archive<br>Timestamp signature.                                               |              |
| 4.   | Emulation: the Cryptographic-Module sends a<br>negative response.                                                                                                           | Sending of negative response was performed successfully.                                                                        |              |
| 5.   | Check the log files of the ArchiSig-Module or observe<br>otherwise the reaction of ArchiSig.                                                                                | ArchiSig shall mention the failed validation of the qualified<br>time-stamp and stop the complete Archive Timestamp<br>Renewal. |              |
| 6.   | Request an Evidence Records for one known AOID.                                                                                                                             | Requesting of an Evidence Records was performed successfully.                                                                   |              |
| 7.   | Check the Evidence Records (ERs) for information<br>about the Archive Timestamp and its digital signature<br>validation of steps 3./4./5. (OCSP Responses, CRL<br>Reports). | The ERs should<br>contain no new Archive Timestamp.                                                                             |              |

<sup>48</sup> See http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-timestamp

| Step | Test sequence of M.3-16                                                                                                                                                                                                                                | Expected Results                                                                                                                                                                                                                | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 8.   | Start the connection to the true Cryptographic<br>Module again and start the complete Archive<br>Timestamp Renewal process.                                                                                                                            | The complete Archive Timestamp Renewal process was started<br>successfully.                                                                                                                                                     |              |
| 9.   | Observe the requests of the ArchiSig-Module to the<br>Cryptographic-Module.                                                                                                                                                                            | ArchiSig will request validation of the very last Archive<br>Timestamp with its digital signature.                                                                                                                              |              |
| 10.  | Emulation: The Cryptographic-Module sends a<br>positive response.                                                                                                                                                                                      | Sending of positive response was performed successfully.                                                                                                                                                                        |              |
| 11.  | Check the log files of the ArchiSig-Module or observe<br>otherwise the reaction of ArchiSig.                                                                                                                                                           | ArchiSig should<br>continue and finish the complete Archive<br>Timestamp Renewal.                                                                                                                                               |              |
| 12.  | Request an Evidence Records<br>for one known AOID                                                                                                                                                                                                      | Requesting of an Evidence Records was performed successfully.                                                                                                                                                                   |              |
| 13.  | Check the Evidence Records for information about<br>the Archive Timestamp and check its digital signature<br>concerning the check of steps 9./10./11. (OCSP<br>Responses, CRL-Reports) and the hash algorithm used<br>for this time-stamp.             | The ERs should<br>contain the new Archive Timestamp. All the<br>hash values of the parallel Archive Timestamps are covered by<br>the new Archive Timestamp.                                                                     |              |
| 14.  | Check that the new Archive Timestamp of the<br>Evidence Records also covers the proof of existence of<br>the previous Archive Timestamps and of the<br>validation data needed to validate the digital<br>signature in the previous Archive Timestamps. | The ERs should<br>contain the new Archive Timestamp as a proof<br>of existence of the previous Archive Timestamps and of the<br>validation data needed to validate the digital signature in the<br>previous Archive Timestamps. |              |
| 15.  | Check the new Evidence Record of test step 12 with<br>the BSI-ERVerify-Tool.                                                                                                                                                                           | The verification report, returned from the BSI-ERVerify-Tool,<br>shows no errors.                                                                                                                                               |              |

#### Verdict of M.3-16

### 4.4.15 M.3-17 – Timestamp Renewal can only be requested by authorised users through administrative interfaces

<span id="page-175-0"></span>

| Identifier          | M.3-17                                                                                                                                                                                                                        |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | M3:A4.7-6                                                                                                                                                                                                                     |
|                     | M3:A4.8-6                                                                                                                                                                                                                     |
|                     | PRP-8.1-03                                                                                                                                                                                                                    |
| Test Purpose        | The test shall<br>verify that the function "Renewal of Archive Timestamp" can –<br>beside the automated function –<br>only be requested manually by authorised<br>users through administrative interfaces and will be logged. |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                 |
| Pre-test conditions | •<br>If required, perform identification and authentication.                                                                                                                                                                  |

| Step | Test sequence of M.3-17                                                                                                 | Expected Results                                                                                                                                | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check whether there is a function "Renewal of<br>Archive Timestamp" for manual start of the renewal<br>process at all.  | There may<br>be a function or not.<br>If not, the remaining test steps do not need to be performed,<br>and the test is considered to be passed. |              |
| 2.   | Use the function "Renewal of Archive Timestamp"<br>with an user who has administrator rights on the<br>system.          | A positive feedback will be received; no error message or error<br>code.                                                                        |              |
| 3.   | Check the log files of the ArchiSig-Module, if there is<br>information about the renewal of Archive<br>Timestamps.      | There is information about the renewal of Archive Timestamps.                                                                                   |              |
| 4.   | Use the function "Renewal of Archive Timestamp"<br>with a user who has no administrator rights on the<br>system.        | A call of the function is not possible and a clear and<br>understandable error message or error code will be received.                          |              |
| 5.   | Check the log files of the ArchiSig-Module, if there is<br>information about the try of renewing Archive<br>Timestamps. | There is no information that the function was performed<br>successfully, but there shall<br>be information about the failed<br>request.         |              |

### 4.4.16 M.3-18 – Hash-tree Renewal can only be requested through administrative interface

<span id="page-177-0"></span>

| Identifier          | M.3-18                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |  |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M3:A4.8-6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |  |
|                     | OVR-6.5-07                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |  |
| Test Purpose        | The test shall<br>check whether the function "Renewal of Hash Tree" calculates new hash values on the basis of configured hash algorithm for all archival<br>information packages stored in the ECM-/Long-Term Storage that have been registered by the TR-ESOR-Middleware as well as the Archive Timestamp<br>Sequences<br>stored in the data storage of the ArchiSig-Module.                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |
| Pre-test conditions | •<br>Test user has administrative rights on the system.<br>•<br>There are XAIPs / BINs, restricted<br>to the preservation object formats<br>described in clause<br>2, Notice 4, registered by the TR-ESOR-Middleware,<br>stored<br>in ECM-/Long-Term Storage.<br>•<br>There are XAIPs / BINs restricted<br>to the preservation object formats<br>described in clause 2, Notice 4, stored in ECM-/Long-Term Storage, which are<br>not registered by the TR-ESOR-Middleware.<br>•<br>If required, perform identification and authentication.<br>•<br>XAIP means XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>BIN<br>•<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured<br>shall be restricted<br>to the preservation object formats<br>described in clause<br>2, Notice 4 |  |

| Step | Test sequence M.3-18                                                                                                                                   | Expected Results                                                                                                                                                                                                            | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Change the hash algorithm configuration of the<br>Crypto-Module so that another algorithm will be used<br>since now.                                   | Configuration is possible (even if the complete Crypto-Module<br>must be replaced for that purpose).                                                                                                                        |              |
| 2.   | Configure the storage in such a way that the access to<br>objects can be traced (e.g. activate detailed logging).                                      | Tracing of every object access is<br>activated.                                                                                                                                                                             |              |
| 3.   | Use the function "Renewal of Archive Timestamp"<br>(with an administrative user).                                                                      | A positive feedback will be received; no error message or error<br>code.                                                                                                                                                    |              |
| 4.   | Check the ECM<br>-/Long-Term Storage, whether objects,<br>which are<br>not registered by the TR-ESOR<br>Middleware, can be accessed by the middleware. | The middleware should<br>not have accessed these objects.                                                                                                                                                                   |              |
| 5.   | Check the ECM<br>-/Long-Term Storage, if XAIPs / BINs,<br>which are<br>registered by the TR-ESOR-Middleware, get<br>a new hash value.                  | The middleware should<br>have accessed these objects.                                                                                                                                                                       |              |
| 6.   | Request the ERs for all these objects.                                                                                                                 | It can be demonstrated that every XAIP / BIN got a new hash<br>value with the new configured algorithm and that the "old"<br>Archive Timestamp Sequences are also covered by the Hash<br>tree Renewal (see M.3 sec. 2.4.4). |              |
| 7.   | Conditional:<br>test steps from<br>If<br>is<br>implemented,<br>LXAIP<br>No. 1 to No. 6 are to be repeated for LXAIP.                                   | See expected results of the test cases from No. 1 to No. 6 for<br>LXAIP.                                                                                                                                                    |              |
| 8.   | Conditional:<br>test steps<br>If<br>ASiC-AIP<br>is<br>implemented,<br>from No. 1 to No. 6 are to be repeated for ASiC-AIP.                             | See expected results of the test cases from No. 1 to No. 6 for<br>ASiC-AIP.                                                                                                                                                 |              |

#### Verdict of M.3-18

### 4.4.17 M.3-19 – Authenticity and integrity of ArchiSig-Module needs to be guaranteed

| Identifier          | M.3-19                                                                                                        |
|---------------------|---------------------------------------------------------------------------------------------------------------|
| Requirement         | M3:A5.1-3                                                                                                     |
|                     | OVR-9.3-02                                                                                                    |
| Test Purpose        | Check whether the authenticity and integrity of the installed ArchiSig-Module is guaranteed during operation. |
| Configuration       | CONFIG_Common                                                                                                 |
| Pre-test conditions | •<br>User manual is present.                                                                                  |
|                     | •<br>Development and design documents are present.                                                            |

<span id="page-179-0"></span>

| Step | Test sequence M.3-19                                                                                                                                     | Expected Results                                                                                             | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual whether there are statements<br>how to ensure the authenticity and integrity of the<br>installed ArchiSig-Module during operation. | The guidance contains such<br>statements and the statements are<br>clear and intelligible.                   |              |
| 2.   | Check whether the ArchiSig-Module is a signed<br>software module.                                                                                        | The ArchiSig-Module is signed or otherwise integrity-proteced<br>(e.g. hardware sealed).                     |              |
| 3.   | Check the user manual whether the ArchiSig-Module<br>includes a function to verify its own integrity as self<br>defence against manipulation.            | The ArchiSig-Module includes a function to verify its own<br>integrity as self-defence against manipulation. |              |

#### Verdict of M.3-19

#### 4.4.18 M.3-20 – ArchiSig-Module should be able to maintain parallel hash-trees

#### Pre-supposition:

An ArchiSig-Module, which manages parallel hash-trees.

<span id="page-180-0"></span>

| Identifier          | M.3-20                                                                                                           |
|---------------------|------------------------------------------------------------------------------------------------------------------|
| Requirement         | M3:A5.2-2                                                                                                        |
|                     | M3:A4.8-7                                                                                                        |
|                     |                                                                                                                  |
| Test Purpose        | Check whether the ArchiSig-Module returns several reduced Evidence Records when parallel hash-trees are managed. |
| Configuration       | CONFIG_Common                                                                                                    |
| Pre-test conditions | •<br>Configure ArchiSig in such a way that at least two parallel hash-trees are managed.                         |
|                     | •<br>Archive (submit) several archive objects to build up the trees.                                             |
|                     | •<br>Ensure that at least one initial Archive Timestamp is created to build up the trees.                        |
|                     | •<br>The test dispenses if the pre-supposition is not valid.                                                     |

| Step | Test sequence M.3-20                                                                              | Expected Results                                                                                      | Observations |
|------|---------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Request the ERs of archive objects submitted to the<br>archive.                                   | The ERs for these archive objects can be retrieved.                                                   |              |
| 2.   | Check the ERs whether there are reduced Evidence<br>Records for every managed hash-tree included. | For every managed hash-tree a separate Evidence Record proofs<br>the integrity of the archive object. |              |

| Verdict of M.3-20 |  |  |
|-------------------|--|--|
|                   |  |  |
|                   |  |  |

### 4.4.19 M.3-22 – Deletion of an archive object shall not impair the conclusiveness of others

<span id="page-181-0"></span>

| Identifier          | M.3-22                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A5.1-32                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  |
| Test Purpose        | The test shall<br>verify that the conclusiveness of the remaining documents in the ECM storage is not affected by the deletion of individual XAIPs or BINs.                                                                                                                                                                                                                                                                                                                                                                                               |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  |
| Pre-test conditions | •<br>Tester has read/write permissions on the middleware.<br>•<br>If required, perform identification and authentication.<br>•<br>XAIP means XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>BIN<br>•<br>shall be restricted<br>to the preservation object formats<br>described in clause<br>2, Notice 4. |  |

| Step | Test sequence M.3-22                                                                                                                                                                         | Expected Results                                                                                     | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Store an XAIP_OK_SIG or BIN<br>using either the<br>interface function "ArchiveSubmission" or<br>"PreservePO" pursuant to TR-S.4 or TR-S.512.                                                 | The call of the function with this XAIP / BIN as a parameter is<br>possible.                         |              |
| 2.   | Observe the output<br>"ArchiveSubmissionResponse" or<br>"PreservePOResponse".                                                                                                                | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned.      |              |
| 3.   | Store another XAIP_OK_SIG<br>or BIN<br>using either<br>the interface function "ArchiveSubmission" or<br>"PreservePO" pursuant to TR-S.4 or TR-S.512.                                         | The call of the function with this XAIP / BIN as a parameter is<br>possible.                         |              |
| 4.   | Observe the output of<br>"ArchiveSubmissionResponse" or<br>"PreservePOresponse".                                                                                                             | A positive feedback is received. No error message or error code<br>occurs. Another AOID is assigned. |              |
| 5.   | Perform either the interface function<br>"ArchiveEvidence" or "RetrievePO"<br>with<br>SubjectOfRetrieval "Evidence" " with the<br>AOID received in step 2 pursuant to TR-S.4 or TR<br>S.512. | The function call is possible.                                                                       |              |
| 6.   | Observe the output of the interface function<br>"ArchiveEvidenceResponse" or<br>"RetrievePOResponse".                                                                                        | An Evidence Record for the XAIP / BIN that has been stored in<br>step 1 is received.                 |              |
| 7.   | Perform either the interface function<br>"ArchiveEvidence" or "RetrievePO"<br>with<br>SubjectOfRetrieval "Evidence" " with the<br>AOID received in step 4 pursuant to TR-S.4 or TR<br>S.512. | The function call is possible.                                                                       |              |

| Step | Test sequence M.3-22                                                                                                                                                                         | Expected Results                                                                                                                                                           | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 8.   | Observe the output of "ArchiveEvidence" or<br>"RetrievePO".                                                                                                                                  | An archive Evidence Record for the XAIP / BIN that has been<br>stored in step 3 is received.                                                                               |              |
| 9.   | Using either the interface function<br>"ArchiveDeletion" or "DeletePO" and the AOID<br>from step 2, delete the XAIP_OK_SIG<br>or BIN<br>pursuant to TR-S.4 or TR-S.512.                      | The call of the function with this AOID as a parameter is<br>possible.                                                                                                     |              |
| 10.  | Observe the output of<br>"ArchiveDeletionResponse" or<br>"DeletePOResponse".                                                                                                                 | A positive feedback is received. No error message or error code<br>occurs. The XAIP / BIN is deleted.                                                                      |              |
| 11.  | Perform either the interface function<br>"ArchiveEvidence" or "RetrievePO"<br>with<br>SubjectOfRetrieval "Evidence" " with the<br>AOID received in step 4 pursuant to TR-S.4 or TR<br>S.512. | The function call is possible.                                                                                                                                             |              |
| 12.  | Observe the output of the interface function<br>"ArchiveEvidence" or "RetrievePO" pursuant<br>to TR-S.4 or TR-S.512.                                                                         | An Evidence Record for the XAIP / BIN that has been stored in<br>step 3 is received.                                                                                       |              |
| 13.  | Compare the two Evidence Records of the XAIP / BIN<br>that was stored in step 3.                                                                                                             | The Evidence Records are equal. It may<br>be possible that in the<br>meantime an Timestamp Renewal of a Hash-tree Renewal<br>occurred. This would be reflected in the ERS. |              |
| 14.  | Conditional:<br>test steps from<br>If<br>is<br>implemented,<br>LXAIP<br>No. 1 to No. 13 are to be repeated for LXAIP.                                                                        | See expected results of the test cases from No. 1 to No. 13 for<br>LXAIP.                                                                                                  |              |
| 15.  | Conditional:<br>test steps<br>If<br>implemented,<br>ASiC-AIP<br>is<br>from No. 1 to No. 13 are to be repeated for ASiC-AIP.                                                                  | See expected results of the test cases from No. 1 to No. 13 for<br>ASiC-AIP.                                                                                               |              |

<span id="page-184-1"></span>

| Verdict of M.3-22 |
|-------------------|
|                   |
|                   |

4.4.20 M.3-23 – The Process of requesting Export-Import package(s) and the Production Methods of the Export-Import Packages shall be stated in the User Manual and in the published TR-ESOR-Product Preservation Evidence Policy (PEP) of the TOT, based on the BSI-[TR-ESOR-PEPT], and is allowed for authorized clients or preservation services [49](#page-184-1)

| Identifier          | M.3-23                                                                                                                                                                                                                                                                                                                                                                             |  |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M.3:A2.7-1, M.3:A2.7-2                                                                                                                                                                                                                                                                                                                                                             |  |
|                     | OVR-6.1-07,<br>OVR-6.1-08,<br>OVR-7.16-01,<br>OVR-7.16-03                                                                                                                                                                                                                                                                                                                          |  |
|                     | PRP-8.1-03                                                                                                                                                                                                                                                                                                                                                                         |  |
| Test Purpose        | The test shall<br>verify that the<br>package(s)<br>and the<br>package(s)<br>are allowed for<br>process of<br>requesting<br>export-import<br>production<br>methods<br>of<br>the<br>export-import<br>authorized clients or preservation services only as described in the User Manual and in the PEP of the TR-ESOR-Product Manufacturer, based on the [TR<br>ESOR-PEPT] of the BSI. |  |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                                                                                                                                                                      |  |
| Pre-test conditions | •<br>The User Manual is present of TOT (TR-ESOR-Product),<br>•<br>The PEP of the TR-ESOR-Product Manufacturer (TR-ESOR-Product PEP), based on the BSI-[TR-ESOR-PEPT],<br>is published.<br>•<br>Tester has read/write permissions on the middleware.<br>•<br>If required, perform identification and authentication.                                                                |  |

<span id="page-184-0"></span> <sup>49</sup> New requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

| Step | Test sequence of M.3-23                                                                                                                                                                                                                                                                                                                                                                                                | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual and the TR-ESOR-Product<br>PEP for information about the<br>process of<br>requesting<br>and check whether the PSP<br>package(s)<br>export-import<br>had chosen and described one process out of the<br>alternatives: Alternative 1a) or Alternative 1b) ,<br>described in [TR-ESOR-M.3], clause 2.7. (A2.7-1)                                                                                    | The necessary details of the<br>process of<br>requesting<br>export<br>package(s)<br>stated, as expected.<br>import<br>are                                                                                                                                                                                                                                                                                                                                                                                                                                    |              |
| 2.   | Check the user manual and the TR-ESOR-Product<br>PEP for information about the<br>of<br>production<br>methods<br>and check whether the<br>the<br>package(s)<br>export-import<br>PSP had chosen and described the production<br>method, described in [TR-ESOR-M.3], clause 2.7,<br>(A2.7-2).                                                                                                                            | The necessary details of the<br>production<br>methods<br>of<br>the<br>export<br>stated in the user manual and the<br>package(s)<br>import<br>are<br>published TR-ESOR-Product PEP.                                                                                                                                                                                                                                                                                                                                                                           |              |
| 3.   | Check that the TR-ESOR-Product PEP of the "TR<br>ESOR Product Manufacturer" based on the [TR<br>ESOR-PEPT]<br>of the BSI.                                                                                                                                                                                                                                                                                              | On base of BSI-[TR-ESOR-PEPT], the "TR-ESOR Product<br>Manufacturer" had refined his actual PEP.                                                                                                                                                                                                                                                                                                                                                                                                                                                             |              |
| 4.   | Check and compare<br>on-site<br>-<br>the<br>of requesting export-import<br>installed<br>process<br>package(s)<br>-<br>the<br>of the export<br>installed<br>production<br>methods<br>import package(s) (e.g. file type, data structure,<br>integrity, etc.),-<br>containing the preserved data, the<br>evidences and all information needed to validate the<br>evidences,<br>with the documentation in the user manual. | The result of the comparison is that<br>-<br>the process of requesting export-import package(s)<br>•<br>pursuant to [TR-ESOR-M.3], clause 2.7 (A2.7-1),<br>either Alternative 1a)<br>o<br>or Alternative 1b) and<br>o<br>-<br>the production method for export-import package(s),e.g.<br>•<br>pursuant to [TR-ESOR-M.3], clause 2.7<br>(A2.7-2),<br>•<br>containing the preserved data, the evidences and all<br>information needed to validate the evidences,<br>are implemented and working as documented in the manual<br>and in the TR-ESOR-Product PEP. |              |

| Step | Test sequence of M.3-23                                                                                                                                                                                                                                                                                                                                       | Expected Results                                                                                                                                                                                                                  | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 5.   | Check the user manual whether only the preservation<br>client or another authorized preservation service or<br>authorized natural or legal persons are allowed<br>to<br>request the<br>export-import<br>package(s),<br>containing<br>the<br>preserved<br>data,<br>the<br>evidences<br>and<br>all<br>information<br>needed<br>to validate<br>the<br>evidences. | The necessary details concerning who is allowed to request the<br>export-import packages are<br>stated.                                                                                                                           |              |
| 6.   | Check and verify<br>on-site<br>-<br>that the delivery of the preservation package(s) only<br>takes place in case of a successful authorization of the<br>legal or natural person or preservation client.                                                                                                                                                      | The verification is successful.<br>It is able to show at least one example of an<br>export-import<br>for each Preservation Evidence Policy in connection<br>package<br>with an authorized person and with an unauthorized person. |              |

Verdict of M.3-23

### <span id="page-187-1"></span>4.4.21 M.3-24 – How the Request for an Export-Import Package can be done with standardised formats, shall be stated in the User Manual and in the published TR-ESOR-Product Preservation Evidence Policy (PEP) of the TOT[50](#page-187-1)

<span id="page-187-0"></span>

| Identifier          | M.3-24                                                                                                                                                                            |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M.3:A2.7-1                                                                                                                                                                        |  |
|                     | M.3:A2.7-2                                                                                                                                                                        |  |
|                     | M3:A2.7-3                                                                                                                                                                         |  |
|                     | OVR-6.2-05                                                                                                                                                                        |  |
|                     | OVR-7.16-02                                                                                                                                                                       |  |
| Test Purpose        | The test shall<br>verify that,<br>are described in the User Manual and in the TR-ESOR-Product PEP.<br>how<br>the<br>request for<br>package<br>can be<br>done,<br>an export-import |  |
| Configuration       | CONFIG_Common                                                                                                                                                                     |  |
| Pre-test conditions | •<br>User manual of TOT (TR-ESOR-Product) is present.                                                                                                                             |  |
|                     | •<br>The PEP of the TR-ESOR-Product Manufacturer (TR-ESOR-Product PEP), based on the BSI-[TR-ESOR-PEPT],<br>is published.                                                         |  |

 <sup>50</sup> New requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

| Step | Test sequence of M.3-24                                                                                                                                                                                                                                                                                                                                                                   | Expected Results                                                                                                                                                                                         | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual and the TR-ESOR-Product<br>PEP<br>for information<br>how the request for an export<br>import package can be done.                                                                                                                                                                                                                                                   | The necessary details,<br>how the request for an export-import<br>package can be done, are<br>stated.                                                                                                    |              |
| 2.   | Check the user manual and the TR-ESOR-Product<br>PEP<br>for information concerning a standardised<br>format for the export-import package(s)                                                                                                                                                                                                                                              | The necessary details of a standardised format for the export<br>import package(s) are<br>stated in [TR-ESOR-M.3],<br>clause 2.7 and<br>referenced in the user manual and in the TR-ESOR-Product<br>PEP. |              |
| 3.   | Check on-site that<br>there is at least one example of<br>-the request for an export-import Package and<br>-an export-import package for each Preservation<br>Evidence Policy<br>and verify that :<br>-<br>a standardised format for the request and for the<br>export-import package(s) is implemented as stated in<br>the user manual and in and the TR-ESOR-Product<br>PEP of the TOT. | A<br>standardised format for the request for an export-import<br>package and for<br>the export-import package(s) are implemented<br>as stated in the user manual and in and the TR-ESOR-Product<br>PEP.  |              |

| Verdict of M.3-24 |
|-------------------|
|                   |

### <span id="page-189-1"></span>4.4.22 M.3-25 – The TR-ESOR middleware shall keep records of all released export-import packages and shall allow only authorized clients or preservation services to request export-import packages[51](#page-189-1)

<span id="page-189-0"></span>

| Identifier          | M.3-25                                                                                                                                                                                                                                 |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Requirement         | M1:A4.0-4                                                                                                                                                                                                                              |
|                     | M1:A4.0-5                                                                                                                                                                                                                              |
|                     | M3:A2.7-2                                                                                                                                                                                                                              |
|                     | M3:A2.7-3                                                                                                                                                                                                                              |
|                     | OVR-7<br>.16-01                                                                                                                                                                                                                        |
|                     | OVR-7<br>.16-04                                                                                                                                                                                                                        |
|                     | PRP-8.1-03                                                                                                                                                                                                                             |
| Test Purpose        | The test shall<br>verify that<br>the TR-ESOR middleware shall<br>keep records of all released export-import packages and that only authorized clients or<br>preservation services are allowed to request the export-import package(s). |
| Configuration       | CONFIG_Common                                                                                                                                                                                                                          |
| Pre-test conditions | •<br>User Manual of TOT (TR-ESOR-Product) is present.                                                                                                                                                                                  |
|                     | •<br>Tester has read/write permissions on the middleware.                                                                                                                                                                              |
|                     | •<br>If required, perform identification and authentication.                                                                                                                                                                           |

 <sup>51</sup> New requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

| Step | Test sequence of M.3-25                                                                                                                                                                                                                                                                        | Expected Results                                                                                | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|--------------|
| 1.   | Request export-import packages according to [TR<br>ESOR-M.3], clause 2.7, (A2.7-1)<br>using the credentials<br>of an unauthorised user.                                                                                                                                                        | Access is denied.                                                                               |              |
| 2.   | Request export-import packages according to [TR<br>ESOR-M.3], clause 2.7, (A2.7-1)<br>using the credentials<br>of an authorised user.                                                                                                                                                          | Access is granted.                                                                              |              |
| 3.   | Observe the output of the export-import process.                                                                                                                                                                                                                                               | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned. |              |
| 4.   | Check the log files of the ArchiSafe-Module, if there is<br>information about all released export-import<br>packages including<br>the date of the event<br>and the<br>criteria that has been used to select the set of<br>preservation objects to be included in the export<br>import package. | There is information about the export-import process as<br>required.                            |              |

Verdict of M.3-25

## <span id="page-191-3"></span><span id="page-191-2"></span>4.5 Interface functions

A product, which claims to comply

- with TR-ESOR V1.3, has to pass
- the following test cases concerning the interface functions and additional
- the tool-based test cases pursuant to TR-ESOR-C.2 for testing
	- a. the interface TR-S.4 Test-Tool or the TR-S.512 Test-Tool[52](#page-191-2)
	- b. (optional) the interface ETSI TS119512 interface TR-S.512 using the BSI-Tool ["Tresor-ETSITS119512-transformator"](https://github.com/de-bund-bsi-tr-esor/tresor-ETSITS119512-transformator) in combination with a TR-ESOR-Product with TR-S.4-interface and
	- c. the tool-based tests cases with the BSI-Tool ("AIPeIDASValidator"), testing XAIP and optionally also LXAIP and in future ASiC-AIP[53](#page-191-3).

### <span id="page-191-5"></span>4.5.1 Interface TR-S.1

<span id="page-191-0"></span>The primary purpose of the TR-ESOR-S.1 interface between the ArchiSafe-Module and the Cryptographic-Module is the validation and creation of digital signatures that were or should be attached to electronic data to be archived ((L)XAIP or BIN documents or in future also ASiC-AIP). BIN documents shall be restricted to the preservation object formats described in clause 2, Notice 4,

#### 4.5.1.1Verify

The test cases of the "Verify" or "ValidateEvidence" - function of the interface TR-S.4 (sec[. 0\)](#page-246-0) are also relevant here.

#### <span id="page-191-4"></span>4.5.1.2 Sign

The test cases M.2-05 (sec[. 4.3.5](#page-101-3) Support of Hash functions), M.2-06 (sec[. 4.3.6](#page-104-1) Crypto-Module supports canonicalisation for the validation of XML digital signatures), M.2-07 (sec. [4.3.7](#page-106-1) Canonicalisation procedures do not change the content data), and M.2-08 (sec[. 4.3.8](#page-107-1) Reliable validation of digital signatures by itself or by a Trust Service Provider ) are also relevant here.

<span id="page-191-1"></span> <sup>52</sup> not yet ready for certification

<sup>53</sup> not yet ready for certification

## 4.5.2 Interface S.2

The main purpose of the TR-ESOR-S.2 interface between the ArchiSig-Module or (conditional) Upload-Module and the ECM-/Long-Term Storage is to make the necessary read and write access to ArchiSig's own database and the archive database in the ECM-/Long-Term Storage possible for the ArchiSig-Module.

This is an interface of a component, which is not part of the TR-ESOR Middle-Ware. Therefore, no conformity tests will be specified here.

### 4.5.3 Interface S.3

The primary purpose of the TR-ESOR-S.3 interface between the ArchiSig-Module and the Cryptographic-Module is the generation of hash values and the generation and validation of qualified time-stamps. Both kinds of data are needed for the development of the Merkle hash trees [MER 1980].

#### Pre-supposition:

A product, which claims to functionally comply with the Interface S.3 specification of this TR has to pass

• all test cases in this section or prove that it supports functional analogous interfaces.

#### 4.5.3.1 Timestamp Generation

<span id="page-192-0"></span>The test cases M.2-17 (sec. 4.3.17 Crypto-Module is able to request qualified electronic time-stamps from a Trust Service Provider ), M.2-18 (sec. 4.3.18 Crypto-Module supports [RFC 3161], [RFC5816], [RFC5652] and [EN 319 422] and suitable algorithms ), M.2-19 (sec. 4.3.19 M.2-19 – Qualified Electronic Time-Stamps fulfil the requirements of [eIDAS-VO], Article 42) and M.2-20 (sec. 4.3.20 ) are also relevant here.

#### 4.5.3.2 Verify

The test cases of the "Verify" or "ValidateEvidence" - function of the interface S.1 (sec[. 4.5.1.2\)](#page-191-4) are also relevant here.

#### <span id="page-192-1"></span>4.5.3.3 Hash

The test cases M.2-05 (sec[. 4.3.5](#page-101-3) M.2-05 – Support of Hash functions), M.2-09 (sec. 4.3.9), and M.2-07 (sec. [4.3.7](#page-106-1) ) are also relevant here.

## 4.5.4 TR-ESOR-Interface TR-S.4 or TR-S.512

The TR-ESOR interfaces TR-S.4 or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall make it possible for the business applications to access the TR-ESOR-Middleware in a standardised and functional manner. Furthermore, the interface shall reliably prevent unauthorised access to the ECM-/Long-Term Storage.

Note: The term "ArchiSafe" in the following means the logical entry in the TR-ESOR-Middleware. 

#### Pre-supposition:

A product, which claims to comply with TR-ESOR V1.3, has to pass

- the following test cases in this section concerning the interface functions and additional and
- the tool-based test cases pursuant to TR-ESOR-C.2 for testing
	- o the interface TR-S.4 Test-Tool or the TR-S.512 Test-Tool
- the tool-based test cases with the BSI-Tool ("ERVerify"), testing Evidence Records and
- the tool-based tests cases with the BSI-Tool ("AIPeIDASValidator"), testing XAIP and optionally also LXAIP and in future ASiC-AIP.
- <span id="page-193-1"></span><span id="page-193-0"></span>4.5.4.1 ArchiveSubmission or PreservePO

#### 4.5.4.1.1 S.4.1-04 – ArchiveSubmission or PreservePO is always possible via a secure communication channel

| Identifier          | S.4.1-04                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A5.1-2,<br>PRP-8.1-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |  |
| Test Purpose        | The test shall<br>verify whether the storage of electronic documents and data from external IT applications is always possible via a secure communication<br>channel.                                                                                                                                                                                                                                                                                                                                                                                                                               |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |
| Pre-test conditions | •<br>The IT system documentation is available.<br>•<br>If required, perform identification and authentication.<br>•<br>Administration access to the IT systems is needed<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and "ASiC-AIP" may<br>be supported, if configured.<br>•<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>be configured.<br>•<br>BIN is restricted<br>to the<br>described in clause 2, Notice 4.<br>object<br>formats<br>preservation |  |

| Step | Test sequence of S.4.1-04                                                                                                                                              | Expected Results                                                                                               | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check whether a secure communication channel<br>between upstream application and TOT is configured<br>and activated by using the TR-S.4 or TR-S.512<br>interface only. | A secure communication channel is set up and active. Only TR<br>S.4 or TR-S.512 is used.                       |              |
| 2.   | Start logging the data traffic between the external IT<br>application and the middleware by using the TR-S.4<br>or TR-S.512 interface only.                            | The data logging process has been started. Only TR-S.4 or TR<br>S.512 is used.                                 |              |
| 3.   | Store an XAIP_OK_SIG<br>or BIN<br>from the external IT<br>application via the middleware to the ECM by using<br>the TR-S.4 or TR-S.512 interface only.                 | The function call is possible. Only TR-S.4 or TR.S.512 is used.                                                |              |
| 4.   | Close the connection of the two components. Stop<br>logging the data traffic.                                                                                          | The complete data exchange between the components has been<br>intercepted and logged.                          |              |
| 5.   | Check the data traffic log file for unprotected<br>document data.                                                                                                      | No document data can be accessed.                                                                              |              |
| 6.   | Store an XAIP_OK_SIG<br>or BIN<br>from the external IT<br>application via the middleware to the ECM by not<br>using TR-S.4 or TR-S.512.                                | The request will be rejected by ArchiSafe-Module including an<br>error message documenting the failed request. |              |
| 7.   | Conditional: If LXAIP is implemented, the test steps<br>from No. 1 to No. 6 are to be repeated for LXAIP.                                                              | See expected results of the test cases from No. 1 to No. 6 for<br>LXAIP.                                       |              |
| 8.   | Conditional: If ASiC-AIP is implemented, the test steps<br>from No. 1 to No. 6 are to be repeated for ASiC-AIP.                                                        | See expected results of the test cases from No. 1 to No. 6 for<br>ASiC-AIP.                                    |              |

Verdict of S.4.1-04

<span id="page-197-0"></span>4.5.4.1.2 S.4.1-05 – ArchiveSubmission or PreservePO includes the validation of supplemental evidence data and evidence records validation and storage of results[54](#page-197-0)

| Identifier   | S.4.1-05                                                                                                                                                                                                                                                                                                                                                                                                                                               |  |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement  | MD:A5.1-5                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |
|              | MD:A8.2.-3                                                                                                                                                                                                                                                                                                                                                                                                                                             |  |
|              | M1:A4.1-3, M1:A4.1-4                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
|              | M2:A5.2-1, M2:A5.2-2, M2:A5.2-3                                                                                                                                                                                                                                                                                                                                                                                                                        |  |
|              | M3:A4.1-1                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |
|              | OVR-6.2-06,<br>OVR-7.5-03,<br>PRP-8.1-05,<br>PRP-8.1-08                                                                                                                                                                                                                                                                                                                                                                                                |  |
| Test Purpose | The test shall<br>verify that the ArchiSafe-Module is able to initiate the validation of the supplemental evidence data (e.g. signatures, seals, time-stamps,<br>certificates, revocation lists, ocsp responses, etc.) and technical evidence records of the XAIPs or BINs before they are stored, -                                                                                                                                                   |  |
|              | The test shall<br>verify that an error message is received in the case of a failed validation of supplemental evidence data (e.g. signatures, seals, time-stamps,<br>certificates, revocation lists, ocsp responses, etc.) and/or technical evidence records.                                                                                                                                                                                          |  |
|              | The test shall<br>verify that it is possible for the ArchiSafe-Module to enter all validation results including the associated certificate information into the<br>archive object.                                                                                                                                                                                                                                                                     |  |
|              | The validation results<br>shall<br>be returned either in the form of a Verification Report pursuant to [TR-ESOR-VR]<br>or as a supplement of the XAIP container<br>handed over pursuant to [TR-ESOR-F].                                                                                                                                                                                                                                                |  |
|              | The test shall<br>verify, that if the validation data of digital signatures or time-stamps is submitted by the preservation client, the TR-ESOR-Middleware<br>automatically shall<br>verify the validation data<br>pursuant to the "signature validation policy" or "time-stamp validation policy" and shall<br>verify that the<br>submitted validation data is appropriate, otherwise it should<br>collect and verify the appropriate validation data |  |
|              | The test shall<br>verify, that if the validation data of digital signatures or time-stamps is not submitted or is not completely submitted by the preservation client,<br>the TR-ESOR-Middleware automatically shall<br>make its best efforts to collect and verify the validation data<br>pursuant to the "signature validation policy" or<br>"time-stamp validation policy".                                                                         |  |

 <sup>54</sup> New requirement, also included in [TR-ESOR-APP] for TR-ESOR V1.2.1 and V1.2.2.

| Identifier          | S.4.1-05                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|                     | The test shall verify, that if the validation data of digital signatures or time-stamps is not completely submitted by the preservation client, and<br>unable<br>it<br>is<br>to<br>, the TR-ESOR-Middleware automatically shall return an understandable error message to the preservation client and<br>collect<br>and<br>verify<br>all<br>the<br>validation<br>data<br>handle this case as a case of failure.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
| Pre-test conditions | •<br>User Manual is present.<br>•<br>Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based on the BSI-[TR-ESOR-PEPT], is present and published.<br>•<br>Preservation Profile is present and published.<br>•<br>"Signature Validation Policy" and "Time-Stamp Validation Policy" are present.<br>•<br>The Cryptographic-Module has a connection to a Trust Service Providers, in order to request the validation of certificates.<br>•<br>Tester has Read/Write permissions on the system.<br>•<br>Perform authentication, if necessary<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause 2, Notice 4.<br>•<br>An XAIP_NOK_SIGSHELL_OK_SIGCHAIN with qualified<br>or advanced electronic signature or seal is present.<br>•<br>An XAIP_NOK_TSPSHELL_OK_TSPCHAIN with (qualified) time-stamp is present.<br>•<br>Conditional: The Verification Report pursuant to<br>[TR-ESOR-VR] supports the element<br><CertifictePathValidationStrategy>.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall be configured.<br>•<br>•<br>The BSI-AIPeIDASValidation-Tool is installed and the tester has access rights to it. |  |

| Step | Test sequence of S.4.1-05                                                                                                                                                                                                                            | Expected Results                                                                                                                                                                                                                                                                                                                          | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check the user manual or the Preservation Evidence<br>Policy where to find the actual Preservation Profile.<br>Check the Preservation Profile in order to find a<br>signature validation policy or a reference to a time<br>stamp validation policy. | In the user manual or the Preservation Evidence Policy there is the<br>information, where to find the actual Preservation Profile. In the<br>actual profile, the signature validation<br>policy and time-stamp<br>validation policy or a reference to the signature validation policy or<br>time-stamp validation policy are to be found. |              |

| Step | Test sequence of S.4.1-05                                                                                                                                                                                                                                                                                                                                                                                                                        | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                            | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 2.   | The automatic validation of the supplemental<br>evidence data (e.g. signatures, seals, time-stamps,<br>certificates, revocation lists, OCSP responses with its<br>reason codes, etc.) and technical evidence records is<br>enabled.<br>Store an XAIP_OK_SIG<br>with appropriate<br>validation<br>data, collected by the client, to the ECM-<br>/Long-Term Storage using either the interface<br>function "ArchiveSubmission" or<br>"PreservePO". | The call of the function is possible.                                                                                                                                                                                                                                                                                                                                                                                                       |              |
| 3.   | Observe the output of the interface function<br>"ArchiveSubmissionResponse" or<br>"PreservePOResponse".                                                                                                                                                                                                                                                                                                                                          | The automatic validation of the supplemental evidence data (e.g.<br>signatures, seals, time-stamps, certificates, revocation lists, OCSP<br>responses, etc.) was successfully completed pursuant to the signature<br>validation policy or time-stamp validation policy.<br>The validation results<br>is<br>returned either in the form of a Verification<br>Report pursuant to [TR-ESOR-VR]<br>or as a supplement of the XAIP<br>container. |              |
| 4.   | The automatic validation of the supplemental<br>evidence data (e.g. signatures, seals, time-stamps,<br>certificates, revocation lists, OCSP responses, with its<br>reason codes<br>etc.) and technical evidence records is<br>enabled.<br>Store an XAIP_OK_SIG<br>without validation data<br>to<br>the ECM-/Long-Term Storage using either the<br>interface function "ArchiveSubmission" or<br>"PreservePO".                                     | The call of the function is possible.                                                                                                                                                                                                                                                                                                                                                                                                       |              |

| Step | Test sequence of S.4.1-05                                                                                                                                                                                                                                                                                                                                                                 | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 5.   | Observe the output of the<br>interface function<br>"ArchiveSubmission" or "PreservePO".                                                                                                                                                                                                                                                                                                   | The automatic validation of the supplemental evidence data (e.g.<br>signatures, seals, time-stamps, certificates, revocation lists, OCSP<br>responses, etc.) was successfully completed pursuant to the signature<br>validation policy or time-stamp validation policy.<br>The validation results<br>is<br>enriched in order that an appropriate<br>validation data<br>is<br>returned either, if supported and requested, in the<br>form of a Verification Report pursuant to [TR-ESOR-VR]<br>or as a<br>supplement of the XAIP container. |              |
| 6.   | The automatic validation of the supplemental<br>evidence data (e.g. signatures, seals, time-stamps,<br>certificates, revocation lists, OCSP responses, etc.) and<br>technical evidence records is enabled.<br>Store an XAIP_OK_SIG<br>without<br>complete<br>validation data to the ECM-/Long-Term Storage using<br>either the interface function<br>"ArchiveSubmission" or "PreservePO". | The call of the function is possible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |              |
| 7.   | Observe the output of the interface function<br>"ArchiveSubmission" or "PreservePO".                                                                                                                                                                                                                                                                                                      | The automatic validation of the supplemental evidence data (e.g.<br>signatures, seals, time-stamps, certificates, revocation lists, OCSP<br>responses, etc.) was successfully completed pursuant to the signature<br>validation policy or time-stamp validation policy.<br>The validation results<br>is<br>enriched in order that an appropriate<br>validation data<br>is<br>returned either in the form of a Verification Report<br>pursuant to [TR-ESOR-VR]<br>or as a supplement of the XAIP container.                                 |              |
| 8.   | The automatic validation of the supplemental<br>evidence data (e.g. signatures, seals, time-stamps,<br>certificates, revocation lists, OCSP responses, etc.) and<br>technical evidence records is not enabled.                                                                                                                                                                            | The call of the function is possible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |              |

| Step | Test sequence of S.4.1-05                                                                                                                                                                                                                                                                                                                                                                                                                                             | Expected Results                                                                                                                                                                                                                                                                                                                                                                                      | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|      | Store an XAIP_OK_SIG<br>with not appropriate<br>validation data, collected by the client, to the ECM-<br>/Long-Term Storage using either the interface<br>function "ArchiveSubmission" or<br>"PreservePO".                                                                                                                                                                                                                                                            |                                                                                                                                                                                                                                                                                                                                                                                                       |              |
| 9.   | Observe the output of the interface function<br>"ArchiveSubmission" or "PreservePO".                                                                                                                                                                                                                                                                                                                                                                                  | The automatic validation of the supplemental evidence data (e.g.<br>signatures, seals, time-stamps, certificates, revocation lists, OCSP<br>responses, etc.) was not successfully completed.<br>The validation results<br>is<br>returned with an understandable error<br>message either in the form of a Verification Report pursuant to [TR<br>ESOR-VR]<br>or as a supplement of the XAIP container. |              |
| 10.  | Check that the validation of the digital signatures or<br>the electronic time-stamps and the validation of the<br>certificate chain back to a trustworthy root TSP<br>or<br>trust anchor according to the preservation evidence<br>policy (PEP) derived from [TR-ESOR-PEPT]<br>of the<br>TR-ESOR-Product Manufacturer or respectively of<br>the preservation service<br>were done according to the<br>signature validation policy or time-stamp validation<br>policy. | The validation of the digital signatures or the time-stamp and the<br>certificate were done according to the signature validation policy or<br>time-stamp validation policy.                                                                                                                                                                                                                          |              |
| 11.  | Verify that the configuration of the ArchiSafe-Module<br>enables the automatic validation of the supplemental<br>evidence data (e.g. signatures, seals, time-stamps,<br>certificates, revocation lists, OCSP responses, etc.) and<br>technical evidence records while submitting an<br>archive object.                                                                                                                                                                | The automatic validation of the supplemental evidence data (e.g.<br>signatures, seals, time-stamps, certificates, revocation lists, OCSP<br>responses, etc.) and technical evidence records can be enabled and is<br>enabled.<br>The validation results<br>will be returned either in the form of a<br>Verification Report pursuant to [TR-ESOR-VR]<br>or as a supplement of<br>the XAIP container.   |              |

| Step | Test sequence of S.4.1-05                                                                                                                                               | Expected Results                                                                                                                                                                                                                                                                                            | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 12.  | Store an XAIP_NOK_SIG<br>with a<br>revoked<br>public<br>to the TOT using either the interface<br>key<br>certificate<br>function "ArchiveSubmission" or<br>"PreservePO". | The call of the function is possible.                                                                                                                                                                                                                                                                       |              |
| 13.  | Observe the output of the interface function<br>"ArchiveSubmission" or "PreservePO".                                                                                    | A negative feedback will be received in form of a Verification Report.<br>An error message or error code occurs. The log file contains an error<br>message.<br>The archive object may<br>be stored with an "OCSP with reason code" as<br>a supplement of the XAIP container and an AOID may<br>be returned. |              |
| 14.  | Store an XAIP_OK_SIG<br>to the ECM-/Long-Term<br>Storage using either the interface function<br>"ArchiveSubmission" or "PreservePO".                                    | The call of the function is possible.                                                                                                                                                                                                                                                                       |              |
| 15.  | Observe the output of the interface function<br>"ArchiveSubmission" or "PreservePO".                                                                                    | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned to the stored archive object.                                                                                                                                                                                |              |
| 16.  | Store an XAIP_NOK_SIG<br>to the TOT using either<br>the interface function "ArchiveSubmission" or<br>"PreservePO".                                                      | The call of the function is possible.                                                                                                                                                                                                                                                                       |              |
| 17.  | Observe the output of the interface function<br>"ArchiveSubmission" or "PreservePO".                                                                                    | A negative feedback will be received. An error message or error code<br>occurs. The log file contains an error message.<br>The archive object may<br>be stored and an AOID may<br>be returned.                                                                                                              |              |
| 18.  | Retrieve the XAIP_OK_SIG<br>by using either the<br>"ArchiveRetrieval" or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" function and the<br>AOID from step 3.         | The XAIP_OK_SIG<br>is retrieved.                                                                                                                                                                                                                                                                            |              |

| Step | Test sequence of S.4.1-05                                                                                                                                                                                                                                | Expected Results                                                                                                                                                                                                                                                                                | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 19.  | Check the XAIP_OK_SIG, especially the credential<br>section, whether the supplemental evidence data (e.g.<br>signatures, seals, time-stamps, certificates, revocation<br>lists, OCSP responses, etc.) and technical evidence<br>records<br>are included. | The certificates, certification validation information and if existent,<br>further supplemental evidence data (e.g. signatures, seals, time<br>stamps, certificates, revocation lists, OCSP responses, etc.) and<br>technical evidence records<br>are included in the retrieved<br>XAIP_OK_SIG. |              |
| 20.  | Check whether the XAIP_OK_SIG<br>is positively<br>validated, using the BSI-AIPeIDASValidation-Tool.                                                                                                                                                      | The BSI-AIPeIDASValidation-Tool returns a Verification Report<br>with a positive result. The schema of the XAIP_OK_SIG<br>and the<br>Signatures or Seals or Time-Stamps are positively tested pursuant to<br>[TR-ESOR-F].                                                                       |              |
| 21.  | If archived/stored, retrieve the XAIP_NOK_SIG<br>by<br>using either the "ArchiveRetrieval" or<br>"RetrievePO" with SubjectOfRetrieval<br>"PO"" function and the AOID from step 5.                                                                        | The XAIP_NOK_SIG<br>is retrieved.                                                                                                                                                                                                                                                               |              |
| 22.  | Check the XAIP_NOK_SIG, especially the credential<br>section, whether the supplemental evidence data (e.g.<br>signatures, seals, time-stamps, certificates, revocation<br>lists, OCSP responses, etc.) and technical evidence<br>records are included.   | The certificates, certification validation information and if existent,<br>further supplemental evidence data (e.g. signatures, seals, time<br>stamps, certificates, revocation lists, OCSP responses, etc.) and<br>technical evidence records are included in the retrieved<br>XAIP_NOK_SIG.   |              |
| 23.  | Check whether the XAIP_NOK_SIG<br>is positively<br>validated, using the BSI-AIPeIDASValidation-Tool.                                                                                                                                                     | The BSI-AIPeIDASValidation-Tool returns a Verification Report<br>with a negative test result.                                                                                                                                                                                                   |              |
| 24.  | Store an XAIP_OK_SIG_OK_ER<br>to the TOT using<br>either the interface function<br>"ArchiveSubmission" or "PreservePO".                                                                                                                                  | The call of the function is possible.                                                                                                                                                                                                                                                           |              |
| 25.  | Observe the output of the interface function<br>"ArchiveSubmission" or "PreservePO"-.                                                                                                                                                                    | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned to the stored archive object.                                                                                                                                                                    |              |

| Step | Test sequence of S.4.1-05                                                                                                                                                                                                                                                  | Expected Results                                                                                                                                                                                                                                                                                    | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 26.  | Retrieve the XAIP_OK_SIG_OK_ER<br>by using either<br>the "ArchiveRetrieval" or "RetrievePO" with<br>SubjectOfRetrieval "PO"" function and the<br>AOID from step 15.                                                                                                        | The XAIP_OK_SIG_OK_ER<br>is retrieved.                                                                                                                                                                                                                                                              |              |
| 27.  | Check the XAIP_OK_SIG_OK_ER, especially the<br>credential section, whether the supplemental<br>evidence data (e.g. signatures, seals, time-stamps,<br>certificates, revocation lists, OCSP responses, etc.)<br>and<br>evidence record validation information are included. | The certificates, certification validation information<br>and the<br>supplemental evidence data (e.g. signatures, seals, time-stamps,<br>certificates, revocation lists, OCSP responses, etc.)<br>and evidence<br>record validation information are included in the retrieved<br>XAIP_OK_SIG_OK_ER. |              |
| 28.  | Check whether the XAIP_OK_SIG_OK_ER is<br>positively validated, using the BSI<br>AIPeIDASValidation-Tool.                                                                                                                                                                  | The BSI-AIPeIDASValidation-Tool returns a Verification Report<br>with a positive result. The schema of the XAIP_OK_SIG_OK_ER<br>and<br>the Signatures or Seals or Time-Stamps are positively tested pursuant<br>to [TR-ESOR-F].                                                                     |              |
| 29.  | Store an XAIP_NOK_SIG_OK_ER to the TOT<br>using either the interface function<br>"ArchiveSubmission" or "PreservePO".                                                                                                                                                      | The call of the function is possible.                                                                                                                                                                                                                                                               |              |
| 30.  | Observe the output of the interface function<br>"ArchiveSubmissionResponse" or "PreservePO"-<br>Response.                                                                                                                                                                  | A negative feedback will be received. An error message or error code<br>occurs. The log file contains an error message with a digital signature<br>and an evidence record.<br>The archive object may<br>be stored and an AOID may<br>be returned.                                                   |              |
| 31.  | If archived/stored, retrieve the<br>XAIP_NOK_SIG_OK_ER<br>by using either the<br>"ArchiveRetrieval" or "RetrievePO" with<br>SubjectOfRetrieval "PO"" function and the<br>AOID from step 19.                                                                                | The XAIP_NOK_SIG_OK_ER<br>is retrieved in the XAIP format.                                                                                                                                                                                                                                          |              |

| Step | Test sequence of S.4.1-05                                                                                                                                                                                                                                                           | Expected Results                                                                                                                                                                                                                                                                                              | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 32.  | Check whether the XAIP_NOK_SIG_OK_ER is<br>positively validated, using the BSI<br>AIPeIDASValidation-Tool.                                                                                                                                                                          | The BSI-AIPeIDASValidation-Tool returns a Verification Report<br>with a negative test result.                                                                                                                                                                                                                 |              |
| 33.  | Check the retrieved XAIP and all the metadata<br>whether the supplemental evidence data (e.g.<br>signatures, seals, time-stamps, certificates, revocation<br>lists, OCSP responses, etc.) and the evidence record<br>validation information are included.                           | The certificates, certification validation information and the<br>supplemental evidence data (e.g. signatures, seals, time-stamps,<br>certificates, revocation lists, OCSP responses, etc.)<br>and the evidence<br>record validation information are included in the retrieved XAIP                           |              |
| 34.  | Store an XAIP_NOK_ER to the TOT using either the<br>interface function "ArchiveSubmission" or<br>"PreservePO".                                                                                                                                                                      | The call of the function is possible.                                                                                                                                                                                                                                                                         |              |
| 35.  | Observe the output of the interface function<br>"ArchiveSubmission" or "PreservePO".                                                                                                                                                                                                | A negative feedback will be received. An error message or error code<br>occurs. The log file contains an error message with an evidence<br>record.<br>The archive object may<br>be stored and an AOID may<br>be returned.                                                                                     |              |
| 36.  | If archived/stored, retrieve the XAIP_NOK_ER<br>by<br>using either the "ArchiveRetrieval" or<br>"RetrievePO"<br>with SubjectOfRetrieval<br>"PO"" function and the AOID from step 23.                                                                                                | The XAIP_NOK_ER<br>is retrieved in the XAIP format.                                                                                                                                                                                                                                                           |              |
| 37.  | Check the retrieved XAIP and all the metadata<br>whether the supplemental evidence data (e.g.<br>signatures, seals, time-stamps, certificates, revocation<br>lists, OCSP responses, etc.) and technical evidence and<br>the evidence record validation information are<br>included. | The certificates, certification validation information and the<br>supplemental evidence data (e.g. signatures, seals, time-stamps,<br>certificates, revocation lists, OCSP responses, etc.) and technical<br>evidence<br>and the evidence record validation information are<br>included in the retrieved XAIP |              |

<span id="page-206-0"></span>

| Step | Test sequence of S.4.1-05                                                                                                                                                                                                                           | Expected Results                                                                                                                                                             | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 38.  | Check whether the XAIP_NOK_ER<br>is positively<br>validated, e.g. by using the BSI-AIPeIDASValidation<br>Tool.                                                                                                                                      | The BSI-AIPeIDASValidation-Tool returns a Verification Report<br>with a negative test result.                                                                                |              |
| 39.  | Transfer the archival information package<br>XAIP_NOK_SIGSHELL_OK_SIGCHAIN (see pre-test<br>conditions) to the TOT using either the interface<br>function "ArchiveSubmission" or "PreservePO"<br>(conditional) asking for a Verification<br>Report. | The call of the function with this<br>XAIP_NOK_SIGSHELL_OK_SIGCHAIN as parameter is possible.                                                                                |              |
| 40.  | Observe the output of the interface function<br>"ArchiveSubmission" or "PreservePO".                                                                                                                                                                | A positive<br>feedback will be received containing (conditional) a<br>Verification Report included in "ArchiveSubmissionResponse"<br>or "PreservePO"-Response.               |              |
| 41.  | Conditional:<br>If<br>Verification<br>the<br>Report<br>pursuant to<br>[TR-ESOR-VR]<br>the<br>element<br>supports<br><CertifictePathValidationStrateg<br>y>,<br>this<br>element.<br>examine                                                          | Verification<br>The<br>Report<br>includes<br>in<br>the<br>element<br><CertifictePathValidationStrateg<br>the<br>content<br>y><br>".55<br>"uri:oid:1<br>.3.6.1.4.1.8301.3.5.2 |              |
| 42.  | Transfer the archival information package<br>XAIP_NOK_TSPSHELL_OK_TSPCHAIN (see pre-test<br>conditions) to the TOT using either the interface<br>function "ArchiveSubmission" or "PreservePO"<br>(conditional) asking for a Verification<br>Report. | The call of the function with this<br>XAIP_NOK_TSPSHELL_OK_TSPCHAIN as parameter is possible.                                                                                |              |
| 43.  | Observe the output of the interface function<br>"ArchiveSubmission" or "PreservePO".                                                                                                                                                                | A positive feedback will be received (no error message or error code)<br>containing (conditional) a Verification Report included in                                          |              |

<sup>55 &</sup>quot;The *CertifictePathValidationStrategy*-element shall contain one of the following values:

<span id="page-206-1"></span><sup>1.</sup> uri:oid:1.3.6.1.4.1.8301.3.5.255 – the certificate path has been validated pursued to the shell-validation-model

<sup>2.</sup> uri:oid:1.3.6.1.4.1.8301.3.5.1 – the certificate path has been validated pursued to the chain-validation-model (c.f. [Common-PKI])." (see [TR-ESOR-VR])

| Step | Test sequence of S.4.1-05                                                                                                                                                                  | Expected Results                                                                                                                                                            | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|      |                                                                                                                                                                                            | "ArchiveSubmissionResponse" or "PreservePOResponse"-<br>Parameter.                                                                                                          |              |
| 44.  | Conditional:<br>If<br>Verification<br>the<br>Report<br>pursuant to<br>[TR-ESOR-VR]<br>the<br>element<br>supports<br><CertifictePathValidationStrateg<br>y>,<br>this<br>element.<br>examine | Verification<br>The<br>Report<br>includes<br>in<br>the<br>element<br><CertifictePathValidationStrateg<br>the<br>content<br>y><br>"55<br>"uri:oid:1<br>.3.6.1.4.1.8301.3.5.2 |              |
| 45.  | Conditional:<br>test steps from<br>If<br>LXAIP<br>is<br>implemented,<br>No. 1 to No. 42 are to be repeated for LXAIP.                                                                      | See expected results of the test cases from No. 1 to No. 42 for LXAIP.                                                                                                      |              |
| 46.  | Conditional:<br>test steps<br>If<br>ASiC-AIP<br>is<br>implemented,<br>from No. 1 to No. 42 are to be repeated for ASiC-AIP.                                                                | See expected results of the test cases from No. 1 to No. 42 for ASiC<br>AIP.                                                                                                |              |

#### 4.5.4.1.3 S.4.1-06 – ArchiveSubmission or PreservePO Request does not change the data objects within the XAIP or BIN

| Identifier          | S.4.1-06                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M1:A4.1-7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
|                     | PRP-8.1-05                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| Test Purpose        | The test shall<br>verify that the ArchiSafe-Module does not change the primary data objects within the XAIPs or BINs.                                                                                                                                                                                                                                                                                                                                                                                                                                             |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
| Pre-test conditions | •<br>If required, perform identification and authentication.<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.<br>Either the TR-S.4-interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>•<br>BIN is restricted<br>to the<br>described<br>in clause<br>2, Notice 4.<br>object<br>formats<br>preservation |  |

| Step | Test sequence of S.4.1-06                                                                                                                        | Expected Results                                                                                                  | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Store an XAIP_OK_SIG<br>or BIN<br>using either the<br>interface function "ArchiveSubmission" or<br>"PreservePO".                                 | The call of the function is possible.                                                                             |              |
| 2.   | Observe the output of the interface function<br>"ArchiveSubmission" or "PreservePO".                                                             | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned to the XAIP / BIN. |              |
| 3.   | Request the XAIP with either the<br>"ArchiveRetrieval" or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" function and the<br>AOID from step 2. | The call of the function is possible.                                                                             |              |

| Step | Test sequence of S.4.1-06                                                                                                                                                                            | Expected Results                                                            | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|--------------|
| 4.   | Compare the data objects of the retrieved XAIP with<br>the data objects of the XAIP / BIN that has originally<br>been stored in step 1.                                                              | The data objects are identical.                                             |              |
| 5.   | Check vendor documentation whether ArchiSafe resp.<br>the TOT provides any function to modify the actual<br>primary data content or whether a conversion of the<br>primary data content is required. | No such function or requirement exists.                                     |              |
| 6.   | Conditional:<br>test steps from<br>If<br>is<br>implemented,<br>LXAIP<br>No. 1 to No. 5 are to be repeated for LXAIP.                                                                                 | See expected results of the test cases from No. 1 to No. 5 for<br>LXAIP.    |              |
| 6.   | Conditional:<br>test steps<br>If<br>implemented,<br>ASiC-AIP<br>is<br>from No. 1 to No. 5<br>are to be repeated for ASiC-AIP.                                                                        | See expected results of the test cases from No. 1 to No. 5 for<br>ASiC-AIP. |              |

#### Verdict of S.4.1-06

<span id="page-209-0"></span>4.5.4.2ArchiveUpdate or UpdatePOC

#### 4.5.4.2.1 S.4.2-05 – Only authorised entities can change data

#### Pre-supposition:

• The TR-ESOR-Middleware supports Multi-Tenancy.

| Identifier          | S.4.2-05                                                                                                                                               |  |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A5.1-11, MD:A5.1-12                                                                                                                                 |  |
|                     | PRP-8.1-01                                                                                                                                             |  |
|                     | PRP-8.1-14                                                                                                                                             |  |
| Test Purpose        | The test shall<br>verify that changes to documents and data including the associated meta data is not possible for unauthorised users or applications. |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                       |  |
| Pre-test conditions | •<br>Tester has no read/write permissions on the middleware.                                                                                           |  |
|                     | •<br>Do not perform any authentication against ArchiSafe.                                                                                              |  |
|                     | •<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].                                                                               |  |
|                     | •<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].                                                                                          |  |
|                     | •<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.                                                         |  |
|                     | Either the TR-S.4-interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.                        |  |
|                     | •<br>BIN is restricted<br>to the<br>described in clause<br>2, Notice 4.<br>formats<br>preservation<br>object                                           |  |
|                     | •<br>The test dispenses if the pre-supposition is not valid.                                                                                           |  |

| Step | Test sequence of S.4.2-05                                                                                                                                           | Expected Results                                   | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|--------------|
| 1.   | Submit a XAIP_OK<br>or BIN<br>to the middleware using an<br>account A<br>from a client A (if TOT is multi-client<br>capable). Perform authentication when required. | The XAIP / BIN was archived. An AOID was returned. |              |

| Step | Test sequence of S.4.2-05                                                                                                                                                           | Expected Results                                                                                                                                                                     | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 2.   | Retrieve a XAIP using the AOID and an account A<br>from a client A (if TOT is multi-client-capable).<br>Perform authentication when required.                                       | XAIP could<br>be retrieved.                                                                                                                                                          |              |
| 3.   | Update the XAIP / XAIP(BIN) several times using the<br>AOID and an account A<br>from a client A (if TOT is<br>multi-client-capable). Perform authentication when<br>required.       | All updates are successfully performed.                                                                                                                                              |              |
| 4.   | Disconnect from the TOT.                                                                                                                                                            | Any existing secure channels are terminated.                                                                                                                                         |              |
| 5.   | Reconnect to the TOT and try to retrieve a XAIP using<br>the AOID and an account B<br>from a client A (if TOT is<br>multi-client-capable). Perform authentication when<br>required. | A negative feedback is received. An error message or error code<br>(e.g. unknownAOID, noPermission) occurs because access is<br>denied. No XAIP is received.                         |              |
| 6.   | Update the XAIP / XAIP(BIN) using the AOID and an<br>account B<br>from a client A (if TOT is multi-client<br>capable). Perform authentication when required.                        | A negative feedback is received. An error message or error code<br>(e.g. noPermission or parameterError) occurs because access is<br>denied. The XAIP / XAIP(BIN) is not updated.    |              |
| 7.   | Retrieve a XAIP using the AOID and an account A<br>from a client B<br>(if TOT is multi-client-capable).<br>Perform authentication when required.                                    | A negative feedback is received. An error message or error code<br>(e.g. unknownAOID, noPermission) occurs because access is<br>denied. No XAIP is received.                         |              |
| 8.   | Update the XAIP / XAIP(BIN) using the AOID and an<br>account A<br>from a client B<br>(if TOT is multi-client<br>capable). Perform authentication when required.                     | A negative feedback is received. An error message or error code<br>(e.g. noPermission or parameterError) occurs<br>because access is<br>denied. The XAIP / XAIP(BIN) is not updated. |              |
| 9.   | Conditional:<br>test steps from<br>If<br>implemented,<br>LXAIP<br>is<br>No. 1 to No. 8 are to be repeated for LXAIP.                                                                | See expected results of the test cases from No. 1 to No. 8 for<br>LXAIP.                                                                                                             |              |
| 10.  | Conditional:<br>test steps<br>If<br>ASiC-AIP<br>is<br>implemented,<br>from No. 1 to No. 8 are to be repeated for ASiC-AIP.                                                          | See expected results of the test cases from No. 1 to No. 8 for<br>ASiC-AIP.                                                                                                          |              |

| Verdict of S.4.2-05 |
|---------------------|
|                     |
|                     |

4.5.4.2.2 S.4.2-06 – Digital Signature, electronic time-stamp and data format validation are also performed on update

| Identifier          | S.4.2-06                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A5.1-4, MD:A5.1-5, MD:A5.1-13                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |
|                     | M1:A4.2-3, M1:A4.2-4, M1:A4.2-7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |  |
|                     | PRP-8.1-14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |
| Test Purpose        | The test shall<br>verify that the same data format and digital signature and time-stamp validations that are performed for the archival of documents and XAIPs<br>are also performed when already archived XAIPs are changed.                                                                                                                                                                                                                                                                                                                 |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |
| Pre-test conditions | •<br>Tester has write permissions on the Middleware.<br>•<br>If required, perform identification and authentication.<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>Either the TR-S.4 interface<br>be configured.<br>•<br>The BSI- AIPeIDASValidation under an Open Source License<br>(Apache 2.0) is installed and the tester has access rights to it. |  |

| Step | Test sequence o f S.4.2-06                                                                                                     | Expected Results                                                                                                 | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Add a digitally signed and separated electronic time<br>stamped data object to an already archived XAIP in<br>form of a DXAIP. | The DXAIP with a signature and separated time stamp in<br>credentialsSection is successfully created.            |              |
| 2.   | Check whether the signature and the time stamp from<br>step 1 can be found in DXAIP using the BSI<br>AIPeIDASValidation-Tool.  | The BSI-AIPeIDASValidation-Tool found the new signature<br>and the new timestamp.                                |              |
| 3.   | Perform either the "ArchiveUpdate" or<br>"UpdatePOC" function<br>with this DXAIP<br>from step 1.                               | The XAIP was successfully updated.<br>The added digital<br>signatures of signed data objects was also validated. |              |

| Step | Test sequence o f S.4.2-06                                                                                                                                                                                                                                                                                                                                    | Expected Results                                                                                                                                         | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 4.   | Perform either the "ArchiveRetrieval" or<br>"RetrievePO" function AOID of corresponding<br>DXAIP<br>from step 1.                                                                                                                                                                                                                                              | The XAIP in the version generated in step 3 will be returned.                                                                                            |              |
| 5.   | Conditional: a proper verification service is integrated<br>into the BSI-AIPeIDASValidation-Tool:<br>Add a<br>digitally signed data object with a wrong signature to<br>an already archived XAIP in form of a<br>DXAIP_NOK_SIG.                                                                                                                               | The DXAIP_NOK_SIG is successfully created.                                                                                                               |              |
| 6.   | Conditional: a proper verification service is integrated<br>into the BSI-AIPeIDASValidation-Tool:<br>Check<br>whether the DXAIP_OK_SIG_NOK_SIG is positively<br>validated, using the BSI-AIPeIDASValidation-Tool.                                                                                                                                             | The BSI-AIPeIDASValidation-Tool returns a Verification<br>Report with a negative result. The Signatures is negatively<br>tested pursuant to [TR-ESOR-F]. |              |
| 7.   | Conditional: a proper verification service is integrated<br>into the BSI-AIPeIDASValidation-Tool:<br>Perform test<br>case S.4.1-06 but either with the "ArchiveUpdate"<br>or "UpdatePOC" function instead of the<br>"ArchiveSubmission" or "PreservePO"-<br>function<br>with this DXAIP_NOK_SIG.                                                              | The XAIP was not successfully updated.<br>The added digital<br>signatures of signed data objects was validated with a negative<br>result.                |              |
| 8.   | Conditional: a proper verification service is integrated<br>into the BSI-AIPeIDASValidation-Tool:<br>Transfer the<br>archival information package<br>DXAIP_NOK_SIGSHELL_OK_SIGCHAIN (see pre-test<br>conditions)<br>to the TOT using either the interface<br>function "ArchiveUpdate"<br>or "UpdatePOC"<br>(conditional) asking for a Verification<br>Report. | The call of the function with this<br>DXAIP_NOK_SIGSHELL_OK_SIGCHAIN as parameter is<br>possible.                                                        |              |

| Step | Test sequence o f S.4.2-06                                                                                                                                                                                                                                                                                                                                        | Expected Results                                                                                                                                                                                              | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 9.   | Conditional: a proper verification service is integrated<br>into the BSI-AIPeIDASValidation-Tool:<br>Observe the<br>output of the interface function "ArchiveUpdate"<br>or "UpdatePOCResponse".                                                                                                                                                                   | A positive<br>feedback will be received containing (conditional) a<br>Verification Report included in "ArchiveUpdateResponse"<br>or "UpdatePOCResponse".                                                      |              |
| 10.  | Conditional: a proper verification service is integrated<br>into the BSI-AIPeIDASValidation-Tool:<br>Transfer the<br>archival information package<br>DXAIP_NOK_TSPSHELL_OK_TSPCHAIN (see pre-test<br>conditions)<br>to the TOT using either the interface<br>function "ArchiveUpdate"<br>or "UpdatePOC",<br>(conditional)<br>asking for a Verification<br>Report. | The call of the function with this<br>DXAIP_NOK_TSPSHELL_OK_TSPCHAIN as parameter is<br>possible.                                                                                                             |              |
| 11.  | Conditional: a proper verification service is integrated<br>into the BSI-AIPeIDASValidation-Tool:<br>Observe the<br>output of the interface function "ArchiveUpdate"<br>or "UpdatePOC".                                                                                                                                                                           | A positive feedback will be received<br>(no error message or error<br>code) containing (conditional)<br>a<br>Verification Report included in<br>"ArchiveUpdateResponse" or "UpdatePOCResponse"-<br>Parameter. |              |

Verdict of S.4.2-06

#### 4.5.4.2.3 S.4.2-08 – Update shall not impair the probative value

| Identifier          | S.4.2-08                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A5.1-15, M1:A4.2-7,<br>PRP-8.1-14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |  |
| Test Purpose        | The test shall<br>verify that the probative value is not compromised by changes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
| Pre-test conditions | •<br>Tester has read/write and administrative permissions on the Middleware.<br>•<br>Test S.4.2-07 has been performed successfully.<br>•<br>If required, perform identification and authentication.<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.<br>Either the TR-S.4-interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>•<br>The BSI-ERVerifyTool is accessible and the tester has access rights to it.<br>•<br>BIN is restricted<br>to the<br>described in clause<br>2, Notice 4.<br>preservation<br>object<br>formats |  |

| Step | Test sequence S.4.2-08                                                                                                                                                 | Expected Results                                                                                | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|--------------|
| 1.   | Store an XAIP_OK<br>or BIN<br>to the ECM-/Long-Term<br>Storage<br>using either the interface function<br>"ArchiveSubmission" or "PreservePO".                          | The call of the function with this XAIP / BIN as a parameter is<br>possible.                    |              |
| 2.   | Observe the output of the interface function<br>"ArchiveSubmission" or "PreservePO".                                                                                   | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned. |              |
| 3.   | Request Evidence Records using the AOID from step 2<br>and either the interface function<br>"ArchiveEvidence" or "RetrievePO" with<br>SubjectOfRetrieval "Evidence" ". | The call of the function with this AOID as a parameter is<br>possible.                          |              |

| Step | Test sequence S.4.2-08                                                                                                                                                    | Expected Results                                                                                                                                   | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 4.   | Observe the output of the interface function<br>"ArchiveEvidence" or "RetrievePO".                                                                                        | A positive feedback is received. No error message or error code<br>occurs. An Evidence Record is received for the first version ID<br>(e.g. "v1"). |              |
| 5.   | Verify the retrieved ERs by using the BSI<br>ERVerifyTool.                                                                                                                | The tool shows that the ERs is upright.                                                                                                            |              |
| 6.   | Change the hash algorithm.                                                                                                                                                | The hash algorithm is changed.                                                                                                                     |              |
| 7.   | Initiate the Hash-tree Renewal process.                                                                                                                                   | The re-hash process is initiated.                                                                                                                  |              |
| 8.   | Using either the interface function<br>"ArchiveUpdate" or "UpdatePOC" Request<br>and<br>the AOID from step 2 add additional changes to<br>XAIP_OK<br>/ XAIP(BIN).         | The call of the function with this AOID and binary data as<br>parameters is possible.                                                              |              |
| 9.   | Observe the output of the interface function<br>"ArchiveUpdate"<br>or "UpdatePOC".                                                                                        | A positive feedback is received. No error message or error code<br>occurs. A new augmented Version ID is assigned (e.g. "v2").                     |              |
| 10.  | Request the XAIP using the AOID from step 2 and<br>either the interface function "ArchiveRetrieval"<br>or "RetrievePO" with SubjectOfRetrieval<br>"PO"".                  | The call of the function with this AOID as a parameter is<br>possible.                                                                             |              |
| 11.  | Observe the output of the interface function<br>"ArchiveRetrieval" or "RetrievePO".                                                                                       | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                                    |              |
| 12.  | Request Evidence Records using the AOID from step 2<br>and either the interface function<br>"ArchiveEvidence" or "RetrievePO"<br>with<br>SubjectOfRetrieval "Evidence" ". | The call of the function with this AOID as a parameter is<br>possible.                                                                             |              |

| Step | Test sequence S.4.2-08                                                                                                                                                    | Expected Results                                                                                                                                           | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 13.  | Observe the output of the interface function<br>"ArchiveEvidence" or "RetrievePO".                                                                                        | A positive feedback is received. No error message or error code<br>occurs. An Evidence Record is received for the new augmented<br>version ID (e.g. "v2"). |              |
| 14.  | Verify the retrieved ERs by using the BSI<br>ERVerifyTool.                                                                                                                | The tool shows that the ERs are upright.                                                                                                                   |              |
| 15.  | Using either the interface function<br>"ArchiveUpdate" or "UpdatePOC" and the AOID<br>from step 2 to change the XAIP_OK /XAIP(BIN) (add<br>metadata) using DXAIP_OK.      | The call of the function with this AOID and the DXAIP_OK as<br>parameters is possible.                                                                     |              |
| 16.  | Observe the output of the interface function<br>"ArchiveUpdate" or "UpdatePOC".                                                                                           | A positive feedback is received. No error message or error code<br>occurs. A new Version ID is assigned.                                                   |              |
| 17.  | Request the XAIP with the AOID from step 2 and<br>either the interface function "ArchiveRetrieval"<br>or "RetrievePO" with SubjectOfRetrieval<br>"PO"".                   | The call of the function with this AOID as a parameter is<br>possible.                                                                                     |              |
| 18.  | Observe the output of the interface function<br>"ArchiveRetrievalResponse" or<br>"RetrievePO" Response.                                                                   | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                                            |              |
| 19.  | Request Evidence Records using the AOID from step 2<br>and either the interface function<br>"ArchiveEvidence" or "RetrievePO"<br>with<br>SubjectOfRetrieval "Evidence" ". | The call of the function with this AOID as a parameter is<br>possible.                                                                                     |              |
| 20.  | Observe the output of the interface function<br>"ArchiveEvidence" or "RetrievePO".                                                                                        | A positive feedback is received. No error message or error code<br>occurs. An Evidence Record is received for the new augmented<br>version ID (e.g. "v3"). |              |

| Step | Test sequence S.4.2-08                                                                                                                                                     | Expected Results                                                                                                                                       | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 21.  | Verify the retrieved ERs by using the BSI<br>ERVerifyTool.                                                                                                                 | The tool shows that the ERs are integer.                                                                                                               |              |
| 22.  | Compare the ERs from step 19 with the ERs from step<br>12.                                                                                                                 | The evidence data from step 19 differs from the evidence data<br>retrieved in step 12.                                                                 |              |
| 23.  | Using either the interface function<br>"ArchiveUpdate" or "UpdatePOC" and the AOID<br>from step 2 to delete the changes to XAIP_OK<br>/XAIP(BIN) added in step 9.          | The call of the function with this AOID and binary data as<br>parameters is possible.                                                                  |              |
| 24.  | Observe the output of the interface function<br>"ArchiveUpdate" or "UpdatePOC".                                                                                            | A positive feedback is received. No error message or error code<br>occurs. A new Version ID is assigned.                                               |              |
| 25.  | Request the XAIP with the AOID from step 2 and<br>either the interface function "ArchiveRetrieval"<br>or "RetrievePO"<br>with SubjectOfRetrieval<br>"PO"".                 | The call of the function with this AOID as a parameter is<br>possible.                                                                                 |              |
| 26.  | Observe the output of the interface function<br>"ArchiveRetrieval" or "RetrievePO".                                                                                        | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                                        |              |
| 27.  | Request Evidence Records using the AOID from step 2<br>and the either the interface function<br>"ArchiveEvidence" or "RetrievePO" with<br>SubjectOfRetrieval "Evidence" ". | The call of the function with this AOID as a parameter is<br>possible.                                                                                 |              |
| 28.  | Observe the output of the interface function<br>"ArchiveEvidence" or "RetrievePO".                                                                                         | A positive feedback is received. No error message or error code<br>occurs. An Evidence Record is received for new augmented<br>version ID (e.g. "v4"). |              |
| 29.  | Calculate manually the evidence data for the updated<br>XAIP / XAIP(BIN). For this purpose, use the time                                                                   | The evidence data has been calculated.                                                                                                                 |              |

| Step | Test sequence S.4.2-08                                                                                                                                                                                                     | Expected Results                                                                                                                                             | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|      | stamp information provided in the ERs retrieved in<br>the previous step.                                                                                                                                                   |                                                                                                                                                              |              |
| 30.  | Compare the manually calculated evidence data with<br>the evidence data of the requested Evidence Record.                                                                                                                  | The evidence data is equal but differs from the evidence data<br>retrieved in step 20.                                                                       |              |
| 31.  | Request Evidence Records using the AOID from step 2<br>and either the interface function<br>"ArchiveEvidence" or "RetrievePO"<br>with<br>SubjectOfRetrieval "Evidence" " for all<br>Version Ids (e.g. Version ID = "all"). | The call of the function with this AOID as a parameter is<br>possible.                                                                                       |              |
| 32.  | Observe the output of the interface function<br>"ArchiveEvidence" or "RetrievePO".                                                                                                                                         | A positive feedback is received. No error message or<br>error code<br>occurs. The Evidence Records for the previously created four<br>versions are received. |              |
| 33.  | Conditional:<br>test steps from<br>If<br>implemented,<br>LXAIP<br>is<br>No. 1 to No. 32 are to be repeated for LXAIP.                                                                                                      | See expected results of the test cases from No. 1 to No. 32 for<br>LXAIP.                                                                                    |              |
| 34.  | Conditional:<br>test steps<br>If<br>ASiC-AIP<br>is<br>implemented,<br>from No. 1 to No. 32 are to be repeated for ASiC-AIP.                                                                                                | See expected results of the test cases from No. 1 to No. 32 for<br>ASiC-AIP.                                                                                 |              |

| Verdict of S.4.2-08 |
|---------------------|
|---------------------|

#### 4.5.4.2.4 S.4.2-09 – Update cannot delete data / Versions can be retrieved separately

| Identifier          | S.4.2-09                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A5.1-16, MD:A5.1-20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |
|                     | M1:A4.2-2, M1:A4.2-7, M1:A4.3-2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |  |
|                     | PRP-8.1-14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
| Test Purpose        | The test shall<br>verify that the update function cannot be used to completely and ultimately delete any data, meta data or complete XAIPs/BINs.                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |  |
|                     | The test shall<br>verify that it is possible to retrieve each version of a changed data structure individually by using the version<br>ID as a parameter when issuing<br>the archive retrieval request.                                                                                                                                                                                                                                                                                                                                                                                                                     |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |  |
| Pre-test conditions | •<br>Tester has read/write permissions on the Middleware.<br>•<br>If required, perform identification and authentication.<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and/or "ASiC-AIP" may<br>be supported, if configured.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>•<br>BIN is restricted<br>to the<br>described in clause<br>2, Notice 4.<br>object<br>formats<br>preservation |  |

| Step | Test sequence S.4.2-09                                                                                                                                      | Expected Results                                                                                                                                                          | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Store an XAIP_OK<br>or BIN<br>with data to the ECM-<br>/Long-Term Storage<br>using either the interface<br>function "ArchiveSubmission" or<br>"PreservePO". | The call of the function with this XAIP / BIN as a parameter is<br>possible.                                                                                              |              |
| 2.   | Observe the output of the interface function<br>"ArchiveSubmission" or "PreservePO".                                                                        | A positive feedback is received. No error<br>message or error code<br>occurs. An AOID is assigned and returned.<br>The first version (e.g.<br>v1) of XAIP_OK is assigned. |              |

| Step | Test sequence S.4.2-09                                                                                                                                                                                          | Expected Results                                                                                                                          | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 3.   | Using either the interface function<br>"ArchiveUpdate" or "UpdatePOC" Request and<br>the AOID and the VersionID from step 2 add an<br>additional data element to the already existing archive<br>data object    | The call of the function with a data element and the AOID as<br>parameters is possible.                                                   |              |
| 4.   | Observe the output of the interface function<br>"ArchiveUpdate" or "UpdatePOC".                                                                                                                                 | A positive feedback is received. No error message or error code<br>occurs. A second version<br>(e.g. v2) is assigned.                     |              |
| 5.   | By using either the interface function<br>"ArchiveUpdate" or "UpdatePOC" Request and<br>the AOID from step 2<br>and VersionID from step 4, by<br>removing<br>one<br>existing protectedObjectPointer<br>Element. | The call of the function with this AOID and the empty data<br>element as parameters is possible.                                          |              |
| 6.   | Observe the output of the interface function<br>"ArchiveUpdate"<br>or "UpdatePOC".                                                                                                                              | A positive feedback is received. No error message or error code<br>occurs. A third<br>Version (e.g. v3)<br>is assigned.                   |              |
| 7.   | Using either the interface function<br>"ArchiveRetrieval" or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"", the AOID from step<br>2 and the Version ID from step 6.                                          | The call of the function with this AOID and Version ID as<br>parameters is possible.                                                      |              |
| 8.   | Observe the output of the interface function<br>"ArchiveRetrieval" or "RetrievePO".                                                                                                                             | A positive feedback is received. No error message or error code<br>occurs. An XAIP<br>only in requested version<br>(e.g. v3) is received. |              |
| 9.   | Check whether the data element is included and<br>whether this data element is identical to the data<br>element used in step 3.                                                                                 | The data element is not included.                                                                                                         |              |
| 10.  | Using either the interface function<br>"ArchiveRetrieval" or "RetrievePO"<br>with                                                                                                                               | The call of the function with this AOID and Version ID as<br>parameters is possible.                                                      |              |

| Step | Test sequence S.4.2-09                                                                                                          | Expected Results                                                                                                                    | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------|--------------|
|      | SubjectOfRetrieval "PO"", the AOID from step<br>2 and the Version ID from step 4.                                               |                                                                                                                                     |              |
| 11.  | Observe the output of the interface function<br>"ArchiveRetrieval" or "RetrievePO".                                             | A positive feedback is received. No error message or error code<br>occurs. An XAIP only in requested version (e.g. v2) is received. |              |
| 12.  | Check whether the data element is included and<br>whether this data element is identical to the data<br>element used in step 3. | The data element is included and is identical to the data<br>element used in step 3.                                                |              |
| 13.  | Conditional:<br>test steps from<br>If<br>implemented,<br>LXAIP<br>is<br>No. 1 to No. 12 are to be repeated for LXAIP.           | See expected results of the test cases<br>from No. 1 to No. 12 for<br>LXAIP.                                                        |              |
| 14.  | Conditional:<br>test steps<br>If<br>implemented,<br>ASiC-AIP<br>is<br>from No. 1 to No. 12 are to be repeated for ASiC-AIP.     | See expected results of the test cases from No. 1 to No. 12 for<br>ASiC-AIP.                                                        |              |

#### Verdict of S.4.2-09

#### 4.5.4.2.5 S.4.2-10 – All updates are logged

| Identifier          | S.4.2-10                                                                                                                                                            |  |
|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A5.1-17                                                                                                                                                          |  |
|                     | OVR-7.10-02,<br>PRP-8.1-01,<br>PRP-8.1-06,<br>PRP-8.1-14                                                                                                            |  |
| Test Purpose        | The test shall<br>verify that all changes are logged to a log file.                                                                                                 |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                    |  |
| Pre-test conditions | •<br>Tester has read permissions on the file system.<br>•<br>Test case S.4.2-03 has been performed.<br>•<br>If required, perform identification and authentication. |  |

| Step | Test sequence                                                                          | Expected Results                                                                                                                                                       | Observations |
|------|----------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 4.5  | Check the vendor documentation how and where the<br>middleware records<br>the updates. | A log file exists, the updates are recorded directly within the<br>XAIPs or there is any other type of records, especially for the<br>BINs.                            |              |
| 2.   | Check the log records for update events triggered in<br>test case S.4.2-09.            | All the updates have been logged, incl. the time when the<br>updates were performed, the changed data and the user name<br>of the person/account who updated the data. |              |

| Verdict of S.4.2-10 |  |
|---------------------|--|
|                     |  |
|                     |  |

#### <span id="page-224-0"></span>4.5.4.3 ArchiveRetrieval or RetrievePO and et. Al

4.5.4.3.1 S.4.3-01 – AOID and secure channel is required for ArchiveSubmission, ArchiveUpdate, ArchiveRetrieval, ArchiveEvidence, ArchiveDelete, ArchiveData

| Identifier          | S.4.3-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A5.1-19, MD:A5.1-18, MD:A5.1-20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  |
|                     | M1:A4.0-5, M1:A4.3-1, M1:A4.3-2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
|                     | PRP-8.1-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| Test Purpose        | The test shall<br>verify that the upstream IT applications can send and retrieve any data only through a secure communication channel and only if a valid<br>AOID (if required) is used as a parameter.                                                                                                                                                                                                                                                                                                                                                                                                           |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
| Pre-test conditions | •<br>Tester has read permissions on the Middleware.<br>•<br>If required, perform identification and authentication.<br>•<br>XAIP means XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and "ASiC-AIP" may<br>be supported, if configured.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>•<br>BIN is restricted<br>to the<br>described in clause<br>2, Notice 4.<br>preservation<br>object<br>formats |  |

| Step | Test sequence of S.4.3-01                                                                                      | Expected Results                                                                                                  | Observations |
|------|----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Start a data traffic capture tool to monitor the traffic<br>between upstream client application and ArchiSafe. | Data traffic capturing is started.                                                                                |              |
| 2.   | Store some XAIP_OKs or BINs using either the<br>interface function "ArchiveSubmission" or<br>"PreservePO".     | The calls of the function with this XAIP / BIN as a parameter<br>are possible.                                    |              |
| 3.   | Observe the output of the interface functions<br>"ArchiveSubmission" or "PreservePO".                          | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned per stored object. |              |

| Step | Test sequence of S.4.3-01                                                                                                                                                                                                         | Expected Results                                                                                     | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------|--------------|
| 4.   | Use either the interface function<br>"ArchiveRetrieval" or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" and one AOID from<br>step 2 to request the XAIP.                                                                      | The call of the function with this AOID as a parameter is<br>possible.                               |              |
| 5.   | Observe the output of the interface function<br>"ArchiveRetrieval" or "RetrievePO".                                                                                                                                               | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.      |              |
| 6.   | Use either the interface function<br>"ArchiveRetrieval" or "RetrievePO" with<br>SubjectOfRetrieval "PO"" and an AOID which<br>does not<br>exist to request an XAIP.                                                               | The call of the function with this AOID as a parameter is<br>possible.                               |              |
| 7.   | Observe the output of the interface function<br>"ArchiveRetrievalResponse" or<br>"RetrievePO" Response.                                                                                                                           | A negative feedback will be received. An error message or error<br>code occurs. No XAIP is received. |              |
| 8.   | Use either several "ArchiveUpdate"<br>or<br>"UpdatePOC" functions with the AOIDs from step 2<br>to change the data contained within all the XAIP or<br>XAIP(BIN).                                                                 | The function calls are possible.                                                                     |              |
| 9.   | Check the output of the "ArchiveUpdate" or<br>"UpdatePOC" functions.                                                                                                                                                              | A new version ID per XAIP / XAIP(BIN) is received.                                                   |              |
| 10.  | Use either several interface functions<br>"ArchiveRetrieval" or "RetrievePO"<br>with<br>SubjectOfRetrieval "PO"" and several AOIDs<br>from step 2 together with the respective version IDs<br>from step 11 to request some XAIPs. | The calls of the function with these AOIDs as a parameter are<br>possible.                           |              |

| Step | Test sequence of S.4.3-01                                                                                                                                                                                           | Expected Results                                                                                                                            | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 11.  | Observe the output of the interface functions<br>"ArchiveRetrieval" or "RetrievePO".                                                                                                                                | A positive feedback is received. No error message or error code<br>occurs. The correct versions of all the requested XAIPs are<br>received. |              |
| 12.  | Use either the "ArchiveUpdate"<br>or "UpdatePOC"<br>function with an AOID which does not exist.                                                                                                                     | The function call is possible.                                                                                                              |              |
| 13.  | Check the output of the "ArchiveUpdate" or<br>"UpdatePOC" function.                                                                                                                                                 | A negative feedback will be received. An error message or error<br>code occurs.                                                             |              |
| 14.  | Use either the "ArchiveEvidence" or<br>"RetrievePO" with SubjectOfRetrieval<br>"Evidence" " function with an AOID which does<br>not exist.                                                                          | The function call is possible.                                                                                                              |              |
| 15.  | Check the output of the "ArchiveEvidence" or<br>"RetrievePO" function.                                                                                                                                              | A negative feedback will be received. An error message or error<br>code occurs.                                                             |              |
| 16.  | , use either the "ArchiveData" or the<br>If<br>supported<br>"Search"<br>function with one AOID from step 2 and<br>the dataLocation parameter to identify an individual<br>data element within the XAIP / XAIP(BIN). | The function call is possible.                                                                                                              |              |
| 17.  | Check the output of the "ArchiveData" or the<br>"Search"<br>function.                                                                                                                                               | The requested data value and the original locationValue are<br>received.                                                                    |              |
| 18.  | If supported, use either the "ArchiveData" or the<br>"Search"<br>function with an AOID which does not<br>exist.                                                                                                     | The function call is possible.                                                                                                              |              |
| 19.  | Check the output of the "ArchiveData" or the<br>"Search"<br>function.                                                                                                                                               | A negative feedback will<br>be received. An error message or error<br>code occurs.                                                          |              |

| Step | Test sequence of S.4.3-01                                                                                                   | Expected Results                                                                                                        | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|--------------|
| 20.  | Use either the "ArchiveDeletion" or<br>"DeletePO" function with an AOID which does not<br>exist.                            | The function call is possible.                                                                                          |              |
| 21.  | Check the output of the "ArchiveDeletion" or<br>"DeletePO"<br>function.                                                     | A negative feedback will be received. An error message or error<br>code occurs.                                         |              |
| 22.  | Use either the "ArchiveDeletion" or "DeletePO"<br>function with one AOID from step 2 to delete the<br>XAIP / BIN.           | The function call is possible.                                                                                          |              |
| 23.  | Check the output of the "ArchiveDeletion" or<br>"DeletePO" function.                                                        | The XAIP / BIN has been deleted from the storage.                                                                       |              |
| 24.  | Stop the data traffic capture tool.                                                                                         | Data traffic capturing is stopped.                                                                                      |              |
| 25.  | Check the captured data.                                                                                                    | The captured data is encrypted or otherwise protected. No<br>references to the previous access procedures can be found. |              |
| 26.  | Conditional:<br>test steps from<br>If<br>is<br>implemented,<br>LXAIP<br>No. 1 to No. 34 are to be repeated for LXAIP.       | See expected results of the test cases from No. 1 to No. 34 for<br>LXAIP.                                               |              |
| 27.  | Conditional:<br>test steps<br>If<br>implemented,<br>ASiC-AIP<br>is<br>from No. 1 to No. 34 are to be repeated for ASiC-AIP. | See expected results of the test cases from No. 1 to No. 34 for<br>ASiC-AIP.                                            |              |

#### Verdict of S.4.3-01

#### 4.5.4.4 ArchiveEvidence or RetrievePO

#### 4.5.4.4.1 S.4.4-01 – Preservation of evidence possible and does not impair possibility to use documents

| Identifier          | S.4.4-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | MD:A6.1-2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |  |
| Test Purpose        | The test shall<br>verify that<br>•<br>that the middleware is able to create correct electronic Evidence Records for each version of an XAIP so<br>that their authenticity and integrity since the time<br>of archiving is ensured even if changes were performed in the meantime.<br>•<br>the procedures used for the preservation of evidence of signed electronic documents do not impair the ability to continue using the electronic documents<br>from the archive.                                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| Pre-test conditions | •<br>If required, perform identification and authentication.<br>•<br>The call of the function "ArchiveSubmission" or "PreservePO" with a XAIP_OK _Sig as a parameter is possible. A positive feedback is received. No<br>error message or error code occurs. An AOID is assigned.<br>•<br>The call of the function "ArchiveUpdate" or "UpdatePOC" with a valid AOID and for adding a DXAIP_OK<br>as a parameter is possible. A positive<br>feedback is received.<br>No error message or error code occurs. A new Version ID is received.<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and "ASiC-AIP" may<br>be supported, if configured.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured. |  |

| Step | Test sequence of S.4.4-01                                                                                              | Expected Results                                                                                | Observations |
|------|------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|--------------|
| 1.   | Start the Timestamp Renewal process.                                                                                   | The Timestamp Renewal is in process.                                                            |              |
| 2.   | Use the interface function"ArchiveRetrieval<br>or<br>"RetrievePO" with SubjectOfRetrieval<br>"PO"" to request an XAIP. | The call of the function is possible.                                                           |              |
| 3.   | Observe the output<br>"ArchiveRetrievalResponse" or<br>"RetrievePOResponse".                                           | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received. |              |

| Step | Test sequence of S.4.4-01                                                                                                                                                                                                                                   | Expected Results                                                                                                                                                             | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 4.   | Check the retrieved XAIP and especially the content<br>data.                                                                                                                                                                                                | All data objects can successfully be retrieved from the archive<br>system, encapsulated in a valid XAIP as defined in the<br>middleware documentation.                       |              |
|      |                                                                                                                                                                                                                                                             | The actual content data is not modified and can be used as<br>usual.                                                                                                         |              |
| 5.   | Use either the interface function "ArchiveEvidence"<br>or "RetrievePO" with SubjectOfRetrieval<br>"Evidence" and a valid AOID to request the<br>Evidence Records for the XAIP/BIN.                                                                          | The call of the function is possible.                                                                                                                                        |              |
| 6.   | Observe and check the output<br>"ArchiveEvidenceResponse" or<br>"RetrievePOResponse" with the BSI<br>ERVerifyTool.                                                                                                                                          | A positive feedback is received. No error message or error code<br>occurs. The correct Evidence Records in ERS as specified in RFC<br>4998 is received.                      |              |
| 7.   | Use either the interface function "ArchiveEvidence"<br>or "RetrievePO" with SubjectOfRetrieval<br>"Evidence" with a valid AOID and an assigned<br>version ID indicating the very first version to request<br>the Evidence Record for the archived XAIP/BIN. | The call of the function with this AOID and the VersionID as<br>parameters is possible.                                                                                      |              |
| 8.   | Observe and check the output<br>"ArchiveEvidenceResponse" or<br>"RetrievePOResponse" with the BSI<br>ERVerifyTool.                                                                                                                                          | A positive feedback will be received; no error message or error<br>code. A correct Evidence Record in ERS as specified in RFC 4998<br>is received.                           |              |
| 9.   | Evaluate the received Evidence Records from step 7<br>and 9 by using the BSI-ERVerifyTool.                                                                                                                                                                  | The Evidence Records are valid with respect to specification in<br>RFC 4998, and contain the necessary data to prove the integrity<br>and authenticity of the XAIP versions. |              |

| Step | Test sequence of S.4.4-01                                                                                                                                                          | Expected Results                                                                                                                                                                                       | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|      |                                                                                                                                                                                    | The hash values of the Evidence Records from step 4 and one<br>Evidence Record of step 2 are equal and cover therefore<br>the<br>same version of the XAIP/BIN.                                         |              |
|      |                                                                                                                                                                                    | In step 4 there is one Evidence Record for one Version ID.<br>In step 2 for each Version ID of the AOID, there is one Evidence<br>Record which contains evidences for this version of the<br>XAIP/BIN. |              |
|      |                                                                                                                                                                                    | The integrity and authenticity can be proven back to the time<br>of first archival.                                                                                                                    |              |
| 10.  | Start the Hash-tree Renewal process.                                                                                                                                               | The Hash-tree Renewal is in process and finalized.                                                                                                                                                     |              |
| 11.  | Using either the interface function<br>"ArchiveRetrieval" or "RetrievePO with<br>SubjectOfRetrieval "PO"" to request an XAIP.                                                      | The call of the function is possible.                                                                                                                                                                  |              |
| 12.  | Observe the output<br>"ArchiveRetrievalResponse" or<br>"RetrievePOResponse".                                                                                                       | A positive feedback is received. No error message or error code<br>occurs. An XAIP is received.                                                                                                        |              |
| 13.  | Check the retrieved XAIP and especially the content<br>data.                                                                                                                       | All data objects can successfully be retrieved from the archive<br>system, encapsulated in a valid XAIP as defined in the<br>middleware documentation.                                                 |              |
|      |                                                                                                                                                                                    | The actual content data is not modified and can be used as<br>usual.                                                                                                                                   |              |
| 14.  | Use either the interface function "ArchiveEvidence"<br>or "RetrievePO" with SubjectOfRetrieval<br>"Evidence" and a valid AOID to request the<br>Evidence Records for the XAIP/BIN. | The call of the function is possible.                                                                                                                                                                  |              |

| Step | Test sequence of S.4.4-01                                                                                                                                                                                                                                   | Expected Results                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 15.  | Observe and check the output<br>"ArchiveEvidenceResponse" or<br>"RetrievePOResponse" with the BSI<br>ERVerifyTool.                                                                                                                                          | A positive feedback is received. No error message or error code<br>occurs. The correct Evidence Records in ERS as specified in RFC<br>4998 is received.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |              |
| 16.  | Use either the interface function "ArchiveEvidence"<br>or "RetrievePO" with SubjectOfRetrieval<br>"Evidence" with a valid AOID and an assigned<br>version ID indicating the very first version to request<br>the Evidence Record for the archived XAIP/BIN. | The call of the function with this AOID and the Version ID as<br>parameters is possible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |              |
| 17.  | Observe and check the output<br>"ArchiveEvidenceResponse" or<br>"RetrievePOResponse" with the BSI<br>ERVerifyTool.                                                                                                                                          | A positive feedback will be received; no error message or error<br>code. A correct Evidence Record in ERS as<br>specified in RFC 4998<br>is received.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |              |
| 18.  | Evaluate the received Evidence Records from step 14<br>and 16 by using the BSI-ERVerifyTool.                                                                                                                                                                | The Evidence Records are valid with respect to specification in<br>RFC 4998, and contain the necessary data to prove the integrity<br>and authenticity of the XAIP versions.<br>The hash values of the Evidence Records from step 4 and one<br>Evidence Record of step 2 are equal and cover therefore the<br>same version of the XAIP/BIN.<br>In step 4 there is one Evidence Record for one Version ID.<br>In step 2 for each Version ID of the AOID, there is one Evidence<br>Record which contains evidences for this version of the<br>XAIP/BIN.<br>The integrity and authenticity can be proven back to the time<br>of first archival. |              |

| Step | Test sequence of S.4.4-01                                                                                                   | Expected Results                                                             | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------|--------------|
| 19.  | Conditional:<br>test steps from<br>If<br>is<br>implemented,<br>LXAIP<br>No. 1 to No. 12 are to be repeated for LXAIP.       | See expected results of the test cases from No. 1 to No. 12 for<br>LXAIP.    |              |
| 20.  | Conditional:<br>test steps<br>If<br>implemented,<br>ASiC-AIP<br>is<br>from No. 1 to No. 12 are to be repeated for ASiC-AIP. | See expected results of the test cases from No. 1 to No. 12 for<br>ASiC-AIP. |              |

| Verdict of S.4.4-01 |  |  |
|---------------------|--|--|
|                     |  |  |
|                     |  |  |

#### 4.5.4.5 ArchiveDelete or DeletePO

#### 4.5.4.5.1 S.4.5-04 – Deletion of an archive object shall be logged

| S.4.5-04                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| MD:A5.1-33                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |
| OVR-7.10-02,<br>PRP-8.1-01,<br>PRP-8.1-06,<br>PRP-8.1-11,<br>PRP-8.1-12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |
| The test shall<br>verify that every deletion is logged.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |
| CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |  |
| •<br>Tester has read/write permissions on the middleware.<br>•<br>If required, perform identification and authentication.<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and "ASiC-AIP" may<br>be supported, if configured.<br>•<br>The call of the function "ArchiveSubmission" or "PreservePO" with a XAIP_OK_Sig or BIN_OK_Sig as a parameter is possible. A positive feedback<br>is received. No error message or error code occurs. An AOID is assigned.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>•<br>BIN is restricted<br>to the<br>described in clause<br>2, Notice 4.<br>preservation<br>object<br>formats |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |  |

| Step | Test sequence of S.4.5-04                                                                                                                                                         | Expected Results                                                                                               | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Check for the existence of a log file or any other type<br>of records that is used by the middleware to log<br>deletions.                                                         | There is such an event log.                                                                                    |              |
| 2.   | Store an XAIP_OK_SIG<br>or BIN<br>using either the<br>interface function "ArchiveSubmission" or<br>"PreservePO".                                                                  | The call of the function with this XAIP / BIN as a parameter is<br>possible.                                   |              |
| 3.   | Observe the output<br>"ArchiveSubmissionResponse" or<br>"PreservePOResponse".                                                                                                     | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned.                |              |
| 4.   | Using either the interface function<br>"ArchiveDeletion" or "DeletePO" Request and<br>the AOID from step 3, delete the XAIP_OK_SIG<br>or<br>theBIN<br>with a reason for deletion. | The call of the function with this AOID as a parameter is<br>possible.                                         |              |
| 5.   | Observe the output "ArchiveDeletionResponse"<br>or "DeletePOResponse".                                                                                                            | A positive feedback is received. No error message or error code<br>occurs. The XAIP / BIN is deleted.          |              |
| 6.   | Check the log for the log data of the deletion<br>procedure.                                                                                                                      | The log contains all the data about the deletion of the XAIP /<br>BIN including the reason why it was deleted. |              |
| 7.   | Conditional:<br>test steps from<br>If<br>LXAIP<br>is<br>implemented,<br>No. 1 to No. 6 are to be repeated for LXAIP.                                                              | See expected results of the test cases from No. 1 to No. 6 for<br>LXAIP.                                       |              |
| 8.   | Conditional:<br>test steps<br>If<br>ASiC-AIP<br>is<br>implemented,<br>from No. 1 to No. 6 are to be repeated for ASiC-AIP.                                                        | See expected results of the test cases from No. 1 to No. 6 for<br>ASiC-AIP.                                    |              |

Verdict of S.4.5-04

#### 4.5.4.5.2 S.4.5-06 – Deletion should be possible in an irreversible manner

| Identifier          | S.4.5-06                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M1:A4.4-5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |  |
|                     | PRP-8.1-11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |  |
| Test Purpose        | The test shall<br>verify that the ArchiSafe-Module is able to initiate a permanent deletion of XAIPs/BINs in the ECM-/Long-Term Storage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |
| Pre-test conditions | •<br>Tester has administration permissions on the file system.<br>•<br>The middleware user manual is available.<br>•<br>The user manual for the ECM-/Long-Term Storage is available.<br>•<br>The ECM-/Long-Term Storage supports permanent deletion.<br>•<br>Check the ArchiSafe documentation how the permanent deletion in the storage can be configured/initiated.<br>•<br>Configure ArchiSafe and the storage in such a way that the permanent deletion will be used.<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and "ASiC-AIP" may<br>be supported, if configured.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall be configured.<br>• |  |

| Step | Test sequence of S.4.5-06                                                                                                                            | Expected Results                                                                                      | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Store an XAIP_OK<br>or BIN<br>using either the interface<br>function "ArchiveSubmission" or<br>"PreservePO".                                         | The call of the function with this XAIP / BIN as<br>a parameter is<br>possible.                       |              |
| 2.   | Observe the output<br>"ArchiveSubmissionResponse" or<br>'"PreservePOResponse".                                                                       | A positive feedback is received. No error message or error code<br>occurs. An AOID is assigned.       |              |
| 3.   | Use either the interface function<br>"ArchiveDeletion" or "DeletePO" and the AOID<br>from step 2 to request the deletion of the XAIP_OK<br>/<br>BIN. | The call of the function with this AOID as a parameter is<br>possible.                                |              |
| 4.   | Observe the output "ArchiveDeletionResponse"<br>or "DeletePO" Response.                                                                              | A positive feedback is received. No error message or error code<br>occurs. The XAIP / BIN is deleted. |              |
| 5.   | Use all available (administration) functions of<br>ArchiSafe and the storage for attempting to recover<br>the XAIP.                                  | The deleted XAIPs / BINs cannot be recovered.                                                         |              |
| 6.   | Conditional:<br>test steps from<br>If<br>LXAIP<br>is<br>implemented,<br>No. 1 to No. 5 are to be repeated for LXAIP.                                 | See expected results of the test cases from No. 1 to No. 5 for<br>LXAIP.                              |              |
| 7.   | Conditional:<br>test steps<br>If<br>ASiC-AIP<br>is<br>implemented,<br>from No. 1 to No. 5 are to be repeated for ASiC-AIP.                           | See expected results of the test cases from No. 1 to No. 5 for<br>ASiC-AIP.                           |              |

# Verdict of S.4.5-06

#### 4.5.4.6 ArchiveData or Search

#### Pre-supposition:

A product which claims to comply with the "ArchiveData" or the "Search" - functionality according to M.1-04 of this TR has to pass the following test case or prove that it supports functional analogous functions.

#### 4.5.4.6.1 S.4.6-01 – ArchiveData shall require valid AOID and dataLocation

| Identifier          | S.4.6-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M1:A4.6-1, M1:A4.6-2, M1:A4.6-3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
|                     | PRP-8.1-09,<br>PRP-8.1-10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
| Test Purpose        | The test shall<br>verify that the "ArchiveData" or "Search" function will retrieve and return a data element from an XAIP/BIN, if the request is performed<br>with a valid AOID and at least one valid dataLocation parameter.                                                                                                                                                                                                                                                                                                                                                    |  |
|                     | The test shall<br>verify that data elements that are retrieved with an "ArchiveData" or "Search" function are returned as they have been stored originally<br>without being changed.                                                                                                                                                                                                                                                                                                                                                                                              |  |
|                     | The test shall<br>verify that an "ArchiveDataRequest" or "Search" with an invalid AOID returns an understandable error code or error message.                                                                                                                                                                                                                                                                                                                                                                                                                                     |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
| Pre-test conditions | •<br>If required, perform identification and authentication<br>•<br>XAIP means "XAIP" or "LXAIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" may<br>be supported, if configured<br>•<br>BIN is restricted<br>to the<br>described in clause<br>2, Notice 4.<br>preservation<br>object<br>formats<br>•<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 pursuant to [TR-ESOR-TRANS] shall be configured.<br>•<br>The test dispenses if the pre-supposition is not valid. |  |

| Step | Test sequence of S.4.6-01                                                                                      | Expected Results                                                                                                      | Observations |
|------|----------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Store several XAIP_OK's or BIN's using either the<br>interface function "ArchiveSubmission" or<br>"PresevePO". | The calls of the function with this XAIP as a parameter are<br>possible.                                              |              |
| 2.   | Observe the output of either the interface function<br>"ArchiveSubmissionResponse" or<br>"PreservePOResponse". | Positive feedbacks are received. No error messages or error<br>codes are returned. A list of AOIDs has been assigned. |              |

| Step | Test sequence of S.4.6-01                                                                                                                                                                                                                                                                                                                            | Expected Results                                                                                                                               | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 3.   | If<br>interface<br>function<br>ArchiveData<br>the<br>"<br>"<br>or<br>Search"<br>, use either the interface<br>"<br>is<br>implemented<br>function "ArchiveData" or "Search" with one<br>AOID from step 2 with one valid dataLocation<br>parameter to retrieve a data element that has been<br>stored in the XAIP_OK<br>/ BIN<br>in step 1.            | The call of the function with these parameters is possible.                                                                                    |              |
| 4.   | Observe the output "ArchiveDataResponse" or<br>the "SearchResponse".                                                                                                                                                                                                                                                                                 | A positive feedback is received. No error message or error code<br>is returned. The intended data element is received.                         |              |
| 5.   | Compare the retrieved data element with the version<br>that has originally been stored in the XAIP / BIN in<br>step 1.                                                                                                                                                                                                                               | The data elements are equal.                                                                                                                   |              |
| 6.   | ArchiveData<br>If<br>interface<br>function<br>the<br>"<br>"<br>or<br>Search"<br>use either the interface<br>implemented,<br>"<br>is<br>function "ArchiveData" or "Search" with all<br>the<br>AOIDs from step 2 with one<br>valid dataLocation<br>parameter to retrieve the data elements that has been<br>stored in the XAIP_OK's / BIN's in step 1. | The call of the function with these parameters is not possible at<br>all or an error occurs.                                                   |              |
| 7.   | "ArchiveData<br>If<br>the<br>interface<br>function<br>"<br>or<br>Search<br>, use either the interface<br>is<br>implemented<br>"<br>"<br>function "ArchiveData" or "Search" with one<br>AOID from step 2 with two<br>valid dataLocation<br>parameters to retrieve a data element that has been<br>stored in the XAIP_OK<br>/ BIN<br>in step 1.        | The call of the function with these parameters is possible.                                                                                    |              |
| 8.   | Observe the output "ArchiveDataResponse" or<br>the "SearchResponse".                                                                                                                                                                                                                                                                                 | A positive feedback is received. No error message or error code<br>is returned. The data elements of the addressed XAIP / BIN are<br>received. |              |

| Step | Test sequence of S.4.6-01                                                                                                                                                                                                                                           | Expected Results                                                                                             | Observations |
|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------|--------------|
| 9.   | Compare the retrieved data element with the version<br>that has originally been stored in the XAIP / BIN in<br>step 1.                                                                                                                                              | The data elements are equal.                                                                                 |              |
| 10.  | ArchiveData<br>If<br>the<br>interface<br>function<br>"<br>"<br>or<br>Search<br>use either the interface<br>is<br>implemented,<br>"<br>"<br>function "ArchiveData" or "Search" with an invalid<br>AOID and an arbitrary dataLocation parameter.                      | The call of the function with these parameters is possible.                                                  |              |
| 11.  | Observe the output "ArchiveDataResponse" or<br>the "Search"-Response.                                                                                                                                                                                               | A negative feedback is received. An error message or error code<br>is returned. No data element is received. |              |
| 12.  | ArchiveDataRequest<br>If<br>the<br>interface<br>function<br>"<br>"<br>Search<br>, use the<br>or the<br>implemented,<br>"<br>"-Request<br>is<br>interface function "ArchiveData" or "Search"<br>with one AOID from step 2 with an invalid<br>dataLocation parameter. | The call of the function with these parameters is possible.                                                  |              |
| 13.  | Observe the output n "ArchiveDataResponse" or<br>the "Search"-Response.                                                                                                                                                                                             | A negative feedback is received. An error message or error code<br>is returned. No data element is received. |              |
| 14.  | Conditional:<br>test steps from<br>If<br>LXAIP<br>is<br>implemented,<br>No. 1 to No. 13 are to be repeated for LXAIP.                                                                                                                                               | See expected results of the test cases from No. 1 to No. 13 for<br>LXAIP.                                    |              |

|  | Verdict of S.4.6-01 |  |
|--|---------------------|--|
|  |                     |  |
|  |                     |  |

#### 4.5.4.7 S.4.8-01 – Performance Requirements

| Identifier          | S.4.8-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |  |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | There is actually no requirement in the TR, but the TOT shall<br>ensure a suitable performance while executing Archive Requests                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  |
| Test Purpose        | The test shall<br>verify that the TOT is able to ensure a suitable performance while executing Archive Requests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |  |
| Pre-test conditions | •<br>The middleware documentation /user manual is available.<br>•<br>The documentation / user manual for the ECM-/Long-Term Storage is available.<br>•<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].<br>•<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].<br>•<br>XAIP shall<br>be supported, "LXAIP" and "ASiC-AIP" may<br>be supported, if configured.<br>•<br>BIN is restricted<br>to the<br>described in clause<br>2, Notice 4.<br>preservation<br>object<br>formats<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall be configured.<br>•<br>•<br>The execution of the necessary Archive Requests is possible with the help of a configurable time control.<br>•<br>About 30 threads can be started for about 60 seconds.<br>•<br>There are 5 types of (L)XAIPs ready to be used for a PreservePO-Request (TR-S.S512) or ArchiveSubmisseionRequest<br>(TR-S.4):<br>< 50 MB<br>< 100 MB<br>< 500 MB<br>< 1 GB MB<br>> 1 GB. |  |

| Step | Test sequence of S.4.8-01                           | Expected Results                                          | Observations |
|------|-----------------------------------------------------|-----------------------------------------------------------|--------------|
| 1.   | Check the documentation of the TOT and (optionally) | The documentation of ArchiSafe and (optional) of the ECM- |              |
|      | of the ECM-/Long-Term Storage, if there are any     | /Long-Term Storage contain some assertions and related    |              |
|      | assertions and related conditions or constraints    |                                                           |              |

| Step | Test sequence of S.4.8-01                                                                                                                                                                                                                                                                                                                                                                                                                                   | Expected Results                                                                                   | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|--------------|
|      | regarding the performance of the TOT while<br>executing Archive Requests (means for example: how<br>long does proceeding of a request with an archive<br>object of the size x take)                                                                                                                                                                                                                                                                         | conditions or constraints regarding the performance of the<br>TOT while executing Archive Requests |              |
| 2.   | Store an XAIP_OK or BIN_OK using either the<br>interface function "ArchiveSubmission" or<br>"PreservePO" and measure the assured<br>performance for executing the function, i.e. the<br>reaction time within which the<br>"ArchiveSubmissionRequest" or<br>"PreservePO" Request will be answered by an<br>"ArchiveSubmissionResponse" or<br>"PreservePO" Response. Please take care to just<br>measure the TOT performance, not other<br>modules/systems.   | The measure confirms the assured performance                                                       |              |
| 3.   | Store a XAIP_OK_Sig or BIN_OK_Sig using either the<br>interface function "ArchiveSubmission" or<br>"PreservePO" and measure the assured<br>performance to execute the request, i.e. the reation<br>time within which the<br>"ArchiveSubmissionRequest" or<br>"PreservePO" Request will be answered by an<br>"ArchiveSubmissionResponse" or<br>"PreservePO" Response. Please take care to just<br>measure the TOT performance, not other<br>modules/systems. | The measure confirms the assured performance                                                       |              |
| 4.   | Repeat steps 2 and 3 at least with 3 data objects which<br>differ notably in the size.                                                                                                                                                                                                                                                                                                                                                                      | The measure confirms the assured performance                                                       |              |

| Step | Test sequence of S.4.8-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Expected Results                             | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|--------------|
| 5.   | Use the AOID retrieved in step 2 for calling an<br>"ArchiveRetrievalRequest" or "RetrievePO"<br>with SubjectOfRetrieval "PO"" Request for the<br>retrieval of the corresponding XAIP_OK / BIN_OK and<br>measure the assured performance to execute the<br>request, i. e. measure the reaction time within which<br>the "ArchiveRetrievalRequest" or<br>"RetrievePORequest"<br>with<br>SubjectOfRetrieval "PO"" will be answered by<br>an "ArchiveRetrievalResponse" or<br>"RetrievePOResponse". Please take care to just<br>measure the TOT performance, not other<br>modules/systems.         | The measure confirms the assured performance |              |
| 6.   | Use the AOID retrieved in step for calling an<br>"ArchiveRetrievalRequest" or "RetrievePO"<br>with SubjectOfRetrieval "PO"" Request for the<br>retrieval of the corresponding XAIP_OK_Sig or<br>BIN_OK_Sig and measure the assured performance to<br>execute the request, i. e. measure the reaction time<br>whithin which the "ArchiveRetrievalRequest"<br>or "RetrievePORequest"<br>with<br>SubjectOfRetrieval "PO"" will be answered by<br>an "ArchiveRetrievalResponse" or<br>"RetrievePOResponse". Please take care to just<br>measure the TOT performance, not other<br>modules/systems. | The measure confirms the assured performance |              |
| 7.   | Repeat steps 5 and 6 with the AOID's retrieved in step<br>4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | The measure confirms the assured performance |              |

| Step | Test sequence of S.4.8-01                                                                                                  | Expected Results                                                            | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|--------------|
| 8.   | Conditional:<br>test steps from<br>If<br>implemented,<br>LXAIP<br>is<br>No. 1 to No.7 are to be repeated for LXAIP.        | See expected results of the test cases from No. 1 to No. 7 for<br>LXAIP.    |              |
| 9.   | Conditional:<br>test steps<br>If<br>implemented,<br>ASiC-AIP<br>is<br>from No. 1 to No. 7 are to be repeated for ASiC-AIP. | See expected results of the test cases from No. 1 to No. 7 for<br>ASiC-AIP. |              |

| Verdict of S.4.8-01 |  |  |  |
|---------------------|--|--|--|
|                     |  |  |  |
|                     |  |  |  |

#### <span id="page-246-0"></span>4.5.4.8 Verify or ValidateEvidence

The test cases of the "Verify" or "ValidateEvidence"- function of the interface S.1 (sec. [4.5.1](#page-191-5) …) are also relevant here.

<span id="page-247-1"></span><span id="page-247-0"></span>4.5.4.8.1 S.4.9-01 – Verify or ValidateEvidence – Validation of digital signature, of Evidence Records and supplemented evidence data (including certificates, certificate status information and certificate path validation according to the signature validation policy) and of Archive Information Package (AIP)

| Identifier          | S.4.9-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |  |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M1:A3.2-1, M1:A3.2-2, M1:A4.0-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  |
|                     | M2:A5.1-9, M2:A5.1-10, M2:A5.1-11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |
|                     | OVR-6.2-06,<br>OVR-7.5-01,<br>PRP-8.1-08,<br>OVR-9.3-01,<br>OVR-9.3-02                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
| Test Purpose        | The function is able to verify whether the user certificate used to generate the digital signature was valid at the time the digital signature was generated or<br>validated ([TR-ESOR-PEPT, clause 7.7.3.2). Validity validation shall<br>be complete, i.e. it includes the entire certificate chain back to a trustworthy root<br>certificate or trust anchor according to the preservation evidence policy (PEP) derived from [TR-ESOR-PEPT]<br>of the TR-ESOR-Product Manufacturer or<br>respectively of the preservation service .<br>The Cryptographic-Module shall<br>be able to verify digital signatures (advanced and qualified electronic signatures and seals).<br>Qualified time-stamps with digital signatures as well as Evidence Records as DXAIPs shall<br>be verifiable, i.e. the validity of the time-stamp digital signature at<br>the time of time-stamp generation shall<br>be verified. |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |  |
| Pre-test conditions | •<br>Preservation Evidence Policy (PEP) of the TR-ESOR-Product Manufacturer, based<br>on the BSI-[TR-ESOR-PEPT], is present and published.<br>•<br>Preservation Profile is present and published.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |  |
|                     | •<br>"Signature Validation Policy"56 and "Time-Stamp Validation Policy"57 are present and published.<br>•<br>An XAIP_OK_Sig_Q / BIN_OK_Sig_Q is present. XAIP_OK_Sig_Q / BIN_OK_Sig_Q is a XAIP_OK_SIG<br>/ BIN<br>with qualified<br>electronic signature or<br>seal or time-stamp.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |  |
|                     | •<br>An XAIP_OK_Sig_A / BIN_OK_Sig_A is present. XAIP_OK_Sig_A / BIN_OK_Sig_A is a XAIP_OK_SIG<br>/ BIN<br>with advanced<br>electronic signature or<br>seal or time-stamp.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |  |
|                     | •<br>An XAIP_OK_Sig_Q_ERS is present. XAIP_OK_Sig_Q_ERS is a XAIP_OK_SIG_OK_ER<br>with qualified<br>electronic signature or seal or time-stamp and                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |  |

 <sup>56</sup> See <http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-xaip> or [http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify](http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-xaip/chain)[xaip/chain](http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-xaip/chain) or http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-xaip/shell.

<sup>57</sup> See http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-timestamp or [http://www.bsi.bund.de/DE/tr](http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-timestamp/chain)[esor/sigpolicy/verify-timestamp/chain](http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-timestamp/chain) or http://www.bsi.bund.de/DE/tr-esor/sigpolicy/verify-timestamp/shell.

| Identifier | S.4.9-01                                                                                                                                                                                                                                 |
|------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|            | at least one evidence record.                                                                                                                                                                                                            |
|            | •<br>An XAIP_OK_Sig_A_ERS is present. XAIP_OK_Sig_A_ERS is a XAIP_OK_SIG_OK_ER<br>with advanced<br>electronic signature or seal or time-stamp and<br>at least one evidence record.                                                       |
|            | •<br>An XAIP_NOK_Sig_Q / BIN_NOK_Sig_Q is present. XAIP_NOK_Sig_Q / BIN_NOK_Sig_Q is a XAIP_NOK_SIG<br>/ BIN_NOK_SIG<br>with qualified<br>electronic signature or seal or time-stamp.                                                    |
|            | •<br>An XAIP_NOK_Sig_A / BIN_NOK_Sig_A is present. XAIP_NOK_Sig_A / BIN_NOK_Sig_A is a XAIP_NOK_SIG<br>/ BIN_NOK_SIG with advanced<br>electronic signature or seal or time-stamp.                                                        |
|            | •<br>An XAIP_NOK_Sig_Q_ERS is present. XAIP_NOK_Sig_Q_ERS is a XAIP_NOK_SIG_OK_ER<br>with qualified<br>electronic signature or seal or time-stamp<br>and at least one evidence record.                                                   |
|            | •<br>An XAIP_NOK_Sig_A_ERS is present. XAIP_NOK_Sig_A_ERS is a XAIP_NOK_SIG_OK_ER<br>with advanced electronic signature or seal or time-stamp<br>and at least one evidence record.                                                       |
|            | •<br>An XAIP_NOK_ERS is present. XAIP_NOK_ERS is a XAIP_NOK_ER<br>with qualified<br>electronic signature or seal or time-stamp and at least one<br>evidence record.                                                                      |
|            | •<br>A DXAIP_OK_SIG is present. DXAIP_OK_SIG is a DXAIP_OK_SIG<br>with qualified<br>or advanced electronic signature or seal or (qualified) time-stamp<br>referenced to an XAIP_OK.                                                      |
|            | •<br>A DXAIP_NOK_SIG is present. DXAIP_NOK_SIG is a DXAIP_NOK_SIG<br>with qualified<br>or advanced electronic signature or seal or (qualified) time<br>stamp referenced to an XAIP_OK.                                                   |
|            | •<br>An XAIP_NOK_SIGSHELL_OK_SIGCHAIN with qualified<br>or advanced electronic signature or seal is present.                                                                                                                             |
|            | •<br>An XAIP_NOK_TSPSHELL_OK_TSPCHAIN with (qualified) time-stamp is present.                                                                                                                                                            |
|            | •<br>A DXAIP_NOK_SIGSHELL_OK_SIGCHAIN with qualified<br>or advanced electronic signature or seal is present.                                                                                                                             |
|            | •<br>A DXAIP_NOK_TSPSHELL_OK_TSPCHAIN with (qualified) time-stamp is present.                                                                                                                                                            |
|            | •<br>Conditional: The Verification Report pursuant to<br>[TR-ESOR-VR] supports the element <CertifictePathValidationStrategy>.                                                                                                           |
|            | •<br>Developer documents are present                                                                                                                                                                                                     |
|            | •<br>If the Cryptographic-Module is not a certified signature product (e. g. according to BSI-TR-03112) a suitable test-bed should<br>be used to verify the<br>correctness of the implementation of the signature-related functionality. |
|            | •<br>XAIP means "XAIP" or "LXAIP" or "ASiC-AIP" pursuant to [TR-ESOR-F].                                                                                                                                                                 |
|            | •<br>DXAIP means "DXAIP" or "DLXAIP" pursuant to [TR-ESOR-F].                                                                                                                                                                            |
|            | •<br>XAIP shall be supported, "LXAIP" and "ASiC-AIP" may<br>be supported, if configured.                                                                                                                                                 |
|            | •<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall be configured.                                                                                                             |
|            | •<br>BIN is restricted<br>to the preservation object formats<br>described in clause<br>2, Notice 4.                                                                                                                                      |

| Step | Test sequence of S.4.9-01                                                                                                                                                                      | Expected Results                                                                                                                                                                                                                                                                                                                                      | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Transfer the archival information package<br>XAIP_OK_Sig_Q / BIN_OK_Sig_Q (see pre-test<br>conditions)<br>to the TOT using the interface function<br>either "Verify" or "ValidateEvidence".    | The call of the function with this XAIP / BIN as parameter is<br>possible.                                                                                                                                                                                                                                                                            |              |
| 2.   | Observe either the output "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                                   | A positive feedback will be received; no error message or error<br>code. A Verification Report is included either in<br>"VerifyResponse" or "ValidateEvidenceResponse".                                                                                                                                                                               |              |
| 3.   | Examine the Verification Report, if the validity<br>validation would be done by the Cryptographic<br>Module.                                                                                   | The validity validation shall<br>be correct and complete, i.e. it<br>includes the entire certificate chain back to a trustworthy root<br>certificate or trust anchor according<br>to the preservation<br>evidence policy (PEP) derived from [TR-ESOR-PEPT]<br>of the<br>TR-ESOR-Product Manufacturer or respectively of the<br>preservation service . |              |
| 4.   | Transfer the archival information package<br>XAIP_OK_Sig_A / BIN_OK_Sig_A (see pre-test<br>conditions)<br>to the TOT<br>using the interface function<br>either "Verify" or "ValidateEvidence". | The call of the function with this XAIP / BIN as parameter is<br>possible.                                                                                                                                                                                                                                                                            |              |
| 5.   | Observe either the output "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                                   | A positive feedback will be<br>received; no error message or error<br>code. A Verification Report is included either in<br>"VerifyResponse" or "ValidateEvidenceResponse".                                                                                                                                                                            |              |
| 6.   | Examine the Verification Report, if the validity<br>validation would be done by the Cryptographic<br>Module.                                                                                   | The validity validation shall<br>be correct and complete, i.e. it<br>includes the entire certificate chain back to a trustworthy root<br>certificate or trust anchor according to the preservation<br>evidence policy (PEP) derived from [TR-ESOR-PEPT]<br>of the<br>TR-ESOR-Product Manufacturer or respectively of the<br>preservation service.     |              |

| Step | Test sequence of S.4.9-01                                                                                                                                                                                                                          | Expected Results                                                                                                                                                          | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 7.   | Transfer the archival information package<br>XAIP_NOK_Sig_Q / BIN_NOK_Sig_Q (see pre-test<br>conditions) to the TOT using the interface function<br>either "Verify" or "ValidateEvidence"<br>(conditional) asking for a Verification Report.       | The call of the function with this XAIP / BIN as parameter is<br>possible.                                                                                                |              |
| 8.   | Observe either the output "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                                                                                       | A negative feedback will be received with error message and<br>error code. A Verification Report is included either<br>in"VerifyResponse" or "ValidateEvidenceResponse".  |              |
| 9.   | Examine the Verification Report if the validity<br>validation would be done by the Cryptographic<br>Module.                                                                                                                                        | The Verification Reports includes Verification Report<br>structures for the digital signatures, time-stamps, Evidence<br>Records and the XAIP.                            |              |
| 10.  | Transfer the archival information package<br>XAIP_NOK_Sig_A / BIN_NOK_Sig_A (see pre-test<br>conditions) to the TOT<br>using<br>the interface function<br>either "Verify" or "ValidateEvidence"<br>(conditional) asking for a Verification Report. | The call of the function with this XAIP / BIN as parameter is<br>possible.                                                                                                |              |
| 11.  | Observe either the output "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                                                                                       | A negative feedback will be received with error message and<br>error code. A Verification Report is included either in<br>"VerifyResponse" or "ValidateEvidenceResponse". |              |
| 12.  | Examine the Verification Report if the validity<br>validation would be done by the Cryptographic<br>Module.                                                                                                                                        | The Verification Reports includes verification report structures<br>for the digital signatures, time-stamps, Evidence Records and<br>the XAIP.                            |              |
| 13.  | Transfer the archival information package<br>XAIP_OK_Sig_Q_ERS (see pre-test conditions) to the<br>TOT using the interface function either "Verify" or<br>"ValidateEvidence".                                                                      | The call of the function with this XAIP as parameter is possible.                                                                                                         |              |

| Step | Test sequence of S.4.9-01                                                                                                                                                        | Expected Results                                                                                                                                                                                                                                                                                                                               | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 14.  | Observe either the output "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                     | A positive feedback will be received; no error message or error<br>code. A Verification Report is either included in<br>"VerifyResponse" or "ValidateEvidenceResponse".<br>The validation of the ER was also successful.                                                                                                                       |              |
| 15.  | Examine the Verification Report if the validity<br>validation would<br>be done by the Cryptographic<br>Module.                                                                   | The validity validation shall be correct and complete, i.e. it<br>includes the entire certificate chain back to a trustworthy root<br>certificate or trust anchor according to the preservation<br>evidence policy (PEP) derived from [TR-ESOR-PEPT]<br>of the<br>TR-ESOR-Product Manufacturer or respectively of the<br>preservation service. |              |
| 16.  | Transfer the archival information package<br>XAIP_OK_Sig_A_ERS (see pre-test conditions) to the<br>TOT<br>using the interface function either "Verify" or<br>"ValidateEvidence". | The call of the function with this XAIP as parameter is possible.                                                                                                                                                                                                                                                                              |              |
| 17.  | Observe either the output "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                     | A positive feedback will be received; no error message or error<br>code. A Verification Report is included either in<br>"VerifyResponse" or "ValidateEvidenceResponse".<br>The validation of the ER was also successful.                                                                                                                       |              |
| 18.  | Examine the Verification Report if the validity<br>validation would be done by the Cryptographic<br>Module.                                                                      | The validity validation shall be correct and complete, i.e. it<br>includes the entire certificate chain back to a trustworthy root<br>certificate or trust anchor according to the preservation<br>evidence policy (PEP) derived from [TR-ESOR-PEPT]<br>of the<br>TR-ESOR-Product Manufacturer or respectively the<br>preservation service.    |              |
| 19.  | Transfer the archival information package<br>XAIP_NOK_Sig_Q_ERS (see pre-test conditions) to the<br>TOT using the interface function either "Verify" or                          | The call of the function with this XAIP as parameter is possible.                                                                                                                                                                                                                                                                              |              |

| Step | Test sequence of S.4.9-01                                                                                                                                                                                                           | Expected Results                                                                                                                                                          | Observations |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|      | "ValidateEvidence" asking for a Verification<br>Report.                                                                                                                                                                             |                                                                                                                                                                           |              |
| 20.  | Observe either the output "VerifyResponse" or<br>"ValidateEvidenceResponse"e.                                                                                                                                                       | A negative feedback will be received with error message and<br>error code. A Verification Report is included either in<br>"VerifyResponse" or "ValidateEvidenceResponse". |              |
| 21.  | Examine the Verification Report if the validity<br>validation would be done by the Cryptographic<br>Module.                                                                                                                         | The Verification Reports includes verification report structures<br>for the digital signatures, time-stamps, Evidence Records and<br>the XAIP.                            |              |
| 22.  | Transfer the archival information package<br>XAIP_NOK_Sig_A_ERS (see pre-test conditions) to the<br>TOT<br>using the interface function either "Verify" or<br>"ValidateEvidence" (conditional) asking for a<br>Verification Report. | The call of the function with this XAIP as parameter is possible.                                                                                                         |              |
| 23.  | Observe either the output "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                                                                        | A negative feedback will be received with error message and<br>error code. A Verification Report is included in either<br>"VerifyResponse" or "ValidateEvidenceResponse". |              |
| 24.  | Examine the Verification Report if the validity<br>validation would be done by the Cryptographic<br>Module.                                                                                                                         | The Verification Reports includes verification report structures<br>for the digital signatures, time-stamps, Evidence Records and<br>the XAIP.                            |              |
| 25.  | Transfer the archival information package<br>XAIP_NOK_ERS (see pre-test conditions) to the TOT<br>using either the interface function "Verify" or<br>"ValidateEvidence" (conditional) asking for a<br>Verification Report.          | The call of the function with this XAIP as parameter is possible.                                                                                                         |              |

| Step | Test sequence of S.4.9-01                                                                                                                                                                                                   | Expected Results                                                                                                                                                                                                                                                                                                                               | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 26.  | Observe either the output "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                                                                | A negative feedback will be received with error message and<br>error code. A Verification Report is included either in<br>"VerifyResponse" or "ValidateEvidenceResponse" .                                                                                                                                                                     |              |
| 27.  | Examine the Verification Report if the validity<br>validation would be done by the Cryptographic<br>Module.                                                                                                                 | The Verification Reports includes verification report structures<br>for the digital signatures, time-stamps, Evidence Records and<br>the XAIP.                                                                                                                                                                                                 |              |
| 28.  | Transfer the archival information package<br>DXAIP_OK_SIG (see pre-test conditions) to the TOT,<br>using either the interface function "Verify" or<br>"ValidateEvidence".                                                   | The call of the function with this DXAIP_OK_SIG as parameter<br>is possible.                                                                                                                                                                                                                                                                   |              |
| 29.  | Observe either the output of the interface function<br>"VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                                   | A positive feedback will be received; no error message or error<br>code. A Verification Report is included either in<br>"VerifyResponse" or "ValidateEvidenceResponse".<br>The validation of the DXAIP_OK_SIG was also successful.                                                                                                             |              |
| 30.  | Examine the Verification Report if the validity<br>validation would be done by the Cryptographic<br>Module.                                                                                                                 | The validity validation shall be correct and complete, i.e. it<br>includes the entire certificate chain back to a trustworthy root<br>certificate or trust anchor according to the preservation<br>evidence policy (PEP) derived from [TR-ESOR-PEPT]<br>of the<br>TR-ESOR-Product Manufacturer or respectively of the<br>preservation service. |              |
| 31.  | Transfer the archival information package<br>DXAIP_NOK_SIG (see pre-test conditions) to the TOT<br>using either the interface function "Verify" or<br>"ValidateEvidence" (conditional) asking for a<br>Verification Report. | The call of the function with this DXAIP_NOK_OK as parameter<br>is possible.                                                                                                                                                                                                                                                                   |              |

<span id="page-254-1"></span><span id="page-254-0"></span>

| Step | Test sequence of S.4.9-01                                                                                                                                                                                                                                                                                                                                                                                                                          | Expected Results                                                                                                                                                                           | Observations |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
| 32.  | Observe either the output of the interface function<br>"VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                                                                                                                                                                                                                                                          | A negative feedback will be received with error message and<br>error code. A Verification Report is included either in<br>"VerifyResponse" or "ValidateEvidenceResponse" .                 |              |
| 33.  | Examine the Verification Report if the validity<br>validation would be done by the Cryptographic<br>Module.                                                                                                                                                                                                                                                                                                                                        | The Verification Reports includes verification report structures<br>for the digital signatures, time-stamps, Evidence Records and<br>the XAIP.                                             |              |
| 34.  | Transfer the archival information package<br>XAIP_NOK_SIGSHELL_OK_SIGCHAIN (see pre-test<br>conditions) to the TOT using either the interface<br>function "Verify" or "ValidateEvidence"<br>(conditional)<br>asking for a Verification Report.<br>Conditional:<br>on base<br>of<br>the<br>signature<br>policy<br>http://www.bsi.bund.de/DE/tr<br>esor/sigpolicy/verify-xaip/shell<br>defined by<br>VerifyUnderSignaturePolicy58 input<br>parameter | The call of the function with this<br>XAIP_NOK_SIGSHELL_OK_SIGCHAIN as parameter is possible.                                                                                              |              |
| 35.  | Observe either the output "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                                                                                                                                                                                                                                                                                       | A negative feedback will be received with error message and<br>error code. A (conditional) Verification Report is included<br>either in "VerifyResponse" or<br>"ValidateEvidenceResponse". |              |
| 36.  | Conditional:<br>If<br>the<br>Verification<br>Report<br>pursuant to<br>[TR-ESOR-VR]<br>the<br>element<br>supports                                                                                                                                                                                                                                                                                                                                   | The<br>Verification<br>includes<br>the<br>element<br>Report<br>in<br><CertifictePathValidationStrateg<br>y> the<br>content<br>"59<br>"uri:oid:1<br>.3.6.1.4.1.8301.3.5.2                   |              |

<span id="page-254-2"></span><sup>58</sup> See clause 3.7.1 [TR-ESOR-E]

<sup>59</sup> The CertifictePathValidationStrategy-element shall contain one of the following values:

<span id="page-255-0"></span>

| Step | Test sequence of S.4.9-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Expected Results                                                                                                                                                                      | Observations |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|      | <CertifictePathValidationStrateg<br>y>,<br>examine<br>this<br>element.                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                       |              |
| 37.  | Transfer<br>the<br>archival<br>information<br>package<br>(see<br>XAIP<br>NOK<br>TSPSHELL<br>OK<br>TSPCHAIN<br>pre-test<br>_<br>_<br>_<br>_<br>conditions)<br>to the<br>using<br>the<br>interface<br>function<br>TOT<br>Verify<br>ValidateEvidence<br>either<br>"<br>"<br>or "<br>"<br>(conditional)<br>asking<br>for<br>a Verification<br>Report.<br>Conditional<br>on base<br>of<br>the<br>policy<br>signature<br>http://www.bsi.bund.de/DE/tr<br>esor/sigpolicy/verify-xaip/chain<br>defined by<br>VerifyUnderSignaturePolicy58 input<br>parameter | The call of the function with this<br>XAIP_NOK_SIGSHELL_OK_SIGCHAIN as parameter is possible.                                                                                         |              |
| 38.  | Observe either the output "VerifyResponse" or<br>"ValidateEvidenceResponse".                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | A positive feedback will be received, no error message or error<br>code. A (conditional) Verification Report is included either in<br>"VerifyResponse" or "ValidateEvidenceResponse". |              |
| 39.  | Conditional:<br>If<br>the<br>Verification<br>Report<br>pursuant<br>to[TR-ESOR-VR]<br>the<br>element<br>supports<br><CertifictePathValidationStrateg<br>y>,                                                                                                                                                                                                                                                                                                                                                                                           | The<br>Verification<br>includes<br>the<br>element<br>Report<br>in<br><CertifictePathValidationStrateg<br>y> the<br>content<br>"60<br>"uri:oid:1<br>.3.6.1.4.1.8301.3.5.1              |              |

3. uri:oid:1.3.6.1.4.1.8301.3.5.2<sup>59</sup> – the certificate path has been validated pursued to the shell-validation-model

4. uri:oid:1.3.6.1.4.1.8301.3.5.1 – the certificate path has been validated pursued to the chain-validation-model (c.f. [Common-PKI]).

<sup>60</sup> The CertifictePathValidationStrategy-element shall contain one of the following values:

- 5. uri:oid:1.3.6.1.4.1.8301.3.5.2<sup>60</sup> the certificate path has been validated pursued to the shell-validation-model
- 6. uri:oid:1.3.6.1.4.1.8301.3.5.1 the certificate path has been validated pursued to the chain-validation-model (c.f. [Common-PKI]).

| Step | Test sequence of S.4.9-01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Expected Results                                                                                                                                                                                   | Observations |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|      | examine<br>this<br>element.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                    |              |
| 40.  | Conditional:<br>If<br>the<br>element<br>•<br>VerifyUnderSignaturePolicy58 and<br>•<br>ReturnVerificationReport58<br>of the<br>dss:OptionalInputs either of the<br>Verify<br>interface<br>function<br>"<br>"<br>or<br>ValidateEvidence<br>"<br>"<br>if<br>Verification<br>is<br>supported,<br>and<br>the<br>Report<br>pursuant<br>to[TR-ESOR-VR]<br>supports<br>the element<br>•<br><CertifictePathValidationStr<br>ategy>,<br>examine,<br>whether<br>the<br>OID<br>in<br>the<br><CertifictePathValidationStrateg<br>y><br>in<br>matches<br>with<br>the<br>[PEP]<br>the Verification Report<br>,<br>To-Do-7<br>.7.3-4. | If supported:<br>The<br>Verification<br>includes<br>the<br>element<br>Report<br><CertifictePathValidationStrateg<br>y> and<br>matches<br>with<br>[PEP],<br>and.<br>To-Do-7.7.3-4<br>To-Do-7.7.5-2. |              |
| 41.  | Conditional:<br>test steps from<br>If<br>LXAIP<br>is<br>implemented,<br>No. 1 to No. 33 are to be repeated for LXAIP.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | See expected results of the test cases from No. 1 to No. 33<br>for<br>LXAIP.                                                                                                                       |              |
| 42.  | Conditional:<br>test steps<br>If<br>ASiC-AIP<br>is<br>implemented,<br>from No. 1 to No. 33 are to be repeated for ASiC-AIP.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | See expected results of the test cases from No. 1 to No. 33 for<br>ASiC-AIP.                                                                                                                       |              |

#### Verdict S.4.9-01

#### 4.5.4.8.2 S.4.9-02 – Verify or ValidateEvidence - Unavailable CRL results in invalid certificate

#### Pre-supposition:

A product which claims to use CRLs for certificate validation instead of OCSPs has to pass this test case.

| Identifier          | S.4.9-02                                                                                                                                                                                                                                                                                                                                |  |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Requirement         | M2:A5.1-18                                                                                                                                                                                                                                                                                                                              |  |
| Test Purpose        | If CRLs are used for certificate validation instead of OCSPs and the CRL is not available or CRL inquiries failed (or the repository, which hosts the CRL<br>cannot accept inquiries), then the respective certificate will be classified as invalid.                                                                                   |  |
| Configuration       | CONFIG_ArchiSafe                                                                                                                                                                                                                                                                                                                        |  |
| Pre-test conditions | •<br>Certificate of a Trust Service Provider which supports CRLs instead of OCSPs is present.<br>Either the TR-S.4 interface or the TS119512 interface TR-S.512 in the profiling of [TR-ESOR-TRANS] shall<br>•<br>be configured.<br>•<br>BIN is restricted<br>to the preservation object formats<br>described in clause<br>2, Notice 4. |  |

| Step | Test sequence                                                                                                                                                                  | Expected Results                                                                                                              | Observations |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------|--------------|
| 1.   | Sign the XAIP_OK<br>/ DXAIP_OK_SIG / BIN<br>archival information package using a valid and not<br>expired certificate issued by a Trust Service Provider,<br>which offers CRL. | The signed XAIP_OK<br>/ DXAIP_OK_SIG / BIN<br>was created<br>successfully.                                                    |              |
| 2.   | Configure the Cryptographic-Module for using CRL.                                                                                                                              | Configuration of the Cryptographic-Module was successful.                                                                     |              |
| 3.   | Block the network connection to the repository,<br>which hosts the CRL.                                                                                                        | The network connection to CRL is blocked.                                                                                     |              |
| 4.   | Transfer the signed XAIP_OK<br>/ DXAIP_OK_SIG /<br>BIN<br>to the TOT using the interface function either<br>"Verify" or "ValidateEvidence" pursuant to<br>TR-S.4 or TR-S.512.  | The call of the function with this XAIP_OK<br>/<br>DXAIP_OK_SIG / BIN<br>as parameter is possible.                            |              |
| 5.   | Observe either the output "VerifyResponse" or<br>"ValidateEvidenceresponse".                                                                                                   | A negative feedback will be received in form of an error<br>message or error code. The certificate was classified as invalid. |              |

#### Verdict of S.4.9-02

### 4.5.5 Interface S.5

The TR-ESOR-S.5 interface enables accesses from the ArchiSafe-Module or (conditional) the Download-Module to the ECM-/Long-Term Storage without technical dependence of the cryptographically secured Evidence Records.

<span id="page-258-0"></span>This is an interface of a component not part of the TR-ESOR middleware. Therefore, no conformity tests can be specified here.

## <span id="page-259-2"></span>4.5.6 Interface S.6

The archiving of (new) archival information packages is possible with the TR-ESOR-S.6 interface described here, which can be used to include the ArchiSig-Module directly in the archiving procedure. This is a direct way to generate the securing hash values. Thus, it is impossible to circumvent this security function.

#### Pre-supposition:

A product, which claims to functionally comply with the Interface S.6 specification of this TR has to pass all test cases in this section or prove that it supports functional analogous interfaces.

4.5.6.1 ArchiveSubmission

The test cases of the "ArchiveSubmission" or "PreservePO" function of the interface TR-S.4 (sec. [4.5.4.1\)](#page-193-1) are also relevant here.

4.5.6.2 ArchiveUpdate

The test cases of the "ArchiveUpdate" or "UpdatePOC" - function of the interface TR-S.4 (sec. [4.5.4.2\)](#page-209-0) are also relevant here.

4.5.6.3 ArchiveEvidence

<span id="page-259-0"></span>The test cases of the "ArchiveEvidence" or "RetrievePO with SubjectOfRetrieval "Evidence"" - function of the interface TR-S.4 (sec[. 4.5.4.3\)](#page-224-0) are also relevant here.

## 4.6Annex [TR-ESOR-F]

<span id="page-259-1"></span>All requirements of Annex TR-ESOR-F are tested at the respective modules or interfaces.