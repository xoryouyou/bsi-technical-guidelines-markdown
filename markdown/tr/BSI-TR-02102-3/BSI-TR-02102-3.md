![](_page_0_Picture_0.jpeg)

# Technische Richtlinie TR-02102-3 Kryptographische Verfahren: Empfehlungen und Schlüssellängen

Teil 3 – Verwendung von Internet Protocol Security (IPsec) und Internet Key Exchange (IKEv2)

![](_page_0_Picture_5.jpeg)

## Änderungshistorie

*Tabelle 1: Änderungshistorie*

| Version | Datum      | Beschreibung                                                      |  |
|---------|------------|-------------------------------------------------------------------|--|
| 2019-01 | 11.02.2019 | Anpassung der Verwendungszeiträume, Empfehlung des CCM-Modus      |  |
| 2020-01 | 31.01.2020 | Anpassung der Verwendungszeiträume, Abkündigung von HMAC-SHA-1    |  |
| 2021-01 | 12.03.2021 | Anpassung der Verwendungszeiträume                                |  |
| 2022-01 | 24.01.2022 | Anpassung der Verwendungszeiträume                                |  |
| 2023-01 | 17.01.2023 | Anhebung des Sicherheitsniveaus auf 120 Bit, Anpassung der        |  |
|         |            | Verwendungszeiträume                                              |  |
| 2024-01 | 29.02.2024 | Anpassung der Verwendungszeiträume                                |  |
| 2024-02 | 13.09.2024 | Empfehlung zusätzlicher<br>Schlüssellängen für RSA-PSS-Signaturen |  |
| 2025-01 | 21.01.2025 | Anpassung der Verwendungszeiträume                                |  |

Bundesamt für Sicherheit in der Informationstechnik Postfach 20 03 63 53133 Bonn Tel.: +49 22899 9582-0 E-Mail: TR02102@bsi.bund.de Internet: https://www.bsi.bund.de © Bundesamt für Sicherheit in der Informationstechnik 2025

| 1 |       | Einleitung                                          | 4 |
|---|-------|-----------------------------------------------------|---|
|   | 1.1   | Spezifikationen und Internetstandards               | 4 |
| 2 |       | Grundlagen                                          | 5 |
|   | 2.1   | IKEv2<br>                                           | 5 |
|   | 2.1.1 | Schlüsselableitung und Schlüsselerzeugung<br>       | 6 |
|   | 2.1.2 | Lifetime<br>                                        | 7 |
|   | 2.1.3 | Rekeying                                            | 7 |
|   | 2.1.4 | RNG/Zufall                                          | 7 |
|   | 2.1.5 | Perfect Forward Secrecy (PFS)<br>                   | 8 |
|   | 2.2   | IPsec<br>                                           | 8 |
|   | 2.2.1 | ESP und AH                                          | 8 |
|   | 2.2.2 | Tunnel-<br>und Transportmodus                       | 8 |
|   | 2.2.3 | SAD und SPD                                         | 8 |
| 3 |       | Empfehlungen10                                      |   |
|   | 3.1   | Allgemeine Hinweise10                               |   |
|   | 3.1.1 | Verwendungszeiträume<br>10                          |   |
|   | 3.1.2 | Sicherheitsniveau10                                 |   |
|   | 3.1.3 | Einsatz quantensicherer Verfahren10                 |   |
|   | 3.2   | IKEv2<br>10                                         |   |
|   | 3.2.1 | Verschlüsselung der IKE-Nachrichten10               |   |
|   | 3.2.2 | Pseudo-Zufallsfunktion zur Schlüsselerzeugung11     |   |
|   | 3.2.3 | Integritätsschutz der IKE-Nachrichten11             |   |
|   | 3.2.4 | Gruppen für den Diffie-Hellman-Schlüsselaustausch12 |   |
|   | 3.2.5 | Authentisierungsverfahren12                         |   |
|   | 3.3   | IPsec<br>13                                         |   |
|   | 3.3.1 | Verschlüsselung der ESP-Pakete<br>13                |   |
|   | 3.3.2 | Integritätsschutz der ESP-Pakete<br>14              |   |
|   | 3.3.3 | Integritätsschutz der AH-Pakete<br>14               |   |
|   | 3.4   | SA-Lifetime und Rekeying<br>14                      |   |
|   |       | Literaturverzeichnis16                              |   |

### <span id="page-3-0"></span>1 Einleitung

Diese Technische Richtlinie (TR) gibt Empfehlungen für die Verwendung von kryptographischen Mechanismen in den Protokollen IPsec (Kurzform für Internet Protocol Security) und IKE (Kurzform für Internet Key Exchange). Sie enthält ausschließlich Empfehlungen für die Version 2 des IKE-Protokolls (IKEv2). In dieser TR werden keine Aussagen zu IKEv1 getroffen; die Verwendung des neueren Protokolls IKEv2 wird für Neuentwicklungen grundsätzlich empfohlen. IKEv2 besitzt Vorteile gegenüber IKEv1, die aber hauptsächlich mit der Komplexität des Protokolls und der benötigten Bandbreite beim Aufbau einer Security Association (siehe auch weiter unten) zu tun haben.

IPsec ermöglicht eine sichere Übertragung von Informationen in IP-basierten Datennetzwerken, wobei insbesondere die Vertraulichkeit, die Integrität und die Authentizität der mittels des IP-Protokolls übertragenen Informationen gewährleistet werden können. Es gibt zwei IPsec-Protokolle:

- *Authentication Header (AH)* gewährleistet die Integrität sowie die Authentizität der mittels des IP-Protokolls übertragenen Daten. Es findet kein Schutz der Vertraulichkeit der übertragenen Daten statt.
- *Encapsulated Security Payload (ESP)* gewährleistet neben den durch AH realisierten Schutzzielen zusätzlich den Schutz der Vertraulichkeit.

Die hier aufgeführten Schutzziele werden durch kryptographische Sicherheitsmechanismen erreicht. IPsec bietet darüber hinaus noch weitere Schutzmechanismen wie z. B. einen Schutz gegen das Wiedereinspielen (Replay-Attacke) von bereits verarbeiteten IPsec-Paketen. Diese werden in der vorliegenden TR nicht betrachtet.

Ein fundamentales Konzept von IPsec ist die *Security Association (SA)*. Dabei handelt es sich um eine IPsecgesicherte Verbindung zwischen zwei Kommunikationspartnern inkl. der zugehörigen kryptographischen Parameter, Algorithmen, Schlüssel und Betriebsmodi für diese Verbindung. Mit dem Protokoll IKEv2 kann eine SA ausgehandelt werden. Die Vorgaben dafür müssen im Voraus durch einen Sicherheitsadministrator festgelegt werden. IPsec ermöglicht dann die eigentliche gesicherte Nutzdatenübertragung auf der Ebene von IP-Paketen basierend auf der vorher ausgehandelten SA. Der Begriff SA existiert analog für IKEv2. Dabei werden IPsec-SAs (Child-SAs) von vorher ausgehandelten IKE-SAs abgeleitet.

**Hinweis:** Auch bei Beachtung aller Vorgaben für die Verwendung von IKEv2 und IPsec können Daten in erheblichem Umfang aus einem kryptographischen System abfließen, z. B. durch Ausnutzung von Seitenkanälen (Messung von Timing-Verhalten, Stromaufnahme, Datenraten etc.) oder durch fehlerhafte Konfiguration der Sicherheitsprotokolle auf den Ablaufplattformen. Daher sollte der Entwickler unter Hinzuziehung von Experten auf diesem Gebiet mögliche Seitenkanäle identifizieren und entsprechende Gegenmaßnahmen umsetzen. Je nach Anwendung gilt dies auch für Fault-Attacken.

**Hinweis:** Für Definitionen kryptographischer Begriffe in diesem Dokument siehe das Glossar in [TR-02102- 1].

### <span id="page-3-1"></span>1.1 Spezifikationen und Internetstandards

Die Protokolle IKEv2 (bzw. IKE) und IPsec wurden in verschiedenen RFCs spezifiziert. Für IKEv2 (bzw. IKE) gibt es die RFCs 2409, 4306, 4718, 5282, 5996, 5998, 7296, 7427, und 8247 (ersetzt RFC 4307). Für IPsec gelten beispielsweise die RFCs 4106, 4301, 4302, 4303, 4308, 4309, 4543 und 8221 (ersetzt RFCs 7321 und 4835).

Diese Technische Richtlinie gibt Empfehlungen für die Protokolle IKEv2 und IPsec, und orientiert sich primär an den zurzeit aktuellen Protokollversionen und RFCs. Für Implementierungen ist RFC 7296 (Vorgängerversion RFC 5996) besonders wichtig, da er eine umfangreiche Überarbeitung von vorigen Standards sowie Klarstellungen aus RFC 4718 enthält.

### <span id="page-4-0"></span>2 Grundlagen

#### <span id="page-4-1"></span>2.1 IKEv2

Das IKE-Protokoll läuft zwischen zwei IP-basierten Kommunikationssystemen ab, die über ein (möglicherweise) unsicheres Netz mittels IPsec verschlüsselt kommunizieren möchten. IKE ermöglicht die Aushandlung und ggf. Erneuerung (Schlüsselwechsel) des dafür zu verwendenden Schlüsselmaterials.

Das IKE-Protokoll existiert in zwei Versionen: Die erste Version (IKEv1) wurde im Jahre 1998 in RFC 2409 spezifiziert. Die derzeit aktuelle Version IKEv2 ist in den drei IETF-Dokumenten RFC 4306, RFC 5996 sowie RFC 7296 spezifiziert. RFC 7296 ist eine Überarbeitung von RFC 5996 sowie RFC 4306. Die Aufgaben des IKE-Protokolls können wie folgt zusammengefasst werden:

- 1. Aushandlung der für IKE zu verwendenden Kryptoalgorithmen und Kryptoparameter für den Aufbau eines verschlüsselten und integritätsgesicherten Kanals, der zwischen zwei über das IP-Protokoll in einem nicht vertrauenswürdigen Netz kommunizierenden Parteien aufgebaut werden soll
- 2. Aufbau eines verschlüsselten und integritätsgesicherten Kanals unter Verwendung der in Punkt 1 ausgehandelten kryptographischen Verfahren
- 3. Gegenseitige Authentisierung der beiden Parteien
- 4. Aushandlung der für IPsec zu verwendenden kryptographischen Algorithmen, Betriebsarten, Schlüssellängen sowie des IPsec-Protokolls (AH oder ESP). Diese Aushandlung geschieht unter dem Schutz des in 2. aufgebauten Kanals
- 5. Erzeugung der IPsec-Schlüssel bei beiden Kommunikationspartnern unter Berücksichtigung der in 4. ausgehandelten Algorithmen

Alle Kommunikationsabläufe innerhalb von IKE bestehen immer aus einer *Request*- und einer *Response*-Nachricht. Beide Nachrichten zusammen bilden einen *Austausch*. Die beiden beteiligten Systeme bzw. Kommunikationspartner heißen im IKE-Protokoll traditionell *Initiator* und *Responder*.

Bei IKEv2 gibt es die vier folgenden Austauscharten:

- IKE\_SA\_INIT
- IKE\_AUTH
- CREATE\_CHILD\_SA
- INFORMATIONAL

IKE\_SA\_INIT (Schritte 1 und 2) und IKE\_AUTH (Schritte 3 und 4) werden dabei zu Beginn des IKE-Ablaufes durchgeführt. Nach erfolgreichem Abschluss von IKE\_AUTH sind bei beiden kommunizierenden Parteien IKE-Sicherheitsbeziehungen (IKE Security Association, kurz IKE-SAs) sowie Sicherheitsbeziehungen für die IPsec-Protokolle AH oder ESP (Child-SAs, d. h. IPsec-SAs) vorhanden. Die IKE-SA beinhaltet die gegenseitige Authentisierung von Initiator und Responder sowie das Vorhandensein einer verschlüsselten und integritätsgesicherten Verbindung zwischen beiden (Schritte 1 bis 3 erfolgreich durchlaufen). Ein CREATE\_CHILD\_SA-Austausch ist optional und ermöglicht zum Beispiel das Erneuern des Schlüsselmaterials einer vorhandenen IPsec-SA auf Basis einer bestehenden IKE-SA. Dies bedeutet die Wiederholung der Schritte 4 und 5 unter dem Schutz der bestehenden IKE-SA und wird nach Ablauf der vorher festgelegten Lifetime durchgeführt.

Weiterhin gibt es auch INFORMATIONAL-Exchanges für den Austausch von Fehlermeldungen und anderer Nachrichten zwischen Initiator und Responder. Für Details wird auf die Abschnitte 1.4 und 1.5 in [RFC 7296] verwiesen.

Für Details zum IKE-Ablauf wird auf das IETF-Dokument [RFC 7296] verwiesen.

#### <span id="page-5-0"></span>2.1.1 Schlüsselableitung und Schlüsselerzeugung

Der Begriff *Schlüsselableitung* beschreibt hier das Erzeugen von kryptographischem Schlüsselmaterial sowohl für IKE-SAs als auch für IPsec-SAs. Ein wesentliches Kernelement der Schlüsselableitung in IKE ist ein Diffie-Hellman-Schlüsselaustausch sowie die Berechnung des Schlüsselmaterials mit einer sog. Pseudo-Zufallsfunktion (engl. pseudorandom function, kurz PRF).

Die Berechnung für das Schlüsselmaterial für die IKE-SA findet zeitlich nach dem IKE\_SA\_INIT-Austausch und vor dem IKE\_AUTH-Austausch statt. Die *erste* IKE\_SA\_INIT-Nachricht enthält in der SA-Payload folgende Vorschläge des Initiators bzgl. der zu verwendenden Algorithmen:

- 1. Symmetrischer Verschlüsselungsalgorithmus für die Verschlüsselung der IKE-Nachrichten des IKE\_AUTH-Austausches und des optionalen CREATE\_CHILD\_SA-Austausches sowie eventuelle INFORMATIONAL-Austauschvorgänge
- 2. Pseudo-Zufallsfunktion (PRF) zur Schlüsselableitung
- 3. Algorithmus zum Integritätsschutz der anschließend übertragenen IKE-Nachrichten
- 4. Diffie-Hellman-Gruppe für die Diffie-Hellman-Schlüsselvereinbarung. Eine Diffie-Hellman-Gruppe ist dabei entweder eine Primzahl *p* zusammen mit einem Generator *g* der zyklischen Gruppe (*Zp*) \* oder elliptische Kurvenparameter zusammen mit einem Basispunkt als Generator einer Untergruppe der Punktegruppe. Es werden dabei lediglich die standardisierten Bezeichner einer DH-Gruppe übertragen. Für die Bezeichner gelten standardisierte Werte, die unter "Transform Type 4" unter [IANA] eingesehen werden können.

Die erste IKE\_SA\_INIT-Nachricht (request) enthält weiterhin:

- Eine Key-Exchange-Payload, die einen öffentlichen Diffie-Hellman-Schlüssel enthält, der vor der Übertragung unter Verwendung der vorgeschlagenen Diffie-Hellman-Gruppe und dem privaten Diffie-Hellman-Schlüssel erzeugt wurde. Für die Erzeugung des privaten Diffie-Hellman-Schlüssel gelten die Empfehlungen aus [TR-02102-1]<sup>1</sup> .
- Den sog. Nonce-Wert des Initiators. Dieser wird zufällig und unvorhersagbar erzeugt, und darf nur einmal verwendet werden.

Die Nonce-Werte Ni und Nr von Initiator und Responder müssen eine Größe von mindestens 16 Byte und maximal 256 Byte haben (siehe [RFC 7296], Abschnitt 3.9). Beide Parteien (Initiator, Responder) berechnen nach dem IKE\_SA\_INIT-Austausch unabhängig voneinander (siehe Abschnitt 2.14 in [RFC 7296]):

- Das Diffie-Hellman shared secret g^ir
- Die Größe SKEYSEED := prf(Ni | Nr, g^ir)

Die Nonce-Werte Ni und Nr sind in der IKE\_SA\_INIT-Nachricht vom Initiator zum Responder übertragen worden (Ni an Responder) und umgekehrt (Nr an Initiator). Sie gehen aneinandergehängt (konkateniert) als Schlüssel in die PRF-Berechnung mit ein. g^ir ist der gemeinsame geheime Schlüssel nach abgeschlossener Diffie-Hellman-Schlüsselvereinbarung. Der Wert SKEYSEED hat die Ausgabelänge der verwendeten Pseudo-Zufallsfunktion.

• Aus SKEYSEED, den Nonces Ni und Nr sowie den SPI-Werten<sup>2</sup> werden mehrere Schlüssel berechnet: prf+(SKEYSEED, Ni| Nr| SPIi| SPIr) = {SK\_d | SK\_ai | SK\_ar | SK\_ei | SK\_er | SK\_pi | SK\_pr}

Dabei sind SPIi und SPIr die eindeutigen Kennzeichner der auszuhandelnden IKE-SA, die jeweils vom Initiator und Responder gebildet werden.

<sup>1</sup> Im Zusammenhang mit der Verwendung von elliptischen Kurven zur Schlüsselvereinbarung sei auf [RFC 6954], Abschnitt 3 hingewiesen: *"…, the private Diffie-Hellman keys should be selected with the same bit length as the order of the group generated by the base point G and with approximately maximum entropy."*

<sup>2</sup> Siehe Abschnitt 2.6 in [RFC 7296].

prf+ bedeutet gemäß [RFC 7296], Abschnitt 2.13 die iterierte Anwendung der vereinbarten Pseudo-Zufallsfunktion, um eine ausreichende Ausgabelänge für die Gesamtmenge der zu erzeugenden Schlüssel zu erreichen. Die Anzahl der Iterationen des PRF-Aufrufes muss dabei so bemessen werden, dass die Summe der Bitlängen von SK\_d, SK\_ai, SK\_ar, SK\_ei, SK\_er, SK\_pi und SK\_pr erreicht wird. Diese Schlüssel haben folgende Bedeutung:

| Schlüssel | Verwendung                                                                          |
|-----------|-------------------------------------------------------------------------------------|
| SK_d      | Ableitung von Schlüsseln für Child-SAs                                              |
| SK_ei     | Symmetrischer Schlüssel zur Verschlüsselung aller weiteren IKE-Nachrichten          |
|           | (IKE_AUTH, CREATE_CHILD_SA, INFORMATIONAL) vom Initiator zum Responder              |
| SK_ai     | Schlüssel für den Integritätsschutz aller weiteren IKE-Nachrichten (IKE_AUTH,       |
|           | CREATE_CHILD_SA, INFORMATIONAL) vom Initiator zum Responder                         |
| SK_er     | Symmetrischer Schlüssel zur Verschlüsselung aller weiteren IKE-Nachrichten          |
|           | (IKE_AUTH, CREATE_CHILD_SA, INFORMATIONAL) vom Responder zum Initiator              |
| SK_ar     | Schlüssel für den Integritätsschutz aller weiteren IKE-Nachrichten (IKE_AUTH,       |
|           | CREATE_CHILD_SA, INFORMATIONAL) vom Responder zum Initiator                         |
| SK_pi     | Schlüssel zur Generierung der AUTH-Payload zur Authentisierung des Initiators beim  |
|           | Responder (beim IKE_AUTH-Exchange). Vgl. auch Abschnitt 2.15 in [RFC<br>7296].      |
| SK_pr     | Schlüssel zur Generierung der AUTH-Payload zur Authentisierung des Responders       |
|           | beim Initiator (beim IKE_AUTH-Exchange). Vgl. auch Abschnitt 2.15 in [RFC<br>7296]. |

*Tabelle 2: Übersicht der wichtigsten Schlüssel*

Die Längen (in Bit) aller oben gelisteten Schlüssel müssen entsprechend den in Kapite[l 3](#page-9-0) empfohlenen Verfahren und deren Bitlängen gewählt werden. Insbesondere sollen die Schlüssellängen von SK\_d, SK\_pi und SK\_pr gemäß der vereinbarten PRF gewählt werden.

#### <span id="page-6-0"></span>2.1.2 Lifetime

Sowohl IKE-SAs als auch IPsec-SAs sollen nur für eine begrenzte Zeit gültig sein und nach Ablauf dieser Zeit neu ausgehandelt werden. Alternativ kann als Kriterium für die Neuaushandlung einer IPsec-SA auch das übertragene Datenvolumen herangezogen werden. Nach [RFC 4301], Abschnitt 4.4.2.1, muss eine IPsec-Implementierung beide Kriterien unterstützen. Die Angabe von verbindlichen Gültigkeitszeiträumen bzw. einer Obergrenze für das Datenvolumen ist Teil einer Sicherheitspolitik und muss vom Systemadministrator festgelegt werden. Im Gegensatz zum alten Protokoll IKEv1 ist die Lifetime von SAs bei IKEv2 nicht mehr aushandelbar (vgl. Seite 37 in [RFC 7296]).

#### <span id="page-6-1"></span>2.1.3 Rekeying

Unter Rekeying versteht man das erneute Aushandeln einer abgelaufenen und damit nicht mehr gültigen Sicherheitsbeziehung. Dies bezieht sich sowohl auf IKE-SAs als auch auf SAs für IPsec. Für beide Fälle wird auf die Beschreibung in [RFC 7296] verwiesen.

#### <span id="page-6-2"></span>2.1.4 RNG/Zufall

Für die Generierung von Zufallszahlen, z. B. für die Erzeugung kryptographischer Schlüssel, für die Signaturerzeugung und für die Erzeugung von Nonces müssen geeignete Zufallszahlengeneratoren eingesetzt werden.

Empfohlen wird ein Zufallszahlengenerator aus einer der Klassen DRG.3, DRG.4, DRT.1, PTG.3 oder NTG.1 gemäß [AIS 20/31], vgl. auch Kapitel 8 in [TR-02102-1].

#### <span id="page-7-0"></span>2.1.5 Perfect Forward Secrecy (PFS)

Perfect Forward Secrecy bedeutet, dass eine abgehörte Verbindung auch bei Kenntnis der Langzeit-Schlüssel der Kommunikationspartner nachträglich nicht entschlüsselt werden kann.

Durch den IKE\_AUTH-Austausch entsteht sowohl das Schlüsselmaterial für die IKE-SA als auch für eine Child-SA. Sollen auf Basis der bestehenden IKE-SA weitere Child-SAs ausgehandelt werden, kann dies nach Abschnitt 2.17 in [RFC 7296] optional unter Verwendung eines erneuten Diffie-Hellman-Schlüsselaustausches geschehen. Dazu werden nach Abschnitt 1.3.1 in [RFC 7296] die öffentlichen Diffie-Hellman-Schlüssel zwischen Initiator und Responder übertragen und anschließend auf beiden Seiten das gemeinsame Diffie-Hellman-Geheimnis berechnet, welches gemäß [RFC 7296], Abschnitt 2.17, in die Sitzungsschlüsselberechnung eingeht.

Die Nutzung von PFS wird grundsätzlich empfohlen.

#### <span id="page-7-1"></span>2.2 IPsec

#### <span id="page-7-2"></span>2.2.1 ESP und AH

Die Sicherheitsdienste der beiden IPsec-Protokolle ESP und AH wurden im Abschnitt [1](#page-3-0) genannt. Für eine genaue Beschreibung wird auf [RFC 4302] (für AH) sowie auf [RFC 4303] (für ESP) verwiesen.

#### <span id="page-7-3"></span>2.2.2 Tunnel- und Transportmodus

Sowohl AH als auch ESP können in zwei Betriebsmodi verwendet werden: *Tunnelmodus* und *Transportmodus*. Im Tunnelmodus werden die IPsec-Schutzmechanismen auf das gesamte IP-Paket (d. h. IP-Header inklusive Schicht-4-Protokoll) angewendet und ein neuer IP-Header vorangestellt. Dieser neue Header enthält die Adressen der kryptographischen Endpunkte (Tunnelenden).

Im Transportmodus hingegen werden die IPsec-Schutzmechanismen nur auf die Nutzdaten des IP- Pakets angewendet und weiterhin der ursprüngliche IP-Header verwendet. Im Gegensatz zum Tunnelmodus werden also die Adressen der gesichert kommunizierenden Systeme nicht verborgen. Ein Angreifer würde beim Abhören der geschützten Verbindung also ggf. Informationen über das Kommunikationsverhalten bzw. über das gesicherte Netz erhalten.

Eine genaue Beschreibung der beiden Betriebsmodi für AH findet sich in [RFC 4302] in den Abschnitten 3.1.1 und 3.1.2. [RFC 4303] enthält in den Abschnitten 3.1.1 und 3.1.2 die Beschreibung der beiden Betriebsmodi für ESP. Die Wahl für den Tunnel- oder Transportmodus hängt von der vorliegenden Anwendung ab (siehe hierzu auch Abschnitt 4 in [RFC 4301]). Grundsätzlich sollte bei der Verwendung von ESP jedoch der Tunnelmodus gegenüber dem Transportmodus bevorzugt werden, da beim Tunnelmodus durch die Verschlüsselung des gesamten inneren IP-Pakets keine verdeckten Kanäle von dem zu schützenden Netzwerk in das nicht vertrauenswürdige Netzwerk bestehen. Zusätzlich ist bei der Verwendung von ESP im Tunnelmodus keine vollständige Verkehrsflussanalyse möglich, weil die Adressinformationen des inneren IP-Headers durch die Verschlüsselung verborgen werden.

#### <span id="page-7-4"></span>2.2.3 SAD und SPD

Die *Security Association Database (SAD)* und die *Security Policy Database (SPD)* sind zwei wichtige IPsec-Datenbanken, die bei der Verarbeitung von IPsec-Paketen verwendet werden (siehe Abschnitte 4.4.1 und 4.4.2 in [RFC 4301] für Details).

Die SPD enthält Regeln, die bestimmen, wie ein- und ausgehende Pakete durch IPsec verarbeitet werden. Dabei werden alle Pakete (auch nicht-IPsec-Pakete) anhand der Regeln in der SPD bearbeitet. Beispielsweise gibt es Regeln, die festlegen, wie die Verbindung zwischen zwei Kommunikationspartnern gesichert ist. Die Sicherung selbst kann dann durch AH oder ESP erfolgen.

In der SAD werden die SAs verwaltet; für jede Verbindung gibt es einen Eintrag in der SAD, der z. B. die Schlüssel für das vereinbarte Sicherheitsprotokoll der Verbindung enthält. Für AH und ESP gibt es separate Einträge in der Datenbank.

**Hinweis:** Die Datenbanken SAD und SPD müssen gesichert gespeichert werden, damit keine Manipulationen durch Angreifer möglich sind.

### <span id="page-9-0"></span>3 Empfehlungen

#### <span id="page-9-1"></span>3.1 Allgemeine Hinweise

#### <span id="page-9-2"></span>3.1.1 Verwendungszeiträume

Die Empfehlungen in dieser Technischen Richtlinie sind mit Verwendungszeiträumen versehen. Die Angabe der Jahreszahl bedeutet hierbei, dass das entsprechende Verfahren bis zum Ende des angegebenen Jahres empfohlen wird. Ist die Jahreszahl mit einem "+"-Zeichen gekennzeichnet, so bedeutet dies, dass dieser Verwendungszeitraum möglicherweise in einer zukünftigen Version dieser Technischen Richtlinie verlängert wird.

#### <span id="page-9-3"></span>3.1.2 Sicherheitsniveau

Das Sicherheitsniveau für alle kryptographischen Verfahren in dieser Technischen Richtlinie richtet sich nach dem in Abschnitt 1.1 in [TR-02102-1] angegebenen Sicherheitsniveau und liegt bei 120 Bit.

#### <span id="page-9-4"></span>3.1.3 Einsatz quantensicherer Verfahren

Die heute eingesetzten klassischen, asymmetrischen kryptographischen Verfahren sind durch die fortschreitende Entwicklung hinreichend großer Quantencomputer bedroht. Teil 1 dieser Technischen Richtline [TR-02102-1] gibt allgemeine Empfehlungen für quantensichere Verfahren. Standards für die Nutzung quantensicherer Verfahren in IKEv2 werden gerade entwickelt und erprobt. Das BSI beabsichtigt, quantensichere Verfahren in dieser Technischen Richtlinie (in hybrider Nutzung mit empfohlenen klassischen Verfahren) zu empfehlen, sobald geeignete Standards verabschiedet wurden.<sup>3</sup>

#### <span id="page-9-5"></span>3.2 IKEv2

In diesem Abschnitt werden Empfehlungen für die folgenden IKE-Komponenten festgelegt:

- 1. Verschlüsselung der IKE-Nachrichten
- 2. Funktion zur Schlüsselableitung bzw. -erzeugung
- 3. Integritätsschutz der IKE-Nachrichten
- 4. Gruppen für den Diffie-Hellman-Schlüsselaustausch
- 5. Verfahren zur gegenseitigen Authentisierung

#### <span id="page-9-6"></span>3.2.1 Verschlüsselung der IKE-Nachrichten

Die Empfehlungen betreffen die Verschlüsselung der im IKE\_AUTH-, CREATE\_CHILD\_SA- sowie INFORMATIONAL-Exchange ausgetauschten Nachrichten. Die folgenden Verschlüsselungsverfahren für IKE werden empfohlen:

<span id="page-9-7"></span>*Tabelle 3: Empfohlene Verschlüsselungsverfahren für IKE-Nachrichten*

| Nr. | Verfahren    | IANA-Nr. | Spezifikation | AES<br>Schlüssellänge | Verwendung<br>bis |
|-----|--------------|----------|---------------|-----------------------|-------------------|
| 1   | ENCR_AES_CBC | 12       | [RFC<br>7296] | 128 / 256             | 2031+             |

<sup>3</sup> [RFC 9370] ermöglicht eine hybride Schlüsseleinigung in IKEv2. Das BSI beabsichtigt, für die quantensichere Schlüsseleinigung die Verfahren ml-kem-768 und ml-kem-1024 aus dem Internet-Draft unte[r https://datatracker.ietf.org/doc/draft-kampanakis-ml-kem-ikev2/](https://datatracker.ietf.org/doc/draft-kampanakis-ml-kem-ikev2/) in Kombination mit einem Schlüsseleinigungsverfahren aus [Tabelle 6](#page-11-2) zu empfehlen, sobald der zugehörige RFC verabschiedet wurde.

| Nr. | Verfahren       | IANA-Nr. | Spezifikation | AES            | Verwendung |
|-----|-----------------|----------|---------------|----------------|------------|
|     |                 |          |               | Schlüssellänge | bis        |
| 2   | ENCR_AES_CTR    | 13       | [RFC<br>5930] | 128 / 256      | 2031+      |
| 3   | ENCR_AES_GCM_16 | 20       | [RFC 5282]    | 128 / 256      | 2031+      |
|     |                 |          | [RFC 8247]    |                |            |
| 4   | ENCR_AES_GCM_12 | 19       | [RFC 5282]    | 128 / 256      | 2031+      |
|     |                 |          | [RFC 8247]    |                |            |
| 5   | ENCR_AES_CCM_16 | 16       | [RFC<br>5282] | 128 / 256      | 2031+      |
| 6   | ENCR_AES_CCM_12 | 15       | [RFC<br>5282] | 128 / 256      | 2031+      |

**Hinweis:** Die ersten beiden Verfahren in [Tabelle 3](#page-9-7) müssen mit einem der in Abschnit[t 3.2.3](#page-10-1) genannten Verfahren zum Schutz der Integrität kombiniert werden. Die Schlüssel für die Verfahren in obiger Tabelle werden nach der in Abschnitt [2.1.1](#page-5-0) angegebenen Vorschrift berechnet. Die hier zur Anwendung kommenden Schlüssel sind SK\_ei und SK\_er.

Für weitere Informationen zu den Betriebsarten GCM und CCM siehe Abschnitt 3.1.2 in [TR-02102-1]. Werden diese Betriebsarten eingesetzt, darf gemäß Abschnitt 8 in [RFC 5282] kein Algorithmus zum Integritätsschutz der übertragenen Nachrichten verwendet werden.

#### <span id="page-10-0"></span>3.2.2 Pseudo-Zufallsfunktion zur Schlüsselerzeugung

Wie in Abschnitt [2.1.1](#page-5-0) erläutert, wird zur Erzeugung von Schlüsselmaterial eine Pseudo-Zufallsfunktion (engl. pseudorandom function, kurz PRF) eingesetzt. Die folgenden PRFs werden empfohlen:

| Nr. | Verfahren         | IANA-Nr. | Spezifikation | Verwendung bis |
|-----|-------------------|----------|---------------|----------------|
| 1   | PRF_AES128_XCBC   | 4        | [RFC<br>4434] | 2031+          |
| 2   | PRF_AES128_CMAC   | 8        | [RFC<br>4615] | 2031+          |
| 3   | PRF_HMAC_SHA2_256 | 5        | [RFC<br>4868] | 2031+          |
| 4   | PRF_HMAC_SHA2_384 | 6        | [RFC<br>4868] | 2031+          |
| 5   | PRF_HMAC_SHA2_512 | 7        | [RFC<br>4868] | 2031+          |

<span id="page-10-2"></span>*Tabelle 4: Empfohlene PRFs zur Schlüsselerzeugung*

**Hinweis:** Die Länge des erzeugten Schlüssels (Ausgabelänge der PRF) muss mindestens so groß sein wie die empfohlene Schlüssellänge des eingesetzten Verschlüsselungsverfahrens aus [Tabelle 3.](#page-9-7) Es ist zu beachten, dass die PRF gemäß Abschnitt 2.13 in [RFC 7296] ggf. mehrfach iterativ aufgerufen werden muss.

Bei Verwendung der Verfahren Nr. 1 und Nr. 2 aus [Tabelle 4](#page-10-2) müssen die entsprechenden Hinweise aus Abschnitt 2.14 in [RFC 7296] beachtet werden.

#### <span id="page-10-1"></span>3.2.3 Integritätsschutz der IKE-Nachrichten

Die folgenden Verfahren werden für die Integritätssicherung der im IKE\_AUTH-, CREATE\_CHILD\_SAsowie INFORMATIONAL-Exchange ausgetauschten Nachrichten empfohlen:

| Nr. | Verfahren              | IANA-Nr. | Spezifikation | Verwendung bis |
|-----|------------------------|----------|---------------|----------------|
| 1   | AUTH_AES_XCBC_96       | 5        | [RFC<br>7296] | 2031+          |
| 2   | AUTH_HMAC_SHA2_256_128 | 12       | [RFC<br>4868] | 2031+          |
| 3   | AUTH_HMAC_SHA2_384_192 | 13       | [RFC<br>4868] | 2031+          |
| 4   | AUTH_HMAC_SHA2_512_256 | 14       | [RFC<br>4868] | 2031+          |

<span id="page-10-3"></span>*Tabelle 5: Empfohlene Verfahren zum Integritätsschutz der IKE-Nachrichten*

**Hinweis:** Die Schlüssellänge für die in [Tabelle 5](#page-10-3) genannten Verfahren muss den geforderten Schlüssellängen in den jeweils angegebenen RFCs entsprechen.

Für Neuentwicklungen wird eines der auf SHA-2 basierenden Verfahren (Nr. 2-4) i[n Tabelle 5](#page-10-3) empfohlen.

#### <span id="page-11-0"></span>3.2.4 Gruppen für den Diffie-Hellman-Schlüsselaustausch

<span id="page-11-2"></span>Die folgenden Gruppen werden für den Schlüsselaustausch mit dem Diffie-Hellman-Verfahren empfohlen: *Tabelle 6: Empfohlene Gruppen für den Diffie-Hellman-Schlüsselaustausch*

| Nr. | Name                     | IANA-Nr. | Spezifikation | Verwendung bis |
|-----|--------------------------|----------|---------------|----------------|
| 1   | 3072-bit MODP Group      | 15       | [RFC<br>3526] | 2031+          |
| 2   | 4096-bit MODP Group      | 16       | [RFC<br>3526] | 2031+          |
| 3   | 256-bit random ECP group | 19       | [RFC<br>5903] | 2031+          |
| 4   | 384-bit random ECP group | 20       | [RFC 5903]    | 2031+          |
| 5   | 521-bit random ECP group | 21       | [RFC 5903]    | 2031+          |
| 6   | brainpoolP256r1          | 28       | [RFC 6954]    | 2031+          |
| 7   | brainpoolP384r1          | 29       | [RFC 6954]    | 2031+          |
| 8   | brainpoolP512r1          | 30       | [RFC 6954]    | 2031+          |

**Hinweis 1:** Zur Realisierung der Eigenschaft *Perfect Forward Secrecy (PFS)* kann im CREATE\_CHILD\_SA-Austausch ein erneuter Diffie-Hellman-Schlüsselaustausch durchgeführt werden. Die dabei empfohlenen elliptischen Kurven und Gruppen sind dabei die gleichen wie in obiger Tabelle.

**Hinweis 2:** Die Verwendung von Brainpool-Kurven wird grundsätzlich empfohlen.

**Hinweis 3:** Eine Verwendung von zusätzlichen Diffie-Hellman-Tests (siehe [RFC 6989]) wird empfohlen. Diese Tests werden besonders beim Einsatz von elliptischen Kurven empfohlen; siehe dazu Abschnitt 2.3 in [RFC 6989].

**Hinweis 4:** Bei den elliptischen Kurven mit den IANA-Nr. 19, 20 und 21 handelt es sich um NIST-Kurven. In [Tabelle 6](#page-11-2) werden die IANA-Bezeichnungen verwendet. Für alternative Bezeichnungen der Kurven (z. B. von NIST) siehe Kapitel 5 in [RFC 5903].

#### <span id="page-11-1"></span>3.2.5 Authentisierungsverfahren

Die folgenden Authentisierungsverfahren werden empfohlen:

*Tabelle 7: Empfohlene Authentisierungsverfahren*

| Nr. | Verfahren                              | Bit<br>länge  | Hash<br>funktion                     | IANA<br>Nr. | Spezifikation            | Verwendung<br>bis |
|-----|----------------------------------------|---------------|--------------------------------------|-------------|--------------------------|-------------------|
| 1   | ECDSA-256 mit Kurve<br>secp256r1       | 256           | SHA-256                              | 9           | [RFC 4754]<br>[RFC 5903] | 2031+             |
| 2   | ECDSA-384 mit Kurve<br>secp384r1       | 384           | SHA-384                              | 10          | [RFC 4754]<br>[RFC 5903] | 2031+             |
| 3   | ECDSA-512 mit Kurve<br>secp521r1       | 512           | SHA-512                              | 11          | [RFC 4754]<br>[RFC 5903] | 2031+             |
| 4   | ECDSA-256 mit Kurve<br>brainpoolP256r1 | 256           | SHA-256                              | 14          | [RFC 7427]               | 2031+             |
| 5   | ECDSA-384 mit Kurve<br>brainpoolP384r1 | 384           | SHA-384                              | 14          | [RFC 7427]               | 2031+             |
| 6   | ECDSA-512 mit Kurve<br>brainpoolP512r1 | 512           | SHA-512                              | 14          | [RFC 7427]               | 2031+             |
| 7   | RSASSA-PSS                             | mind.<br>3000 | SHA-256 /<br>SHA-384<br>/<br>SHA-512 | 14          | [RFC 7427]<br>[RFC 4055] | 2031+             |

| Nr. | Verfahren                                | Bit<br>länge | Hash<br>funktion | IANA<br>Nr. | Spezifikation | Verwendung<br>bis |
|-----|------------------------------------------|--------------|------------------|-------------|---------------|-------------------|
| 8   | ECGDSA-256 mit Kurve<br>brainpoolP256r14 | 256          | SHA-256          | 14          | [RFC 7427]    | 2031+             |
| 9   | ECGDSA-384 mit Kurve<br>brainpoolP384r1  | 384          | SHA-384          | 14          | [RFC 7427]    | 2031+             |
| 10  | ECGDSA-512 mit Kurve<br>brainpoolP512r1  | 512          | SHA-512          | 14          | [RFC 7427]    | 2031+             |

**Hinweis 1:** Die Verfahren RSA (IANA-Nr. 1) und DSS (IANA-Nr. 3) sind in [RFC 7296] nur in Verbindung mit der Hashfunktion SHA-1 spezifiziert. SHA-1 sollte aber aufgrund von Angriffen gegen seine Kollisionsresistenz-Eigenschaften grundsätzlich nicht mehr für die Erstellung von Signaturen verwendet werden. Siehe dazu auch Bemerkung 4.3 in [TR-02102-1]. Stattdessen sollte RSASSA nur in Verbindung mit PSS (siehe Abschnitte 8.1 und 9.1 in [RFC 8017]) und einer Hashfunktion aus der SHA-2-Familie verwendet werden.

**Hinweis 2:** Bei der Erstellung einer ECDSA-Signatur ist zu beachten, dass die Nonce *k* zufällig und gleichverteilt aus dem Intervall [1, *q*–1] gewählt wird, wobei *q* die Ordnung des Basispunkts der elliptischen Kurve ist. Die Nonce ist ebenso wie der Langzeitschlüssel geheim zu halten und muss nach einmaliger Verwendung unmittelbar gelöscht werden. Die in IKEv2 zu signierenden Nachrichten werden in [RFC 7296] im Abschnitt 2.15 beschrieben. Die erstellte Signatur wird in der Authentication Payload übertragen.

**Hinweis 3:** Bei der Authentication Method Nr. 14 [RFC 7427] werden das Signaturverfahren und die Hashfunktion als ASN.1-Objekt direkt vor der eigentlichen Signatur innerhalb der Authentication Payload gespeichert. Das ASN.1-Objekt enthält die OIDs der eingesetzten Verfahren.

Die Technische Richtlinie [TR-02103] enthält Empfehlungen zu X.509-Zertifikaten und Zertifizierungspfadvalidierung.

#### <span id="page-12-0"></span>3.3 IPsec

In diesem Abschnitt werden Vorgaben für die IPsec-Protokolle *Encapsulating Security Payload (ESP)* und *Authentication Header (AH)* gemacht. Es werden Vorgaben und Empfehlungen für die folgenden Sicherheitsziele festgelegt:

- 1. Schutz der Vertraulichkeit der ESP-Pakete durch Verschlüsselung
- 2. Integritätsschutz der ESP-Pakete
- 3. Integritätsschutz der AH-Pakete

#### <span id="page-12-1"></span>3.3.1 Verschlüsselung der ESP-Pakete

Die Empfehlungen betreffen die Verschlüsselung des zu verschlüsselnden Bereichs von ESP-Paketen. Die Empfehlungen sind unabhängig davon, ob der Tunnel- oder Transportmodus von ESP verwendet wird. Für Details über die zu verschlüsselnden Bereiche wird auf die Abschnitte 3.1.1 und 3.1.2 in [RFC 4303] verwiesen.

| Nr. | Verfahren    | IANA-Nr. | Spezifikation | AES<br>Schlüssellänge | Verwendung<br>bis |
|-----|--------------|----------|---------------|-----------------------|-------------------|
| 1   | ENCR_AES_CBC | 12       | [RFC<br>3602] | 128 / 256             | 2031+             |

<span id="page-12-2"></span>*Tabelle 8: Empfohlene Verschlüsselungsverfahren für ESP-Pakete*

<sup>4</sup> Für die Kodierung der ECGDSA-Signaturen siehe Abschnitt 5.2.1 in [TR-03111]. Für die OIDs der ECGDSA-Varianten siehe Abschnitt 5.2.1.2 in [TR-03111]. Für das Public-Key-Format wird auf OID 1.3.36.3.3.2.5 sowie [Teletrust] und Abschnitt 4.4 in [ECGDSA] verwiesen.

| Nr. | Verfahren       | IANA-Nr. | Spezifikation | AES            | Verwendung |
|-----|-----------------|----------|---------------|----------------|------------|
|     |                 |          |               | Schlüssellänge | bis        |
| 2   | ENCR_AES_CTR    | 13       | [RFC<br>3686] | 128 / 256      | 2031+      |
| 3   | ENCR_AES_GCM_16 | 20       | [RFC 4106]    | 128 / 256      | 2031+      |
|     |                 |          | [RFC 8247]    |                |            |
| 4   | ENCR_AES_GCM_12 | 19       | [RFC 4106]    | 128 / 256      | 2031+      |
|     |                 |          | [RFC 8247]    |                |            |
| 5   | ENCR_AES_CCM_16 | 16       | [RFC<br>4309] | 128 / 256      | 2031+      |
| 6   | ENCR_AES_CCM_12 | 15       | [RFC<br>4309] | 128 / 256      | 2031+      |

**Hinweis:** Die ersten beiden Verfahren in [Tabelle 8](#page-12-2) müssen mit einem der in Abschnit[t 3.3.2](#page-13-0) genannten Verfahren zum Schutz der Integrität kombiniert werden. Bei Verwendung der Betriebsarten GCM und CCM muss ein separater Integritätsschutz der ESP-Pakete entfallen.

#### <span id="page-13-0"></span>3.3.2 Integritätsschutz der ESP-Pakete

Die folgenden Empfehlungen betreffen den Integritätsschutz von ESP-Paketen. Die Empfehlungen sind unabhängig davon, ob der Tunnel- oder Transportmodus von ESP verwendet wird. Für Details über die zu sichernden Bereiche innerhalb des ESP-Pakets wird auf [RFC 4303], Abschnitt 3.1.1 und Abschnitt 3.1.2, verwiesen.

| Nr. | Verfahren              | IANA-Nr. | Spezifikation | Verwendung bis |
|-----|------------------------|----------|---------------|----------------|
| 1   | AUTH_AES_XCBC_96       | 5        | [RFC<br>3566] | 2031+          |
| 2   | AUTH_AES_CMAC_96       | 8        | [RFC 4494]    | 2031+          |
| 3   | AUTH_HMAC_SHA2_256_128 | 12       | [RFC<br>4868] | 2031+          |
| 4   | AUTH_HMAC_SHA2_384_192 | 13       | [RFC<br>4868] | 2031+          |
| 5   | AUTH_HMAC_SHA2_512_256 | 14       | [RFC<br>4868] | 2031+          |

<span id="page-13-3"></span>*Tabelle 9: Empfohlene Verfahren für den Integritätsschutz der ESP-Pakete*

Für Neuentwicklungen wird eines der auf SHA-2 basierenden Verfahren (Nr. 3-5) i[n Tabelle 9](#page-13-3) empfohlen.

#### <span id="page-13-1"></span>3.3.3 Integritätsschutz der AH-Pakete

Die folgenden Empfehlungen betreffen die Berechnung des Integrity Check Values (ICV) für die Anwendung im IPsec-Protokoll *Authentication Header (AH)*. Die Empfehlungen sind unabhängig davon, ob der Tunnel- oder Transportmodus von AH verwendet wird. Für Details über die zu sichernden Bereiche innerhalb des AH-Pakets wird auf [RFC 4302], Abschnitt 3.1.1 und Abschnitt 3.1.2, verwiesen.

| Nr. | Verfahren              | IANA-Nr. | Spezifikation | Verwendung bis |
|-----|------------------------|----------|---------------|----------------|
| 1   | AUTH_AES_XCBC_96       | 5        | [RFC<br>3566] | 2031+          |
| 2   | AUTH_AES_CMAC_96       | 8        | [RFC 4494]    | 2031+          |
| 3   | AUTH_HMAC_SHA2_256_128 | 12       | [RFC<br>4868] | 2031+          |
| 4   | AUTH_HMAC_SHA2_384_192 | 13       | [RFC<br>4868] | 2031+          |
| 5   | AUTH_HMAC_SHA2_512_256 | 14       | [RFC<br>4868] | 2031+          |

<span id="page-13-4"></span>*Tabelle 10: Empfohlene Verfahren für den Integritätsschutz der AH-Pakete*

Für Neuentwicklungen wird eines der auf SHA-2 basierenden Verfahren (Nr. 3-5) i[n Tabelle 10](#page-13-4) empfohlen.

#### <span id="page-13-2"></span>3.4 SA-Lifetime und Rekeying

Die Lebensdauer einer SA (SA-Lifetime) soll je nach Sicherheitsanforderung der Anwendung festgelegt werden; dies gilt sowohl für IKE-SAs als auch für IPsec-SAs. In gewöhnlichen Einsatzszenarien soll die IKE- SA-Lifetime maximal 24 h und die IPsec-SA-Lifetime maximal 4 h betragen. Für besondere Szenarien können nach Rücksprache mit einem Experten auch längere SA-Lifetimes verwendet werden.

### <span id="page-15-0"></span>Literaturverzeichnis

**[AIS 20/31]** BSI: AIS 20/31 – A proposal for: Functionality classes for random number generators, 2024

**[ECGDSA]** Erwin Hess, Marcus Schafheutle, Pascale Serf (Siemens AG): The Digital Signature Scheme ECGDSA, 2006, URL[: https://www.teletrust.de/fileadmin/files/oid/ecgdsa\\_final.pdf](https://www.teletrust.de/fileadmin/files/oid/ecgdsa_final.pdf)

**[IANA]** Internet Assigned Numbers Authority (IANA): Internet Key Exchange Version 2 (IKEv2) Parameters, URL[: https://www.iana.org/assignments/ikev2-parameters/ikev2-parameters.xhtml](https://www.iana.org/assignments/ikev2-parameters/ikev2-parameters.xhtml)

**[RFC 2104]** H. Krawczyk, M. Bellare, R. Canetti: RFC 2104, HMAC: Keyed-Hashing for Message Authentication, 1997

**[RFC 2404]** C. Madson, R. Glenn: RFC 2404, The Use of HMAC-SHA-1-96 within ESP and AH, 1998

**[RFC 2409]** D. Harkins, D. Carrel: RFC 2409, The Internet Key Exchange (IKE), 1998

**[RFC 3526]** T. Kivinen, M. Kojo: RFC 3526, More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE), 2003

**[RFC 3566]** S. Frankel, H. Herbert: RFC 3566, The AES-XCBC-MAC-96 Algorithm and Its Use With IPsec, 2003

**[RFC 3602]** S. Frankel, R. Glenn, S. Kelly: RFC 3602, The AES-CBC Cipher Algorithm and Its Use with IPsec, 2003

**[RFC 3686]** R. Housley: RFC 3686, Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP), 2004

**[RFC 4055]** J. Schaad, B. Kaliski, R. Housley: RFC 4055, Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile, 2005

**[RFC 4106]** J. Viega, D. McGrew: RFC 4106, The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP), 2005

**[RFC 4301]** S. Kent, K. Seo: RFC 4301, Security Architecture for the Internet Protocol, 2005

**[RFC 4302]** S. Kent: RFC 4302, IP Authentication Header, 2005

**[RFC 4303]** S. Kent: RFC 4303, IP Encapsulating Security Payload (ESP), 2005

**[RFC 4306]** C. Kaufman (Ed.): RFC 4306, Internet Key Exchange (IKEv2) Protocol, 2005

**[RFC 4307]** J. Schiller: RFC 4307, Cryptographic Algorithms for Use in the Internet Key Exchange Version 2 (IKEv2), 2005

**[RFC 4308]** P. Hoffman: RFC 4308, Cryptographic Suites for IPsec, 2005

**[RFC 4309]** R. Housley: RFC 4309, Using Advanced Encryption Standard (AES) CCM Mode with IPsec Encapsulating Security Payload (ESP), 2005

**[RFC 4494]** JH. Song, R. Poovendran, J. Lee: RFC 4494, The AES-CMAC-96 Algorithm and Its Use with IPsec, 2006

**[RFC 4543]** D. McGrew, J. Viega: RFC 4543, The Use of Galois Message Authentication Code (GMAC) in IPsec ESP and AH, 2006

**[RFC 4615]** J. Song, R. Poovendran, J. Lee, T. Iwata: RFC 4615, The Advanced Encryption Standard-Cipherbased Message Authentication Code-Pseudo-Random Function-128 (AES-CMAC-PRF-128) Algorithm for the Internet Key Exchange Protocol (IKE), 2006

**[RFC 4718]** P. Eronen, P. Hoffman: RFC 4718, IKEv2 Clarifications and Implementation Guidelines, 2006

**[RFC 4754]** D. Fu, J. Solinas: RFC 4754, IKE and IKEv2 Authentication Using the Elliptic Curve Digital Signature Algorithm (ECDSA), 2007

**[RFC 4835]** V. Manral: RFC 4835, Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH), 2007

**[RFC 4868]** S. Kelly, S. Frankel: RFC 4868, Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec, 2007

**[RFC 5114]** M. Lepinski, S. Kent: RFC 5114, Additional Diffie-Hellman Groups for Use with IETF Standards, 2008

**[RFC 5282]** D. Black, D. McGrew: RFC 5282, Using Authenticated Encryption Algorithms with the Encrypted Payload of the Internet Key Exchange version 2 (IKEv2) Protocol, 2008

**[RFC 5903]** D. Fu, J. Solinas: RFC 5903, Elliptic Curve Groups modulo a Prime (ECP Groups) for IKE and IKEv2, 2010

**[RFC 5930]** S. Shen, Y. Mao, NSS. Murthy: RFC 5930, Using Advanced Encryption Standard Counter Mode (AES-CTR) with the Internet Key Exchange version 02 (IKEv2) Protocol, 2010

**[RFC 5996]** C. Kaufman, P. Hoffman, Y. Nir, P. Eronen: RFC 5996, Internet Key Exchange Protocol Version 2 (IKEv2), 2010

**[RFC 5998]** P. Eronen, H. Tschofenig, Y. Sheffer: RFC 5998, An Extension for EAP-Only Authentication in IKEv2, 2010

**[RFC 6954]** J. Merkle, M. Lochter: RFC 6954, Using the Elliptic Curve Cryptography (ECC) Brainpool Curves for the Internet Key Exchange Protocol Version 2 (IKEv2), 2013

**[RFC 6989]** Y. Sheffer, S. Fluhrer: RFC 6989, Additional Diffie-Hellman Tests for the Internet Key Exchange Protocol Version 2 (IKEv2), 2013

**[RFC 7296]** C. Kaufman, P. Hoffman, Y. Nir, P. Eronen, T. Kivinen: RFC 7296, Internet Key Exchange Protocol Version 2 (IKEv2), 2014

**[RFC 7321]** D. McGrew, P. Hoffman: RFC 7321, Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH), 2014

**[RFC 7427]** T. Kivinen, J. Snyder: RFC 7427, Signature Authentication in the Internet Key Exchange Version 2 (IKEv2), 2015

**[RFC 8017]** K. Moriarty, B. Kaliski, J. Jonsson, A. Rusch: RFC 8017, PKCS #1: RSA Cryptography Specification Version 2.2, 2016

**[RFC 8221]** P. Wouters, D. Migault, J. Mattsson, Y. Nir, T. Kivinen: RFC 8221, Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH), 2017

**[RFC 8247]** Y. Nir, T. Kivinen, P. Wouters, D. Migault: RFC 8247, Algorithm Implementation Requirements and Usage Guidance for the Internet Key Exchange Protocol Version 2 (IKEv2), 2017

**[RFC 9370]** CJ. Tjhai, M. Tomlinson, G. Bartlett, S. Fluhrer, D. Van Geest, O. Garcia-Morchon, V. Smyslov: RFC 9370, Multiple Key Exchanges in the Internet Key Exchange Protocol Version 2 (IKEv2), 2023

**[Teletrust]** Teletrust: OID-Datenbank. URL[: https://www.teletrust.de/fileadmin/docs/projekte/oid/OID-](https://www.teletrust.de/fileadmin/docs/projekte/oid/OID-Liste_1_3_36_3_3.pdf)[Liste\\_1\\_3\\_36\\_3\\_3.pdf](https://www.teletrust.de/fileadmin/docs/projekte/oid/OID-Liste_1_3_36_3_3.pdf)

**[TR-02102-1]** BSI: Technische Richtlinie TR-02102-1, Kryptographische Verfahren: Empfehlungen und Schlüssellängen, 2025

**[TR-02103]** BSI: Technische Richtlinie TR-02103, X.509 Zertifikate und Zertifizierungspfadvalidierung, Version 1.0, 2020

**[TR-03111]** BSI: Technical Guideline TR-03111, Elliptic Curve Cryptography, Version 2.10, 2018