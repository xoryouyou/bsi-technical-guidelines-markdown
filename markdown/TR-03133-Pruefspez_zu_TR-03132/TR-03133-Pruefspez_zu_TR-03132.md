![](_page_0_Picture_0.jpeg)

# Technische Richtlinie TR-03133 Prüfspezifikation zur Technischen Richtlinie BSI TR-03132 SiSKo-hD

Version 1.8 24.10.2018

![](_page_0_Picture_4.jpeg)

## <span id="page-1-0"></span>Änderungshistorie

| Version | Datum      | Beschreibung                              |
|---------|------------|-------------------------------------------|
| 1.8     | 11.10.2018 | Anpassung an Version 1.8 der BSI TR-03132 |

Bundesamt für Sicherheit in der Informationstechnik Postfach 20 03 63 53133 Bonn Tel.: +49 22899 9582-0 E-Mail: xhd@bsi.bund.de Internet: https://www.bsi.bund.de © Bundesamt für Sicherheit in der Informationstechnik 2018

|                                | Änderungshistorie 2                                                                                                               |  |
|--------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|--|
| 1                              | Einleitung 5                                                                                                                      |  |
| 1.1                            | Referenzierte Spezifikation 5                                                                                                     |  |
| 1.2                            | Aufbau des Dokuments 5                                                                                                            |  |
| 2                              | Prüfmodule 6                                                                                                                      |  |
| 2.1<br>2.1.1<br>2.1.2          | Inhaltsdatenebene 6<br>Relevante Vorgaben der BSI TR-031326<br>Anwendbarkeit 6                                                    |  |
| 2.1.3                          | Prüffälle 6                                                                                                                       |  |
| 2.2<br>2.2.1<br>2.2.2<br>2.2.3 | Prüfmodul OSCI-Client 9<br>Relevante Vorgaben der BSI TR-031329<br>Anwendbarkeit 9<br>Prüffälle 9                                 |  |
| 2.3<br>2.3.1<br>2.3.2<br>2.3.3 | Prüfmodul OSCI-Intermediär 11<br>Relevante Vorgaben der BSI TR-0313211<br>Anwendbarkeit 11<br>Prüffälle 11                        |  |
| 2.4<br>2.4.1<br>2.4.2<br>2.4.3 | Prüfmodul Empfangssystem des Dokumentenherstellers12<br>Relevante Vorgaben der BSI TR-0313212<br>Anwendbarkeit 12<br>Prüffälle 12 |  |
| 3                              | Abkürzungsverzeichnis 14                                                                                                          |  |
| 4                              | Literaturverzeichnis 15                                                                                                           |  |

| Tabelle 1: Prüffall I-001 Inhaltsdatensignatur 7                               |  |
|--------------------------------------------------------------------------------|--|
| Tabelle 2: Prüffall I-002 Inhaltsdatenverschlüsselung8                         |  |
| Tabelle 3: Prüffall I-003: Bezug des Inhaltsdaten-Verschlüsselungszertifikats9 |  |
| Tabelle 4: Prüffall O-001: OSCI-Nachrichtenerstellung10                        |  |
| Tabelle 5: Prüffall IM-001: OSCI-Intermediärsfunktionalität11                  |  |
| Tabelle 6: Prüffall E-001: OSCI-Eingangsprüfung 12                             |  |
| Tabelle 7: Prüffall E-002: Eingangsprüfung der Inhaltsdatensignatur13          |  |
|                                                                                |  |

## <span id="page-4-2"></span>1 Einleitung

Die technische Richtlinie BSI TR-03132 "Sichere Szenarien für Kommunikationsprozesse im Bereich hoheitlicher Dokumente" legt Anforderungen an die Kommunikationsbeziehungen nach [03104] fest. Sie beschreibt Kommunikationsmodelle für alle Nachrichten zwischen Behörden und Dokumentenherstellern.

Das vorliegende Dokument definiert Prüfanforderungen zur Feststellung der Korrektheit der Umsetzung der in BSI TR-03132 festgelegten Anforderungen.

#### <span id="page-4-1"></span>1.1 Referenzierte Spezifikation

Das vorliegende Dokument ist gültig im Zusammenhang mit BSI TR-03132, Version 1.8.

#### <span id="page-4-0"></span>1.2 Aufbau des Dokuments

Die in BSI TR-03132 definierten Kommunikationsmodelle erstrecken sich in der Beziehung zwischen Behörde und Dokumentenhersteller typischerweise über diverse Verarbeitungsschritte, von der initialen Signatur und Verschlüsselung über den Transport über ggf. verschiedene Akteure bis hin zum Lesen und Verarbeiten der Nachricht auf Empfängerseite.

Infolgedessen sind i.A. auch verschiedene Akteure und verschiedene Software-Module zur Umsetzung der relevanten Funktionalitäten im Einsatz. Aus diesem Grund spezifiziert diese Technische Richtlinie verschiedene Prüfmodule mit durchzuführenden Prüfschritten für verschiedene Teilaspekte des gesamten Kommunikationsszenarios.

Die durchzuführenden Prüfmodule ergeben sich aus der Funktionalität der Software-Module im Rahmen der Kommunikationsmodelle und werden in Abstimmung zwischen Hersteller, Prüfstelle und Zertifizierungsstelle festgelegt.

## <span id="page-5-4"></span>2 Prüfmodule

#### <span id="page-5-3"></span>2.1 Inhaltsdatenebene

#### <span id="page-5-2"></span>2.1.1 Relevante Vorgaben der BSI TR-03132

Dieses Modul dient der Abprüfung der Vorgaben der BSI TR-03132 (Kapitel 4: Kodierung der Inhaltsdatensignatur und -verschlüsselung).

#### <span id="page-5-1"></span>2.1.2 Anwendbarkeit

Diese Prüffälle sind anwendbar auf Softwarekomponenten, welche Signatur- und Verschlüsselungsoperationen auf Inhaltsdatenebene ausführen. Führt ein Modul beide Schritte zusammen aus, muss es das Zwischenergebnis zum Zweck der Prüfung (nur Signatur) separat ausgeben können.

#### <span id="page-5-0"></span>2.1.3 Prüffälle

| Prüffall I-001: Inhaltsdatensignatur                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |  |  |  |  |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|--|--|
| Umfang                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |  |  |  |
| Dieser Prüffall dient zur Überprüfung der korrekten Durchführung der Inhaltsdatensignatur<br>–                                                                                                                                                                                                                                                                                                                                                                                                                 |  |  |  |  |
| Vorbedingungen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |  |  |  |
| Vorlage einer XhD-konformen Nachricht gemäß [03123] vom Typ BestellungDokument                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |  |  |  |
| Vorlage des zugehörigen kryptographischen Materials (Hardware- oder Software-PSE, zugehörige PIN<br>–<br>und Passwort)                                                                                                                                                                                                                                                                                                                                                                                         |  |  |  |  |
| Durchführung einer Signatur der XhD-Nachricht<br>–                                                                                                                                                                                                                                                                                                                                                                                                                                                             |  |  |  |  |
| Prüfschritte                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |  |  |  |
| 1 Zugriff auf den privaten Schlüssel                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |  |  |  |  |
| Erwartetes<br>Das Prüfobjekt muss auf den privaten Schlüssel des Autors Zugriff nehmen können.<br>–                                                                                                                                                                                                                                                                                                                                                                                                            |  |  |  |  |
| Resultat<br>Anmerkung für die Prüfung                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  |  |  |  |
| Für Software-PSE ist die Prüf-Anforderung i.W. trivial (Zugriff auf das Schlüsselmaterial). Im<br>Fall von Hardware-PSE muss geprüft werden, ob es durch das Software-Modul<br>Einschränkungen (z.B. bzgl. der Verwendung bestimmter Kartenleser gibt). Ist nur eine<br>definierte Liste von Kartenlesern für die Verwendung mit der Software freigegeben, so ist<br>jeder Leser dieser Liste zu prüfen; gibt es keine Einschränkung, so ist die Prüfung mit drei<br>marktgängigen Kartenlesern durchzuführen. |  |  |  |  |
| 2 Schema-Konformität der Nachricht                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |  |  |  |  |

| Erwartetes<br>Resultat                         | –                                    | Die Nachricht ist konform zum XhD 1.5-Schema (Namensraum<br>http://www.bsi.de/trxhd/1.5).                                                                                                                                                                                                                                                                                         |  |
|------------------------------------------------|--------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|                                                | –                                    | Das Teilelement Signature ist konform zum [XMLDSIG]-Schema.                                                                                                                                                                                                                                                                                                                       |  |
|                                                | 3 Typus und Platzierung der Signatur |                                                                                                                                                                                                                                                                                                                                                                                   |  |
| Erwartetes<br>Resultat                         | –                                    | Es handelt sich um eine eingebettete Signatur nach [XMLDSIG]. Der Algorithmus<br>Kennzeichner ist http://www.w3.org/2000/09/xmldsig#enveloped<br>signature                                                                                                                                                                                                                        |  |
|                                                | –                                    | Das Signature-Element ist gekapselt im Element any das letzte Element der zu<br>signierenden Daten im XML-Baum.                                                                                                                                                                                                                                                                   |  |
|                                                | –                                    | Die verwendeten CanonicalizationMethod entsprechen den Vorgaben von<br>[XMLDSIG].                                                                                                                                                                                                                                                                                                 |  |
|                                                | –                                    | Das Signature/SignedInfo-Element enthält genau ein Reference-Element mit<br>Wert Leerstring (URI="").                                                                                                                                                                                                                                                                             |  |
|                                                |                                      | 4 Korrekte Verwendung der Hash- und Signatur-Algorithmen                                                                                                                                                                                                                                                                                                                          |  |
| Erwartetes<br>Resultat                         | –                                    | Die Signatur benutzt eine DigestMethod, welche [XMLDSIG] entspricht und vom BSI<br>zugelassen ist.                                                                                                                                                                                                                                                                                |  |
|                                                | –                                    | Die Signatur benutzt eine SignatureMethod, welche [XMLDSIG] entspricht und vom<br>BSI zugelassen ist.1                                                                                                                                                                                                                                                                            |  |
| 5 Korrektheit von Signatur und Hash-Berechnung |                                      |                                                                                                                                                                                                                                                                                                                                                                                   |  |
| Erwartetes<br>Resultat                         | –                                    | Der Hash-Algorithmus wird korrekt berechnet.                                                                                                                                                                                                                                                                                                                                      |  |
|                                                | –                                    | Die Signatur wird korrekt berechnet.                                                                                                                                                                                                                                                                                                                                              |  |
|                                                |                                      | Anmerkung für die Prüfung<br>Das Nachrechnen der Korrektheit ist unabhängig von der existierenden Software auf einem<br>zweiten Weg (manuell oder durch Verwendung anderer Software-Funktionalitäten)<br>nachzuprüfen. Bietet die Software Konfigurationsmöglichkeiten bzgl. verschiedener<br>Algorithmen an, so ist der Prüffall für alle möglichen Kombinationen durchzuführen. |  |

Tabelle 1: Prüffall I-001 Inhaltsdatensignatur

| Prüffall I-002: Inhaltsdatenverschlüsselung                                                                              |  |  |  |  |  |
|--------------------------------------------------------------------------------------------------------------------------|--|--|--|--|--|
| Umfang                                                                                                                   |  |  |  |  |  |
| Dieser Prüffall dient zur Überprüfung der korrekten Durchführung der Inhaltsdatenverschlüsselung<br>–                    |  |  |  |  |  |
| Vorbedingungen                                                                                                           |  |  |  |  |  |
| Vorlage einer XhD-konformen, nach TR-03132 auf Inhaltsdatenebene signierten Nachricht vom Typ<br>–<br>BestellungDokument |  |  |  |  |  |
| Vorlage des zugehörigen kryptografischen Materials (Inhaltsdaten-Verschlüsselungszertifikat des Lesers)<br>–             |  |  |  |  |  |
| Durchführung der Verschlüsselung der XhD-Nachricht auf Inhaltsdatenebene<br>–                                            |  |  |  |  |  |
| Prüfschritte                                                                                                             |  |  |  |  |  |
| 1 Zugriff auf den privaten Schlüssel                                                                                     |  |  |  |  |  |
|                                                                                                                          |  |  |  |  |  |

<span id="page-6-0"></span>1 Vgl. https:/www.bsi.bund.de/Algorithmenkatalog

| Erwartetes<br>Resultat            | Das Prüfobjekt muss auf den privaten Schlüssel des Lesers Zugriff nehmen können.<br>–<br>Anmerkung für die Prüfung<br>Für Software-PSE ist die Prüf-Anforderung i.W. trivial (Zugriff auf das Schlüsselmaterial). Im<br>Fall von Hardware-PSE muss geprüft werden, ob es durch das Software-Modul<br>Einschränkungen (z.B. bzgl. der Verwendung bestimmter Kartenleser gibt). Ist nur eine<br>definierte Liste von Kartenlesern für die Verwendung mit der Software freigegeben, so ist<br>jeder Leser dieser Liste zu prüfen; gibt es keine Einschränkung, so ist die Prüfung mit drei<br>marktgängigen Kartenlesern durchzuführen. |  |
|-----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|                                   | 2 Schema-Konformität der Nachricht                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
| Erwartetes<br>Resultat            | Die Nachricht ist konform zum XhD 1.5-Schema (Namensraum<br>–<br>http://www.bsi.de/trxhd/1.5).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |  |
|                                   | Das Teilelement EncryptedData ist konform zum[XMLENC]-Schema.<br>–                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  |
|                                   | 3 Typus und Platzierung der Verschlüsselung                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |  |
| Erwartetes<br>Resultat            | Es handelt sich um eine Element-Verschlüsselung nach [XMLENC]. Der Algorithmus<br>–<br>http://www.w3.org/2001/04/xmlenc#Element<br>Kennzeichner ist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
|                                   | Die Elemente Nachrichtenkopf und Signature sind unverschlüsselt und gegenüber<br>–<br>dem Input unverändert.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |  |
|                                   | Das Element Nutzdaten ist entfernt und das Element EncryptedData innerhalb des<br>–<br>any-Elements eingefügt.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |  |
|                                   | Es gibt in EncryptedData ein Element EncryptedKey (hybrides<br>–<br>Verschlüsselungsverfahren).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |
|                                   | Es gibt unter EncryptedKey eine KeyInfo-Struktur, welche mittels<br>–<br>X509SubjectName auf das verwendete Inhaltsdaten-Verschlüsselungszertifikat zeigt.                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |  |
|                                   | 4 Korrekte Verwendung der Verschlüsselungsalgorithmen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  |
| Erwartetes<br>Resultat            | Die Verschlüsselung benutzt Algorithmen, welche [XMLENC] entspricht und vom BSI<br>–<br>zugelassen sind (vgl. Signaturprüffall).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |  |
| 5 Korrektheit der Verschlüsselung |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |  |
| Erwartetes<br>Resultat            | Die Verschlüsselung durch den symmetrischen Schlüssel ist mathematisch korrekt.<br>–                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |  |
|                                   | Die Verschlüsselung des symmetrischen Schlüssels durch das Inhaltsdaten<br>–<br>Verschlüsselungszertifikat ist mathematisch korrekt.<br>Anmerkung für die Prüfung<br>Das Nachrechnen der Korrektheit ist unabhängig von der existierenden Software auf einem<br>zweiten Weg (manuell oder durch Verwendung anderer Software-Funktionalitäten)<br>nachzuprüfen. Bietet die Software Konfigurationsmöglichkeiten bzgl. verschiedener<br>Algorithmen an, so ist der Prüffall für alle möglichen Kombinationen durchzuführen.                                                                                                            |  |

Tabelle 2: Prüffall I-002 Inhaltsdatenverschlüsselung

**Prüffall I-003: Bezug des Inhaltsdaten-Verschlüsselungszertifikats**

Umfang

– Dieser Prüffall dient zur Überprüfung des korrekten Bezugs des Inhaltsdaten-Verschlüsselungszertifikats.

Vorbedingungen

– DVDV-Anbindung technisch vorhanden.

– Bezug der vollständigen Dienstbeschreibung gemäß [03132] aus dem DVDV.

#### **Anmerkung für die Prüfung**

Für Nutzungsszenarien, in denen keine DVDV-Anbindung möglich ist, kann das Prüfobjekt auch eine alternative Zuführung des Inhaltsdaten-Verschlüsselungszertifikats vorsehen.

#### Prüfschritte

1 Abruf aus dem DVDV

| Erwartetes<br>Resultat                                                                       | Das Prüfobjekt ruft die korrekte WSDL-Beschreibung aus dem DVDV ab.<br>–                                                                                                                             |  |
|----------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 2 Korrektes Auslesen des Inhaltsdaten-Verschlüsselungszertifikats aus der WSDL-Beschreibung. |                                                                                                                                                                                                      |  |
| Erwartetes<br>Resultat                                                                       | Das Prüfobjekt nutzt das korrekte Zertifikat für die Durchführung der<br>–<br>Inhaltsdatenverschlüsselung.<br>Anmerkung für die Prüfung<br>Dies ist durch Betrachtung erzeugten Chiffrats zu prüfen. |  |

Tabelle 3: Prüffall I-003: Bezug des Inhaltsdaten-Verschlüsselungszertifikats

#### <span id="page-8-3"></span>2.2 Prüfmodul OSCI-Client

#### <span id="page-8-2"></span>2.2.1 Relevante Vorgaben der BSI TR-03132

Dieses Modul dient der Abprüfung der Vorgaben der BSI TR-03132 zur Erstellung der OSCI-Nachrichten im OSCI 1.2-Kommunikationsmodell.

#### <span id="page-8-1"></span>2.2.2 Anwendbarkeit

Diese Prüffälle sind anwendbar auf Softwarekomponenten, welche OSCI 1.2-Nachrichten erstellen. Dies umfasst alle in der BSI TR-03132 geregelten Aspekte einschließlich der Kommunikation mit dem OSCI-Intermediär.

#### <span id="page-8-0"></span>2.2.3 Prüffälle

#### **Prüffall O-001: OSCI-Nachrichtenerstellung**

Umfang

– Dieser Prüffall dient zur Überprüfung der korrekten Erstellung der OSCI-Nachricht **Anmerkung für die Prüfung**

Je nach Kommunikationsrichtung kommen verschiedene Nachrichten als Payload in Frage. Ebenso finden verschiedene OSCI-Nachrichten, je nach OSCI-Szenario Anwendung. Im Rahmen des Prüffalls sind bei den verschiedenen Optionen jeweils die für das Szenario relevanten auszuwählen.

Vorbedingungen

– Vorlage einer XhD-konformen, nach TR-03132 auf Inhaltsdatenebene signierten und verschlüsselten Nachricht vom Typ BestellungDokument oder Auftragsinformation.

| Vollständige DVDV-Dienstbeschreibung gemäß TR-03132 im DVDV oder einem gültigen DVDV-Cache<br>–<br>gemäß Kapitel 3.4.2 der TR-03132 vorhanden.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |  |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|
| –                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | OSCI-Sender-Zertifikat                                                                                                                                                                                                                                                                                                                                                                                                                             |  |  |
| Durchführung der Kommunikation mit einem OSCI-Intermediär, Protokollierung der On-The-Wire<br>–<br>Durchführung der Kommunikation<br>Anmerkung für die Prüfung<br>In der Kommunikation zum Dokumentenhersteller ist die Nutzung eines Test-Intermediärs und eines<br>zugehörigen Backendsystems notwendig. Hierzu kann das Testsystem des Dokumentenherstellers nach<br>[03104] herangezogen werden. Bei auftretenden Fehlern ist hierbei allerdings auch auf ein mögliches<br>Fehlverhalten des Intermediärs bzw. Backendsystems zu achten und deren Spezifikationskonformität zu<br>untersuchen.<br>In der Kommunikation zur Behörde und beim Abholen von Nachrichten durch die Behörde ist ein<br>geeigneter Test-Intermediär zu nutzen. Das korrekte Verhalten des Intermediärs ist analog zu beachten. |                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |  |
| Prüfschritte                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 1 Bezug der DVDV-Dienstbeschreibung                                                                                                                                                                                                                                                                                                                                                                                                                |  |  |
| Erwartetes<br>Resultat                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Der Client bezieht die Dienstbeschreibung aus dem DVDV oder aus einem gültigen DVDV<br>–<br>Cache gemäß Kapitel 3.4.2 der TR-03132.                                                                                                                                                                                                                                                                                                                |  |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 2 Korrektheit der OSCI-Kommunikation                                                                                                                                                                                                                                                                                                                                                                                                               |  |  |
| Erwartetes<br>Resultat                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Alle im Rahmen der OSCI-Kommunikation mit dem Intermediär ausgetauschten<br>–<br>Nachrichten sind konform zum [OSCI].                                                                                                                                                                                                                                                                                                                              |  |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Die jeweils korrekten OSCI-Nachrichtentypen (insbesondere die eigentlichen<br>–<br>Transportnachrichten StoreDelivery und ForwardDelivery) werden verwendet.<br>Anmerkung für die Prüfung<br>Hierzu sind alle im Rahmen des OSCI-Dialogs erzeugten Nachrichten zu untersuchen. Die<br>jeweiligen Abschnitte der OSCI-Spezifikation definieren Schemata für jede Nachricht und ggf.<br>darüber hinausgehende Anforderungen, welche abzuprüfen sind. |  |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 3 Korrektheit der ContentContainer                                                                                                                                                                                                                                                                                                                                                                                                                 |  |  |
| Erwartetes<br>Resultat                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Es gibt genau einen ContentContainer mit der Ref-ID XHD_DATA.<br>–<br>Der ContentContainer ist signiert durch den OSCI-Sender.<br>–                                                                                                                                                                                                                                                                                                                |  |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Die Anforderungen von [OSCI] an die Signatur werden eingehalten.<br>–                                                                                                                                                                                                                                                                                                                                                                              |  |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 4 Einbindung des Autoren-Zertifikats auf OSCI-Ebene                                                                                                                                                                                                                                                                                                                                                                                                |  |  |
| Erwartetes<br>Resultat                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Das im Input auf Inhaltsdatenebene verwendete Autoren-Signatur-Zertifikat wird auf der<br>–<br>Transportebene zusätzlich abgelegt.                                                                                                                                                                                                                                                                                                                 |  |  |
| 5 Korrekte Übernahme der Zertifikate                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                    |  |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Der Client nutzt das korrekte Zertifikat aus der WSDL-Beschreibung als OSCI-Empfänger<br>–<br>Zertifikat.                                                                                                                                                                                                                                                                                                                                          |  |  |

Tabelle 4: Prüffall O-001: OSCI-Nachrichtenerstellung

### <span id="page-10-3"></span>2.3 Prüfmodul OSCI-Intermediär

#### <span id="page-10-2"></span>2.3.1 Relevante Vorgaben der BSI TR-03132

Dieses Modul dient der Abprüfung der Vorgaben der BSI TR-03132, welche an den eingesetzten OSCI-Intermediär gemacht werden.

#### <span id="page-10-1"></span>2.3.2 Anwendbarkeit

Diese Prüffälle sind anwendbar auf die jeweilige OSCI-Intermediärskomponente.

#### <span id="page-10-0"></span>2.3.3 Prüffälle

| Prüffall IM-001: OSCI-Intermediärsfunktionalität                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                        |  |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Umfang                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| –                                                                                                                                                                                                                                              | Dieser Prüffall dient zur Überprüfung der korrekten Funktionalität des OSCI-Intermediärs im OSCI 1.2-<br>Kommunikationsmodell.                                                                                                                                                                                                                                                                         |  |
| Vorbedingungen                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| Durchführung der Kommunikation mit einem OSCI-Client, Protokollierung der On-The-Wire<br>–<br>Durchführung des Protokolls                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| Ggf. Durchführung der Kommunikation mit einem Backendsystem (bei passivem OSCI-Szenario),<br>–<br>Protokollierung der On-The-Wire-Durchführung des Protokolls<br>Anmerkung für die Prüfung                                                     |                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| Fokus der Prüfung sind insbesondere die Aspekte des Intermediär-Betriebs, welche spezielle<br>Anforderungen der BSI TR-03132 darstellen.<br>Die Nutzung eines OSCI-Clients, welcher entsprechend der BSITR-03132 arbeitet, wird vorausgesetzt. |                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| Prüfschritte                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                        |  |
|                                                                                                                                                                                                                                                | 1 Korrektheit der OSCI-Kommunikation                                                                                                                                                                                                                                                                                                                                                                   |  |
| Erwartetes<br>Resultat                                                                                                                                                                                                                         | Alle im Rahmen der OSCI-Kommunikation mit dem Client ausgetauschten Nachrichten<br>–<br>sind konform zum [OSCI].<br>Anmerkung für die Prüfung<br>Hierzu sind alle im Rahmen des OSCI-Dialogs erzeugten Nachrichten zu untersuchen. Die<br>jeweiligen Abschnitte der OSCI-Spezifikation definieren Schemata für jede Nachricht und ggf.<br>darüber hinausgehende Anforderungen, welche abzuprüfen sind. |  |
| 2 Korrektheit der Prüfung der Zertifikate und des Laufzettels.                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                        |  |
| Erwartetes<br>Resultat                                                                                                                                                                                                                         | Der Intermediär prüft alle Zertifikate auf Gültigkeit (bis zur Root des Zertifikatsausstellers<br>–<br>innerhalb der PKI-1-Verwaltung).                                                                                                                                                                                                                                                                |  |
|                                                                                                                                                                                                                                                | Der Intermediär protokolliert das Ergebnis der Prüfungen auf dem Laufzettel.<br>–<br>Anmerkung für die Prüfung<br>Zur Sicherstellung der korrekten Arbeitsweise des Intermediärs sollte dieser Prüfschritt<br>jeweils mit einem gültigen und einem gesperrten Zertifikat durchgeführt werden.                                                                                                          |  |
|                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                        |  |

Tabelle 5: Prüffall IM-001: OSCI-Intermediärsfunktionalität

### <span id="page-11-3"></span>2.4 Prüfmodul Empfangssystem des Dokumentenherstellers

#### <span id="page-11-2"></span>2.4.1 Relevante Vorgaben der BSI TR-03132

Dieses Modul dient der Abprüfung der Vorgaben der BSI TR-03132, welche an den Prüfprozess zur Eingangsprüfung beim Dokumentenhersteller gemacht werden.

#### <span id="page-11-1"></span>2.4.2 Anwendbarkeit

Diese Prüffälle sind anwendbar auf Softwarekomponenten im Empfangs- (Backend-)System des Dokumentenherstellers.

#### <span id="page-11-0"></span>2.4.3 Prüffälle

| Prüffall E-001: OSCI-Eingangsprüfung                                                                                                                                                       |                                                                                                                                                                                                                                              |  |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Umfang                                                                                                                                                                                     |                                                                                                                                                                                                                                              |  |
| Dieser Prüffall dient der Prüfung der korrekten Umsetzung der spezifizierten Prüfmaßnahmen beim<br>–<br>Eingangssystem des Dokumentenherstellers.<br>Vorbedingungen                        |                                                                                                                                                                                                                                              |  |
|                                                                                                                                                                                            |                                                                                                                                                                                                                                              |  |
| Durchführung der Kommunikation mit einem OSCI-Client und dem Intermediär des<br>–<br>Dokumentenherstellers inkl. Beantwortung durch das passive Backendsystem des<br>Dokumentenherstellers |                                                                                                                                                                                                                                              |  |
| Vollständige DVDV-Dienstbeschreibung gemäß TR-03132 im DVDV oder einem gültigen DVDV-Cache<br>–<br>gemäß Kapitel 3.4.2 der TR-03132 vorhanden.<br>Anmerkung für die Prüfung                |                                                                                                                                                                                                                                              |  |
| vorausgesetzt.                                                                                                                                                                             | Die Nutzung eines OSCI-Clients und Intermediärs, welcher konform zu BSI TR-03132 arbeitet, wird                                                                                                                                              |  |
| Prüfschritte                                                                                                                                                                               |                                                                                                                                                                                                                                              |  |
|                                                                                                                                                                                            | Korrektheit der OSCI-Sender-Signatur und VerifyCategory                                                                                                                                                                                      |  |
| Erwartetes<br>Resultat                                                                                                                                                                     | Der Dokumentenhersteller weist Nachrichten ab, welche eine ungültige Sender-Signatur<br>–<br>haben.                                                                                                                                          |  |
|                                                                                                                                                                                            | Der Dokumentenhersteller weist Nachrichten ab, welche mit ungültigen Zertifikaten<br>–<br>signiert sind.                                                                                                                                     |  |
|                                                                                                                                                                                            | Der Dokumentenhersteller weist Nachrichten ab, bei denen das verifyCategory nicht<br>–<br>erfolgreich war.                                                                                                                                   |  |
|                                                                                                                                                                                            | Der Dokumentenhersteller akzeptiert Nachrichten, bei denen alle o.g. Prüfungen<br>–<br>erfolgreich sind, sofern keine weiteren fachlichen Fehler außerhalb des<br>Anwendungsgebiets der BSI TR-03132 vorliegen.<br>Anmerkung für die Prüfung |  |
|                                                                                                                                                                                            | Um das korrekte Verhalten abzuprüfen, sind drei fehlerhafte Nachrichten (Signatur ungültig,<br>Zertifikat ungültig, VerifyCategory nicht erfolgreich) und eine valide Nachricht zu generieren<br>und in das Empfangssystem einzuspeisen.     |  |

#### Tabelle 6: Prüffall E-001: OSCI-Eingangsprüfung

| Prüffall E-002: Eingangsprüfung der Inhaltsdatensignatur                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                              |  |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Umfang                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                              |  |
| –                                                                                                                                                                                                                                                                                                                                            | Dieser Prüffall dient der Prüfung der korrekten Umsetzung der spezifizierten Prüfmaßnahmen beim<br>Eingangssystem des Dokumentenherstellers.                                                                                                                 |  |
| Vorbedingungen                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                              |  |
| Durchführung der Kommunikation mit einem OSCI-Client und dem Intermediär des<br>–<br>Dokumentenherstellers inkl. Beantwortung durch das passive Backendsystem des<br>Dokumentenherstellers<br>Anmerkung für die Prüfung<br>Die Nutzung eines OSCI-Clients und Intermediärs, welcher konform zu BSI TR-03132 arbeitet, wird<br>vorausgesetzt. |                                                                                                                                                                                                                                                              |  |
| Prüfschritte                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                              |  |
| Korrektheit der Inhaltsdatensignatur                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                              |  |
| Erwartetes<br>Resultat                                                                                                                                                                                                                                                                                                                       | Der Dokumentenhersteller prüft, ob die Inhaltsdatensignatur korrekt ist.<br>–<br>Der Dokumentenhersteller prüft, ob das verwendete Zertifikat gültig ist.<br>–<br>Der Dokumentenhersteller prüft, ob das verwendete Zertifikat aus der korrekten Sub-CA<br>– |  |

Tabelle 7: Prüffall E-002: Eingangsprüfung der Inhaltsdatensignatur

gemäß BSI TR-03132 stammt.

## <span id="page-13-0"></span>3 Abkürzungsverzeichnis

| Abkürzung | Beschreibung                                       |  |
|-----------|----------------------------------------------------|--|
| DVDV      | Deutsches Verwaltungsdiensteverzeichnis            |  |
| OSCI      | Online Services Computer Interface                 |  |
| PIN       | Personal Identification Number                     |  |
| PSE       | Personal Security Environment, Smartcard           |  |
| WSDL      | Web Services Description Language                  |  |
| XhD       | XML-Datenaustauschformat für hoheitliche Dokumente |  |
| XML       | Extensible Markup Language                         |  |
| XMLDSIG   | XML Signature                                      |  |
| XMLENC    | XML Encryption                                     |  |

## <span id="page-14-0"></span>4 Literaturverzeichnis

- [03104] BSI TR-03104: Technische Richtlinie Produktionsdatenerfassung, -qualitätsprüfung und -übertragung für hoheitliche Dokumente [03123] BSI TR-03123: Technische Richtlinie XML-Datenaustauschformat für die Beantragung hoheitlicher Dokumente [03132] BSI TR-03132: Technische Richtlinie Sichere Szenarien für Kommunikationsprozesse im Bereich hoheitlicher Dokumente [OSCI] OSCI-Leitstelle: OSCI-Transport 1.2 – Spezifikation
- 
- [XMLDSIG] W3C: http://www.w3.org/TR/xmldsig-core/
- [XMLENC] W3C: http://www.w3.org/TR/xmlenc-core/