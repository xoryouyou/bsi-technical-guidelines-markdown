![](_page_0_Picture_0.jpeg)

![](_page_0_Picture_2.jpeg)

# TR 03126 - Technische Richtlinie für den sicheren RFID-Einsatz

TR 03126-3: Einsatzgebiet "NFC-basiertes eTicketing"

Autoren:

Cord Bartels, NXP Harald Kelter, BSI Rainer Oberweis, BSI Birger Rosenberg, NXP

Bundesamt für Sicherheit in der Informationstechnik Postfach 20 03 63 53133 Bonn Tel.: +49 (0) 228 99 9582 0 E-Mail: rfid@bsi.bund.de Internet: http://www.bsi.bund.de © Bundesamt für Sicherheit in der Informationstechnik 2009

# **Inhaltsverzeichnis**

| 1     | Beschreibung des Einsatzgebiets "NFC-basiertes eTicketing für den<br>öffentlichen Personenverkehr"  | 13 |
|-------|-----------------------------------------------------------------------------------------------------|----|
| 2     | Beschreibung der Dienste, Produkte und Trägermedien                                                 | 15 |
|       |                                                                                                     |    |
| 3     | Vereinbarungen                                                                                      | 18 |
| 3.1   | Definition von Begriffen                                                                            | 18 |
| 3.2   | Generische Modellierung von Rollen und Entitäten                                                    | 19 |
| 3.3   | Zuordnung der Rollen und Entitäten im Einsatzgebiet eTicketing im ÖPV                               | 21 |
| 3.4   | Beziehung zwischen Trägermedien, Anwendungen und Berechtigungen                                     | 23 |
| 4     | Generelle Anforderungen                                                                             | 25 |
| 4.1   | Funktion                                                                                            | 25 |
| 4.1.1 | Anforderungen des Kunden                                                                            | 25 |
| 4.1.2 | Anforderungen des Produktanbieters und des Dienstleisters                                           | 25 |
| 4.2   | Wirtschaftlichkeit                                                                                  | 26 |
| 4.3   | Sicherheit                                                                                          | 26 |
| 5     | Methodik zur Ermittlung der Sicherheitsanforderungen                                                | 27 |
| 5.1   | Zielsetzung                                                                                         | 27 |
| 5.2   | Methodik                                                                                            | 27 |
| 5.2.1 | Erwägungen zum Umfang der Systembetrachtung                                                         | 27 |
| 5.2.2 | Skalierbarkeit und Flexibilität                                                                     | 28 |
| 5.2.3 | Aufbau der Technischen Richtlinie                                                                   | 30 |
| 5.2.4 | Erläuterung des Sicherheitskonzepts                                                                 | 31 |
| 6     | Generische Geschäftsprozesse                                                                        | 33 |
| 6.1   | Prozess P1 "Anmeldung und Bestellung"                                                               | 33 |
| 6.1.1 | Anlegen eines Kundenkontos, Erwerb von personalisierten Kundenmedien und<br>Berechtigungen          | 33 |
| 6.1.2 | Erwerb von unpersonalisierten Trägermedien und Berechtigungen                                       | 35 |
| 6.2   | Prozess P2 "Erstellung und Auslieferung von Produkten"                                              | 37 |
| 6.2.1 | Prozess P2A "Erstellung und Auslieferung von personalisierten Trägermedien<br>und Berechtigungen"   | 37 |
| 6.2.2 | Prozess P2B "Erstellung und Auslieferung von unpersonalisierten<br>Trägermedien und Berechtigungen" | 38 |
| 6.3   | Prozess P3 "Verwendung der Berechtigung"                                                            | 39 |
| 6.4   | Prozess P4 "Sperrung von Berechtigungen, Anwendungen und Trägermedien"                              | 41 |
| 7     | Anwendungsfälle                                                                                     | 42 |
| 7.1   | Anwendungsfall "Identifizierung bei Anmeldung und Bestellung"                                       | 42 |

| 7.2                                              | Anwendungsfall "Initialisieren des Trägermediums"                             | 42 |  |
|--------------------------------------------------|-------------------------------------------------------------------------------|----|--|
| 7.3                                              | Anwendungsfall "Nachladen der Anwendung"                                      |    |  |
| 7.4                                              | Anwendungsfall "Einbringen der Berechtigung"                                  |    |  |
| 7.5                                              | Anwendungsfall "Auslieferung"                                                 | 45 |  |
| 7.6                                              | Anwendungsfall "Offline Check-in"                                             | 46 |  |
| 7.7                                              | Anwendungsfall "Kontrolle"                                                    | 48 |  |
| 7.8                                              | Anwendungsfall "Offline Check-out"                                            | 49 |  |
| 7.9                                              | Anwendungsfall "Sperrung"                                                     |    |  |
| 7.10                                             | Anwendungsfälle "Schlüsselmanagement"                                         |    |  |
| 7.10.1                                           | Schlüsselmanagement für das Initialisieren der Trägermedien                   |    |  |
| 7.10.2                                           | Schlüsselmanagement für das Aufbringen und Personalisieren der<br>Anwendungen |    |  |
| 7.10.3                                           | Schlüsselmanagement für das Einbringen der Berechtigungen                     | 52 |  |
| 7.10.4                                           | Schlüsselmanagement für die Nutzung beim Dienstleister                        | 53 |  |
| 7.11                                             | Anwendungsfall "Initialisieren des lokalen Transponders"                      | 53 |  |
| 8                                                | Sicherheitsbetrachtungen                                                      | 56 |  |
| 8.1                                              | Definitionen zum Thema Sicherheit und Datenschutz                             | 56 |  |
| 8.2                                              | Definition der Sicherheitsziele                                               | 58 |  |
| 8.2.1<br>Spezifische Sicherheitsziele des Kunden |                                                                               | 58 |  |
|                                                  | 8.2.1.1<br>Funktionssicherheit                                                | 59 |  |
|                                                  | 8.2.1.2<br>Informationssicherheit                                             | 59 |  |
|                                                  | 8.2.1.3<br>Schutz der Privatsphäre                                            | 60 |  |
| 8.2.2                                            | Spezifische Sicherheitsziele des Produktanbieters                             | 60 |  |
|                                                  | 8.2.2.1<br>Funktionssicherheit                                                | 60 |  |
|                                                  | 8.2.2.2<br>Informationssicherheit                                             | 61 |  |
|                                                  | 8.2.2.3<br>Schutz der Privatsphäre                                            | 62 |  |
| 8.2.3                                            | Spezifische Sicherheitsziele des Dienstleisters                               | 62 |  |
|                                                  | 8.2.3.1<br>Funktionssicherheit                                                | 62 |  |
|                                                  | 8.2.3.2<br>Informationssicherheit                                             | 63 |  |
|                                                  | 8.2.3.3<br>Schutz der Privatsphäre                                            | 64 |  |
| 8.2.4                                            | Zusammenfassung der Sicherheitsziele der Entitäten                            | 64 |  |
| 8.2.5                                            | Bildung von Schutzbedarfsklassen                                              | 65 |  |
| 8.3                                              | Gefährdungen                                                                  |    |  |
| 8.3.1                                            | Gefährdungen der kontaktlosen Schnittstelle                                   |    |  |
| 8.3.2                                            | Gefährdungen des aktiven NFC-Mobiltelefons                                    |    |  |
| 8.3.3                                            | Gefährdungen des passiven NFC-Mobiltelefons                                   | 70 |  |
| 8.3.4                                            | Gefährdungen des lokalen Transponders                                         |    |  |
| 8.3.5                                            | Gefährdungen des Lesegeräts                                                   |    |  |

| 8.3.6  | Gefährdungen des Schlüsselmanagement                                                                               | 73  |
|--------|--------------------------------------------------------------------------------------------------------------------|-----|
| 8.3.7  | Gefährdungen der Verkaufs-, Kontroll- und Hintergrundsysteme                                                       | 74  |
| 8.4    | Maßnahmen                                                                                                          | 76  |
| 8.4.1  | Auswahl kryptographischer Verfahren                                                                                | 76  |
| 8.4.2  | Maßnahmen zum Schutz des Gesamtsystems                                                                             | 77  |
| 8.4.3  | Maßnahmen in Bezug auf das Trägermedium (NFC-Mobiltelefon im passiven<br>Modus)                                    | 87  |
| 8.4.4  | Maßnahmen in Bezug auf das aktive NFC-Mobiltelefon                                                                 | 99  |
| 8.4.5  | Maßnahmen in Bezug auf den lokalen Transponder beim Online-Check-in und<br>Check-out                               | 102 |
| 8.4.6  | Maßnahmen in Bezug auf den lokalen Transponder beim Offline-Check-in und<br>Check-out                              | 102 |
| 8.4.7  | Maßnahmen in Bezug auf die Lesegeräte                                                                              | 104 |
| 8.4.8  | Maßnahmen in Bezug auf das Schlüsselmanagement                                                                     | 107 |
| 9      | Definition produktspezifischer Einsatzszenarien                                                                    | 116 |
| 9.1    | Einsatzszenario "Interfunktionsfähige, personalisierte Dauerberechtigung mit<br>automatischer Fahrpreisermittlung" | 116 |
| 9.2    | Einsatzszenario "Mehrfahrtenberechtigung Nahbereich"                                                               | 117 |
| 10     | Umsetzungsvorschläge zum Gesamtsystem                                                                              | 119 |
| 10.1   | Umsetzungsvorschläge zur eTicketing-Infrastruktur                                                                  | 120 |
| 10.1.1 | Ermittlung des Schutzbedarfs für die eTicketing-Infrastruktur                                                      | 120 |
| 10.1.2 | Schnittstellen des Gesamtsystems                                                                                   | 123 |
|        | 10.1.2.1<br>Relevante Gefährdungen für die eTicketing Infrastruktur                                                | 123 |
|        | 10.1.2.2<br>Definition von Schutzmaßnahmen für die Schnittstellen des<br>Gesamtsystems                             | 125 |
|        | 10.1.2.3<br>Verbleibende Risiken                                                                                   | 126 |
| 10.1.3 | Lesegeräte nach ISO/IEC14443                                                                                       | 126 |
|        | 10.1.3.1<br>Relevante Gefährdungen für das Lesegerät                                                               | 128 |
|        | 10.1.3.2<br>Definition von Schutzmaßnahmen für das Lesegerät und dessen<br>Anwendungen                             | 130 |
|        | 10.1.3.3<br>Verbleibende Risiken                                                                                   | 131 |
| 10.1.4 | Verkaufs-, Kontroll- und Managementsysteme                                                                         | 131 |
|        | 10.1.4.1<br>Verkaufssysteme                                                                                        | 131 |
|        | 10.1.4.2<br>Ticketsystem                                                                                           | 133 |
|        | 10.1.4.3<br>Zentrales Kontrollsystem                                                                               | 134 |
|        | 10.1.4.4<br>Service-Desk                                                                                           | 135 |
|        | 10.1.4.5<br>Managementsystem für NFC-Mobiltelefone und Anwendungen                                                 | 135 |
|        | 10.1.4.6<br>Managementsystem für lokale Transponder                                                                | 136 |
|        | 10.1.4.7<br>Relevante Gefährdungen für die Ticket-, Kontroll- und<br>Managementsysteme                             | 137 |

| 10.1.4.8<br>Definition von Schutzmaßnahmen für die Ticket-, Kontroll- und<br>Managementsysteme            | 138        |
|-----------------------------------------------------------------------------------------------------------|------------|
| 10.1.4.9<br>Verbleibende Risiken                                                                          | 140        |
| 10.1.5<br>Schlüsselmanagement                                                                             |            |
| 10.1.5.1<br>Schlüsselmanagement beim ÖPV-Dienstleister / SAM für Dienstleister                            |            |
| 10.1.5.2<br>Relevante Gefährdungen für das Schlüsselmanagement                                            | 141<br>142 |
| 10.1.5.3<br>Definition von Schutzmaßnahmen für das Schlüsselmanagement                                    | 143        |
| 10.1.5.4<br>Verbleibende Risiken                                                                          | 144        |
| 10.2<br>Lokaler Transponder                                                                               | 144        |
| 10.2.1<br>Initialisierung von lokalen Transpondern                                                        | 146        |
| 10.2.2<br>Aufbringen der Ortsinformation                                                                  | 146        |
| 10.2.3<br>Ermittlung des Schutzbedarfs für den lokalen Transponder                                        | 146        |
| 10.2.4<br>Gefährdungen für den lokalen Transponder                                                        | 146        |
| 10.2.5<br>Definition spezifischer Maßnahmen                                                               | 147        |
| 10.3<br>NFC-Mobiltelefon                                                                                  | 147        |
| 10.3.1<br>Eigenschaften des NFC-Mobiltelefons                                                             | 147        |
| 10.3.2<br>Initialisierung des NFC-Mobiltelefons                                                           | 148        |
| 10.3.3<br>Personalisierung des NFC-Mobiltelefons                                                          | 149        |
| 10.3.4<br>Ermittlung des Schutzbedarfs für das NFC-Mobiltelefon                                           | 149        |
| 10.3.5<br>Gefährdungen für das NFC-Mobiltelefon                                                           | 149        |
| 10.3.5.1<br>Gefährdungen im aktiven Modus (PCD-Mode)                                                      | 149        |
| 10.3.5.2<br>Gefährdungen im passiven Modus                                                                | 150        |
| 10.3.6<br>Definition spezifischer Maßnahmen                                                               | 151        |
| 11<br>Umsetzungsvorschläge zu den produktspezifischen Einsatzszenarien                                    | 152        |
| 11.1<br>Einsatzszenario "Interfunktionsfähige Dauerberechtigung mit automatischer<br>Fahrpreisermittlung" | 152        |
| 11.1.1<br>Ermittlung der Schutzbedarfsklasse                                                              | 152        |
| 11.1.2<br>Schutz des passiven NFC-Mobiltelefons                                                           | 155        |
| 11.1.2.1<br>Relevante Gefährdungen des passiven NFC-Mobiltelefons                                         | 155        |
| 11.1.2.2<br>Definition relevanter Anwendungsfälle für das passive NFC-Mobiltelefon                        | 156        |
| 11.1.2.3<br>Definition von Schutzmaßnahmen für das passive NFC-Mobiltelefon                               | 157        |
| 11.1.3<br>Schutz des aktiven NFC-Mobiltelefons                                                            | 159        |
| 11.1.3.1<br>Relevante Gefährdungen des aktiven NFC-Mobiltelefons                                          | 159        |
| 11.1.3.2<br>Definition relevanter Anwendungsfälle für das aktive NFC-Mobiltelefon                         | 160        |
| 11.1.3.3<br>Definition von Schutzmaßnahmen für das aktive NFC-Mobiltelefon                                | 160        |
| 11.1.4<br>Schutz des lokalen Transponders                                                                 |            |
| 11.1.4.1<br>Relevante Gefährdungen den lokalen Transponder                                                | 162        |
| 11.1.4.2<br>Definition relevanter Anwendungsfälle für den lokalen Transponder                             | 163        |
| 11.1.4.3<br>Definition von Schutzmaßnahmen für den lokalen Transponder                                    | 164        |

| 11.1.5 | Verbleibende Risiken                   | 165 |
|--------|----------------------------------------|-----|
| 12     | Referenzimplementierung Touch & Travel | 166 |
| 13     | Literaturverzeichnis                   | 167 |
| 14     | Abkürzungsverzeichnis                  | 169 |

# **Tabellenverzeichnis**

| Tabelle 2–1  | Übersicht über Vertriebsformen und deren Eigenschaften                                        | 16 |
|--------------|-----------------------------------------------------------------------------------------------|----|
| Tabelle 5–1  | Aufbau der Technischen Richtlinien                                                            | 31 |
| Tabelle 8–1  | Kodierungsschema der Sicherheitsziele                                                         | 58 |
| Tabelle 8–2  | Sicherheitsziele des Kunden zur Funktionssicherheit                                           | 59 |
| Tabelle 8–3  | Sicherheitsziele des Kunden zur Informationssicherheit                                        | 60 |
| Tabelle 8–4  | Sicherheitsziele des Kunden zum Schutz der Privatsphäre                                       | 60 |
| Tabelle 8–5  | Sicherheitsziele des Produktanbieters zur Funktionssicherheit                                 | 61 |
| Tabelle 8–6  | Sicherheitsziele des Produktanbieters zur Informationssicherheit                              | 62 |
| Tabelle 8–7  | Sicherheitsziele des Produktanbieters zum Schutz der Privatsphäre                             | 62 |
| Tabelle 8–8  | Sicherheitsziele des Dienstleisters zur Funktionssicherheit                                   | 63 |
| Tabelle 8–9  | Sicherheitsziele des Dienstleisters zur Informationssicherheit                                | 64 |
| Tabelle 8–10 | Sicherheitsziele des Dienstleisters zum Schutz der Privatsphäre                               | 64 |
| Tabelle 8–11 | Übersicht über die Sicherheitsziele der Entitäten                                             | 65 |
| Tabelle 8–12 | Definition von Schutzbedarfsklassen                                                           | 67 |
| Tabelle 8–13 | Kodierungsschema der Gefährdungen                                                             | 68 |
| Tabelle 8–14 | Gefährdungen der kontaktlosen Schnittstelle                                                   | 68 |
| Tabelle 8–15 | Gefährdungen des aktiven NFC Mobiltelefons                                                    | 70 |
| Tabelle 8–16 | Gefährdungen des passiven NFC-Mobiltelefons                                                   | 71 |
| Tabelle 8–17 | Gefährdungen des lokalen Transponders                                                         | 72 |
| Tabelle 8–18 | Gefährdungen des Lesegerätes                                                                  | 73 |
| Tabelle 8–19 | Gefährdungen des Schlüsselmanagements                                                         | 74 |
| Tabelle 8–20 | Gefährdungen der Verkaufs-, Kontroll- und Hintergrundsysteme                                  | 75 |
| Tabelle 8–21 | Kodierungsschema der Maßnahmen                                                                | 76 |
| Tabelle 8–22 | Schutz des Gesamtsystems durch Einführung von Schnittstellentests<br>und Freigabeverfahren    | 77 |
| Tabelle 8–23 | Schutz des Gesamtsystems durch Sicherung der Vertraulichkeit der<br>Kommunikation             | 78 |
| Tabelle 8–24 | Schutz des Gesamtsystems durch Einführung der kontaktlosen<br>Schnittstelle nach ISO/IEC14443 | 79 |
| Tabelle 8–25 | Schutz des Gesamtsystems durch Definition von Rückfalllösungen                                | 79 |
| Tabelle 8–26 | Schutz des Gesamtsystems durch Sicherung der Vertraulichkeit von<br>Daten                     | 80 |
| Tabelle 8–27 | Schutz des Gesamtsystems durch vertrauliche Speicherung von<br>Daten                          | 81 |
| Tabelle 8–28 | Schutz des Gesamtsystems durch Sicherung der Datenintegrität bei<br>der Datenübertragung      | 81 |

| Tabelle 8–29 | Schutz des Gesamtsystems durch Sicherung der Datenintegrität bei<br>der Datenspeicherung     | 82  |
|--------------|----------------------------------------------------------------------------------------------|-----|
| Tabelle 8–30 | Schutz des Gesamtsystems durch Sicherung der Systemfunktionen<br>gegen DoS-Angriffe          | 82  |
| Tabelle 8–31 | Schutz des Gesamtsystems durch Sicherung der Funktion des<br>Systems gegen Fehlbedienung     | 83  |
| Tabelle 8–32 | Schutz des Gesamtsystems durch Sicherung der Funktion des<br>Systems gegen technische Fehler | 83  |
| Tabelle 8–33 | Schutz des Gesamtsystems durch Spezifikation des Systems und der<br>Komponenten              | 84  |
| Tabelle 8–34 | Schutz des Gesamtsystems durch ergonomische Benutzerführung                                  | 85  |
| Tabelle 8–35 | Schutz des Gesamtsystems durch Support                                                       | 85  |
| Tabelle 8–36 | Schutz des Gesamtsystems durch Trennung von Applikationen                                    | 85  |
| Tabelle 8–37 | Schutz des Gesamtsystems durch Identifikation des Kunden                                     | 86  |
| Tabelle 8–38 | Schutz des Gesamtsystems durch Umsetzung des Gebots der<br>Datensparsamkeit                  | 86  |
| Tabelle 8–39 | Schutz des Transponders durch Zugriffsschutz für den EPC                                     | 87  |
| Tabelle 8–40 | Schutz des Transponders vor Klonen                                                           | 88  |
| Tabelle 8–41 | Schutz des Transponders vor Emulation                                                        | 89  |
| Tabelle 8–42 | Schutz von personenbezogenen Daten im Transponder                                            | 90  |
| Tabelle 8–43 | Schutz von Abrechnungsdaten im Transponder                                                   | 91  |
| Tabelle 8–44 | Schutz durch Trennung von Anwendungen im Transponder                                         | 92  |
| Tabelle 8–45 | Schutz durch Spezifikation des Trägermediums                                                 | 92  |
| Tabelle 8–46 | Schutz durch Einführung der Nahbereichstechnik nach ISO/IEC14443                             | 93  |
| Tabelle 8–47 | Schutz durch Rückfalllösung bei Fehlfunktion des Trägermediums                               | 93  |
| Tabelle 8–48 | Schutz durch Sichern von Authentizität und Integrität beim Nachladen<br>von Anwendungen      | 96  |
| Tabelle 8–49 | Schutz durch Sichern von Vertraulichkeit beim Nachladen von<br>Anwendungen                   | 97  |
| Tabelle 8–50 | Schutz durch Sichern von Authentizität und Integrität beim Nachladen<br>von Berechtigungen   | 98  |
| Tabelle 8–51 | Schutz durch Sichern von Vertraulichkeit beim Nachladen von<br>Berechtigungen                | 99  |
| Tabelle 8–52 | Schutz durch Vermitteln der Abläufe und Nutzungsbedingungen                                  | 100 |
| Tabelle 8–53 | Schutz durch Ausweichen auf alternativen Vertriebskanal                                      | 100 |
| Tabelle 8–54 | Schutz von Daten und Schlüsseln im NFC-Mobiltelefon                                          | 101 |
| Tabelle 8–55 | Schutz von Transponderdaten im NFC-Mobiltelefon                                              | 101 |
| Tabelle 8–56 | Schutz durch Überprüfung des NFC-Mobiltelefons/Displays                                      | 102 |
| Tabelle 8–57 | Schutz durch Sichern der Authentizität der Ortsinformation                                   | 103 |
| Tabelle 8–58 | Schutz vor Vandalismus / DoS-Attacken                                                        | 103 |
| Tabelle 8–59 | Schutz der Installation des Transponders                                                     | 104 |

| Tabelle 8–60  | Schutz der Lesegeräte durch Einführung von Schnittstellentests                                                         | 104 |  |  |  |
|---------------|------------------------------------------------------------------------------------------------------------------------|-----|--|--|--|
| Tabelle 8–61  | Schutz durch Schützen der Referenzinformationen                                                                        | 105 |  |  |  |
| Tabelle 8–62  | Schutz des Lesegerätes gegen Fehlfunktion                                                                              |     |  |  |  |
| Tabelle 8–63  | Schutz durch sichere Erzeugung und Einbringung von Schlüsseln                                                          | 108 |  |  |  |
| Tabelle 8–64  | Schutz durch Einführung eines Schlüsselmanagements                                                                     |     |  |  |  |
| Tabelle 8–65  | Schutz durch Zugriffsschutz auf kryptographische Schlüssel                                                             | 111 |  |  |  |
| Tabelle 8–66  | Schutz durch Sicherung der Funktion der Sicherheitskomponenten                                                         | 111 |  |  |  |
| Tabelle 8–67  | Schutz durch Verfügbarkeit des Schlüsselmanagements                                                                    | 112 |  |  |  |
| Tabelle 8–68  | Schutz durch Definition des Verhaltens bei Kompromittierung von<br>Schlüsseln                                          | 113 |  |  |  |
| Tabelle 8–69  | Schutz durch Trennung von Schlüsseln                                                                                   | 113 |  |  |  |
| Tabelle 8–70  | Schutz durch Sicherung der Authentizität und Integrität beim<br>Nachladen von Schlüsseln                               | 115 |  |  |  |
| Tabelle 9–1   | Trägermedien für die Nutzung der "Interfunktionsfähigen<br>Dauerberechtigung mit automatischer Fahrpreisermittlung"    | 117 |  |  |  |
| Tabelle 9–2   | Relevante Prozesse für die Nutzung der Dauerberechtigung mit<br>automatischer Fahrpreisermittlung                      | 117 |  |  |  |
| Tabelle 9–3   | Trägermedien für die Nutzung der Mehrfahrtenberechtigung<br>Nahbereich                                                 | 118 |  |  |  |
| Tabelle 9–4   | Relevante Prozesse für die Nutzung der Mehrfahrtenberechtigung<br>Nahbereich                                           | 118 |  |  |  |
| Tabelle 10–1  | Schutzbedarf des Systems                                                                                               | 123 |  |  |  |
| Tabelle 10–2  | Relevante Gefährdungen der kontaktlosen Schnittstelle                                                                  | 123 |  |  |  |
| Tabelle 10–3  | Relevante Gefährdungen des Systems                                                                                     | 124 |  |  |  |
| Tabelle 10–4  | Schutzmaßnahmen für das Gesamtsystem                                                                                   | 126 |  |  |  |
| Tabelle 10–5  | Relevante Gefährdungen der kontaktlosen Schnittstelle                                                                  | 129 |  |  |  |
| Tabelle 10–6  | Relevante Gefährdungen des Lesegeräts                                                                                  | 130 |  |  |  |
| Tabelle 10–7  | Schutzmaßnahmen für das Lesegerät und dessen Anwendungen                                                               | 131 |  |  |  |
| Tabelle 10–8  | Relevante Gefährdungen für die Ticket-, Kontroll- und<br>Managementsysteme                                             | 138 |  |  |  |
| Tabelle 10–9  | Schutzmaßnahmen für die Ticket-, Kontroll- und<br>Managementsysteme                                                    | 140 |  |  |  |
| Tabelle 10–10 | Relevante Gefährdungen des Schlüsselmanagements                                                                        | 143 |  |  |  |
| Tabelle 10–11 | Schutzmaßnahmen für das Schlüsselmanagement                                                                            | 144 |  |  |  |
| Tabelle 10–12 | Kategorisierung der Chipprodukte                                                                                       | 146 |  |  |  |
| Tabelle 10–13 | Relevante Gefährdungen für den lokalen Transponder                                                                     | 147 |  |  |  |
| Tabelle 10–14 | Kategorisierung der Trägermedien                                                                                       | 148 |  |  |  |
| Tabelle 10–15 | Eigenschaften der im NFC-Mobiltelefon integrierten Chipprodukte                                                        | 148 |  |  |  |
| Tabelle 10–16 | Relevante Gefährdungen des aktiven NFC-Mobiltelefons im<br>Einsatzszenario "Dauerberechtigung mit Fahrpreisermittlung" | 150 |  |  |  |
| Tabelle 10–17 | Relevante Gefährdungen für das NFC-Mobiltelefon (passiver Modus)                                                       | 151 |  |  |  |

| Tabelle 11–1  | Schutzbedarf Einsatzszenario "Dauerberechtigung mit automatischer<br>Fahrpreisermittlung"                               | 155 |
|---------------|-------------------------------------------------------------------------------------------------------------------------|-----|
| Tabelle 11–2  | Relevante Gefährdungen des passiven NFC-Mobiltelefons im<br>Einsatzszenario "Dauerberechtigung mit Fahrpreisermittlung" | 156 |
| Tabelle 11–3  | Relevante Anwendungsfälle Einsatzszenario "Dauerberechtigung mit<br>Fahrpreisermittlung"                                | 157 |
| Tabelle 11–4  | Maßnahmen zum passiven NFC-Mobiltelefon im Einsatzszenario<br>"Dauerberechtigung mit Fahrpreisermittlung"               | 159 |
| Tabelle 11–5  | Relevante Gefährdungen des aktiven NFC-Mobiltelefons im<br>Einsatzszenario "Dauerberechtigung mit Fahrpreisermittlung"  | 160 |
| Tabelle 11–6  | Relevante Anwendungsfälle Einsatzszenario "Dauerberechtigung mit<br>Fahrpreisermittlung"                                | 160 |
| Tabelle 11–7  | Maßnahmen zum aktiven NFC-Mobiltelefon im Einsatzszenario<br>"Dauerberechtigung mit Fahrpreisermittlung"                | 162 |
| Tabelle 11–8  | Relevante Gefährdungen des lokalen Transponder im<br>Einsatzszenario "Dauerberechtigung mit Fahrpreisermittlung"        | 163 |
| Tabelle 11–9  | Relevante Anwendungsfälle Einsatzszenario "Dauerberechtigung mit<br>Fahrpreisermittlung"                                | 164 |
| Tabelle 11–10 | Maßnahmen zum lokalen Transponder im Einsatzszenario<br>"Dauerberechtigung mit Fahrpreisermittlung"                     | 165 |

# **Abbildungsverzeichnis**

| Abbildung 3–1  | Entitäten eines Einsatzgebiets nach ISO 24014 (erweitert um<br>Entitäten des Kundenmediums)         | 19  |  |  |
|----------------|-----------------------------------------------------------------------------------------------------|-----|--|--|
| Abbildung 3–2  | Entitäten des Einsatzgebiets "eTicketing für den öffentlichen<br>Personenverkehr"                   | 22  |  |  |
| Abbildung 3–3  | Entitäten des Einsatzszenarios "VDV Kernapplikation"                                                |     |  |  |
| Abbildung 3–4  | Trägermedien, Anwendungen und Berechtigungen                                                        | 24  |  |  |
| Abbildung 5–1  | Beispiel: Bestimmung RFID-relevanter Anwendungsfälle für<br>eTicketing                              | 28  |  |  |
| Abbildung 5–2  | Beispiel für Einsatzszenarios und RFID-relevante Anwendungsfälle<br>für eTicketing im ÖPV           | 29  |  |  |
| Abbildung 5–3  | Hierarchisches Konzept für Medien, Anwendungen und Tickets beim<br>eTicketing                       | 29  |  |  |
| Abbildung 5–4  | Sicherheitsbewertungskonzept                                                                        | 32  |  |  |
| Abbildung 5–5  | Generische Sicherheitsziele                                                                         | 32  |  |  |
| Abbildung 6–1  | Prozessdarstellung P1A "Anmeldung und Bestellung"                                                   | 35  |  |  |
| Abbildung 6–2  | Prozessdarstellung P1B "Erwerb von unpersonalisierten<br>Trägermedien und Berechtigungen            | 36  |  |  |
| Abbildung 6–3  | Prozess P2A "Erstellung und Auslieferung von personalisierten<br>Trägermedien und Berechtigungen"   | 37  |  |  |
| Abbildung 6–4  | Prozess P2B "Erstellung und Auslieferung von unpersonalisierten<br>Trägermedien und Berechtigungen" | 38  |  |  |
| Abbildung 6–5  | Prozessdarstellung P3 "Verwendung der CICO-Berechtigung"                                            | 40  |  |  |
| Abbildung 7–1  | Anwendungsfall "Initialisierung des Trägermediums"                                                  | 43  |  |  |
| Abbildung 7–2  | Anwendungsfall "Nachladen der Anwendung"                                                            | 44  |  |  |
| Abbildung 7–3  | Anwendungsfall "Einbringen der Berechtigung"                                                        | 45  |  |  |
| Abbildung 7–4  | Anwendungsfall "Offline Check-in"                                                                   | 47  |  |  |
| Abbildung 7–5  | Anwendungsfall "Kontrolle"                                                                          | 48  |  |  |
| Abbildung 7–6  | Anwendungsfall "Sperrung"                                                                           | 50  |  |  |
| Abbildung 7–7  | Anwendungsfall "Schlüsselmanagement für Trägermedien"                                               | 51  |  |  |
| Abbildung 7–8  | Anwendungsfall "Schlüsselmanagement für Anwendungen"                                                | 52  |  |  |
| Abbildung 7–9  | Anwendungsfall "Schlüsselmanagement für<br>Berechtigungen/Produkte"                                 | 53  |  |  |
| Abbildung 7–10 | Anwendungsfall "Initialisierung des lokalen Transponders"                                           | 55  |  |  |
| Abbildung 10–1 | Exemplarische Darstellung des Gesamtsystems "NFC-basiertes<br>eTicketing"                           | 119 |  |  |
| Abbildung 10–2 | Systemdarstellung der Referenzimplementierung "Touch & Travel"                                      | 120 |  |  |
| Abbildung 10–3 | Beispiel eines Lesegeräts mit Smart Card bzw. Smart Label                                           | 128 |  |  |
| Abbildung 10–4 | Exemplarisches Ticketsystem mit möglichem Prozessablauf                                             | 134 |  |  |

# <span id="page-12-0"></span>**1 Beschreibung des Einsatzgebiets "NFC-basiertes eTicketing für den öffentlichen Personenverkehr"**

Für die Nutzung von öffentlichen Verkehrsmitteln benötigt der Fahrgast eine Berechtigung, auch Ticket genannt. Diese Berechtigung wird klassisch als Papierticket ausgeführt, dass bei Ausgabe bzw. Fahrtantritt durch den Fahrgast mit einem Gültigkeitsmerkmal (Validieren, Entwerten) versehen wird und ggf. durch einen Kontrolleur im Fahrzeug oder auf dem Bahnsteig geprüft wird.

In den Beschreibungen der Einsatzszenarien des "eTicketing für Veranstaltungen" und "eTicketing für den ÖPV" werden NFC-Trägermedien im "Smart Object Mode", also wie Smart Cards oder Smart Tickets verwendet. Dem NFC-Trägermedium fällt hier bei der Kommunikation mit einem ISO14443-Lesegerät die passive Rolle zu.

Die NFC-Technologie bietet jedoch auch die Möglichkeit einer aktiven Funktion des Kundenmediums. In diesem Fall fungiert das NFC-Gerät als aktives Lesegerät, dass die Kommunikation mit einem anderen NFC-Gerät oder einem ISO14443-Transponder steuert. Beide Rollen und zugeordnete Applikationen lassen sich in einem NFC-Trägermedium nebeneinander implementieren.

Diese aktive Funktionalität der NFC-Trägermedien kann für gewisse Einsatzszenarien dazu genutzt werden, die für Chipkarten nötige lokale Erfassungsinfrastruktur durch fest installierte Transponder zu ersetzen. Dadurch ergibt sich die Möglichkeit eine komplementäre, technisch interfunktionsfähige Systeminfrastruktur für Chipkarten und NFC-Geräte aufzubauen.

Dies ist besonders für den ÖPV interessant, da hier die Kosten für Infrastruktur, die im Fahrzeug oder an den Haltestellen installiert werden müsste, hoch sind. Hochfrequentierte Bereiche könnten dabei weiterhin mit leistungsfähigen lokalen Lesegeräten ausgerüstet werden (vgl. Beschreibung des Einsatzgebietes "eTicketing für den ÖPV"). Bereiche mit geringerem Fahrgastaufkommen (ländliche Gebiete, etc) werden durch eine Infrastruktur bestehend aus fest installierten Transpondern abgedeckt. Die Check-in/Entwertungsfunktion würde von den NFC-Mobilgeräten der Fahrgäste durchgeführt, die diese Transponder auslesen und den Datenabgleich mit dem Ticketsystem selbstständig vornehmen.

Die Beschreibung des Einsatzgebiets "NFC-basiertes eTicketing" basiert auf der Nutzung der aktiven Funktion des NFC-Trägermediums als Lesegerät im Anwendungsbereich des ÖPV.

Wie vorstehend beschrieben, sind die entsprechenden Einsatzszenarien im ÖPV komplementär zu denen des klassischen eTicking mit Chipkarten zu sehen. Dementsprechend können die dort verwendeten Standards und Vereinbarungen auch als Basis für die Beschreibung dieses Einsatzgebiets herangezogen werden.

Die europäische Standardisierung hat zur Unterstützung der entstehenden IFM-Systeme zurzeit drei Standards entwickelt.

- 1 Die funktionale Systemarchitektur mit den Einsatzszenarien von IFM-Systemen werden im Standard ISO EN 24014-1 beschrieben. Dieser Standard wurde in der Arbeitsgruppe CEN TC 278 WG3 SG5 konzipiert.
- 2 Die Beschreibung der auf dem Medium zu verwendenden Datenelemente und die Strukturierung der Datenelemente (Applikation) wurden im CEN TC 224 WG11 SG1 erarbeitet.
- 3 Die Norm EN 1545 beschreibt die Datenelemente und die Norm EN 15320 beschreibt die Datenstrukturierung (IOPTA, InterOperable Public Transport Application).

In der Praxis ist zu erwarten, dass es zu den lokal existierenden Implementierungen des eTicketing im ÖPV komplementäre Erweiterungen in Richtung NFC-basiertes eTicketing geben wird.

Die VDV Kernapplikation (KA) implementiert die vorhandenen Systemstandards in einer gesamten technischen Spezifikation.

# <span id="page-14-1"></span><span id="page-14-0"></span>**2 Beschreibung der Dienste, Produkte und Trägermedien**

Die Betrachtung von Produkten und Trägermedien soll zunächst -wie auch in [IOPTA] vorgesehen- den aktuellen und erwarteten Stand in Europa wiedergeben. Ein besonderer Schwerpunkt soll jedoch auf die Check-in/Check-outCICO-Variante der KA (CICO) gelegt werden, da diese das am weitesten entwickelte, leistungsfähigste und flexibelste Einsatzszenario der [IOPTA] darstellt. Beim Check-in/Check-out-Verfahren meldet sich der Fahrgast vor Antritt der Beförderung mit Hilfe des Mediums bewusst an und nach Erreichen des Ziels bewusst ab.

Dem Kunden werden Dienstleistungen durch Verkehrsunternehmen gewährt. Mit Hilfe des Ticketing werden dazu folgende Produkte angeboten:

- 4 Elektronischer Fahrschein EFS (Einzelfahrschein, Tages-, Monats-, Jahres- und Netzkarten mit definierter räumlicher Gültigkeit sowie Fahrscheine für den Regional- und Fernverkehr)
- 5 Mehrfahrtenberechtigungen (Streifenkarte, Werteinheiten)
- 6 Upgrade/Aufladen einer Mehrfachberechtigung um weitere Einzelberechtigungen.
- 7 Dauerberechtigungen (Automatische Fahrpreisberechnung, CICO, EFS-Abovertrag)

Die Produkte unterscheiden sich durch besondere Merkmale:

- 1 Interfunktionsfähige oder nicht interfunktionsfähige Nutzung
- 2 Wert der Berechtigung:
	- EFS ca. 1€ … 15000 €; z. B. VRR: 6000€, DB AG: 15.000€ ,
	- WES … 150€
	- Dauerberechtigungen … >1000€
- 3 personengebunden personalisiert, personenungebunden personalisiert, anonym
- 4 zeitliche und räumliche Gültigkeit / nicht reglementierte Berechtigungen
- 5 Abrechnungsvarianten (Kontoberechtigungen {Pre-/Postpaid}, Werteinheiten-Berechtigungen, …)
- 6 Zeitpunkt der Fahrpreisermittlung (pre-, trip- und post-pricing)

Interfunktionsfähigkeit ist dabei so definiert, dass mehrere Unternehmen eine Berechtigung/ Produkt akzeptieren (Schnittstellen der Akzeptanzterminals müssen standardisiert sein, in der VDV-KA sind ist dies die ISO-14443 sowie die spezifizierten Datenschnittstellen) und die in Anspruch genommenen Leistungen und zugehörige Einnahmen untereinander verrechnen. Dies ist heute in Deutschland in jedem Verbund bereits gegeben. Aus Kundensicht bedeutet Interfunktionsfähigkeit, dass er sein Medium und seine Dauerberechtigungen bei verschiedenen Kundenvertragspartnern erstehen und aufbringen und bei verschiedenen Dienstleistern einsetzen kann.

Zur automatischen Fahrpreisberechnung erfolgt ein Anmelden bei Beginn (Check-in) als auch ein Abmelden bei Beendigung der Nutzung des ÖPV (Check-out). Dazu ist eine entsprechende Infrastruktur, die CICO-Infrastruktur, erforderlich. Bei Systemen, die Zutrittssperren verwenden, kann diese dafür genutzt werden. Sollte das nicht der Fall sein (z. B. in Deutschland), dann ist eine CICO-Infrastruktur bestehend aus An- und Abmeldeterminals auf den Bahnsteigen oder in den Fahrzeugen zu installieren.

Grundsätzlich lassen sich die gängigen Produkte, bei denen eine Check-in /check-out oder eine Entwertung der Berechtigung vorgenommen wird, auch mit aktiven NFC-Trägermedien abbilden. Ein besonderer Schwerpunkt soll jedoch auf die NFC-basierte CICO-Variante, die in Anlehnung an die VDV KA definiert wurde, gelegt werden.

<span id="page-15-0"></span>Als Trägermedium für den Einsatz im ÖPV kann universell das "sichere NFC-Mobiltelefon" verwendet werden.

Die Produkte werden über folgende Kanäle vertrieben:

- 7 Direkter Vertrieb durch den Produktanbieter:
	- a Internetvertrieb
- 8 Vertrieb über Wiederverkäufer:
	- a Internetvertrieb

Die verschiedenen Vertriebskanäle und ihre Eigenschaften sind in der folgenden Tabelle beschrieben:

| Vertriebs<br>kanal                                                                               | Anlegen eines Kun<br>denkontos | Zuverlässige Identifi<br>zierung | Initialisieren von Kun<br>medien vor Ort<br>den | Direkte Ausgabe von<br>medien<br>Kunden | wendungen auf ex.<br>Aufbringen von An<br>medien<br>Kunden | rechtigungen auf ex.<br>Aufbringen von Be<br>medien<br>Kunden | Bezahlformen                                                                  | Verkaufspersonal vor<br>handen | m<br>Verkauf in sichere<br>Bereich | Mobiler Verkaufsbe<br>trieb | Online-Anbindung an<br>Verkaufs- und Mana<br>me<br>mentsyste<br>ge |
|--------------------------------------------------------------------------------------------------|--------------------------------|----------------------------------|-------------------------------------------------|-----------------------------------------|------------------------------------------------------------|---------------------------------------------------------------|-------------------------------------------------------------------------------|--------------------------------|------------------------------------|-----------------------------|--------------------------------------------------------------------|
| Kunden<br>zentrum /<br>Verkaufs<br>stelle                                                        | +                              | +                                | Over-the-air                                    | +                                       | Over-the-air                                               | +                                                             | Cash, Kar<br>ten, Last<br>schrift                                             | +                              | –                                  | +                           | +                                                                  |
| Servicecen<br>ter (Telefon,<br>Internet)                                                         | +                              | –                                | Over-the<br>air                                 | Postver<br>sand                         | Over-the<br>air                                            | –                                                             |                                                                               | +                              | –                                  | –                           | +                                                                  |
| Internet (via<br>Mobilnetz)                                                                      | +                              | –                                | the-air<br>Over                                 | –                                       | +                                                          | +                                                             |                                                                               | –                              | –                                  | +                           | +                                                                  |
| Internet (via<br>Mobilnetz)<br>und Anmel<br>dung Kun<br>denkonto<br>mit siche<br>rem ID<br>Token | +                              | +                                | Over-the-air                                    | –                                       | +                                                          | +                                                             | Karten, Lastschrift, Akzeptanz von sys<br>mspezifischen Bezahlverfahren<br>te | –                              | –                                  | +                           | +                                                                  |

**Tabelle 2–1 Übersicht über Vertriebsformen und deren Eigenschaften** 

 "+" zeigt an, dass die Funktion oder Eigenschaft für den Vertriebskanal zu berücksichtigen ist.

"-" zeigt an, dass keine relevante Beziehung zwischen Funktion/Eigenschaft und dem speziellen Vertriebskanal existiert.

"+" grau hinterlegte Symbole kennzeichnen die künftig erwarteten Entwicklungen.

1 Verkauf durch Personal

Beim Vertrieb über Kundenzentren und Verkaufsstellen findet eine direkte Interaktion zwischen dem Kunden und dem Personal des Produktanbieters (KVP) statt.

Gemeinsamkeiten dieser Vertriebswege sind die Möglichkeit der Identifizierung des Kunden durch das Personal (z. B. Personalausweis) und die flexible Handhabung von Bezahlverfahren, etc.

Unterschiede ergeben sich aus den verschiedenen technischen Möglichkeiten.

Die Initialisierung von NFC-Mobiltelefonen ist möglich, wenn diese "over-the-air" über das Mobilnetz ausgeführt wird. In jedem Fall können Kundenmedien in Kundenzentrenoder Verkaufsstellen bestellt und dann dem Kunden nach Hause zugestellt werden. Alternativ kann das initialisierte und personalisierte Kundenmedium auch zur Abholung im Kundenzentrum bereitgelegt werden. Ggf. ist die Initialisierung auch über andere Schnittstellen (z. B. NFC) möglich.

Das Aufbringen von Produkten bzw. Berechtigungen auf existierende personalisierte und unpersonalisierte NFC-Mobiltelefone kann ebenfalls "over-the-air" über das Mobilnetz ausgeführt werden. Alternativ kann die NFC-Schnittstelle zum Einbringen von Berechtigungen genutzt werden. Dies erfordert eine direkte Kommunikation zwischen dem Kundenmedium und dem Verkaufssystem über ein geeignetes Lesegerät. Eine solche Möglichkeit wird zur Zeit in Kundenzentren und lokalen Verkaufsstellen für personalisierte und unpersonalisierte Produkte zur Aufbringung auf Kundenkarten bereits unterstützt. Unpersonalisierte Produkte können auch offline über Secure Authentication Module (SAM) verkauft werden.

2 Service Center (Internet bzw. Hotline)

Der Kunde übergibt die persönlichen Informationen, die Bestellung und Zahlungsinformationen per Internet (Webpage) oder Hotline an ein zentrales Servicecenter. Bei der Bestellung beim Service-Center kann meistens die Verfügbarkeit des Produkts und ggf. die Sitzplatzreservierung direkt geklärt werden. Die Bezahlung erfolgt per Kreditkarte, per Lastschrift, etc. Produkte und Kundenmedien werden zugesendet oder könnten zur Abholung im Kundenzentrum bereitgestellt werden.

Die durch Eingabe auf der Webpage oder am Telefon erhaltenen Angaben zur Person und zur Adresse sind nicht grundsätzlich als vertrauenswürdig anzusehen. Eine belastbare Überprüfung ist mit zusätzlichem Aufwand erfolgen. Üblicherweise wird lediglich ein Abgleich mit einer aktuellen Adressdatenbank und eine Bonitätsprüfung durchgeführt.

3 Internet unter Verwendung von Kartenleser und sicherem Identitätsnachweis (z. B. eID) In Zukunft kann ggf. eine zusätzliche Option zur Anmeldung und Bestellung umgesetzt werden.

Dabei übergibt der Kunde die Bestellung und die Zahlungsinformationen per Internet (Webpage) an ein zentrales Servicecenter. Die Identifizierung und Übergabe von personenbezogenen Daten (sofern erforderlich) erfolgt online über eine direkte Kommunikation zwischen dem Anwendungsserver des Ticketanbieters und einer sicheren Bürgerkarte (eID). Dies kann z. B. möglicherweise (durch den künftigen elektronischen Personalausweis (ePA) realisiert werden,

Bei der Bestellung im Internet kann meistens die Verfügbarkeit des Produkts und z. B. die Sitzplatzwahl direkt geklärt werden. Die Bezahlung erfolgt per Kreditkarte, per Lastschrift, etc. Produkte und Kundenmedien werden per Post zugesendet oder am Veranstaltungsort zur Abholung (Verkaufsstelle, Automat) bereitgestellt.

Die durch Kommunikation mit dem elektronischen Identitätsnachweis erhaltenen Angaben zur Person und zur Adresse sind grundsätzlich als vertrauenswürdig und belastbar anzusehen. Eine weitere Überprüfung ist nicht erforderlich.

# <span id="page-17-0"></span>**3 Vereinbarungen**

# **3.1 Definition von Begriffen**

#### Einsatzgebiet

Bereich, in dem die technische Richtlinie Anwendung finden soll. Höchste Einheit in der Begriffsstruktur. Umfasst eine oder mehrere Anwendungen, die jeweilig zugehörigen Produkte/Dienste und den daraus resultierenden Einsatzszenarien.

#### Einsatzszenario

Spezielle Betrachtung des Einsatzgebiets im Hinblick auf die Implementierung spezifischer Produkte bzw. Dienste.

#### Betriebsprozess

Umfassender betrieblicher Ablauf des eTicketing. Beispiele sind der Verkaufsprozess, Nutzung der Berechtigung, Clearing, etc.

### Anwendungsfall/ Nutzungsfall

Detaillierte Beschreibung einer Aktivität- bzw. eines Handlungsablaufs, der Teil eines Betriebsprozesses ist. Beispiele sind die Initialisierung eines Trägermediums oder das Nachladens einer Berechtigung.

#### Check-in / Check-out (CICO)

Bei Nutzung des Produkts "automatischen Fahrpreisberechnung" erfolgt ein Anmelden bei Beginn (Check-in) als auch ein Abmelden bei Beendigung der Fahrt (Check-out). Dazu ist eine entsprechende Infrastruktur, die CICO-Infrastruktur, erforderlich. Bei Systemen, die Zutrittssperren verwenden, können diese genutzt werden. Sonst ist eine CICO-Infrastruktur aus lokalen Transpondern auf den Bahnsteigen, an den Haltestellen oder in den Fahrzeugen zu installieren.

### Interfunktionsfähigkeit

Interfunktionsfähigkeit bedeutet, dass der Kunde Berechtigung bei verschiednene Produktanbietern erwerben, ggf. mit dem im System vereinbarten Bezahlverfahren bezahlen und diese Berechtigungen bei mehreren Dienstleistern einlösen kann. Die jeweils erbrachten Leistungen werden den Dienstleistern vom Produkteigentümer bzw. Produktanbieter über eine Clearing-Prozedur vergütet. Die Forderung nach Interfunktionsfähigkeit entsteht zwischen Verbünden aber auch innerhalb eines Verbundes zwischen den einzelnen Verkehrsunternehmen. Die Abrechnungsgenauigkeit ist dabei ein zentrales Element, da hierdurch die Einnahmen der Dienstleister bestimmt werden. In der Vergangenheit basierte die Verteilung in Verbünden auf Verkehrsflussanalysen, Statistiken und Schätzungen. Mit Einführung der CICO-Technik kann technisch Abrechnungsgenauigkeit erreicht werden.

### Nutzungsdaten

Die Abrechnung des Produkts "Automatische Fahrpreisberechnung" basiert auf Daten, die bei der Nutzung des Dienstes durch den Kunden erhoben werden. Dazu meldet sich der Kunde mit seinem Kundenmedium an einem lokalen Transponder an (Check-in) und nach der Nutzung wieder ab (Check-out). Die dabei gewonnenen Nutzungsdaten werden im Erfassungssystem und dem Kundenmedium gespeichert. Die Verlässlichkeit dieser Daten ist die Basis für eine verlässliche Rechnungsstellung an den Kunden und die Interfunktionsfähigkeit zwischen Dienstleistern.

### <span id="page-18-0"></span>Abrechnungsdaten

Der zur Abrechnung verwendete Teil der Nutzungsdaten wird Abrechnungsdaten genannt. Die Abrechnungsdaten enthalten z. B. Informationen zur Berechtigung, den Produkteigentümer, den Dienstleister, den Ort und die Zeit des Check-in / Check-out. Je nachdem ob eine personalisierte oder anonyme Berechtigung verwendet wird, können die Daten dem Kunden zugeordnet werden. Die Abrechnungsdaten werden vom Dienstleister, der sie im Erfassungssystem sammelt, an den Produkteigentümer weitergeleitet. Die Authentizität, Integrität und Vertraulichkeit der Abrechnungsdaten ist sowohl für den Kunden als auch für die Dienstleister von großer Bedeutung.

# Statistikdaten

Statistikdaten geben Aufschluss über die generelle Nutzung eines Produkts, einer Linie, eines Fahrzeugs, etc. Bei der Berechtigung "Automatische Fahrpreisberechnung" können die Statistikdaten aus den Nutzungsdaten gewonnen werden. Bei anderen Produkten können Nutzungsdaten bei der Prüfung der Berechtigung vor dem Zutritt erhoben werden. Statistikdaten werden in anonymisierter und statistisch aufbereiteter Form gespeichert und verwendet. Statistikdaten werden nicht für die Abrechnung eines Dienstes mit dem Kunden sondern für Planungszwecke des Dienstleisters oder Produkteigentümers verwendet. Deshalb liegen sie nur in anonymisierter Form vor. Statistikdaten können allerdings für die generelle Aufteilung von Einnahmen zwischen Dienstleistern herangezogen werden.

# <span id="page-18-1"></span>**3.2 Generische Modellierung von Rollen und Entitäten**

Die Beschreibung der Rollen- und Verantwortlichkeiten soll in Anlehnung an die Norm ISO 24014 erfolgen.

![](_page_18_Figure_7.jpeg)

#### **Abbildung 3–1 Entitäten eines Einsatzgebiets nach ISO 24014 (erweitert um Entitäten des Kundenmediums)**

In der ISO 24014 werden Entitäten definiert und diesen Rollen und Verantwortlichkeiten zugewiesen. Die Implementierung für die Einsatzgebiete eTicketing ist im Folgenden beschrieben:

#### Akteur

Entitäten, die entsprechend der zugewiesenen Rolle handeln.

#### Kunde

Käufer für Produkte und Nutzer der damit verbundenen Dienste. Erhält gegen Bezahlung vom Produktanbieter die Berechtigung zur Nutzung von Diensten. Löst diese Berechtigung beim Dienstleister ein.

#### Kundenmedium

Das Kundenmedium ist ein Datenträger, in dem die elektronische Berechtigung gespeichert werden kann. Das Kundenmedium ist im Besitz des Kunden und wird von diesem zur Nutzung der Berechtigung benötigt. Weitere übliche Bezeichnungen sind Nutzermedium und Trägermedium. Ausprägungen des Kundenmediums sind z. B. das Smart Ticket, eine Chipkarte oder ein aktives oder passives NFC-Mobiltelefon (NMD). Das aktive NFC-Mobiltelefon erfüllt daneben auch Aufgaben der Erfassungsinfrastruktur und der Ausgabe von Berechtigungen.

#### Herausgeber Kundenmedium

Der Herausgeber des Kundenmediums konfiguriert dieses für die weitere Nutzung. Der Herausgeber vermarktet das Kundenmedium ggf. über Anbieter von Kundenmedien(z. B. ein Verkehrsunternehmen). Zwischen Herausgeber des Kundenmediums, Anwendungsherausgeber und Systemmanager ist eine enge Abstimmung und vertragliche Bindung erforderlich.

#### Anbieter Kundenmedium

Der Anbieter des Kundenmediums (z. B. ein Verkehrsunternehmen oder ein Mobilfunkprovider) vermarktet das Kundenmedium, die er vom Herausgeber des Kundenmediums erhalten hat. Der Anbieter des Kundenmediums implementiert üblicherweise mit der Ausgabe auch eine Anwendung.

#### Anwendung

Die Anwendung (oft auch Applikation genannt) unterstützt ein oder mehrere Produkte durch die Bereitstellung von Funktionen und Strukturen zur Aufnahme von z. B. Berechtigungen auf dem Trägermedium, im Verkaufssystem und im Hintergrundsystem. Die Implementierung folgt der Anwendungsspezifikation, die üblicherweise dem Anwendungsherausgeber gehört. Der Anwendungsherausgeber vermarktet die Anwendung ggf. über Anwendungsanbieter (z. B. einen Verkehrsverbund). Neben den Produkten kann eine Anwendung z. B. auch kundenspezifische Informationen enthalten.

#### Anwendungsherausgeber

Der Anwendungsherausgeber ist der Eigentümer der Anwendungsspezifikation. Der Anwendungsherausgeber vermarktet die Anwendung ggf. über Anwendungsanbieter (z. B. ein Verkehrsunternehmen).

#### Anwendungsanbieter

Der Anwendungsanbieter (z. B. ein Verkehrsunternehmen oder ein Stadionbetreiber) implementiert und vermarktet die Anwendung, die er vom Anwendungsherausgeber erhalten (z. B. lizensiert) hat. Der Anwendungsanbieter gibt ggf. mit der Anwendungsimplementierung auch das Trägermedium aus und ist damit z. B. bei Anwendungen aus dem Einsatzgebiet 'eTicketing' der Vertragspartner des Kunden.

### Produkt/Berechtigung/Dienst

Das Produkt ist das Leistungsangebot eines Produkteigentümers, das der Kunde gegen Bezahlung in Anspruch nehmen kann. Das Produkt gehört dem Produkteigentümer (z. B. einem Veranstalter von Konzerten) und wird direkt oder ggf.

<span id="page-20-0"></span>über einen Produktanbieter (z. B. Reisebüro oder Vorverkaufsstelle) dem Kunden angeboten. Bei Kauf des Produktes erhält der Kunde eine Berechtigung zur Benutzung eines Dienstes, die er beim Dienstanbieter (z. B. Verkehrsunternehmen) einlösen kann.

#### Produkteigentümer

Eigentümer des Produkts (z. B. Einzelzutritt zu einem Bundesligaspiel). Der Produkteigentümer definiert und vermarktet das Produkt ggf. über Produktanbieter (z. B. eine Vorverkaufsstelle). In einfachen Szenarien ist es jedoch üblich, dass der Produkteigentümer auch die Rolle des Produktanbieters innehat. Um sicherzustellen, dass die Anwendung das Produkt unterstützen kann, muss der Produkteigentümer bei der Definition des Produktes den Spezifikationen des Anwendungsherausgebers folgen. Weiterhin ist eine enge Abstimmung zwischen dem Produkteigentümer und dem Dienstleister, der die mit dem Produkt versprochene Leistung erbringen soll, erforderlich. Zwischen Produkteigentümer, Produktanbieter und Dienstleister ist eine vertragliche Bindung erforderlich.

#### Produktanbieter

Vermarktet das Produkt im Auftrag des Produkteigentümers gegen eine Gebühr. Der Produktanbieter empfängt die Zahlung des Kunden und ist damit die einzige Schnittstelle für Zahlungen. Dies erfordert eine direkte Abstimmung und vertragliche Bindung mit dem Produkteigentümer. Der Produktanbieter bringt das Produkt (z. B. eine Berechtigung) in die Anwendung auf dem Trägermedium ein. Der Produktanbieter ist der Vertragspartner des Kunden bezüglich der verkauften Berechtigungen zur Nutzung von Diensten. Organisatorisch bedient der Produkteigentümer oft auch die Rolle des Produktanbieters.

#### Dienstleister

z. B. Stadionbetreiber oder Verkehrsunternehmen. Gewährt dem Kunden gegen Vorlage der vom Produktanbieter gekauften Berechtigung eine Dienstleistung (z. B. Zutritt zu einem Stadion). Dies erfordert eine direkte Abstimmung und vertragliche Bindung mit dem Produktanbieter und dem Produkteigentümer.

#### Systemmanager

Der Systemmanager sorgt für die Einhaltung der Regeln des Systems. Hierzu bedient er sich der funktionalen Entitäten Sicherheitsmanager und Registrar.

#### Registrar

Der Registrar sorgt für die Vergabe eineindeutiger Identifizierungsmerkmale im System. Wird benötigt für eineindeutige Identifizierung der Entitäten, Trägermedien, Anwendungen und Produkte/Berechtigungen.

#### Sicherheitsmanager

Etabliert und koordiniert die Sicherheitsregeln im System. Ist verantwortlich für die Zulassung der Komponenten des Systems. Überwacht die Durchführung von sicherheitsrelevanten Funktionen (z. B. Schlüsselmanagement).

# <span id="page-20-1"></span>**3.3 Zuordnung der Rollen und Entitäten im Einsatzgebiet eTicketing im ÖPV**

Die Umsetzung der in Kapitel [2](#page-14-1) beschriebenen Dienste erfordert in der Maximalkonfiguration ein Zusammenwirken verschiedener und wechselnder Akteure. Zum Beispiel muss ein Dienstleister in die Lage versetzt werden, Produkte verschiedener Produkteigentümer und Anbieter zu verarbeiten und die Abrechnung entsprechend zu unterstützen.

<span id="page-21-0"></span>Die Zuordnung der Entitäten dieses Einsatzgebietes ist identisch zur generischen Beschreibung aus Kapitel [3.2](#page-18-1). In der folgenden Abbildung sind zusätzlich exemplarisch die wesentlichen Akteure entsprechend der Definitionen der VDV Kernapplikation benannt:

![](_page_21_Figure_2.jpeg)

**Abbildung 3–2 Entitäten des Einsatzgebiets "eTicketing für den öffentlichen Personenverkehr"** 

<span id="page-21-1"></span>In der Spezifikation zur VDV Kernapplikation können einige der Rollen zusammengefasst werden:

- 1 Der Kundenvertragspartner (KVP) übernimmt die Rollen des Anbieters für Anwendung und Produkt. In Ausnahmefällen können auch vorkonfigurierte NFC-Mobiltelefone als Kundenmedium mit Anwendung und Berechtigung ausgegeben werden.
- 2 Die VDV KA GmbH übernimmt die Rollen des Systemmanagers (inkl. Sicherheitsmanager und Registrar) und auch des Anwendungsherausgebers.

Darauf basierend wird die generische [Abbildung 3–2](#page-21-1) in die folgende spezifische Darstellung überführt:

![](_page_21_Figure_8.jpeg)

**Abbildung 3–3 Entitäten des Einsatzszenarios "VDV Kernapplikation"** 

# <span id="page-22-0"></span>**3.4 Beziehung zwischen Trägermedien, Anwendungen und Berechtigungen**

Das Modell aus den Kapiteln [3.2](#page-18-1) und [3.3](#page-20-1) erlaubt die Unterstützung von jeweils mehreren Produktanbietern, Dienstleistern, Anwendungsherausgebern, usw.

Dementsprechend sind auch eine große Zahl verschiedener Trägermedien, Anwendungen und Produkte denkbar.

Das Kunden- oder Trägermedium ist der Datenträger des Kunden, auf dem er seine Berechtigungen speichert und mit dessen Hilfe er die zugeordneten Dienste in Anspruch nimmt.

Anwendungen stellen die Strukturen und Funktionen für das Aufbringen und die Nutzung von Berechtigungen auf Trägermedien bereit. Anwendungsimplementierungen müssen deshalb den Eigenschaften spezifischer Trägermedien und Berechtigungen Rechnung tragen.

Berechtigungen können vom Kunden beim Dienstleister in Leistungen umgetauscht werden.

Folgende Regeln gelten für die Beziehungen zwischen Trägermedien, Anwendungen und Berechtigungen:

- 1 Ein Trägermedium kann mindestens eine Anwendung aufnehmen. Sofern mehr als eine Anwendung aufgebracht werden kann, spricht man von multiapplikationsfähigen Trägermedien.
- 2 Eine Anwendung kann mindestens eine Berechtigung aufnehmen. Bei der Anwendung VDV Kernapplikation können verschiedene Berechtigungen verschiedenen Typs, die von verschiedenen Produktanbietern stammen können, gleichzeitig unterstützt werden. Personenbezogene Daten und Check-in / Check-out Daten werden ggf. in der Anwendung gespeichert.
- 3 Anwendungen auf einem Trägermedium können von verschiedenen Anwendungsherausgebern bzw. -anbietern stammen.
- 4 Berechtigungen in einer Anwendung können von verschiedenen Produkteigentümern bzw. -anbietern stammen.
- 5 Berechtigungen des gleichen Typs können in verschiedene Anwendungen eingebracht werden.

<span id="page-23-0"></span>Die folgende Abbildung zeigt ein Beispiel für die Beziehungen zwischen Trägermedien, Anwendungen und Berechtigungen.

![](_page_23_Figure_2.jpeg)

**Abbildung 3–4 Trägermedien, Anwendungen und Berechtigungen** 

# <span id="page-24-1"></span><span id="page-24-0"></span>**4 Generelle Anforderungen**

Die Anforderungen an das Gesamtsystem und dessen Prozesse und Komponenten lassen sich in drei Kategorien gliedern.

# **4.1 Funktion**

# **4.1.1 Anforderungen des Kunden**

Aus Sicht des Kunden sollten z. B. die folgenden Eigenschaften umgesetzt werden:

- Die Kundenmedien und Systeme und müssen einfach zu handhaben sein.
- Das Kundenmedium muss robust sein und zuverlässig und performant funktionieren.
- Die Berechtigung bzw. das Kundenmedium muss ggf. bei verschiedenen Dienstleistern einfach und zuverlässig zu nutzen sein.
- Die Abrechung bei Produkten "Automatische Fahrpreisberechnung" muss zuverlässig und nachvollziehbar sein.
- Abhanden gekommene Berechtigungen sollten gegen eine Aufwandsentschädigung ersetzt werden können. Gleiches sollte für den Umtausch von Berechtigungen gelten.
- Der Kauf von anonymen Berechtigungen muss optional möglich sein.
- Die personenbezogenen Daten (so vorhanden) müssen angemessen geschützt sein.

Generell sollte der Kunde beim Einsatz der kontaktlosen Chiptechnik über die verwendeten personenbezogenen Daten, die Verwendung dieser Daten, Maßnahmen zum Datenschutz und verbleibende Risiken offen informiert werden.

# **4.1.2 Anforderungen des Produktanbieters und des Dienstleisters**

Funktionalität

- Die Verwendung der Kundenmedium und Systeme muss den Kunden und dem eigenen Personal mit wenig Erklärungsaufwand vermittelbar sein.
- Die Umsetzung der Systemkomponenten und Prozesse muss den besonderen Bedingungen des ÖPV Rechnung tragen. Z. B. kann in Fahrzeugen kein permanenter Datenzugang zum Gesamtsystem sichergestellt werden. Deshalb muss z. B. der Erwerb von Berechtigungen sowie Entwertung bzw. Check-in / Check-out und die Kontrolle auch möglich sein, wenn die jeweiligen Terminals nicht während des gesamten Prozesses online sind.
- Sperrung und Ersatzausstellung von personalisierten Berechtigungen und Kundenmedien muss unterstützt werden.
- Generell muss bei Zutrittssperren und Check-in/Check-out-Systemen der erforderliche Durchsatz gewährleistet sein.

Technische Kompatibilität

• Die Kompatibilität der Systemkomponenten muss auch dann sichergestellt sein, wenn Trägermedien, Systeme und Komponenten von unterschiedlichen Hersteller und Anbietern kommen und bei verschiedenen Dienstleistern zum Einsatz gebracht werden.

# <span id="page-25-0"></span>**4.2 Wirtschaftlichkeit**

Ein wirtschaftlicher Betrieb des eTicketing-Systems erfordert, dass der kommerzielle Nutzen in jeder Ausbaustufe größer als die Kosten für Prozesse, Systeme und Sicherheit ist. Dies muss für alle Akteure, die in den Aufbau des Systems investieren, gelten.

Das Gesamtsystem und dessen Komponenten sollte daher so ausgelegt werden, dass die Anforderungen der relevanten Einsatzszenarien möglichst effizient erfüllt werden. Deshalb sind zunächst diese Anforderungen möglichst exakt zu bestimmen.

# **4.3 Sicherheit**

Auf Anforderungen zur Sicherheit wird in diesem Dokument ab Kapitel [8.2](#page-57-1) speziell eingegangen.

# <span id="page-26-0"></span>**5 Methodik zur Ermittlung der Sicherheitsanforderungen**

# **5.1 Zielsetzung**

Die Technische Richtlinie RFID soll folgenden Zielen dienen:

- Leitfaden für Systemlieferanten und Systemanwender zur sachgerechten Implementierung von spezifischen RFID-Systemlösungen bzgl. Funktions- und Informationssicherheit und Datenschutz.
- Schaffung von Aufmerksamkeit und Transparenz in Bezug auf Sicherheitsaspekte.
- Basis für eine Konformitätserklärung der Systemlieferanten oder Betreiber und die Vergabe eines Gütesiegels durch eine Zertifizierungsstelle.

Zur Umsetzung dieser Ziele sind folgende Informationen erforderlich:

- Ermittlung der Sicherheitsanforderungen an ein RFID-System eines Einsatzgebietes.
- Benennung der spezifischen Gefährdungen, geeigneter Gegenmaßnahmen und des möglicherweise verbleibenden Restrisikos.
- Definition der Kriterien für eine Konformitätserklärung bzw. Zertifizierung.

Bei der Definition von Maßnahmen und Systemvorschlägen sind nicht nur Sicherheitsaspekte relevant. Vielmehr müssen alle in Kapitel [4](#page-24-1) benannten Anforderungen berücksichtigt werden.

# **5.2 Methodik**

# **5.2.1 Erwägungen zum Umfang der Systembetrachtung**

RFID-basierte Systeme können sehr komplex sein. In den meisten Fällen gehören zur Systemlösung auch viele Komponenten, die nicht mit RFID ausgestattet sind. Auf der anderen Seite dürfen bei der Betrachtung der Systemsicherheit nicht nur das Medium/das Tag und die Lesegeräte berücksichtigt werden.

Die Technische Richtlinie muss alle für RFID relevanten Sicherheitsaspekte im Detail einbeziehen. Diese Aspekte hängen stark vom Einsatzgebiet und der jeweiligen Implementierung der Systemlösung ab. Diese Technische Richtlinie enthält daher detaillierte Angaben über das Einsatzgebiet und die dazugehörenden Betriebsprozesse (einschließlich der Vertriebskanäle und -prozesse). Basierend auf diesen Informationen werden RFID-relevante Anwendungsfälle bestimmt. Die Prozesse und Anwendungsfälle decken den gesamten Lebenszyklus eines Trägermediums oder Transponders ab. Basierend auf diesen Prozessen werden Anwendungsfälle bestimmt, die aus für die Sicherheitsbetrachtung des RFID-Systems relevant sind. Diese Anwendungsfälle werden dann als Grundlage für die Ermittlung von Gefährdungen und eine detaillierte, systemspezifische Sicherheitsbewertung für die mit RFID im Zusammenhang stehenden Bereiche des Systems genutzt. [Abbildung 5–1](#page-27-1) zeigt diese Vorgehensweise am Beispiel des eTicketing im ÖPV.

<span id="page-27-0"></span>![](_page_27_Figure_1.jpeg)

**Abbildung 5–1 Beispiel: Bestimmung RFID-relevanter Anwendungsfälle für eTicketing** 

<span id="page-27-1"></span>Alle anderen Systemkomponenten werden nur allgemein behandelt. Die vorgeschlagenen Sicherheitsmaßnahmen basieren auf den bekannten offenen IT-Sicherheitsstandards.

Dieses Konzept legt den Schwerpunkt der Betrachtung auf die für RFID relevanten Systemteile und gewährleistet dennoch die Berücksichtigung aller Sicherheitsaspekte. Auf der anderen Seite lässt die Technische Richtlinie auch Raum für individuelle und anwendereigene IT-Implementierungen (Back Offices, Vertriebs- und Logistiksysteme etc.). Dies unterstützt insbesondere die Erweiterung bestehender Systeme um die RFID-Technologie.

# **5.2.2 Skalierbarkeit und Flexibilität**

Diese Technischen Richtlinien müssen sollen in erster Linie Sicherheitsfragen behandeln. Parallel muss für alle Implementierungen, die auf dieser Richtlinie aufsetzen, Wirtschaftlichkeit ein wirtschaftlicher Betrieb sichergestellt möglich werden. Daher sollen die folgenden Anforderungen an die Methodologie der Richtlinie berücksichtigt werden:

- 1 Es muss möglich sein, Systeme so zu implementieren, dass eine Ausgewogenheit von Kosten und Nutzen erreicht wird. Dies bedeutet in der Praxis, dass die Schutzmaßnahmen den ermittelten Schutzbedarf zwar erfüllen aber nicht übertreffen müssen. Beispiel: Werden nur preiswerte Produkte verwendet, die eine relativ niedrige Sicherheitsanforderung haben, sollten die Schutzmaßnahmen entsprechend gestaltet werden. Dies ermöglicht beispielsweise die Verwendung preiswerter Medien, wodurch sich die Kosten für die Systemimplementierung und den Betrieb verringern.
- 2 Die für die Technische Richtlinie ausgewählten Einsatzszenarios umfassen eine große Bandbreite, von kleinen bis zu landesweiten oder sogar grenzüberschreitenden Anwendungen. Wichtig ist, dass das in der Richtlinie verwendete Konzept für Systemlösungen aller Größen und verschiedener Komplexität genutzt werden kann.

<span id="page-28-0"></span>3 In vielen Fällen lässt sich die Wirtschaftlichkeit einer Systemlösung wesentlich leichter durch die Kooperation mit Geschäftspartnern erreichen. Dies gilt insbesondere für eTicketing-Anwendungen, bei denen es sehr vorteilhaft sein kann, wenn bereits beim Kunden verfügbare Medien (z. B. Karten mit Mehrfachanwendung oder NFC-fähige Telefone) für zusätzliche Anwendungen, Produkte und damit verbundene Dienstleistungen wiederverwendet werden können.

Die folgenden Abbildungen zeigen Beispiele von eTicketing für eine system- und anwendungsübergreifende Nutzung von Kundenmedien und -infrastruktur.

[Abbildung 5–2](#page-28-1) zeigt, dass u. U. verschiedene Produkte bzw. Einsatzszenarios in einem System unterstützt werden müssen. Dabei werden diese Produkte möglicherweise auf verschiedene Trägermedien aufgebracht.

![](_page_28_Figure_4.jpeg)

#### **Abbildung 5–2 Beispiel für Einsatzszenarios und RFID-relevante Anwendungsfälle für eTicketing im ÖPV**

<span id="page-28-1"></span>[Abbildung 5–3](#page-28-2) zeigt ein Beispiel eines Kundenmediums für eTicketing, das Anwendungen aus zwei Einsatzgebieten unterstützt.

![](_page_28_Figure_7.jpeg)

#### **Abbildung 5–3 Hierarchisches Konzept für Medien, Anwendungen und Tickets beim eTicketing**

<span id="page-28-2"></span>Um die genannten Anforderungen zu erfüllen, wird für diese Technische Richtlinie folgendes Konzept verwendet:

- <span id="page-29-0"></span>1 Ein passendes Rollenmodell und die Struktur einiger Hauptelemente (Produkte, Applikationen und Medien) wurden in Kapitel 3 beschrieben. Dieses Modell unterstützt einen in skalierbaren und erweiterbaren Ansatz.
- 2 Die Technische Richtlinie muss Sicherheitskonzepte anbieten, die alle in einer Infrastruktur verwendeten Kombinationen von Einsatzszenarios und Medien umfassen. Dies wird durch individuelle Sicherheitsbewertungen, die auf den RFID-relevanten Anwendungsfällen basieren, erreicht.
- 3 Gleiche Einsatzgebiete (insbesondere im eTicketing), die die Möglichkeit für anwendungsübergreifende Partnerschaften bieten, werden in den entsprechenden Technischen Richtlinien mit so viel Kommunalität wie möglich behandelt. Die Sicherheitsbewertung basiert auf ähnlichen Sicherheitszielen. Die Schutzmaßnahmen verwenden wenn möglich die gleichen Mechanismen.
- 4 Eine besondere Herausforderung besteht bei system- und anwendungsübergreifenden Partnerschaften im Hinblick auf die Systemsicherheit. Es muss gewährleistet sein, dass die Sicherheit eines Systems nicht von Schwächen eines anderen Systems untergraben wird. Dies erfordert normalerweise eine umfassende Sicherheitsbewertung beider Systeme.

Die Technischen Richtlinien widmen sich diesem Problem durch Einführung eines skalierbaren und transparenten Konzepts für die Anwendung von Schutzmaßnahmen gegenüber den festgestellten Gefährdungen, den "Schutzbedarfsklassen". Insgesamt werden drei Klassen von 1 (normale Anforderung) bis zu 3 (hohe Anforderung) verwendet. Alle Schutzmaßnahmen werden entsprechend in drei Stufen definiert, von normalem Schutz bis zu erweitertem Schutz.

Bei jeder individuellen Systemimplementierung wird zuallererst die Schutzanforderungskategorie für jedes Sicherheitsziel definiert. Daraus ergibt sich der Umfang der zu treffenden Schutzmaßnahmen.

Dieses Konzept bietet eine einfache Möglichkeit zur Installation einer sicheren Systemkooperation. Es muss lediglich sichergestellt werden, dass die Schutzbedarfsklassen beider Systeme zusammenpassen.

# **5.2.3 Aufbau der Technischen Richtlinie**

| Kapitel                         | Inhalt                                                                                       |
|---------------------------------|----------------------------------------------------------------------------------------------|
| Beschreibung des Einsatzgebiets | Beschreibung des Einsatzgebiets: Aufbau,<br>Leistungen, spezielle Randbedingungen<br>etc.    |
| Produkte und Leistungen         | Beschreibung von Beispielprodukten und -<br>leistungen sowie Vertriebskanälen                |
| Definitionen                    | Modelle, Begriffsdefinitionen                                                                |
| Einführung in die Methodologie  | Vorstellung des für die Sicherheitsbewer<br>tung verwendeten Konzepts sowie der Me<br>thoden |
| Allgemeine Anforderungen        | Allgemeine Anforderungen der beteiligten<br>Parteien, beachtenswerte Aspekte etc.            |
| Betriebsprozesse                | Beschreibung von Betriebsprozessen, die<br>für den Lebenszyklus von Trägermedien             |

[Tabelle 5–1](#page-30-1) zeigt den Aufbau aller bisher erstellten Technischen Richtlinien.

<span id="page-30-0"></span>

| Kapitel                                                 | Inhalt                                                                                                                                                                                                                                                                                            |
|---------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                                         | von Bedeutung sind                                                                                                                                                                                                                                                                                |
| Anwendungsfälle                                         | Definition von RFID-relevanten Anwen<br>dungsfällen                                                                                                                                                                                                                                               |
| Sicherheitsbewertung                                    | Einführung in die IT-Sicherheit                                                                                                                                                                                                                                                                   |
|                                                         | Definition spezieller Sicherheitsziele,<br>Schutzbedarfsklassen und Gefährdungen                                                                                                                                                                                                                  |
|                                                         | Vorgeschlagene Schutzmaßnahmen                                                                                                                                                                                                                                                                    |
| Definition von Einsatzszenarios                         | Definition von Beispielen für Einsatzszena<br>rios. Diese Beispiele decken die gesamte<br>Bandbreite relevanter Parameter ab, die in<br>einem bestimmten Einsatzgebiet auftreten<br>kann. Der Nutzer der technischen Richtlinie<br>kann diese Szenarios seinen eigenen Be<br>dürfnissen anpassen. |
| Implementierungsvorschlag für die System<br>lösung      | Generische Systembeschreibung mit Bei<br>spielen zur Durchführung einer Gefähr<br>dungsanalyse und machbarer Schutzmaß<br>nahmen für die Systemkomponenten                                                                                                                                        |
| Implementierungsvorschlag einzelner<br>Einsatzszenarios | Beispiele für die Verwendung des Konzepts<br>zur Sicherheitsbewertung                                                                                                                                                                                                                             |

**Tabelle 5–1 Aufbau der Technischen Richtlinien** 

# <span id="page-30-1"></span>**5.2.4 Erläuterung des Sicherheitskonzepts**

Jede Technische Richtlinie enthält Beispiele zur Durchführung der Sicherheitsbewertung in bestimmten Einsatzszenarios. Diese können an die Anforderungen und Randbedingungen der speziellen Systemimplementierung angepasst werden.

[Abbildung 5–4](#page-31-1) zeigt das in allen Technischen Richtlinien verwendete Konzept der Sicherheitsbewertung.

<span id="page-31-0"></span>![](_page_31_Figure_1.jpeg)

**Abbildung 5–4 Sicherheitsbewertungskonzept** 

<span id="page-31-1"></span>Alle Erwägungen basieren auf der klassischen Definition von Sicherheitszielen, die in [Abbildung 5–5](#page-31-2) gezeigt wird.

![](_page_31_Figure_4.jpeg)

<span id="page-31-2"></span>**Abbildung 5–5 Generische Sicherheitsziele** 

# <span id="page-32-1"></span><span id="page-32-0"></span>**6 Generische Geschäftsprozesse**

# **6.1 Prozess P1 "Anmeldung und Bestellung"**

# **6.1.1 Anlegen eines Kundenkontos, Erwerb von personalisierten Kundenmedien und Berechtigungen**

Zum Anlegen eines Kundenkontos und zum Erwerb einer personalisierten oder unpersonalisierten Berechtigung wendet sich der Kunde an den Produktanbieter (bzw. Kundenvertragspartner für VDV Kernapplikation). Falls der Kunde nicht im Besitz eines Trägermediums sein sollte, das mit einer geeigneten Anwendung versehenen ist, kann der Kunde über den Produktanbieter ein solches beziehen[1](#page-32-0) . Dazu arbeitet der Produktanbieter mit den Anbietern der Anwendung und des Kundenmediums zusammen.

Der Erwerb von kundenbezogenen Berechtigungen, Anwendungen und Trägermedien erfordert die Anmeldung des Kunden. Dabei übergibt der Kunde die geforderten persönlichen Daten (z. B. Name, Postadresse, Zahlungsinformationen) und bestellt das gewünschte Gut.

Normalerweise liegt es im Ermessen des Produktanbieters, welche Daten vom Kunden zwecks Identitäts- und Adressenfeststellung sowie Bonitätsprüfung verlangt werden.

Für die Anmeldung und Bestellung sollen exemplarisch folgende Prozesse betrachtet werden:

1 Bestellung im Kundenzentrum oder einer lokalen Verkaufsstelle

Der Kunde sucht die Verkaufsstelle (z. B. das Kundenzentrum eines Verkehrsunternehmens, eine Verkaufsstelle am Bahnhof oder ein Reisebüro) auf und bestellt das Produkt. Sofern die Bezahlung nicht nach der Leistungserbringung vereinbart ist (Post-Paid) erfolgt diese vor Ort. Im Idealfall kann die Verkaufsstelle das Kundenmedien mit der Anwendung versehen und vor Ort ausgeben. Ansonsten wird beides per Post zugestellt. Personenbezogene Daten sind nur gefordert, wenn ein kundenspezifisches Produkt oder ein Produkt mit KA-Bezahlverfahren per Lastschrift bestellt wird oder Postversand erforderlich ist.

Die Überprüfung der Identität und der personenbezogenen Daten erfolgt, sofern erforderlich, z. B. durch Vorlage des Personalausweises.

2 Servicecenter

Der Kunde übergibt die benötigten persönlichen Informationen, die Bestellung und Zahlungsinformationen per Fax, per schriftlichen Antrag oder telefonisch an ein zentrales Servicecenter. Bei der telefonischen Bestellung kann meistens die Verfügbarkeit des Produkts und z. B. die Sitzplatzwahl direkt geklärt werden. Sofern die Bezahlung nicht nach der Leistungserbringung vereinbart ist (Post-Paid) erfolgt diese per Kreditkarte, per Lastschrift, etc. Das initialisierte Kundenmedium und ggf. das Produkt werden zugesandt.

Die per Fax oder Telefon erhaltenen Angaben zur Person und zur Adresse sind nicht grundsätzlich als vertrauenswürdig anzusehen. Eine belastbare Überprüfung kann nur

<sup>1</sup> Der Fall, dass ein Kunde nur ein Kundenmedium mit einer Anwendung ohne ein Produkt erwerben möchte, erscheint nicht relevant und soll hier nicht betrachtet werden.

mit zusätzlichem Aufwand erfolgen. Üblicherweise wird lediglich ein Abgleich mit einer aktuellen Adressdatenbank und eine Bonitätsprüfung durchgeführt.

3 Internet

Der Kunde übergibt die persönlichen Informationen, die Bestellung und Zahlungsinformationen per Internet (Webpage) an ein zentrales Servicecenter. Bei der Bestellung im Internet kann meistens die Verfügbarkeit des Produkts und ggf. die Sitzplatzreservierung direkt geklärt werden. Sofern die Bezahlung nicht nach der Leistungserbringung vereinbart ist (Post-Paid) erfolgt diese per Kreditkarte, per Lastschrift, etc. Das initialisierte Kundenmedium und ggf. das Produkt werden zugesandt.

Die durch Eingabe auf der Webpage erhaltenen Angaben zur Person und zur Adresse sind nicht grundsätzlich als vertrauenswürdig anzusehen. Eine belastbare Überprüfung kann nur mit zusätzlichem Aufwand erfolgen. Üblicherweise wird lediglich ein Abgleich mit einer aktuellen Adressdatenbank und eine Bonitätsprüfung durchgeführt.

4 Internet unter Verwendung von Kartenleser und sicherem Identitätsnachweis (z. B. eID) In Zukunft kann ggf. eine zusätzliche Option zur Anmeldung und Bestellung umgesetzt werden.

Dabei übergibt der Kunde die Bestellung und die Zahlungsinformationen per Internet (Webpage) an ein zentrales Servicecenter. Die Identifizierung und Übergabe von personenbezogenen Daten (sofern erforderlich) erfolgt online über eine direkte Kommunikation zwischen dem Anwendungsserver des Ticketanbieters und einem sicheren elektronischen Identitätsnachweis.

Bei der Bestellung im Internet kann meistens die Verfügbarkeit des Produkts und z. B. die Sitzplatzwahl direkt geklärt werden. Die Bezahlung erfolgt per Kreditkarte, per Lastschrift, etc.

Die durch Kommunikation mit dem sicheren elektronischen Identitätsnachweis erhaltenen Angaben zur Person und zur Adresse sind grundsätzlich als vertrauenswürdig und belastbar anzusehen. Eine weitere Überprüfung ist nicht erforderlich.

Wird ein Kundenmedium bestellt, so wird dieses zugeschickt.

Besitzt der Kunde bereits ein geeignetes NFC-Mobiltelefon, so muss er dessen Kenndaten angeben um das Aufbringen der Anwendung zu ermöglichen. Die Anwendung und die Berechtigung kann über die Internetverbindung des NFC-Mobiltelefons geladen werden.

Die folgende [Abbildung 6–1](#page-34-1) zeigt den Prozess P1A "Anmeldung und Bestellung".

<span id="page-34-0"></span>![](_page_34_Figure_1.jpeg)

**Abbildung 6–1 Prozessdarstellung P1A "Anmeldung und Bestellung"** 

<span id="page-34-1"></span>Das Anlegen eines Kundenkontos und die Bestellung können auch voneinander unabhängig erfolgen. Das Kundenkonto wird einmalig angelegt. Alle später erfolgenden Bestellungen können über das Kundenkonto abgewickelt werden. In diesen Fällen ist eine sichere Authentisierung beim Zugang zum Kundenkonto erforderlich.

# **6.1.2 Erwerb von unpersonalisierten Trägermedien und Berechtigungen**

Eine besondere Bedeutung kommt im ÖPV dem anonymen Verkauf und dem Verkauf von unpersonalisierten Produkten zu. In diesen Fällen wird kein Kundenkonto angelegt bzw. ein existierendes Kundenkonto nicht genutzt. Das Produkt wird auf einem unpersonalisierten Trägermedium geliefert oder auf ein existierendes Kundenmedium anonym aufgebracht.

Der Erwerb von unpersonalisierten Produkten schließt die Möglichkeit zur Zahlung per Lastschrift aus.

Falls ein Produkt, das eine Fahrpreisfindung nach Fahrtantritt beinhaltet, verwendet wird (z. B. VDV Kernapplikation), muss eine Pre-Paid-Lösung zum Bezahlung vorgesehen werden. Dies kann durch eine anonyme Bezahlfunktion oder einen speziellen Werteinheitenspeicher auf dem Trägermedium erfolgen.

Der Kunde muss grundsätzlich vor der Nutzung des Produkts die Zahlung leisten bzw. bei automatischer Fahrpreisfindung vor dem Fahrtantritt für ein ausreichendes Guthaben zur Ausgleich des in Anspruch genommenen Beförderungsdienstleistung sorgen.

<span id="page-35-0"></span>Der anonyme Verkauf erfordert, dass die Zahlung sofort erfolgt, das Trägermedium ggf. initialisiert die Berechtigung aufgebracht und vom Kunden auf dem Trägermedium mitgenommen werden kann. Unpersonalisierte Berechtigung werden vor Ort erstellt und auf vorhandene oder neue Kundenmedien aufgebracht. Die Zahlung erfolgt bar, per Karte oder über ein anonymes Pre-Paid Verfahren.

Folgende Vertriebskanäle können genutzt werden:

1 Verkaufsstelle/Kundenzentrum, Reisebüro

In Zukunft könnten unpersonalisierte Kundenmedien vor Ort erstellt oder auch unpersonalisierte Berechtigungen und Wertguthaben auf existierende Kundenmedien aufgeladen werden.

2 Automat

Der Verkauf von Fahrscheinen durch Automaten ist gängige Praxis für Papiertickets. In Zukunft könnten unpersonalisierte Berechtigungen durch den Automaten erstellt und über die NFC-Schnittstelle auf NFC-Mobiltelefone aufgeladen werden, die bereits die nötige Initialisierung besitzen.

Bei Verwendung von Berechtigungen mit Automatischer Fahrpreisermittlung kann das Aufladen von Pre-Paid-Guthaben (z. B. eines Werteinheitenspeichers WES) am Automaten erfolgen.

3 Internet

Unpersonalisierte Berechtigungen können im Internet erstanden und bezahlt und auf existierende Kundenmedien aufgeladen werden. Die Zahlung erfolgt über ein Pre-Paid-Verfahren oder per Karte. Beide Anwendungen könnten ebenfalls auf ein NFC-Mobiltelefon aufgebracht werden.

Das Aufladen von Pre-Paid-Guthaben kann ebenfalls im Internet erfolgen.

Die folgende Abbildung zeigt den Prozess PB1 "Erwerb von unpersonalisierten Trägermedien und Berechtigungen":

![](_page_35_Figure_12.jpeg)

**Abbildung 6–2 Prozessdarstellung P1B "Erwerb von unpersonalisierten Trägermedien und Berechtigungen** 

# <span id="page-36-2"></span><span id="page-36-0"></span>**6.2 Prozess P2 "Erstellung und Auslieferung von Produkten"**

# **6.2.1 Prozess P2A "Erstellung und Auslieferung von personalisierten Trägermedien und Berechtigungen"**

Bei der Beschreibung des Prozesses sind zwei wesentliche Fälle zu unterscheiden:

- 1 Die Erstellung und Auslieferung der Berechtigung zusammen mit einem speziell erstellten Trägermedium.
- 2 Das Aufladen einer Berechtigung auf ein bereits im Besitz des Kunden befindlichen kundenbezogenen NFC-Mobiltelefons.

In der folgenden [Abbildung 6–3](#page-36-1) findet sich die Darstellung des Prozesses P2A mit 4 Unterprozessen, die die möglichen Wege der Zustellung des Produkts repräsentieren.

![](_page_36_Figure_7.jpeg)

#### **Abbildung 6–3 Prozess P2A "Erstellung und Auslieferung von personalisierten Trägermedien und Berechtigungen"**

<span id="page-36-1"></span>Bei den Prozesse P2A.1 bis P2A.3 wird die bestellte Berechtigung auf einem speziellen Trägermedium an den Kunden ausgeliefert.

Beim Prozess P2A.4 wird davon ausgegangen, dass der Kunde bereits ein geeignetes NFC-Mobiltelefon besitzt.

<span id="page-37-0"></span>Das Kundenmedium dient zunächst zur elektronischen Identifizierung und Authentifizierung des Kunden. Sofern keine geeignete Anwendung auf dem Kundenmedium vorhanden sein sollte, muss diese vor dem Aufbringen der Berechtigung geladen werden.

# **6.2.2 Prozess P2B "Erstellung und Auslieferung von unpersonalisierten Trägermedien und Berechtigungen"**

Bei der Beschreibung sind zwei wesentliche Fälle zu unterscheiden:

Die Erstellung und Auslieferung der Berechtigung zusammen mit einem speziell ausgegebenen NFC-Mobiltelefon.

Das Aufladen einer Berechtigung auf ein bereits im Besitz des Kunden befindlichen kundenbezogenen NFC-Mobiltelefons.

In der folgenden [Abbildung 6–4](#page-37-1) findet sich die Darstellung des Prozesses P2B mit 3 Unterprozessen, die die möglichen Wege der Zustellung des Produkts repräsentieren.

![](_page_37_Figure_7.jpeg)

#### **Abbildung 6–4 Prozess P2B "Erstellung und Auslieferung von unpersonalisierten Trägermedien und Berechtigungen"**

<span id="page-37-1"></span>Beim Prozess P2B.1 wird die bestellte Anwendung mit einer Berechtigung auf einem speziellen Trägermedium an den Kunden ausgeliefert. Sofern eine klare Trennung der personenbezogenen Daten auf Trägermedium und Applikation besteht, kann eine unpersonalisierte Berechtigung ggf. auf ein personalisiertes Trägermedium aufgebracht werden.

Beim Prozess P2B.2 wird davon ausgegangen, dass der Kunde bereits ein geeignetes NFC-Mobiltelefon besitzt. Sofern keine geeignete Anwendung auf dem Kundenmedium vorhanden sein sollte, so wird diese vor dem Aufbringen der Berechtigung geladen.

<span id="page-38-0"></span>Der Prozess P2B.3 entspricht dem P2B.2. Allerdings kann hier keine Anwendung auf das Trägermedium aufgebracht werden. Als Vorbedingung der Nutzung des Prozesses durch den Kunden muss das Kundenmedium bereits komplett zur Aufnahme der Berechtigung konfiguriert sein.

# **6.3 Prozess P3 "Verwendung der Berechtigung"**

Die Berechtigung wird vom Kunden gegen eine Dienstleistung eingelöst. Der Kunde muss ein Trägermedium mit einer zulässigen Anwendung und gültiger Berechtigung besitzen, um die Beförderung in Anspruch nehmen zu können.

Die CICO-Infrastruktur (Tags) und elektronische Kontrollinfrastruktur wird vom Dienstleister verantwortet. Zum Betrieb hat der Dienstleister umfangreiche Vorarbeiten zu leisten, um die Funktion zu gewährleisten:

- 1 Die lokale Tag-Infrastruktur muss an die verwendeten Anwendungen und die Berechtigungen angepasst werden.
- 2 Die spezifischen Schlüsselinformationen zum Lesen der Berechtigungen und dem Schreiben der Nutzungsdaten muss in das Schlüsselmanagement der Erfassungssysteme und Kontrollgeräte und zum Personalisieren der Tags integriert werden.
- 3 Die Liste der gesperrten Berechtigungen (Black List) muss vom Ticketsystem in die Kontrollinfrastruktur übernommen werden. Dazu muss eine echtzeitfähige Datenschnittstelle zwischen dem Ticketsystem des Produktanbieters und der Kontrollinfrastruktur des Dienstleisters vereinbart und installiert werden.

Beim Check-in soll die Berechtigung überprüft werden. Sofern ein Produkt "automatische Fahrpreisberechnung" verwendet wird, ist darüber hinaus ein Abmelden bei Beendigung der Fahrt erforderlich. Zu beiden Zeitpunkten werden tarifrelevante Daten im Ticketsystem und im Trägermedium gespeichert.

Bei Verwendung eines Produkts "automatische Fahrpreisberechnung" (z. B. Projekt Touch&Travel) erfolgt der Check-in durch eine Anmeldung an stationären Tags, die z. B. am Bahnsteig oder an der Haltestelle montiert sind. Das NFC-Mobiltelefon agiert dabei im aktiven Modus. In diesen Tags sind eindeutige Ortsinformationen gespeichert, die beim Checkin gesichert und manipulationsfest ausgelesen und an das zentrale Erfassungssystem weitergeleitet wird. Dort wird der eigentliche Check-in vollzogen.

Stationäre Tags können auch für die Entwertung von klassischen Berechtigungen (z. B. Streifenkarte) vor Fahrtantritt verwendet werden.

Im Fahrzeug kann nicht von einer ständig verfügbaren Internetverbindung ausgegangen werden. Um eine Kontrolle im Fahrzeug zu ermöglichen, werden die Check-in Daten vor dem Fahrtantritt gesichert auf dem Trägermedium abgelegt. Sobald diese Daten auf dem NFC-Mobiltelefon vorliegen, wird der Kunde über eine Nachricht auf dem Display über den erfolgreichen Abschluss des Check-in-Vorgangs oder die erfolgte Entwertung informiert. Üblicherweise darf der Kunde erst dann die Fahrt aufnehmen.

Die Kontrollterminals im Fahrzeug müssen ebenfalls offline-fähig sein. Das NFC-Mobiltelefon verhält sich bei der Kontrolle mit einem Kontrollmedium wie ein passives Trägermedium.

Alternativ sind auch Szenarien möglich, bei denen seitens des Kontrolleurs mit einer "Kontrollkarte", einer passiven Chipkarte, gearbeitet wird. In diesem Fall agiert das NFC-Mobiltelefon im aktiven Modus.

![](_page_39_Figure_1.jpeg)

<span id="page-39-0"></span>Die folgende Abbildung zeigt den Prozess P3:

![](_page_39_Figure_3.jpeg)

Der Fehlerfall ist hier nicht berücksichtigt.

# <span id="page-40-0"></span>**6.4 Prozess P4 "Sperrung von Berechtigungen, Anwendungen und Trägermedien"**

Die sichere Sperrung von Berechtigungen, Anwendungen und Trägermedien ist bei chipbasierten Trägermedien möglich. Das unterstützt das Stornieren und den Umtausch von Trägermedien und Berechtigungen und gestattet den Ersatz von verloren gegangenen Medien.

Dabei sind folgende Fälle möglich:

- 1 Defekte Trägermedien werden eingezogen. Dabei ist vor Ausgabe eines Ersatzmediums sicherzustellen, dass keine Fälschung zum Umtausch vorgelegt bzw. als defektes Medium deklariert und eingereicht wurde.
- 2 Verlorengegangene Trägermedien können in der Praxis nur gesperrt und ersetzt werden, sofern diese personalisiert und einem Kundenkonto (siehe Anmeldung) bei einem Produktanbieter zugeordnet sind. In diesem Fall könnte sich der Besitzer gegenüber dem Produktanbieter, über den er das Medium erhalten hat, identifizieren und das zu sperrende Trägermedium benennen. Ebenso kann bei der Stornierung von Berechtigungen verfahren werden.
- 3 Der Ersatz von verloren gegangenen personalisierten Trägermedien und der gespeicherten Berechtigungen kann erfolgen, sofern eine Sperrung aller gespeicherter Anwendungen und Berechtigungen durchgeführt werden konnte. Dabei ist zu berücksichtigen, dass ggf. mehrere Anwendungen auf dem Trägermedium vorhanden sind, die wiederum Berechtigungen verschiedener Produktherausgeber und -anbieter enthalten können.

# <span id="page-41-1"></span><span id="page-41-0"></span>**7 Anwendungsfälle**

Die folgenden Unterkapitel enthalten Beschreibungen von Anwendungsfällen, die für die weitere Betrachtung der kontaktlosen Chiptechnik im Einsatzgebiet von Bedeutung sind. Die Anwendungsfälle wurden aus den generischen Betriebsprozessen in Kapitel [6](#page-32-1) abgeleitet.

Bei der Beschreibung der Anwendungsfälle wurde von einer exemplarischen Systemarchitektur ausgegangen, die in Kapitel [10](#page-118-1) näher beschrieben ist.

# **7.1 Anwendungsfall "Identifizierung bei Anmeldung und Bestellung"**

Die Qualität der Authentisierung und Identifizierung des Kunden ist entscheidend für die Verlässlichkeit der Daten, die dem Prozess P1 "Anmeldung und Bestellung" zugrunde liegen. Zur Betrachtung können die Prozessbeschreibungen P1A.1 – P1A.4 herangezogen werden. Die Verwendung eines zuverlässigen Verfahrens wie z. B. durch ein sicheres personalisiertes Kundenmedium oder ein elektronisches Identifizierungsmedium würde einen Gewinn an Sicherheit und Funktionalität bedeuten.

# <span id="page-41-2"></span>**7.2 Anwendungsfall "Initialisieren des Trägermediums"**

Der in [Abbildung 7–1](#page-42-1) dargestellte Anwendungsfall "Initialisieren des Trägermediums" deckt die folgenden Arbeitsschritte ab:

- 1 Initialisieren des Trägermediums
	- a Funktionale und sicherheitstechnische Voreinstellungen
	- b Setzen spezifischer Schlüssel
	- c Setzen einer ID, die das Trägermedium eindeutig kennzeichnet
- 2 Aufbringen der Anwendungen
	- a Aufbringen der anwendungsspezifischen Software
	- b Zuordnung von Ressourcen des Trägermediums (Anlegen von Dateisystemen, etc)
	- c Setzen anwendungsspezifischer Schlüssel pro Anwendung
	- d Setzen der Gültigkeit der Anwendung
- 3 Einbringen der anwendungsspezifischer Daten
	- a Einbringen der Kundendaten (sofern gefordert)
	- b Einbringen der ID des Anwendungsanbieters

Mit dem Fortgang der Arbeitsschritte zur Initialisierung des Trägermediums muss der Informationsstand im Managementsystem für Trägermedien und Anwendungen aktualisiert werden.

Die verschiedenen verwendeten Schlüsselinformationen, Zertifikate, etc. werden über ein Schlüsselmanagement erzeugt und zugeführt. Dieses liegt in der Zuständigkeit des Systemmanagers (konkret des Sicherheitsmanagers und des Registrars). Sollten bei der Initialisierung öffentliche Schlüssel vom Chip des Trägermediums erzeugt werden, so sind diese in das Schlüsselmanagementsystem einzupflegen.

<span id="page-42-0"></span>![](_page_42_Figure_1.jpeg)

**Abbildung 7–1 Anwendungsfall "Initialisierung des Trägermediums"** 

<span id="page-42-1"></span>Üblicherweise erfolgt das Initialisieren des Trägermediums in einer sicheren Umgebung (z. B. bei einem Massenpersonalisierer oder in einem Automaten).

Bei der Verwendung von NFC-Mobiltelefonen ist das Initialisieren inkl. des Aufbringens von Anwendungen jedoch auch im Feld ("over-the-air") erforderlich. Diesem Anwendungsfall kommt deshalb eine besondere Bedeutung zu.

# <span id="page-42-2"></span>**7.3 Anwendungsfall "Nachladen der Anwendung"**

Die Darstellung des Anwendungsfalls "Nachladen der Anwendung" in [Abbildung 7–2](#page-43-1) deckt den Sonderfall des Nachladens einer Anwendung auf ein bereits im Besitz des Kunden befindliches NFC-Mobiltelefon ab.

<span id="page-43-0"></span>![](_page_43_Figure_1.jpeg)

**Abbildung 7–2 Anwendungsfall "Nachladen der Anwendung"** 

<span id="page-43-1"></span>Beim Nachladen einer Anwendung kann es verschiedene Szenarien geben:

- 1 Nachladen der Anwendung über die kontaktlose Schnittstelle in einer vertrauenswürdigen Umgebung.
- 2 Nachladen der Anwendung über die kontaktlose Schnittstelle in einer unsicheren Umgebung. Dieser Fall kann z. B. beim Laden einer Anwendung über ein Lesegerät am Heim-PC oder in einer Vorverkaufsstelle eintreten.
- 3 Nachladen einer Anwendung "Over-the-Air" bei NFC-Mobiltelefonen.

Beim Nachladen der Anwendung über das Internet wird der Prozessschritt "Trägermedium im Lesebereich" durch das Erstellen einer geschützten Verbindung zwischen dem NFC-Mobiltelefon und dem Server des Anwendungsanbieters ersetzt.

# <span id="page-43-2"></span>**7.4 Anwendungsfall "Einbringen der Berechtigung"**

Sobald das Trägermedium initialisiert und die Anwendungen installiert sind, können Berechtigungen in die Anwendungen geladen werden.

Der Verkauf der Produkte ist direkt von der sicheren und kundenfreundlichen Abwicklung dieses Anwendungsfalls abhängig. Er ist deshalb für den Anbieter und den Kunden von elementarer Bedeutung. Bei der Betrachtung des in [Abbildung 7–3](#page-44-1) dargestellten Anwendungsfalls "Einbringen der Berechtigung" müssen alle Vertriebskanäle aus den Prozessbeschreibungen P2A und P2B (Kapitel [6.2](#page-36-2)) entsprechend berücksichtigt werden.

<span id="page-44-0"></span>![](_page_44_Figure_1.jpeg)

**Abbildung 7–3 Anwendungsfall "Einbringen der Berechtigung"** 

<span id="page-44-1"></span>Es muss zwischen dem Einbringen der Berechtigung bei der Erstausgabe des Trägermediums und dem Nachladen der Berechtigung unterschieden werden. Letzteres wird bei NFC-Mobiltelefonen meistens "Over-the-Air" erfolgen. Grundsätzlich ist aber auch ein Laden über die kontaktlose Schnittstelle in der Verkaufsstelle und am Automaten erfolgen.

Beim Nachladen der Berechtigung über das Internet wird der Prozessschritt "Trägermedium im Lesebereich" durch das Erstellen einer geschützten Verbindung zwischen dem NFC-Mobiltelefon und dem Server des Produktanbieters ersetzt.

# **7.5 Anwendungsfall "Auslieferung"**

Initialisierte und mit Berechtigungen versehene Trägermedien müssen nach P2A.1, P2A.2 und P2B. 1 an den Kunden oder die Ausgabestelle ausgeliefert werden.

Mit der Auslieferung müssen vom Produktanbieter sicherheitsrelevante Informationen der Sendung im Ticketsystem dokumentiert werden. Dazu gehören:

- 1 Adressat,
- 2 ID der Trägermedien, ID der Berechtigungen,
- 3 Versender,
- 4 Abgabestelle, spezielle Vereinbarungen zur Übergabe

Bei der Evaluierung sind mögliche Gefährdungen (z. B. Diebstahl, Klonen, etc) für die Einsatzszenarien zu benennen und zu bewerten.

# <span id="page-45-0"></span>**7.6 Anwendungsfall "Offline Check-in"**

Der Anwendungsfall "Check-in" bildet den ersten Teil des Prozesses P3.2 im Detail ab.

Der Check-in bzw. die Entwertung der Berechtigung wie auch ein möglicher Check-out erfolgen mit Hilfe einer Infrastruktur an fest installierten lokalen Transpondern (Tags), die insbesondere Ortsinformationen bzw. Verweise darauf enthalten. Üblicherweise verfügen die lokalen Transponder über eine kontaktlose Schnittstelle nach ISO/IEC14443 und nehmen die in diesem Standard spezifizierte passive Rolle des PICC ein. Das NFC-Mobiltelefon agiert im aktiven Modus. Sofern es sich um Tags nach ISO/IEC14443 handelt, arbeitet das NFC-Mobiltelefon im "PCD-Mode" nach NFCIP2.

Grundsätzlich sind zwei Varianten der Implementierung möglich. Die Nutzung dieser Varianten hängt von den Anforderungen der speziellen Implementierung ab:

- 1 In Fällen, bei denen die Ablaufzeit unkritisch und gleichzeitig die Verfügbarkeit der Internetverbindung gewährleistet ist, kann der Check-in – nachdem eine Verbindung über das NFC-Mobiltelefon aufgebaut worden ist - online in direkter Kommunikation zwischen dem Server des Hintergrundsystems und dem Tag erfolgen.
- 2 Sofern der Check-in in begrenzter Zeit erfolgen muss, ist es sinnvoll, den Check-in in verschiedene Schritte aufzuteilen, wobei Daten auf dem NFC-Mobiltelefon zwischengespeichert werden.

Der zweite Fall deckt alle Anforderungen des ÖPV für das Check-in bzw. das Entwerten einer Berechtigung auch unter ungünstigen Bedingungen ab und soll deshalb an dieser Stelle beschrieben werden.

Die folgende Abbildung zeigt den Ablauf. Die konkrete Umsetzung ist von der jeweiligen Anwendung den damit verbundenen Datenmodellen und Algorithmen abhängig.

<span id="page-46-0"></span>![](_page_46_Figure_1.jpeg)

**Abbildung 7–4 Anwendungsfall "Offline Check-in"** 

<span id="page-46-1"></span>Folgende Sonderfälle des Anwendungsfalls müssen bei der Umsetzung und der Sicherheitsbetrachtung besonders berücksichtigt werden:

- 1 Im Falle der Nutzung einer unpersonalisierten Berechtigung des Typs "Automatische Fahrpreisberechnung" muss ein nicht personenbezogenes Bezahlverfahren (z. B. ein Werteinheitenspeicher) verwendet werden. Es muss vor Fahrtantritt geprüft werden, ob genügend Guthaben vorhanden ist und nach dem Check-out der richtige Betrag abgebucht werden kann.
- 2 Es ist denkbar, dass die Auswertungen der aus dem lokalen Transponder gelesenen Informationen, der Berechtigung oder des Guthabens, die im Hintergrundsystem stattfinden, mit Fehlern enden. Auch ist denkbar, dass das Hintergrundsystem aufgrund von Fehlern (kein Mobilnetz, Akku des NFC-Mobiltelefons leer) die Check-in Informationen nicht in die Anwendung auf dem NFC-Mobiltelefon zurückschreiben kann.

# <span id="page-47-0"></span>**7.7 Anwendungsfall "Kontrolle"**

Der Anwendungsfall "Kontrolle" bildet den technischen Ablauf der Kontrolle der Fahrtberechtigung durch einen Kontrolleur ab. Das NFC-Mobiltelefon befindet sich dabei im passiven Modus nach [NFCIP2] und verhält sich dabei wie eine kontaktlose Chipkarte. Die konkrete Umsetzung ist von der jeweiligen Anwendung und den damit verbundenen Datenmodellen und Algorithmen abhängig. Die folgende Abbildung zeigt den Ablauf.

Die Kontrolle wird üblicherweise mit einem mobilen Kontrollterminal ausgeführt, das mit den nötigen SAM und Sperrlisten versehen ist.

![](_page_47_Figure_4.jpeg)

# **Abbildung 7–5 Anwendungsfall "Kontrolle"**

Im Fehlerfall wird normalerweise eine Sichtkontrolle erfolgen.

<span id="page-48-0"></span>Gegebenenfalls werden nach erfolgreicher Kontrolle Informationen, die zur – und Fahrpreisberechnung dienen, in die Anwendung geschrieben.

# **7.8 Anwendungsfall "Offline Check-out"**

Der Anwendungsfall "Offline Check-out" bildet den zweiten Teil des Prozesses P3.2 im Detail ab.

Der Anwendungsfall "Offline-Check-out" entspricht bezüglich des Ablaufs dem in [Abbildung](#page-46-1)  [7–4](#page-46-1) gezeigten Anwendungsfall "Offline-Check-in". Es werden im Falle einer Nutzung einer automatischen Fahrpreisermittlung anstelle von "Check-in"-Daten die finalen oder vorläufigen Daten zur Abrechnung ermittelt.

Zur Abrechnung verwendbare Daten, die ggf. im Rahmen einer Kontrolle in die Anwendung im NFC-Mobiltelefon eingebracht worden sind, werden ebenfalls ausgelesen und ggf. zur Berechnung des Fahrpreises herangezogen.

# **7.9 Anwendungsfall "Sperrung"**

Trägermedien, die abhanden gekommen sind, müssen gesperrt werden. Das gleiche gilt für defekte Medien oder Berechtigungen sofern diese nicht eingezogen und vernichtet werden können.

Die Sperrung eines Mediums und/oder der darauf gespeicherten Berechtigung ist die Voraussetzung für die Ausstellung eines Ersatzmediums bzw. für die Überschreibung einer Berechtigung auf einen neuen Eigentümer mit einem anderen Kundenmedium.

Eine Sperrung kann nur erfolgen, wenn hinreichend sicher ist, dass der Kunde, der dieses wünscht, der rechtmäßige Besitzer des Mediums bzw. der Berechtigung ist. Deshalb ist eine Sperrung durch den Kunden nur in folgenden alternativen Fällen möglich:

- 1 Die Kundendaten sind beim Kauf gespeichert worden. Die Sperrung erfolgt aufgrund einer zuverlässigen Identifizierung und einer rechtsverbindliche Willenserklärung des Kunden.
- 2 Das Medium mit der Berechtigung wird vorgelegt. Die Echtheit kann sicher festgestellt werden.

Alternativ zur Sperrung durch den Kunden können auch andere Entitäten des Systems die Sperrung beantragen. Dazu werden für diese Entitäten im Gesamtsystem Verantwortlichkeiten und Prozesse definiert. Dabei ist für Berechtigung, Anwendung und Medium festzulegen, welche Entitäten unter welchen Umständen die Sperrung veranlassen dürfen. Gleiches gilt für die Übertragung von Anwendungen und Berechtigungen auf andere Medien.

<span id="page-49-0"></span>![](_page_49_Figure_1.jpeg)

**Abbildung 7–6 Anwendungsfall "Sperrung"** 

# <span id="page-49-1"></span>**7.10 Anwendungsfälle "Schlüsselmanagement"**

Zum Schutz der Berechtigungen auf Trägermedien kommen aus Gründen der Performanz überwiegend Verfahren zum Einsatz, die symmetrische Schlüssel nutzen. Die Sicherheit und Funktionsfähigkeit des Gesamtsystems hängt damit entscheidend von der sicheren Bereitstellung und Verwahrung der Schlüssel ab. Diese Aufgabe muss durch das Schlüsselmanagement und dessen zugeordnete Prozesse geleistet werden.

In den folgenden Darstellungen der Anwendungsfälle wird mit **Secure Authentication Modules** (**SAM**) als sicheren Speichern für Schlüsselinformationen, Sicherheitsmechanismen und Diversifikationsalgorithmen gearbeitet. Prinzipiell sind auch andere Verfahren denkbar.

Zum Initialisieren des Trägermediums und beim Aufbringen der Berechtigungen ist ein Schlüsselmanagement erforderlich, dass die hierarchische Beziehung von Trägermedium, Anwendungen und Produkten/Berechtigungen berücksichtigt.

# **7.10.1 Schlüsselmanagement für das Initialisieren der Trägermedien**

Die Darstellung in [Abbildung 7–7](#page-50-1) beschreibt den Anwendungsfall zum Schlüsselmanagement für das Initialisieren der Trägermedien. Die hier definierten Schlüssel und Verfahren sind auch für das Aufbringen von Anwendungen erforderlich.

<span id="page-50-0"></span>![](_page_50_Figure_1.jpeg)

**Abbildung 7–7 Anwendungsfall "Schlüsselmanagement für Trägermedien"** 

# <span id="page-50-2"></span><span id="page-50-1"></span>**7.10.2 Schlüsselmanagement für das Aufbringen und Personalisieren der Anwendungen**

Zur Sicherung von Anwendungen, die bei der Erstellung der Trägermedien oder im Nachhinein aufgebracht werden, sind spezielle Schlüssel und Kennungen für die Anwendung zu erstellen.

[Abbildung 7–8](#page-51-1) zeigt den entsprechenden Anwendungsfall. Beim Aufbringen der Anwendung auf das Trägermedium muss das Schlüsselmanagement für Trägermedien ebenfalls zur Verfügung stehen.

<span id="page-51-0"></span>![](_page_51_Figure_1.jpeg)

**Abbildung 7–8 Anwendungsfall "Schlüsselmanagement für Anwendungen"** 

# <span id="page-51-2"></span><span id="page-51-1"></span>**7.10.3 Schlüsselmanagement für das Einbringen der Berechtigungen**

Zur Sicherung von Berechtigungen, die bei der Erstellung der Trägermedien oder im Nachhinein aufgebracht werden, sind grundsätzlich spezielle Schlüssel und Kennungen für die Produkte zu erstellen.

[Abbildung 7–9](#page-52-1) zeigt den entsprechenden Anwendungsfall. Beim Einbringen der Berechtigung in die Anwendung muss das Schlüsselmanagement für Anwendungen ebenfalls zur Verfügung stehen.

<span id="page-52-0"></span>![](_page_52_Figure_1.jpeg)

**Abbildung 7–9 Anwendungsfall "Schlüsselmanagement für Berechtigungen/Produkte"** 

# <span id="page-52-1"></span>**7.10.4 Schlüsselmanagement für die Nutzung beim Dienstleister**

Die Anbieter und Herausgeber benötigen ein Schlüsselmanagement für die Initialisierung der Trägermedien, das Aufbringen von Anwendungen und das Ausstellen der Berechtigungen.

Der ÖPV-Dienstleister ist auf die Schlüssel und andere Informationen zum Lesen und zur Auswertung der Berechtigungen angewiesen.

Diese Informationen müssen im Kontrollsystem vorliegen.

Zu diesem Zweck werden vom Sicherheitsmanager über das Schlüsselmanagement üblicherweise spezifische SAM (Dienstleister-SAM) für den Dienstleister erstellt und übergeben. Dienstleister-SAM können Schlüsselinformationen mehrerer Anbieter von Produkten, Anwendungen und Trägermedien enthalten. Die Zusammenstellung der Auswahl erfolgt durch den Sicherheitsmanager nach den Bedürfnissen des Dienstleisters.

# <span id="page-52-2"></span>**7.11 Anwendungsfall "Initialisieren des lokalen Transponders"**

Der lokale Transpnder (Tag) deckt in Systemen, die die aktive Funktionalität der NFC-Schnittstelle nutzen, gewisse Funktionen der klassischen Lesegeräteinfrastruktur ab. Grundsätzlich ist ein lokal installierter Transponder damit auch ähnlichen Gefährdungen wie ein Lesegerät ausgesetzt.

Der in [Abbildung 7–10](#page-54-1) dargestellte Anwendungsfall "Initialisieren des lokalen Transponders" deckt die folgenden Arbeitsschritte ab:

- 1 Initialisieren des lokalen Transponders
	- a Funktionale und sicherheitstechnische Voreinstellungen
	- b Setzen spezifischer Schlüssel
	- c Setzen einer ID, die den Transponder eindeutig kennzeichnet
	- d Update von Schlüsselinformationen
- 2 Aufbringen der Anwendungen
	- a Aufbringen der anwendungsspezifischen Software
	- b Zuordnung von Resourcen des Transponders (Anlegen von Dateisystemen, etc)
	- c Setzen anwendungsspezifischer Schlüssel pro Anwendung
	- d Setzen der Gültigkeit der Anwendung
- 3 Einbringen der Anwendungsdaten
	- a Einbringen der Kundendaten (sofern gefordert)
	- b Einbringen der ID des Anwendungsanbieters

Mit dem Fortgang der Arbeitsschritte zur Initialisierung des lokalen Transponders muss der Informationsstand im Managementsystem für Trägermedien und Anwendungen aktualisiert werden.

Die verschiedenen verwendeten Schlüsselinformationen, Zertifikate, etc. werden über ein Schlüsselmanagement erzeugt und zugeführt. Dieses liegt in der Zuständigkeit des Systemmanagers (konkret des Sicherheitsmanagers und des Registrars). Sollten bei der Initialisierung öffentliche Schlüssel vom Chip des lokalen Transponders erzeugt werden, so sind diese in das Schlüsselmanagementsystem einzupflegen.

Üblicherweise erfolgt das Initialisieren des lokalen Transponders in einer sicheren Umgebung (z. B. bei einem Massenpersonalisierer).

<span id="page-54-0"></span>![](_page_54_Figure_1.jpeg)

<span id="page-54-1"></span>**Abbildung 7–10 Anwendungsfall "Initialisierung des lokalen Transponders"** 

# <span id="page-55-0"></span>**8 Sicherheitsbetrachtungen**

# **8.1 Definitionen zum Thema Sicherheit und Datenschutz**

Es existieren drei Aspekte oder Unterscheidungsbereiche der Sicherheit, die im Rahmen dieses Dokuments betrachtet werden sollen. Es sind dies:

- Funktionssicherheit (Safety)
- Informationssicherheit (Security)
- Datenschutz (Privacy).

Diese Unterscheidungsbereiche lassen sich wie im Folgenden dargestellt untergliedern:

1 Funktionssicherheit

Funktionssicherheit wird vielfach mit Zuverlässigkeit/Korrektheit oder Quality of Service verwechselt. Zuverlässigkeit bedeutet, dass das System entsprechend seiner Spezifikation korrekt arbeitet. Die Erfahrung zeigt, dass jedes technische System fehleranfällig ist. Unter Funktionssicherheit wird nun die Eigenschaft eines Systems verstanden, trotz aufgetretener Systemfehler nicht in unkontrollierbare Systemzustände zu geraten, in denen das System selbst oder seine Umwelt in Gefahr gebracht werden (FailSafe). Zugleich soll das System noch weitestgehend konform seiner Spezifikation reagieren (Fault Tolerance). D.h. unter Funktionssicherheit wird im Wesentlichen der Schutz vor unbeabsichtigten Ereignissen verstanden.

2 Informationssicherheit

Informationssicherheit betrachtet im Gegensatz zur Funktionssicherheit den Schutz vor beabsichtigten Angriffen.

Im Bereich Informationssicherheit lassen sich Sicherheitsziele in folgenden Klassen formulieren:

- a Vertraulichkeit: Vertraulichkeit ist der Schutz vor unbefugter Preisgabe von Informationen. Vertrauliche Daten und Informationen dürfen ausschließlich Befugten in der zulässigen Weise zugänglich sein. Als Schutzziel formuliert bedeutet dies: Gespeicherte bzw. zu kommunizierende Informationen sind vor dem Zugriff von Unbefugten zu schützen.
- b Integrität: Integrität bezeichnet die Sicherstellung der Korrektheit (Unversehrtheit) von Daten und der korrekten Funktionsweise von Systemen. Als Schutzziel formuliert bedeutet dies: Gespeicherte bzw. zu kommunizierende Informationen sind vor unberechtigter Veränderung zu schützen
- c Verfügbarkeit: Die Verfügbarkeit von Dienstleistungen, Funktionen eines IT-Systems, IT-Anwendungen oder IT-Netzen oder auch von Informationen ist vorhanden, wenn diese den Benutzern stets wie gewünscht zur Verfügung stehen. Als Schutzziel formuliert bedeutet dies: Informationen und Betriebsmittel sind vor unbefugter Vorenthaltung zu schützen.
- d Unverknüpfbarkeit: Unverknüpfbarkeit zweier Kommunikationselemente innerhalb eines Systems bedeutet, dass diese Kommunikationselemente nicht mehr oder weniger miteinander in Beziehung stehen, als es schon durch ein Vorwissen bekannt ist. Innerhalb des Systems können keine weiteren Informationen über die Beziehung zwischen diesen Kommunikationselementen erlangt werden. Praktisch bedeutet dies z. B., dass ein und derselbe Benutzer Dienste oder Ressourcen mehrmalig in Anspruch nehmen kann, wobei Dritte nicht erkennen können, dass

diese Anfragen (im Kommunikationsmodell: Nachrichten) über den Benutzer in Verbindung stehen.

- e Unbeobachtbarkeit: Unbeobachtbarkeit eines Ereignisses ist derjenige Zustand, in dem nicht zu entscheiden ist, ob dieses Ereignis stattfindet oder nicht. Somit kann bei Sender-Unbeobachtbarkeit nicht erkannt werden, ob überhaupt gesendet wird. Empfänger-Unbeobachtbarkeit ist analog definiert, es kann nicht festgestellt werden ob empfangen wird oder nicht. Beziehungs-Unbeobachtbarkeit bedeutet, dass nicht erkennbar ist, ob aus der Menge der möglichen Sender zur Menge der möglichen Empfänger gesendet wird.
- f Anonymität: Anonymität ist der Zustand, in dem man innerhalb seiner Anonymitätsgruppe nicht identifizierbar ist. Mit Hilfe des Begriffs Unverknüpfbarkeit lässt sich Anonymität nun präzisieren zu Unverknüpfbarkeit zwischen der Identität des Benutzers und des von ihm ausgelösten Ereignisses. Somit gibt es Sender-Anonymität als Unverknüpfbarkeit zwischen Sender und Nachricht und Empfänger-Anonymität entsprechend als Unverknüpfbarkeit zwischen Nachricht und Empfänger.
- g Authentizität: Mit dem Begriff Authentizität wird die Eigenschaft bezeichnet, die gewährleistet, dass ein Kommunikationspartner tatsächlich derjenige ist, der er vorgibt zu sein. Bei authentischen Informationen ist sichergestellt, dass sie von der angegebenen Quelle erstellt wurden. Der Begriff wird nicht nur verwendet, wenn die Identität von Personen geprüft wird, sondern auch bei IT-Komponenten oder Anwendungen.
- h Nichtabstreitbarkeit: Das Versenden bzw. Empfangen von Nachrichten durch authentisch festgestellte Personen ist gegen Abstreiten zu schützen. Verbindlichkeit: Unter Verbindlichkeit werden die IT-Sicherheitsziele Authentizität und Nichtabstreitbarkeit zusammengefasst. Bei der Übertragung von Informationen bedeutet dies, dass die Informationsquelle ihre Identität bewiesen hat und der Empfang der Nachricht nicht in Abrede gestellt werden kann.
- 3 Datenschutz

Zweck des Datenschutzes ist es, den Einzelnen davor zu schützen, dass er durch den Umgang mit seinen personenbezogenen Daten in seinen Persönlichkeitsrechten beeinträchtigt wird.

Mit Datenschutz wird der Schutz personenbezogener Daten vor etwaigem Missbrauch durch Dritte bezeichnet (nicht zu verwechseln mit Datensicherheit).

Weiterhin sollen die folgenden Begrifflichkeiten einheitlich verwendet werden:

1 Sicherheitsziele

Sicherheitsziele sind sicherheitsrelevante Ziele bei der Realisierung eines IT-Systems. Im Rahmen dieses Dokuments werden spezifische Sicherheitsziele innerhalb von Einsatzgebieten und Einsatzszenarien festgelegt. Eine Verletzung der Sicherheitsziele erzeugt unmittelbaren Schaden für die Entität, deren Sicherheitsziel verletzt wird.

2 Gefährdungen

Gefährdungen sind unmittelbare Gefahren für die Sicherheitsziele der Anwendung. Diese können als Folge eines aktiven Angriffs auf eines oder mehrere Sicherheitsziele oder in Form von möglichen Schwächen des Systems, wie z. B. dem Fehlen einer Rückfalllösung, auftreten.

3 Maßnahmen

Maßnahmen sind konkrete Handlungsempfehlungen, die gegen eine oder mehrere Gefährdungen wirken. Die in diesem Dokument genannten Maßnahmen sollen sinnvoll und bedarfsgerecht sein, d.h. sie werden unter den Gesichtspunkten Wirtschaftlichkeit und

<span id="page-57-0"></span>Manipulationsfestigkeit (Wie aufwändig ist eine Maßnahme und welche finanzielle Schadenshöhe kann damit begrenzt oder verhindert werden) empfohlen.

4 Restrisiko

Es ist in der Regel nicht möglich, allen Gefährdungen so entgegenzuwirken, dass ein System die perfekte Sicherheit bietet. Das Restrisiko ist daher das Risiko, das verbleibt, wenn eine Menge von Maßnahmen umgesetzt wurde und trotzdem noch Angriffe möglich sind. Die Höhe des Risikos hängt davon ab, welche Gegenmaßnahmen getroffen werden können, wie komplex diese sind und vor allem, welches Ergebnis eine Kosten – Nutzen-Rechnung der jeweiligen Entität erbringt. Das Restrisiko muss von der Entität explizit getragen werden.

# <span id="page-57-1"></span>**8.2 Definition der Sicherheitsziele**

Im seltensten Fall sind alle im Bereich Funktionssicherheit, Informationssicherheit und Datenschutz genannten Sicherheitsaspekte für ein gegebenes Einsatzszenario gleichwichtig bzw. überhaupt relevant. Die Herausforderung bei der Konzeption eines sicheren RFID-Einsatzes liegt zuerst dementsprechend in der Formulierung spezifischer Sicherheitsziele.

Innerhalb der Einsatzgebiete zum eTicketing sind basierend auf den vorgenannten generischen Sicherheitszielen *übergeordnete* einsatzgebietsspezifische Sicherheitsziele zu erkennen:

- 1 Schutz der elektronischen Berechtigung (repräsentiert die Schutzziele Integrität und Authentizität)
- 2 Funktionssicherheit des RFID-Systems
- 3 Schutz der Privatsphäre des Kunden (repräsentiert die Schutzziele Vertraulichkeit, Unverknüpfbarkeit, Unbeobachtbarkeit, Anonymität und Datenschutz als allgemeine Anforderung)

Aus den Betrachtungen der Sicherheitsziele der Entitäten in den folgenden Unterkapiteln ergeben sich die *untergeordneten* Sicherheitsziele, die in Kapitel [8.2.4](#page-63-1) aufgeführt sind.

Die folgende Tabelle zeigt das Kodierungsschema der Sicherheitsziele sowie die verwendeten Abkürzungen.

| Feldnummer | 1                   | 2                    | 3                                                | 4         |
|------------|---------------------|----------------------|--------------------------------------------------|-----------|
| Feld       | Sicherheits<br>ziel | Zugeordnete Entität  | Zugeordnetes gene<br>risches Sicherheits<br>ziel | Zählindex |
| Inhalt     | S                   | K := Kunde           | F := Funktionssi<br>cherheit                     |           |
|            |                     | P := Produktanbieter | I := Informationssi<br>cherheit                  | 1,  , n   |
|            |                     | D := Dienstleister   | P := Privatsphäre                                |           |

**Tabelle 8–1 Kodierungsschema der Sicherheitsziele** 

# **8.2.1 Spezifische Sicherheitsziele des Kunden**

Die spezifischen Sicherheitsziele des Kunden sind in den folgenden Unterkapiteln aufgeführt.

|      | Kurzbezeichnung des<br>Sicherheitsziels   | Beschreibung des Sicherheitsziels                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|------|-------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SKF1 | Technische<br>Kompatibilität              | Die Interaktion zwischen NFC-Mobiltelefonen, lokalen Transpon<br>dern, Kontrollgeräten sowie den Hintergrundsystemen muss wie<br>spezifiziert funktionieren. Dies muss für alle zugelassenen NFC<br>Mobiltelefone an allen Transpondern und Kontrollgeräten in der<br>gesamten Systeminfrastruktur gelten. Dabei ist zu berücksichti<br>gen, dass NFC-Mobiltelefone, Transponder und Kontrollgeräte<br>von verschiedenen Herstellern geliefert und von verschiedenen<br>Dienstleistern betrieben werden können. |
| SKF2 | Rückfalllösung<br>bei Fehlfunkti<br>onen  | Die Nutzung der Dienstleistung muss für Berechtigte auch dann<br>möglich sein, wenn das Kundenmedium oder die Systeminfra<br>struktur nicht einwandfrei funktionieren.                                                                                                                                                                                                                                                                                                                                          |
| SKF3 | Intuitive, feh<br>lertolerante<br>Nutzung | Nutzung muss möglichst selbsterklärend bzw. einfach zu erler<br>nen sein<br>Der Kunde muss zu jedem Zeitpunkt wissen, welchen Stand der<br>Nutzungsprozess aufweist.                                                                                                                                                                                                                                                                                                                                            |

# <span id="page-58-0"></span>**8.2.1.1 Funktionssicherheit**

### **Tabelle 8–2 Sicherheitsziele des Kunden zur Funktionssicherheit**

# **8.2.1.2 Informationssicherheit**

| Kurzbezeichnung des<br>Sicherheitsziels |                                        | Beschreibung des Sicherheitsziels                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|-----------------------------------------|----------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SKI1                                    | Schutz der<br>personenbe<br>zogenen Da | Die im System und/oder im Kundenmedium gespeicherten Kun<br>dendaten dienen zur Identifizierung des Kunden, zur Zahlung,<br>zum Zustellen von Berechtigungen, etc.                                                                                                                                                                                                                                                                                                |
|                                         | ten                                    | Eine missbräuchliche Verwendung, Manipulation oder Weiter<br>gabe an Unberechtigte wäre für den Kunden ggf. mit kommer<br>ziellen Risiken und Verlust der Funktionssicherheit verbunden<br>und soll vermieden werden.                                                                                                                                                                                                                                             |
| SKI2                                    | Schutz der<br>Berechtigun<br>gen       | Berechtigungen sind möglicherweise DoS-Angriffen bzw. Mani<br>pulation durch Dritte ausgesetzt. Dies wäre für den Kunden mit<br>Unannehmlichkeiten bzw. einem Schaden verbunden. Dieser<br>Schaden ist normalerweise begrenzt, da üblicherweise der<br>Dienst in Anspruch genommen werden kann, sofern der Kunde<br>nachweisen kann, dass er eine gültige Berechtigung erstanden<br>hat. Manipulation der Berechtigung durch Unbefugte soll ver<br>mieden werden. |
| SKI3                                    | Schutz der<br>Nutzungsdaten            | Nutzungsdaten dienen zur Abrechnung für die Nutzung des<br>Produkts "Automatische Fahrpreisberechnung". Die Daten müs<br>sen deshalb verlässlich sein.                                                                                                                                                                                                                                                                                                            |
| SKI4                                    | Zuverlässige<br>Abrechnung             | Bei Nutzung muss der Zeitpunkt der Entwertung und bei Check<br>in / Check-out der Zeitpunkt, der Ort und Dienstleister für den<br>Kunden erkennbar sein.                                                                                                                                                                                                                                                                                                          |
|                                         |                                        | Die Abrechnungsdaten (Pricing) müssen nachvollziehbar und                                                                                                                                                                                                                                                                                                                                                                                                         |

<span id="page-59-0"></span>

| Kurzbezeichnung des<br>Sicherheitsziels |                                                     | Beschreibung des Sicherheitsziels                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|-----------------------------------------|-----------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                         |                                                     | zuverlässig sein.                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| SKI5                                    | Schutz von<br>Anwendungen<br>und Berechti<br>gungen | Kundenmedien können mehr als eine Anwendung aufnehmen.<br>Diese Anwendungen können verschiedenen Anwendungsher<br>ausgebern gehören. Weiterhin kann eine Anwendung mehrere<br>Berechtigungen aufnehmen, die von verschiedenen Produktei<br>gentümern geliefert wurden. Es muss sichergestellt sein, dass<br>Anwendungen und Berechtigungen technisch zuverlässig ge<br>trennt sind oder Vereinbarungen zwischen den Entitäten beste<br>hen, die die mehrseitige Nutzung oder Konflikte regeln. |

### **Tabelle 8–3 Sicherheitsziele des Kunden zur Informationssicherheit**

# **8.2.1.3 Schutz der Privatsphäre**

| Kurzbezeichnung des<br>Sicherheitsziels |                                                          | Beschreibung des Sicherheitsziels                                                                                                                                                                   |
|-----------------------------------------|----------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SKP1                                    | Schutz der<br>personenbe<br>zogene Daten                 | Personenbezogene Daten, die dem Produktanbieter (KVP) über<br>geben wurden, müssen vertraulich behandelt werden und dürfen<br>nur für die vereinbarten Zwecke eingesetzt werden.                    |
| SKP2                                    | Schutz der<br>Nutzungsdaten                              | Nicht anonymisierte, personenbezogene Daten über die Nut<br>zung des Dienstes dürfen nur nach Zustimmung des Kunden für<br>Zwecke des Produktanbieters oder des Dienstleisters verwendet<br>werden. |
| SKP3                                    | Schutz vor der<br>Erzeugung von<br>Bewegungs<br>profilen | Es ist zu verhindern, dass Unberechtigte durch Nutzung der<br>RFID-Technologie personenbezogene Bewegungsprofile erstel<br>len können.                                                              |
| SKP4                                    | Datenspar<br>samkeit                                     | Es dürfen nicht mehr Daten gesammelt und gespeichert werden,<br>als für den spezifischen Zweck nötig ist.                                                                                           |
| SKP5                                    | Löschungsfrist                                           | Eine Löschung der personenbezogenen Daten soll erfolgen,<br>sobald die Zweckbindung entfallen ist.                                                                                                  |

**Tabelle 8–4 Sicherheitsziele des Kunden zum Schutz der Privatsphäre** 

# **8.2.2 Spezifische Sicherheitsziele des Produktanbieters**

Die spezifischen Sicherheitsziele des Produktanbieters sind in den folgenden Unterkapitels aufgeführt.

# **8.2.2.1 Funktionssicherheit**

| Kurzbezeichnung des<br>Sicherheitsziels |                              | Beschreibung des Sicherheitsziels                                                                                                                                                                |
|-----------------------------------------|------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SPF1                                    | Technische<br>Kompatibilität | Die Interaktion zwischen NFC-Mobiltelefonen, lokalen Transpon<br>dern Kontrollgeräten sowie den Hintergrundsystemen muss wie<br>spezifiziert funktionieren. Dies muss für alle zugelassenen NFC- |

<span id="page-60-0"></span>

| Kurzbezeichnung des<br>Sicherheitsziels |                                           | Beschreibung des Sicherheitsziels                                                                                                                                                                                                                                                                                                      |
|-----------------------------------------|-------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                         |                                           | Mobiltelefone an allen lokalen Transpondern und mit allen Kon<br>trollgeräten in der gesamten Systeminfrastruktur gelten. Dabei<br>ist zu berücksichtigen, dass NFC-Mobiltelefone, lokale<br>Transponder und Infrastruktur von verschiedenen Herstellern<br>geliefert und von verschiedenen Dienstleistern betrieben werden<br>können. |
| SPF2                                    | Rückfalllösung<br>bei Fehlfunkti<br>onen  | Die Erbringung der Dienstleistung für den Kunden sollte auch<br>dann möglich sein, wenn das NFC-Mobiltelefon oder die Sys<br>teminfrastruktur nicht einwandfrei funktionieren.                                                                                                                                                         |
| SPF3                                    | Intuitive, feh<br>lertolerante<br>Nutzung | Fehlerfreie Nutzung durch den Kunden muss mit geringem Er<br>klärungsaufwand möglich sein.                                                                                                                                                                                                                                             |
|                                         |                                           | Der Kunde muss zu jedem Zeitpunkt wissen, welchen Stand der<br>Nutzungsprozess aufweist.                                                                                                                                                                                                                                               |

| Tabelle 8–5 | Sicherheitsziele des Produktanbieters zur Funktionssicherheit |
|-------------|---------------------------------------------------------------|
|             |                                                               |

# **8.2.2.2 Informationssicherheit**

| Kurzbezeichnung des<br>Sicherheitsziels |                                           | Beschreibung des Sicherheitsziels                                                                                                                                                                                                                                                   |
|-----------------------------------------|-------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SPI1                                    | Schutz der<br>personenbezo<br>genen Daten | Die im System und im NFC-Mobiltelefon gespeicherten Kunden<br>daten dienen zur Identifizierung des Kunden, zur Zahlung, zum<br>Zustellen von Berechtigungen, etc.                                                                                                                   |
|                                         |                                           | Eine missbräuchliche Verwendung, Manipulation oder Weitergabe<br>an Unberechtigte wäre für den Produktanbieter z. B. mit kommer<br>ziellen Risiken oder Verlust der Kundenakzeptanz verbunden und<br>würde ggf. als Gesetzesverstoß geahndet werden. Dies muss<br>vermieden werden. |
| SPI2                                    | Schutz der<br>Berechtigun<br>gen          | Die Manipulation, die Störung und insbesondere die Fälschung<br>von Berechtigungen wären für den Produktanbieter, den Produkt<br>eigentümer und den Dienstleister ggf. mit erheblichem kommer<br>ziellem Schaden verbunden.                                                         |
|                                         |                                           | Die Fälschungssicherheit von Berechtigungen ist ein wichtiges<br>Ziel des Produkteigentümers.                                                                                                                                                                                       |
| SPI3                                    | Schutz der<br>Nutzungsdaten               | Die Verfügbarkeit und Integrität der Nutzungsdaten ist für den<br>Produktanbieter, den Produkteigentümer und den Dienstleister<br>von großem Wert. Sie dienen zur Abrechnung, zur Planung von<br>Produkten, Kapazitäten und zur Kundenbindung.                                      |
| SPI4                                    | Zuverlässige<br>Abrechnung                | Die richtige Zuordnung der Erlöse aus dem Verkauf von Berechti<br>gungen durch den Produktanbieter zu den vom Dienstleister er<br>brachten Beförderungsleistungen ist sicherzustellen.                                                                                              |

<span id="page-61-0"></span>

| Kurzbezeichnung des<br>Sicherheitsziels |                                                     | Beschreibung des Sicherheitsziels                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|-----------------------------------------|-----------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SPI5                                    | Schutz von<br>Anwendungen<br>und Berechti<br>gungen | NFC-Mobiltelefone können mehr als eine Anwendung aufnehmen.<br>Diese Anwendungen können verschiedenen Anwendungsheraus<br>gebern gehören. Weiterhin kann eine Anwendung mehrere Be<br>rechtigungen aufnehmen, die von verschiedenen Produkteigen<br>tümern geliefert wurden. Es muss sichergestellt sein, dass An<br>wendungen und Berechtigungen technisch zuverlässig getrennt<br>sind oder Vereinbarungen zwischen den Entitäten bestehen, die<br>die mehrseitige Nutzung oder Konflikte regeln. |

**Tabelle 8–6 Sicherheitsziele des Produktanbieters zur Informationssicherheit** 

# **8.2.2.3 Schutz der Privatsphäre**

| Kurzbezeichnung des<br>Sicherheitsziels |                                               | Beschreibung des Sicherheitsziels                                                                                                                                                                                                                                                                                                    |
|-----------------------------------------|-----------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SPP1                                    | Schutz der<br>personenbe<br>zogenen Da<br>ten | Eine missbräuchliche Verwendung, Manipulation oder Weiter<br>gabe an Unberechtigte wäre für den Kundenvertragspartner ggf.<br>mit kommerziellen Risiken oder Verlust der Kundenakzeptanz<br>verbunden und würde ggf. als Gesetzesverstoß geahndet wer<br>den.                                                                        |
| SPP2                                    | Schutz der<br>Nutzungsdaten                   | Nicht anonymisierte, personenbezogene Daten über die Nut<br>zung des Dienstes dürfen nur nach Zustimmung des Kunden für<br>Zwecke des Produktanbieters verwendet werden. Das Ziel ist,<br>für gewisse Produkte (automatische Fahrpreisfindung CICO,<br>etc) diese Zustimmung zu erhalten um z. B. eine Abrechnung zu<br>ermöglichen. |
| SPP4                                    | Datenspar<br>samkeit                          | Es dürfen nicht mehr Daten gesammelt und gespeichert werden,<br>als für den spezifischen Zweck nötig ist.                                                                                                                                                                                                                            |

**Tabelle 8–7 Sicherheitsziele des Produktanbieters zum Schutz der Privatsphäre** 

# **8.2.3 Spezifische Sicherheitsziele des Dienstleisters**

Die spezifischen Sicherheitsziele des Dienstleisters sind in den folgenden Unterkapiteln aufgeführt.

# **8.2.3.1 Funktionssicherheit**

| Kurzbezeichnung des<br>Sicherheitsziels |                                           | Beschreibung des Sicherheitsziels                                                                                                                                                                                                                                                                                                                                                                                                            |
|-----------------------------------------|-------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SDF1                                    | Technische<br>Interfunktions<br>fähigkeit | Die in den verschiedenen NFC-Mobiltelefonen gespeicherten<br>Berechtigungen müssen wie spezifiziert mit dem Hintergrund<br>system funktionieren. Dies muss für alle zugelassenen NFC<br>Mobiltelefone an allen lokalen Transpondern und mit allen Kon<br>trollgeräten in der gesamten Systeminfrastruktur des<br>Dienstleisters gelten. Dabei ist zu berücksichtigen dass NFC<br>Mobiltelefone und lokale Transponder von verschiedenen Her- |

<span id="page-62-0"></span>

| Kurzbezeichnung des<br>Sicherheitsziels |                                           | Beschreibung des Sicherheitsziels                                                                                                                                                                                            |
|-----------------------------------------|-------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                         |                                           | stellern geliefert werden können.                                                                                                                                                                                            |
| SDF2                                    | Rückfalllösung<br>bei Fehlfunkti<br>onen  | Die Erbringung der Dienstleistung muss auch dann möglich<br>sein, wenn das NFC-Mobiltelefon oder die Systeminfrastruktur<br>nicht einwandfrei funktionieren. Das Vorhandensein einer Be<br>rechtigung muss nachweisbar sein. |
| SDF3                                    | Intuitive, feh<br>lertolerante<br>Nutzung | Nutzung durch den Kunden muss mit geringer Fehlerquote mög<br>lich sein.<br>Der Kunde muss zu jedem Zeitpunkt wissen, welchen Stand der<br>Nutzungsprozess aufweist.                                                         |

| Tabelle 8–8 | Sicherheitsziele des Dienstleisters zur Funktionssicherheit |
|-------------|-------------------------------------------------------------|
|-------------|-------------------------------------------------------------|

### **8.2.3.2 Informationssicherheit**

| Kurzbezeichnung des<br>Sicherheitsziels |                                               | Beschreibung des Sicherheitsziels                                                                                                                                                                                                                                              |
|-----------------------------------------|-----------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SDI1                                    | Schutz der<br>personenbe<br>zogenen Da<br>ten | Die im System und im NFC-Mobiltelefon gespeicherten Kunden<br>daten dienen zur Identifizierung des Kunden, zur Zahlung, zum<br>Zustellen von Berechtigungen, etc.                                                                                                              |
|                                         |                                               | Eine missbräuchliche Verwendung, Manipulation oder Weiter<br>gabe an Unberechtigte wäre für den Dienstleister ggf. mit kom<br>merziellen Risiken, Verlust der Kundenakzeptanz und würde<br>ggf. als Gesetzesverstoß geahndet werden.                                           |
| SDI2                                    | Schutz der<br>Berechtigun<br>gen              | Die Manipulation, die Störung und insbesondere die Fälschung<br>von Berechtigungen wäre für für den Produktanbieter, den Pro<br>dukteigentümer und den Dienstleister ggf. mit erheblichem kom<br>merziellem Schaden verbunden.                                                 |
|                                         |                                               | Die Fälschungssicherheit von Berechtigungen ist ein wichtiges<br>Ziel des Dienstleisters. Zusätzlich erfolgt die Nutzung der Be<br>rechtigungen in der Systeminfrastruktur des Dienstleisters. Auch<br>hier muss der Schutz der Berechtigung gewährleistet sein.               |
| SDI3                                    | Schutz der<br>Nutzungsdaten                   | Nutzungsdaten sind für den für den Dienstleister von großem<br>Wert. Sie dienen zur Abrechnung und zur Planung von Kapazi<br>täten.                                                                                                                                            |
|                                         |                                               | Kundenspezifische Nutzungsdaten sind aus Sicht des Kunden<br>und aufgrund gesetzlicher Vorschriften vom Dienstleister ver<br>traulich zu behandeln. Zuwiderhandlung hätte den Verlust der<br>Kundenakzeptanz zur Folge und würde ggf. als Gesetzesver<br>stoß geahndet werden. |
| SDI4                                    | Zuverlässige<br>Abrechnung                    | Die richtige Zuordnung der Erlöse aus dem Verkauf von Berech<br>tigungen durch den Produktanbieter zu den vom Dienstleister<br>erbrachten Beförderungsleistungen ist sicherzustellen.                                                                                          |

<span id="page-63-0"></span>

| Kurzbezeichnung des<br>Sicherheitsziels |                                                     | Beschreibung des Sicherheitsziels                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|-----------------------------------------|-----------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SDI5                                    | Schutz von<br>Anwendungen<br>und Berechti<br>gungen | NFC-Mobiltelefone können mehr als eine Anwendung aufneh<br>men. Diese Anwendungen können verschiedenen Anwen<br>dungsherausgebern gehören. Weiterhin kann eine Anwendung<br>mehrere Berechtigungen aufnehmen, die von verschiedenen<br>Produkteigentümern geliefert wurden. Es muss sichergestellt<br>sein, dass Anwendungen und Berechtigungen technisch zuver<br>lässig getrennt sind oder Vereinbarungen zwischen den Entitä<br>ten bestehen, die die mehrseitige Nutzung oder Konflikte regeln. |

#### **Tabelle 8–9 Sicherheitsziele des Dienstleisters zur Informationssicherheit**

# **8.2.3.3 Schutz der Privatsphäre**

| Kurzbezeichnung des<br>Sicherheitsziels |                                               | Beschreibung des Sicherheitsziels                                                                                                                                                                                                                                                                                                  |
|-----------------------------------------|-----------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SDP1                                    | Schutz der<br>personenbe<br>zogenen Da<br>ten | Eine missbräuchliche Verwendung, Manipulation oder Weiter<br>gabe an Unberechtigte wäre für den Dienstleister ggf. mit kom<br>merziellen Risiken, Verlust der Kundenakzeptanz verbunden<br>und würde ggf. als Gesetzesverstoß geahndet werden.                                                                                     |
| SDP2                                    | Schutz der<br>Nutzungsdaten                   | Nicht anonymisierte, personenbezogene Daten über die Nut<br>zung des Dienstes dürfen nur nach Zustimmung des Kunden für<br>Zwecke des Dienstleisters verwendet werden. Das Ziel ist, für<br>gewisse Produkte (automatische Fahrpreisfindung CICO, etc)<br>diese Zustimmung zu erhalten um z. B. eine Abrechnung zu<br>ermöglichen. |
| SDP4                                    | Datenspar<br>samkeit                          | Es dürfen nicht mehr Daten gesammelt und gespeichert werden,<br>als für den spezifischen Zweck nötig ist.                                                                                                                                                                                                                          |

**Tabelle 8–10 Sicherheitsziele des Dienstleisters zum Schutz der Privatsphäre** 

# <span id="page-63-1"></span>**8.2.4 Zusammenfassung der Sicherheitsziele der Entitäten**

Die folgende Tabelle fasst die vorstehend genannten Sicherheitsziele der verschiedenen Akteure zusammen.

| Sicherheitsziel |                                       | Ziele Kunde | Ziele Pro<br>duktanbie<br>ter | Ziele<br>Dienstleister |
|-----------------|---------------------------------------|-------------|-------------------------------|------------------------|
| SF1             | Technische Kompatibilität             | SKF1        | SPF1                          | SDF1                   |
| SF2             | Rückfalllösung bei Fehlfunktionen     | SKF2        | SPF2                          | SDF2                   |
| SF3             | Intuitive, fehlertolerante Nutzung    | SKF3        | SPF3                          | SDF3                   |
| SI1             | Schutz der personenbezogenen<br>Daten | SKI1, SKP1  | SPI1, SPP1                    | SDI1, SDP1             |
| SI2             | Schutz der Berechtigungen             | SKI2        | SPI2                          | SDI2                   |
| SI3             | Schutz der Logistikdaten (anony-      | SKP4        | SPI3                          | SDI3                   |

<span id="page-64-0"></span>

| Sicherheitsziel |                                                    | Ziele Kunde                  | Ziele Pro<br>duktanbie<br>ter | Ziele<br>Dienstleister |
|-----------------|----------------------------------------------------|------------------------------|-------------------------------|------------------------|
|                 | misierten Nutzungsdaten)                           |                              |                               |                        |
| SI4             | Zuverlässige Abrechnung                            | SKI3, SKI4,<br>SKP2,<br>SKP4 | SPI3, SPI4,<br>SPP2           | SDI3, SDI4,<br>SDP2    |
| SI5             | Schutz von Anwendungen und<br>Berechtigungen       | SKI5                         | SPI5                          | SDI5                   |
| SP3             | Schutz vor der Erzeugung von Be<br>wegungsprofilen | SKP3                         |                               |                        |
| SP4             | Datensparsamkeit                                   | SKP4                         | SPP4                          | SDP4                   |

| Tabelle 8–11 | Übersicht über die Sicherheitsziele der Entitäten |
|--------------|---------------------------------------------------|
|--------------|---------------------------------------------------|

# <span id="page-64-1"></span>**8.2.5 Bildung von Schutzbedarfsklassen**

Basierend auf den Sicherheitszielen aus Kapitel [8.2.4](#page-63-1) werden 3 Schutzbedarfsklassen gebildet. Klasse 1 repräsentiert den geringsten Schutzbedarf, Klasse 3 den höchsten.

Die in der folgenden Tabelle angeführten Kriterien zur Zuordnung des Schutzbedarfs in eine Schutzbedarfsklasse basieren auf der Annahme der Situation im Falle, dass keine Schutzmassnahmen ergriffen werden.

| Sicherheitsziel |                                          | Schutz<br>bedarfs<br>klasse | Kriterien zur Einordnung in Schutzbedarfsklassen                                                                                               |  |
|-----------------|------------------------------------------|-----------------------------|------------------------------------------------------------------------------------------------------------------------------------------------|--|
| SF1             | Technische Kom<br>patibilität            | 1                           | Alle Systemkomponenten sind vom gleichen Lie<br>feranten. Der Lieferant sorgt für Kompatibilität.                                              |  |
|                 |                                          | 2                           | System muss mit Komponenten von wenigen<br>definierten Lieferanten funktionieren. Der Sys<br>temmanager oder ein SI sorgen für Kompatibilität. |  |
|                 |                                          | 3                           | Offenes System, dass mit Komponenten von allen<br>Marktteilnehmern funktionieren soll.                                                         |  |
| SF2             | Rückfalllösung<br>bei Fehlfunktio<br>nen | 1                           | Fehlfunktion betrifft einzelne Kunden                                                                                                          |  |
|                 |                                          | 2                           | Fehlfunktion betrifft größere Kundenmenge                                                                                                      |  |
|                 |                                          | 3                           | Fehlfunktion betrifft eine großen Teil der Kunden                                                                                              |  |
| SF3             | Intuitive, fehlerto<br>lerante Nutzung   | 1                           | Intuitiv nicht bedienbar von einzelnen Kunden                                                                                                  |  |
|                 |                                          | 2                           | Intuitiv nicht bedienbar von größerer Kunden<br>menge                                                                                          |  |
|                 |                                          | 3                           | Intuitiv nicht bedienbar von einem großen Teil der<br>Kunden                                                                                   |  |
| SI1             | Schutz der per-                          | 1                           | Kunde wird in seinem Ansehen geschädigt                                                                                                        |  |

| Sicherheitsziel |                                                                       | Schutz<br>bedarfs<br>klasse | Kriterien zur Einordnung in Schutzbedarfsklassen                                                                                                                                                                                                                                                       |  |
|-----------------|-----------------------------------------------------------------------|-----------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|                 | sonenbezogenen<br>Daten (inkl. per                                    |                             | Kunde wird in seiner sozialen Existenz geschädigt                                                                                                                                                                                                                                                      |  |
|                 | sonenbezogene<br>Nutzungsdaten) –<br>Daten werden<br>dritten bekannt  | 3                           | Kunde wird in seiner physischen Existenz ge<br>schädigt                                                                                                                                                                                                                                                |  |
| SI2             | Schutz der Be<br>rechtigungen                                         | 1                           | Erwarteter produktbezogener Umsatzverlust<br>durch Fälschung, Stören oder Manipulation <0,5<br>%                                                                                                                                                                                                       |  |
|                 |                                                                       | 2                           | Erwarteter produktbezogener Umsatzverlust<br>durch Fälschung, Stören oder Manipulation <3%                                                                                                                                                                                                             |  |
|                 |                                                                       | 3                           | Erwarteter produktbezogener Umsatzverlust<br>durch Fälschung, Stören oder Manipulation >3%                                                                                                                                                                                                             |  |
| SI3             | Schutz der Logis                                                      | 1                           | Daten werden Dritten bekannt                                                                                                                                                                                                                                                                           |  |
|                 | tikdaten (anony<br>misierte Nut<br>zungsdaten) in<br>terne Abrechnung | 2                           | Daten gehen verloren                                                                                                                                                                                                                                                                                   |  |
|                 |                                                                       | 3                           | Daten werden verfälscht                                                                                                                                                                                                                                                                                |  |
| SI4             | Zuverlässige Ab<br>rechnung                                           | 1                           | Daten sind nicht verfügbar                                                                                                                                                                                                                                                                             |  |
|                 |                                                                       | 2                           | Daten sind verloren                                                                                                                                                                                                                                                                                    |  |
|                 |                                                                       | 3                           | Daten werden verfälscht, missbraucht, etc                                                                                                                                                                                                                                                              |  |
| SI5             | Schutz von An<br>wendungen und<br>Berechtigungen                      | 1                           | Anwendungen werden vom selben Anwendungs<br>herausgeber und Berechtigungen vom selben<br>Produkteigentümer herausgegeben.                                                                                                                                                                              |  |
|                 |                                                                       | 2                           | Anwendungen werden von einem Anwendungs<br>herausgeber, aber unterschiedlichen Anwen<br>dungsanbietern und Berechtigungen von unter<br>schiedlichen Produkteigentümern, Produktanbie<br>tern und Dienstleistern herausgegeben. Mehrere<br>Unternehmen kooperieren und "vertrauen" sich<br>gegenseitig. |  |
|                 |                                                                       | 3                           | Anwendungen werden von unterschiedlichen An<br>wendungsanbietern und Berechtigungen von un<br>terschiedlichen Produkteigentümern, Produktan<br>bietern und Dienstleistern herausgegeben. Meh<br>rere Unternehmen kooperieren und "vertrauen"<br>sich nicht gegenseitig.                                |  |
| SP3             | Schutz vor der<br>Erzeugung von<br>Bewegungsprofi<br>len              | 1                           | Kunde wird in seinem Ansehen geschädigt                                                                                                                                                                                                                                                                |  |
|                 |                                                                       | 2                           | Kunde wird in seiner sozialen Existenz geschädigt                                                                                                                                                                                                                                                      |  |
|                 |                                                                       | 3                           | Kunde wird in seiner physischen Existenz ge<br>schädigt                                                                                                                                                                                                                                                |  |

<span id="page-66-0"></span>

| Sicherheitsziel |                      | Schutz<br>bedarfs<br>klasse | Kriterien zur Einordnung in Schutzbedarfsklassen                                   |
|-----------------|----------------------|-----------------------------|------------------------------------------------------------------------------------|
| SP4             | Datensparsam<br>keit | 1                           | Es werden keine personenbezogenen Daten ver<br>wendet.                             |
|                 |                      | 2                           | Es werden personenbezogene Daten verwendet,<br>aber keine Nutzungsdaten gesammelt. |
|                 |                      | 3                           | Es werden personenbezogene Daten und Nut<br>zungs- und Abrechnungsdaten verwendet. |

**Tabelle 8–12 Definition von Schutzbedarfsklassen** 

# <span id="page-66-1"></span>**8.3 Gefährdungen**

In diesem Kapitel werden potentielle Gefährdungen für die in Kapitel [8.2](#page-57-1) benannten Sicherheitsziele benannt. Dabei wird nach Gefährdungen für die kontaktlose Schnittstelle, das aktive und das passive NFC-Mobiltelefon, den lokalen Transponder, das Lesegerät, das Schlüsselmanagement und das Gesamtsystem unterschieden.

Die folgende Tabelle zeigt das Kodierungsschema der Gefährdungen und die verwendeten Abkürzungen.

| Feldnummer | 1          | 2                                                                                                                                                                                                                                                                                        | 3       |  |
|------------|------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------|--|
| Feld       | Gefährdung | Zugeordnete Komponente<br>Zählindex                                                                                                                                                                                                                                                      |         |  |
| Inhalt     | G          | IF := kontaktlose Schnittstelle (Interface)                                                                                                                                                                                                                                              | 1,  , n |  |
|            |            | NMD := NFC-Mobiltelefon (aktiv)<br>Im aktiven Modus initiiert und steuert das<br>NFC Mobiltelefon (NFC mobile device) die<br>Kommunikation mit anderen Systemkom<br>ponenten über die RF-Schnittstelle (lokaler<br>Transponder, Automat) oder eine Internet<br>verbindung (Gesamtsystem) |         |  |
|            |            | T := Trägermedium, NFC-Mobiltelefon<br>(passiv)<br>Im passiven Modus verhält sich das NFC<br>Mobiltelefon wie ein passives Trägermedi<br>um (z. B. PICC nach ISO/IEC 14443)                                                                                                              |         |  |
|            |            | TR := Lokaler Transponder (Tag)<br>Fest installierter passiver Transponder mit<br>RF-Schnittstelle. Wird vom NFC<br>Mobiltelefon ausgelesen zum Check<br>in/Entwertung und Check-out ausgelesen.                                                                                         |         |  |
|            |            | R := Lesegerät (Reader)<br>z. B. mobiles Kontrollgerät. Liest bei der<br>Kontrolle die im NFC-Mobiltelefon abge<br>legte Berechtigung und Check-in-daten.                                                                                                                                |         |  |
|            |            | K := Schlüsselmanagement (key manage                                                                                                                                                                                                                                                     |         |  |

<span id="page-67-0"></span>

| Feldnummer | 1 | 2                                                             | 3 |
|------------|---|---------------------------------------------------------------|---|
|            |   | ment)<br>S := Verkaufs-, Kontroll- und Hintergrund<br>systeme |   |

#### **Tabelle 8–13 Kodierungsschema der Gefährdungen**

Die auf die jeweiligen Systemkomponenten bezogenen potentiellen Gefährdungen der Sicherheitsziele sind in den folgenden Tabellen dargestellt.

# **8.3.1 Gefährdungen der kontaktlosen Schnittstelle**

| Kurzbezeichnung der Ge<br>fährdung |                                                       | Bedrohte<br>Sicher<br>heitsziele | Beschreibung der Gefährdung                                                                                                                                                                                                                                                                                                                               |
|------------------------------------|-------------------------------------------------------|----------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GIF1                               | Mangelnde<br>Kompatibilität<br>der Schnittstel<br>len | SF1                              | Mangelnde Kompatibilität der Schnittstellen<br>NFC-Mobiltelefon – lokaler Transponder bzw.<br>Trägermedium –Lesegerät führt zu Nichtfunkti<br>on beim Check-in / der Entwertung, der Kon<br>trolle, etc. Das Resultat ist ähnlich einer DoS<br>Angriff auf das System. Eine Vielzahl von Kun<br>den bzw. Berechtigungen wäre möglicherweise<br>betroffen. |
| GIF2                               | Abhören                                               | SI1, SI2,<br>SI5                 | Unberechtigtes Belauschen der Kommunikati<br>on zwischen einem Trägermedium und einem<br>Lesegerät.                                                                                                                                                                                                                                                       |
| GIF3                               | DoS-Angriff auf<br>die RF<br>Schnittstelle            | SF1, SF2,<br>SF3                 | 1<br>Stören der RFID-Kommunikation (Jam<br>ming)<br>2<br>Stören des Antikollisionsmechanismus zur<br>Selektierung des Trägermediums (Blocker<br>Tag)<br>3<br>Abschirmung des elektromagnetischen<br>Feldes des Lesegerätes (Shielding)<br>4<br>Verstimmen der Resonanzfrequenz von<br>Reader oder Trägermedium (De-Tuning)                                |

**Tabelle 8–14 Gefährdungen der kontaktlosen Schnittstelle** 

# **8.3.2 Gefährdungen des aktiven NFC-Mobiltelefons**

| Kurzbezeichnung der Ge<br>fährdung |                                                       | Bedrohte<br>Sicher<br>heitsziele | Beschreibung der Gefährdung                                                                                                                                                                                     |
|------------------------------------|-------------------------------------------------------|----------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GNMD1                              | Mangelnde<br>Kompatibilität<br>der Schnittstel<br>len | SF1                              | Mangelnde Kompatibilität der Schnittstellen<br>NFC-Mobiltelefon – lokaler Transponder bzw.<br>Trägermedium –Lesegerät kann zu Nichtfunk<br>tion beim Check-in / der Entwertung, der Kon<br>trolle, etc. führen. |

| Kurzbezeichnung der Ge<br>fährdung |                                             | Bedrohte<br>Sicher<br>heitsziele | Beschreibung der Gefährdung                                                                                                                                                                                                                               |
|------------------------------------|---------------------------------------------|----------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GNMD2                              | Fehlfunktion des<br>NFC                     | SF2                              | Die Funktion des NFC-Mobiltelefons kann im<br>täglichen Betrieb gestört sein. Beispiele:                                                                                                                                                                  |
|                                    | Mobiltelefons                               |                                  | 1<br>Kein Mobilnetz vorhanden<br>2<br>Akku leer                                                                                                                                                                                                           |
|                                    |                                             |                                  | Dadurch kann z. B. ein Übertragen der Daten<br>des lokalen Transponders and das Hinter<br>grundsystem oder eine Übertragung der<br>Check-in Daten an das NFC-Mobiltelefon ge<br>fährdet sein.                                                             |
| GNMD3                              | Handhabungs<br>probleme                     | SF3                              | Die Lesereichweite des NFC-Mobiltelefons ist<br>begrenzt. Weiterhin erfordert ein "offline<br>Check-in" eine genaue Kenntnis der zu erwar<br>tenden Systemnachrichten. Dies kann bei un<br>erfahrenen Anwendern zu Problemen bei der<br>Anwendung führen. |
| GNMD4                              | Unerlaubtes<br>Auslesen der<br>Berechtigung | SI2, SI5,<br>SI4                 | Die Berechtigung oder Informationen über die<br>Berechtigung könnten z. B. beim Datenaus<br>tausch zwischen dem NFC-Mobiltelefon und<br>dem Hintergrundsystem offen gelegt werden.                                                                        |
| GNMD5                              | Manipulation der<br>Berechtigung            | SI2, SI5,<br>SI4                 | Die Berechtigung oder Informationen über die<br>Berechtigung könnten z. B. beim Datenaus<br>tausch zwischen dem NFC-Mobiltelefon und<br>dem Hintergrundsystem manipuliert werden.                                                                         |
| GNMD6                              | Offenlegung<br>Orts<br>Informationen        | SI4                              | Offenlegung der aus dem Tag gelesenen In<br>formationen könnte indirekt zu Abrechnungs<br>problemen führen und für DoS-Attacken aus<br>genutzt werden.                                                                                                    |
| GNMD7                              | Manipulation der<br>Orts<br>Informationen   | SI4                              | Manipulation der aus dem Tag gelesenen In<br>formationen kann zu Abrechnungsproblemen<br>führen und für DoS-Attacken benutzt werden.                                                                                                                      |
| GNMD8                              | Schutz vor DoS<br>Angriffen                 | SF2                              | Durch Angriffe auf die aktiven Funktionen des<br>NFC-Mobiltelefons könnte das Lesen des Tag,<br>das Prüfen der Authentizität oder der nachge<br>lagerte Datenaustausch mit dem Hintergrund<br>system vereitelt werden.                                    |
| GNMD9                              | Schutz der per<br>sonenbezoge<br>nen Daten  | SI1                              | Sofern personenbezogene Daten (z. B. Bewe<br>gungsdaten) gespeichert oder übermittelt wer<br>den, sind diese den gleichen Gefährdungen<br>wie Berechtigungen und Ortsinformationen<br>ausgesetzt.                                                         |

<span id="page-69-0"></span>

| Kurzbezeichnung der Ge<br>fährdung |                                       | Bedrohte<br>Sicher<br>heitsziele | Beschreibung der Gefährdung                                                                                                                                                |
|------------------------------------|---------------------------------------|----------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GNMD10                             | Manipulation<br>von Display<br>Texten | SF2                              | Der Kunde wird mit Anzeigetexten über den<br>Stand des Check-in und Check-out informiert.<br>Eine Manipulation dieser Texte könnte zu<br>Problemen bei der Nutzung führen. |

**Tabelle 8–15 Gefährdungen des aktiven NFC Mobiltelefons** 

# **8.3.3 Gefährdungen des passiven NFC-Mobiltelefons**

Das NFC-Mobiltelefon verhält sich im passiven Modus wie eine passives Trägermedium. Deshalb sind die im Folgenden aufgeführten Gefährdungen identisch zu denen, die bei kontaktlosen passiven Trägermedien ermittelt wurden.

| Kurzbezeichnung der Ge<br>fährdung |                                                                                | Bedrohte<br>Sicher<br>heitsziele | Beschreibung der Gefährdung                                                                                                                                                            |
|------------------------------------|--------------------------------------------------------------------------------|----------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GT1                                | Unerlaubtes<br>Auslesen der<br>Berechtigung                                    | SI2, SI5                         | Unerlaubtes aktives Auslesen des Trägerme<br>diums.                                                                                                                                    |
| GT2                                | Unerlaubtes<br>Schreiben / Ma<br>nipulieren der<br>Berechtigung                | SI2, SI5,<br>SI4                 | Unerlaubtes Schreiben von Daten in das Trä<br>germedium.                                                                                                                               |
| GT3                                | Klonen des Me<br>diums inkl. Be<br>rechtigung                                  | SI2, SI5,<br>SI4                 | Möglichst exaktes Nachbilden von Trägerme<br>dien, Anwendungen oder Berechtigungen.                                                                                                    |
| GT4                                | Emulieren der<br>Anwendung und<br>Berechtigung                                 | SI2, SI5,<br>SI4                 | Nachbilden der elektrischen Funktion des Trä<br>germediums über ein programmierbares Gerät                                                                                             |
| GT5                                | Unerlaubtes<br>Auslesen der<br>personenbezo<br>genen Daten                     | SI1                              | Unerlaubtes aktives Auslesen von in der An<br>wendung auf dem Trägermedium gespeicher<br>ten personenbezogenen Daten (z. B. Bewe<br>gungsdaten).                                       |
| GT6                                | Unerlaubtes<br>Schreiben / Ma<br>nipulieren der<br>personenbezo<br>genen Daten | SI1                              | Unerlaubtes Schreiben von personenbezoge<br>nen Daten in das Trägermedium. Umfasst<br>auch die Nutzungsdaten, die im Medium ge<br>speichert sein können (aut. Fahrpreisermitt<br>lung) |
| GT7                                | Unerlaubtes<br>Auslesen der<br>Abrechnungsda<br>ten                            | SI4                              | Unerlaubtes aktives Auslesen der Abrech<br>nungsdaten                                                                                                                                  |
| GT8                                | Unerlaubtes<br>Schreiben / Ma<br>nipulieren der                                | SI4                              | Unerlaubtes Schreiben von Abrechnungsdaten<br>in das Trägermedium zum Zwecke der Mani<br>pulation bzw. Kompromittierung.                                                               |

<span id="page-70-0"></span>

| Kurzbezeichnung der Ge<br>fährdung |                                                                                                            | Bedrohte<br>Sicher<br>heitsziele | Beschreibung der Gefährdung                                                                                                                                                                                                                                                                                                                                                           |
|------------------------------------|------------------------------------------------------------------------------------------------------------|----------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                    | Abrechnungsda<br>ten                                                                                       |                                  |                                                                                                                                                                                                                                                                                                                                                                                       |
| GT9                                | Gefährdung<br>durch unzurei<br>chenden Schutz<br>von zusätzlichen<br>Anwendungen<br>und Berechti<br>gungen | SI5                              | Sofern mehrere Berechtigungen und Anwen<br>dungen auf einem Trägermedium vorhanden<br>sind, könnten diese bei wechselseitiger Benut<br>zung beeinflusst oder beschädigt werden.                                                                                                                                                                                                       |
| GT10                               | Fehlfunktion des<br>Trägermediums                                                                          | SF1, SF2                         | Fehlfunktionen des Trägermediums können<br>durch technische Fehler, Fehlbedienung oder<br>DoS-Angriffe in verschiedenen Szenarien her<br>beigeführt werden:<br>1<br>Störung der kontaktlose Schnittstelle<br>2<br>Störung der Referenzinformationen<br>(Schlüssel, etc)<br>3<br>Störung der Anwendungsimplementierung<br>4<br>Störung der Berechtigungen<br>5<br>Physische Zerstörung |
| GT11                               | Tracking durch<br>unberechtigtes<br>Auslesen durch<br>Dritte                                               | SP3                              | Der Antikollisionsmechanismus des Trägerme<br>diums sendet eine Kennung unverschlüsselt<br>an jeden anfragenden Leser. Das kann von<br>Unberechtigten zum Auslesen von Kennungen<br>des Trägermediums und ggf. zur Erstellung<br>von Bewegungsprofilen basierend auf dieser<br>Kennung ausgenutzt werden.                                                                             |
| GT12                               | Fehlen einer<br>Rückfalllösung<br>bei Fehlfunktion                                                         | SF2                              | Fehlen einer sicheren Möglichkeit zur Bewer<br>tung der Echtheit bzw. Identifizierung des Me<br>diums bei defektem Chip kann zu Problemen<br>bei der Sperrung und Ersatz führen.                                                                                                                                                                                                      |

| Tabelle 8–16 |  | Gefährdungen des passiven NFC-Mobiltelefons |
|--------------|--|---------------------------------------------|
|              |  |                                             |

# **8.3.4 Gefährdungen des lokalen Transponders**

| Kurzbezeichnung der Ge<br>fährdung |                                                                    | Bedrohte<br>Sicher<br>heitsziele | Beschreibung der Gefährdung                              |
|------------------------------------|--------------------------------------------------------------------|----------------------------------|----------------------------------------------------------|
| GTR1                               | Unerlaubtes<br>Auslesen der<br>Ortsinformation                     | SI2, SI5                         | Unerlaubtes aktives Auslesen                             |
| GTR2                               | Unerlaubtes<br>Schreiben / Ma<br>nipulieren der<br>Ortsinformation | SI2, SI5,<br>SI4                 | Unerlaubtes Schreiben von Daten in das Trä<br>germedium. |

<span id="page-71-0"></span>

| Kurzbezeichnung der Ge<br>fährdung |                                                    | Bedrohte<br>Sicher<br>heitsziele | Beschreibung der Gefährdung                                                                                                                                                                                          |
|------------------------------------|----------------------------------------------------|----------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GTR3                               | Klonen des loka<br>len Transpon<br>ders            | SI2, SI5,<br>SI4                 | Möglichst exaktes Nachbilden des Trägerme<br>diums inklusive Anwendung und Informationen                                                                                                                             |
| GTR4                               | Emulieren des<br>lokalen<br>Transponders           | SI2, SI5,<br>SI4                 | Nachbilden der elektrischen Funktion des Trä<br>germediums über ein programmierbares Gerät                                                                                                                           |
| GTR5                               | Umplatzieren<br>des lokalen<br>Transponders        | SI2, SI5,<br>SI4                 | Abmontieren und Ummontieren eines<br>Transponders kann zu Abrechnungs-, Be<br>triebs- und Sicherheitsproblemen führen.                                                                                               |
| GTR6                               | Ausbringen zu<br>sätzlicher<br>Transponder         | SI2, SI5,<br>SI4                 | Ausbringen von zusätzlichen Transponders mit<br>z. B. fremder Ortskennungen kann zu Betriebs<br>und Sicherheitsproblemen führen -> mögliche<br>DoS Attacke.                                                          |
| GTR7                               | Fehlfunktion des<br>lokalen<br>Transponders        | SF1, SF2                         | Fehlfunktionen des Trägermediums können<br>durch technische Fehler, Fehlbedienung oder<br>DoS-Angriffe in verschiedenen Szenarien her<br>beigeführt werden:                                                          |
|                                    |                                                    |                                  | 1<br>Störung der kontaktlose Schnittstelle<br>2<br>Störung der Referenzinformationen<br>(Schlüssel, etc)<br>3<br>Störung der Anwendungsimplementierung<br>4<br>Störung des Dateninhalts<br>5<br>Physische Zerstörung |
| GTR8                               | Fehlen einer<br>Rückfalllösung<br>bei Fehlfunktion | SF2                              | Fehlen einer Rückfalllösung kann zum Ge<br>samtausfall des Systems führen, da ggf. kein<br>Check-in / Entwertung mehr möglich wäre.                                                                                  |

**Tabelle 8–17 Gefährdungen des lokalen Transponders** 

# **8.3.5 Gefährdungen des Lesegeräts**

| Kurzbezeichnung der Ge<br>fährdung |                                                                | Bedrohte<br>Sicher<br>heitsziele | Beschreibung der Gefährdung                                                                                                                                                                                  |
|------------------------------------|----------------------------------------------------------------|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GR1                                | Unberechtigte<br>Manipulation der<br>Referenzinfor<br>mationen | SI1, SI2,<br>SI3, SI4,<br>SI5    | Manipulation der Referenzinformationen<br>(Schlüssel, Auswertealgorithmen, Black- oder<br>Whitelists) kann zur unberechtigten Nutzung<br>oder zu DoS verwendet werden.                                       |
| GR2                                | Unberechtigtes<br>Auslesen der<br>Referenzinfor<br>mationen    | SI1, SI2,<br>SI4, SI5            | Auslesen der Referenzinformationen (Schlüs<br>sel, Auswertealgorithmen, Black- oder White<br>lists) kann zur unberechtigten Nutzung (Z. B.<br>Fälschung von Berechtigungen) oder zu DoS<br>verwendet werden. |

<span id="page-72-0"></span>

| GR3 | Fehlfunktion des<br>Lesegerät | SF1, SF2 | Fehlfunktionen des Lesegeräts können durch<br>technische Fehler, Fehlbedienung oder DoS<br>Angriffe in verschiedenen Szenarien herbeige<br>führt werden:        |
|-----|-------------------------------|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|
|     |                               |          | 1<br>Störung der kontaktlose Schnittstelle                                                                                                                      |
|     |                               |          | 2<br>Störung der Referenzinformationen<br>(Schlüssel, Sperrlisten, etc)                                                                                         |
|     |                               |          | 3<br>Störung der Anwendungsimplementierung                                                                                                                      |
|     |                               |          | 4<br>Störung der Auswertealgorithmen für Be<br>rechtigungen                                                                                                     |
|     |                               |          | 5<br>Fehler in der Stromversorgung                                                                                                                              |
|     |                               |          | 6<br>Unterbrechung der Anbindung an das<br>Zentralsystem                                                                                                        |
|     |                               |          | 7<br>Physische Zerstörung                                                                                                                                       |
|     |                               |          | 8<br>Störung der Funktionen zur Nutzerführung                                                                                                                   |
| GR4 | Mangelnde Be<br>dienerführung | SF3      | Mangelnde Bedienerfreundlichkeit an Automa<br>ten und Terminals für Entwertung bzw. Check<br>in / Check-out kann zu erheblichen operativen<br>Problemen führen. |

**Tabelle 8–18 Gefährdungen des Lesegerätes** 

# **8.3.6 Gefährdungen des Schlüsselmanagement**

| Kurzbezeichnung der Ge<br>fährdung |                                                    | Bedrohte<br>Sicher<br>heitsziele | Beschreibung der Gefährdung                                                                                                                                                                                                                                                                                                                                                      |
|------------------------------------|----------------------------------------------------|----------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GK1                                | Qualität der<br>Schlüsseldaten                     | SI1, SI2,<br>SI3, SI4,<br>SI5    | Mangelnde Qualität der Schlüssel steigert die<br>Erfolgschancen von Angriffen.                                                                                                                                                                                                                                                                                                   |
| GK2                                | Unberechtigtes<br>Auslesen von<br>Schlüsseldaten   | SI1, SI2,<br>SI3, SI4,<br>SI5    | Das Auslesen von Schlüsseldaten durch Unbe<br>rechtigte kann das Systems diskreditieren und<br>z. B. Angriffe auf alle kryptografisch geschütz<br>ten Daten und Funktionen begünstigen.                                                                                                                                                                                          |
| GK3                                | Manipulieren<br>von Schlüssel<br>daten             | SI1, SI2,<br>SI3, SI4,<br>SI5    | Manipulation von Schlüsseldaten kann das<br>Sicherheitskonzept des Systems diskreditieren<br>und z. B. Angriffe auf alle kryptografisch ge<br>schützten Daten und Funktionen begünstigen.<br>Die Manipulation kann die Erstellung von<br>Schlüsseln, die Erstellung von Schlüsselträ<br>gern, die Übertragung von Schlüsseln und die<br>lokale Nutzung von Schlüsseln betreffen. |
| GK4                                | Fehlfunktion des<br>Schlüsselmana<br>gementsystems | SF1, SF2                         | Fehlfunktionen des Schlüsselmanagements<br>können durch technische Fehler, Fehlbedie<br>nung oder DoS-Angriffe in verschiedenen Sze<br>narien herbeigeführt werden:<br>1<br>Störung der lokalen und zentralen Syste<br>me                                                                                                                                                        |

<span id="page-73-0"></span>

| Kurzbezeichnung der Ge<br>fährdung |                                | Bedrohte<br>Sicher<br>heitsziele | Beschreibung der Gefährdung                                                                                                                                                                                                                                                                                                                                      |
|------------------------------------|--------------------------------|----------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                    |                                |                                  | 2<br>Mangelnde Verfügbarkeit der lokalen und<br>zentralen Systeme<br>3<br>Störung der Datenspeicher<br>4<br>Störung der spezifischen Anwendungs<br>implementierung<br>5<br>Störung der Auswertealgorithmen für Be<br>rechtigungen<br>6<br>Fehler in der Stromversorgung<br>7<br>Unterbrechung der Anbindung an das<br>Zentralsystem<br>8<br>Physische Zerstörung |
| GK5                                | Fehlen einer<br>Rückfalllösung | SF2                              | Die Verfügbarkeit der benötigten Schlüsselin<br>formationen ist die Grundvoraussetzung für die<br>Funktion des Gesamtsystems. Bei Fehlfunktio<br>nen des Schlüsselmanagement wäre ohne<br>Rückfalllösung die Funktion des Gesamtsys<br>tems bedroht.                                                                                                             |

**Tabelle 8–19 Gefährdungen des Schlüsselmanagements** 

# **8.3.7 Gefährdungen der Verkaufs-, Kontroll- und Hintergrundsysteme**

| Kurzbezeichnung der Ge<br>fährdung |                                                 | Bedrohte<br>Sicher<br>heitsziele   | Beschreibung der Gefährdung                                                                                                                                                                                                                                                                                   |
|------------------------------------|-------------------------------------------------|------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GS1                                | Fehlen einer<br>Rückfalllösung                  | SF2, SI4                           | Das Fehlen einer Rückfalllösung beim Ausfall<br>von Systemkomponenten wie Ticketverkaufs<br>system, Verwaltungssystem für Trägermedien<br>und Berechtigungen, Kontrollsystem kann zu<br>Komplettausfällen von Services führen (Ver<br>kauf, Abrechnung, Akzeptanz, etc).                                      |
| GS2                                | Unberechtigtes<br>Auslesen von<br>Referenzdaten | SF1, SI1,<br>SI2, SI3,<br>SI4, SI5 | In den Hintergrundsystemen sind Informatio<br>nen zu den Medien, den Berechtigungen, der<br>Nutzung sowie ggf. personenbezogene Daten<br>und Abrechnungsdaten gespeichert. Das Aus<br>lesen dieser Daten durch Unberechtigte würde<br>das System diskreditieren und die Möglichkeit<br>für Angriffe schaffen. |
| GS3                                | Manipulieren<br>von Referenzda<br>ten im System | SF1, SI1,<br>SI2, SI3,<br>SI4, SI5 | In den Hintergrundsystemen sind Informatio<br>nen zu den Medien, den Berechtigungen, der<br>Nutzung sowie ggf. personenbezogene Daten<br>und Abrechnungsdaten gespeichert. Das Ma<br>nipulieren dieser Daten durch Unberechtigte ist<br>ein schwerwiegender Angriff.                                          |
| GS4                                | Fehlfunktion des                                | SF1, SF2                           | Fehlfunktionen einzelner Systemkomponenten<br>können durch technische Fehler, Fehlbedie-                                                                                                                                                                                                                      |

<span id="page-74-0"></span>

| Kurzbezeichnung der Ge<br>fährdung |                                                                                          | Bedrohte<br>Sicher<br>heitsziele | Beschreibung der Gefährdung                                                                                                                                                                                                                                                                                                                                             |
|------------------------------------|------------------------------------------------------------------------------------------|----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                    | Systems                                                                                  |                                  | nung oder DoS-Angriffe in verschiedenen Sze<br>narien herbeigeführt werden:<br>1<br>Störung der lokalen und zentralen Syste<br>me<br>2<br>Mangelnde Verfügbarkeit der lokalen und<br>zentralen Systeme<br>3<br>Störung der Datenspeicher<br>4<br>Fehler in der Stromversorgung<br>5<br>Unterbrechung der Anbindung an das<br>Zentralsystem<br>6<br>Physische Zerstörung |
| GS5                                | Mangelnde<br>Kompatibilität<br>der Schnittstel<br>len                                    | SF1                              | Mangelnde Kompatibilität der Schnittstellen<br>führt zu Fehlfunktion. Das Resultat ist ähnlich<br>einem DoS-Angriff auf das System. Eine Viel<br>zahl von Kunden bzw. Berechtigungen wäre<br>möglicherweise betroffen.                                                                                                                                                  |
| GS6                                | Unerlaubtes<br>Auslesen der<br>Verkaufs- und<br>Abrechnungsda<br>ten                     | SI4                              | Unerlaubtes aktives Auslesen der Abrech<br>nungsdaten                                                                                                                                                                                                                                                                                                                   |
| GS7                                | Unerlaubtes<br>Schreiben / Ma<br>nipulieren der<br>Verkaufs- und<br>Abrechnungsda<br>ten | SI4                              | Unerlaubtes Schreiben von Abrechnungsdaten<br>in das Trägermedium oder in Hintergrundsys<br>teme zum Zwecke der Manipulation bzw.<br>Kompromittierung.                                                                                                                                                                                                                  |
| GS8                                | Schutz von man<br>dantenspezifi<br>schen Anwen<br>dungen und Be<br>rechtigungen          | SI5                              | Sofern mehrere Entitäten mit Verkaufsdaten,<br>Berechtigung und Anwendungen von den Sys<br>temen unterstützt werden, könnten diese bei<br>wechselseitiger Benutzung beeinflusst oder<br>beschädigt werden.                                                                                                                                                              |
| GS9                                | Fälschung von<br>Identifikations<br>daten                                                | SI2                              | Beim Kauf oder Abholung eines Produktes ist<br>ggf. eine Identifizierung erforderlich. Das Vor<br>täuschen einer falschen Identität erlaubt z. B.<br>das Erschleichen von Berechtigungen zu Las<br>ten anderer Kunden oder des Produktanbie<br>ters.                                                                                                                    |
| GS10                               | Ungerechtfertig<br>tes Sammeln<br>und Speichern<br>von Daten                             | SI6                              | Verstoß gegen das Gebot zur Datensparsam<br>keit durch ungerechtfertigtes Sammeln und<br>Speichern von Daten                                                                                                                                                                                                                                                            |

| Tabelle 8–20 | Gefährdungen der Verkaufs-, Kontroll- und Hintergrundsysteme |
|--------------|--------------------------------------------------------------|
|--------------|--------------------------------------------------------------|

# <span id="page-75-1"></span><span id="page-75-0"></span>**8.4 Maßnahmen**

In diesem Kapitel werden Maßnahmen benannt, die den in Kapitel [8.3](#page-66-1) benannten Gefährdungen entgegen gestellt werden können. Dabei werden die Maßnahmen so definiert, dass sie aufeinander aufbauend stufenweise höhere Sicherheit bringen, sofern eine Abstufung möglich ist. Stufe 1 stellt dabei die niedrigste Sicherheitsstufe dar, Stufe 3 die höchste.

Als 3+ werden zusätzlich mögliche Maßnahmen eingestuft, die die Sicherheit des Systems zwar steigern, jedoch den Aufwand im Vergleich zum zusätzlichen Sicherheitsgewinn unverhältnismäßig steigern können.

Die Sicherheitsstufen orientieren sich dabei an den Schutzbedarfsklassen des Systems. Einer Gefährdung eines Sicherheitsziels, welches in Schutzbedarfsklasse 3 eingestuft wurde, soll dabei durch Maßnahmen der Sicherheitsstufe 3 begegnet werden. Generell kann eine Gefährdung einer bestimmten Schutzbedarfsklasse mit Maßnahmen der gleichen oder einer höheren Schutzklasse kompensiert werden.

Die folgenden Maßnahmen sind in der Regel nicht als Einzelmaßnahmen definiert worden, sondern vielmehr als "Maßnahmenpakete" zu verstehen. In der Regel kann die Sicherheit von Komponenten und Schnittstellen sowie des Gesamtsystems nur dann sinnvoll erhöht werden, wenn Maßnahmen als solche Pakete flächendeckend umgesetzt werden. Des Weiteren werden innerhalb der Sicherheitsstufen alternative Möglichkeiten gekennzeichnet, beispielsweise kann eine sichere Einsatzumgebung (in der Regel nicht gegeben) eine verschlüsselte Speicherung von Daten ersetzen.

| Feldnummer | 1        | 2                                                    | 3         |
|------------|----------|------------------------------------------------------|-----------|
| Feld       | Maßnahme | Zugeordnete Komponente                               | Zählindex |
|            | M        | IF := kontaktlose Schnittstelle (Interface)          | 1,  , n   |
|            |          | NMD := NFC-Mobiltelefon (aktiv)                      |           |
|            |          | T := Trägermedium, NFC-Mobiltelefon<br>(passiv)      |           |
| Inhalt     |          | TR := Lokaler Transponder (Tag)                      |           |
|            |          | R := Lesegerät (Reader)                              |           |
|            |          | K := Schlüsselmanagement (key manage<br>ment)        |           |
|            |          | S := Verkaufs-, Kontroll- und Hintergrund<br>systeme |           |

Die folgende Tabelle zeigt das Kodierungsschema der Maßnahmen und die verwendeten Abkürzungen.

**Tabelle 8–21 Kodierungsschema der Maßnahmen** 

# <span id="page-75-2"></span>**8.4.1 Auswahl kryptographischer Verfahren**

In den folgenden Maßnahmenbeschreibungen werden für neue Implementierungen kryptographische Verfahren gemäß [ALGK\_BSI] gefordert. In [ALGK\_BSI] werden geeignete Verfahren, geeignete Schlüssellängen und die erwartete Lebensdauer dieser Verfahren genannt. [ALGK\_BSI] wird in geeigneten Abständen überarbeitet und durch das BSI veröffentlicht werden.

<span id="page-76-0"></span>Bereits bestehende Implementierungen sollen grundsätzlich [ALGK\_BSI] oder [TR\_eCARD] genügen. Mit dem nächsten Evolutionsschritt der jeweiligen Implementierung soll [ALGK\_BSI] angewendet werden. Dieser Schritt muss in einem angemessenen Zeitraum durchgeführt werden.

Die Anwendung des TDES-Algorithmus ist für Bestandssysteme für die Authentifikation, die Verschlüsselung und die MAC-Bildung unter vorstehend genannten Randbedingungen zulässig.

# <span id="page-76-1"></span>**8.4.2 Maßnahmen zum Schutz des Gesamtsystems**

Die folgenden Maßnahmen beziehen sich auf das Gesamtsystem. Der Schwerpunkt liegt dabei auf den Verkaufs-, Kontroll- und Managementsystemen inklusive der zugehörigen Schnittstellen.

Auf die RF-Schnittstelle, Lesegeräte, die in Terminals, Automaten, etc eingebaut sind, Trägermedien und das Schlüsselmanagement wird zusätzlich gesondert eingegangen.

| MS1           | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                   | Adressierte Gefährdungen |  |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|               | Einführung von Schnittstellentests und Frei<br>gabeverfahren                                                                                                                                                                                                                                                                                                    | GS5, GIF1, GNMD1         |  |
| Allge<br>mein | Durch die Einführung von schnittstellenbasierter Testspezifikationen und ent<br>sprechender Tests für alle Komponenten soll die Kompatibilität der Komponen<br>ten erreicht und überprüfbar gemacht werden. Dabei sind alle Ebenen der<br>Schnittstellen (OSI-Modell) inklusive der Fehlerfälle zu betrachten.                                                  |                          |  |
|               | Schnittstellentest:                                                                                                                                                                                                                                                                                                                                             |                          |  |
| 1             | •<br>Verwendung von existierenden Prüfvorschriften wie insbesondere<br>[BSI_PICC_TestSpec] und [BSI_PCD_TestSpec] für die kontaktlose<br>Schnittstelle nach ISO/IEC14443. Prüfen der Schnittstelle zwischen NFC<br>Mobiltelefon (PCD-Modus) und lokalem Transponder sowie zwischen NFC<br>Mobiltelefon (PICC Mode) und klassischem Lesegerät nach ISO/IEC14443. |                          |  |
|               | •<br>Erstellung und Verwendung von spezifischen Testvorschriften für die an<br>wendungsspezifischen Funktionen der Schnittstellen von Trägermedien und<br>Lesegeräten                                                                                                                                                                                           |                          |  |
|               | •<br>Erstellung und Verwendung von spezifischen Testvorschriften für die Proto<br>kolle und anwendungsspezifischen Funktionen der Schnittstellen zwischen<br>den übrigen Systemkomponenten.                                                                                                                                                                     |                          |  |
| 2             | Komponentenfreigabe                                                                                                                                                                                                                                                                                                                                             |                          |  |
|               | s.o., zusätzlich Komponentenfreigabe (Trägermedium, lokaler Transponder,<br>Lesegeräte, Schlüsselmanagement)                                                                                                                                                                                                                                                    |                          |  |
| 3             | Zertifizierung                                                                                                                                                                                                                                                                                                                                                  |                          |  |
|               | s.o., zusätzlich Zertifizierung durch unabhängiges Institut für Trägermedien,<br>Lesegeräte und bei Bedarf auch anderer Komponenten.                                                                                                                                                                                                                            |                          |  |
|               |                                                                                                                                                                                                                                                                                                                                                                 |                          |  |

#### **Tabelle 8–22 Schutz des Gesamtsystems durch Einführung von Schnittstellentests und Freigabeverfahren**

<span id="page-77-0"></span>

| MS2           | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Adressierte Gefährdungen |  |
|---------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|               | Sicherung der Vertraulichkeit der Kommunika<br>tion zwischen Trägermedium und Lesegerät<br>zur Abwehr von Abhören                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | GIF2, GNMD6, GNMD7       |  |
| Allge<br>mein | Die Maßnahme betrifft alle Implementierungen der kontaktlosen Schnittstelle<br>zwischen dem NFC-Mobiltelefon, dem lokalen Transponder und Lesegeräten,<br>die z. B. in Automaten, Verkaufsterminals, Ticketdrucker und CICO-Terminals<br>eingebaut sind.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                          |  |
| 1             | Übertragungssicherung:<br>•<br>Sofern kein sicherer Kanal nach MS2.2 oder MS2.3 aufgebaut werden<br>kann, werden die Daten terminalseitig verschlüsselt und an die Trägerme<br>dien übertragen Die Entschlüsselung der vom Trägermedium erhaltenen<br>Daten erfolgt demnach ebenfalls im Lesegerät.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                          |  |
| 2             | Gegenseitige Authentisierung bei der Übertragung:<br>•<br>Vor der Übertragung von Daten wird eine gegenseitige Authentifikation mit<br>festen symmetrischen Schlüsseln zur Aushandlung eines gemeinsamen<br>Verschlüsselungsschlüssels durchgeführt. Der ausgehandelte Schlüssel<br>wird zur Verschlüsselung mittels AES128, TDES oder eines vergleichbaren<br>offenen Verfahrens verwendet. Die Art und Stärke des Mechanismus ist an<br>künftige Entwicklungen entsprechend [ALGK_BSI] anzupassen.                                                                                                                                                                                                                                                                                            |                          |  |
| 3             | Gegenseitige, dynamische Authentisierung bei der Übertragung:<br>•<br>Implementierung eines dynamischen Verschlüsselungsverfahrens.<br>Dabei wird vor Übertragung von Daten zwischen Trägermedium und Lese<br>gerät gegenseitig mit Hilfe eines geeigneten Challenge- und Responsever<br>fahrens ein gemeinsamer Schlüssel ausgehandelt, der zur Kommunikation<br>genutzt wird.<br>•<br>Die Algorithmen und Schlüssellängen sind hierbei so zu wählen, dass Sie<br>dem aktuellen Stand der Technik entsprechen. Aktuell können verwendet<br>werden: TDES, AES128 oder vergleichbare offene Verfahren. Für RSA und<br>ECC gelten die jeweils aktuellen Vorgaben des [ALGK_BSI].<br>•<br>Die Art und Stärke des Mechanismus ist an künftige Entwicklungen ent<br>sprechend [ALGK_BSI] anzupassen. |                          |  |

#### **Tabelle 8–23 Schutz des Gesamtsystems durch Sicherung der Vertraulichkeit der Kommunikation**

|     | Kurzbezeichnung der Maßnahmen                                                                              | Adressierte Gefährdungen |
|-----|------------------------------------------------------------------------------------------------------------|--------------------------|
| MS3 | Einführung der kontaktlosen Schnittstelle nach<br>ISO/IEC14443 / ISO/IEC 21481 oder von<br>Felddetektoren. | GIF2, GIF3               |
| 1   |                                                                                                            |                          |
| 2   | Einführung der kontaktlosen Nahbereichsschnittstelle nach ISO/IEC14443 bzw .<br>ISO/IEC 21481              |                          |
| 3   |                                                                                                            |                          |

<span id="page-78-0"></span>

|     | Kurzbezeichnung der Maßnahmen                                                                              | Adressierte Gefährdungen |
|-----|------------------------------------------------------------------------------------------------------------|--------------------------|
| MS3 | Einführung der kontaktlosen Schnittstelle nach<br>ISO/IEC14443 / ISO/IEC 21481 oder von<br>Felddetektoren. | GIF2, GIF3               |
| 3+  | Es werden zusätzlich Felddetektoren eingesetzt.                                                            |                          |

#### **Tabelle 8–24 Schutz des Gesamtsystems durch Einführung der kontaktlosen Schnittstelle nach ISO/IEC14443**

|     | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Adressierte Gefährdungen |  |
|-----|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
| MS4 | Definition von Rückfalllösungen beim Ausfall<br>von Systemschnittstellen und Systemkompo<br>nenten.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | GS1, GS4                 |  |
| 1   | Definition von geeigneten Betriebsprozessen, Offlinefähigkeit und Backup:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                          |  |
| 2   | •<br>Systemkomponenten müssen prinzipiell (zumindest temporär) auch autark<br>ohne Hintergrundsystem bzw. bei Ausfall von Systemschnittstellen funktio<br>nieren können oder eine definierte Verfügbarkeit aufweisen, die aus den<br>speziellen betrieblichen Anforderungen abgeleitet ist.<br>•<br>Es ist ein regelmäßiges Backup von Daten durchzuführen, so dass ein To<br>talverlust auszuschließen ist.<br>•<br>Der Austausch defekter Komponenten ist zu regeln.<br>•<br>Es müssen für alle Komponenten und Schnittstellen Rückfallprozesse auf<br>gesetzt werden, die operative Probleme, die nach Ausfall einer Komponen<br>te entstehen können, durch betriebliche Maßnahmen beseitigen oder mil<br>dern.<br>•<br>Rückfalllösungen müssen in den vertraglichen Vereinbarungen zwischen<br>Kunden, Dienstleistern und Anbietern benannt und deren Folgen berück<br>sichtigt werden. |                          |  |
|     | Umsetzung nach Rückfallkonzept:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                          |  |
|     | Zusätzlich zu 1, 2:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                          |  |
| 3   | •<br>Es muss ein Systemkonzept erstellt werden, das die Verfügbarkeit und<br>Rückfalllösungen mit Verfügbarkeitszeiten und Rückfallintervallen explizit<br>festlegt.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                          |  |
|     | •<br>Kritische Komponenten müssen über eine USV und weitere Sicherungsme<br>chanismen (wie RAID) verfügen, so dass der Ausfall von Teilkomponenten<br>die Verfügbarkeit des Gesamtsystems nicht beeinträchtigt.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                          |  |
|     | •<br>Ggf. muss eine ausreichende Anzahl von Austausch-Systemkomponenten<br>zur Verfügung stehen, so dass die geforderte Verfügbarkeit erfüllt werden<br>kann.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                          |  |

#### **Tabelle 8–25 Schutz des Gesamtsystems durch Definition von Rückfalllösungen**

| MS5 | Kurzbezeichnung der Maßnahmen                                                          | Adressierte Gefährdungen                       |
|-----|----------------------------------------------------------------------------------------|------------------------------------------------|
|     | Sicherung der Vertraulichkeit von Daten bei<br>der Kommunikation innerhalb des Systems | GS2, GS6, GNMD4, GNMD5,<br>GNMD6, GNMD7, GNMD9 |
| 1   | Statische Verschlüsselung bei interner Kommunikation:                                  |                                                |

<span id="page-79-0"></span>

| MS5 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Adressierte Gefährdungen                       |
|-----|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|
|     | Sicherung der Vertraulichkeit von Daten bei<br>der Kommunikation innerhalb des Systems                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | GS2, GS6, GNMD4, GNMD5,<br>GNMD6, GNMD7, GNMD9 |
| 2   | •<br>Daten werden verschlüsselt übertragen. Als Verfahren kommen statische<br>Verschlüsselungsverfahren zum Einsatz. Alternativ kann anstelle einer ge<br>nerellen Datenverschlüsselung die Datenübertragung über dedizierte Netze<br>(abgeschlossene Lösung) erfolgen, in denen nur berechtigte Nutzer admi<br>nistriert und zugelassen sind. Das Netz ist über geeignete Maßnahmen<br>(z. B. Grundschutzmaßnahmen) physikalisch vor Zugriffen von außen zu<br>schützen und einhergehend konform zu einem hierfür geeigneten Sicher<br>heitskonzept zu betreiben. |                                                |
| 3   | Sicherer Kommunikationskanal:<br>•<br>Die Kommunikation zwischen den Komponenten des Systems erfolgt über<br>VPNs oder eine vergleichbare (abgeschirmte) Lösung. Dazu wird vor der<br>Kommunikation eine Authentifikation mit Schlüsselaushandlung zwischen<br>Sender und Empfänger durchgeführt. Der ausgehandelte Schlüssel wird<br>dann zur Kommunikation verwendet.                                                                                                                                                                                            |                                                |

| Tabelle 8–26 | Schutz des Gesamtsystems durch Sicherung der Vertraulichkeit von |
|--------------|------------------------------------------------------------------|
|              | Daten                                                            |

| MS6 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                             | Adressierte Gefährdungen |
|-----|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|     | Vertrauliche Speicherung von Daten                                                                                                                                                                                                                                                        | GS2, GS3, GS6, GS7, GS8  |
| 1   | Einführung eines mandantenfähigen Zugriffsschutz:                                                                                                                                                                                                                                         |                          |
| 2   | •<br>Auf gespeicherte Daten (personenbezogene Daten, Verkaufsdaten, Nut<br>zungsdaten, Abrechnungsdaten, Sperrlisten, Freigabelisten etc.) darf nur<br>ein bestimmter legitimierter Personenkreis zugreifen.<br>•<br>Daten werden in einem gegen unbefugte Zugriffe geschützten Umfeld ge |                          |
|     | speichert. Kann der Zugriffsschutz nicht gewährleistet werden, so sind die<br>Daten auf einem verschlüsselten Datenträger zu speichern (Einsatz von<br>Festplattenverschlüsselungswerkzeugen).                                                                                            |                          |
|     | Alternativ können andere gleichwertige Verschlüsselungsmechanismen zum<br>Einsatz kommen. Die Algorithmenstärke muss zumindest der des TDES<br>Algorithmus entsprechen.                                                                                                                   |                          |
|     | Die Art und Stärke des Mechanismus ist an künftige Entwicklungen entspre<br>chend [ALGK_BSI] anzupassen.                                                                                                                                                                                  |                          |
| 3   | Einführung eines mandantenfähigen Zugriffsschutz mit definiertem Rollenmo<br>dell.                                                                                                                                                                                                        |                          |
|     | Siehe 1-2, außerdem:                                                                                                                                                                                                                                                                      |                          |
|     | •<br>Es ist ein Mandantenkonzept in Form eines Rollenmodells zu etablieren.                                                                                                                                                                                                               |                          |

<span id="page-80-0"></span>

| MS6 | Kurzbezeichnung der Maßnahmen                                                                                                                                            | Adressierte Gefährdungen |
|-----|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|     | Vertrauliche Speicherung von Daten                                                                                                                                       | GS2, GS3, GS6, GS7, GS8  |
|     | Siehe 1-3,                                                                                                                                                               |                          |
| 3+  | Sensible Daten werden zum Schutz vor inneren Angriffen mit einer zusätzlichen<br>Verschlüsselung versehen, wobei ein Zugriff nur im Vier-Augen-Prinzip erfolgen<br>kann. |                          |

| Tabelle 8–27 | Schutz des Gesamtsystems durch vertrauliche Speicherung von Daten |
|--------------|-------------------------------------------------------------------|
|--------------|-------------------------------------------------------------------|

| MS7 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                    | Adressierte Gefährdungen                       |  |
|-----|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|--|
|     | Sicherung der Datenintegrität zum Schutz vor<br>Manipulationen bei der Datenübertragung<br>innerhalb des Systems                                                                                                                                 | GS3, GS7, GNMD4, GNMD5,<br>GNMD6, GNMD7, GNMD9 |  |
| 1   | Kryptographische Integritätssicherung:                                                                                                                                                                                                           |                                                |  |
|     | •<br>Die Integrität der Datenübertragung wird durch MAC-Sicherung gewährleis<br>tet. Die Algorithmen sind gemäß [ALGK_BSI] zu wählen.                                                                                                            |                                                |  |
| 2   | •<br>Die Art und Stärke des Mechanismus ist an künftige Entwicklungen ent<br>sprechend [ALGK_BSI] anzupassen.                                                                                                                                    |                                                |  |
|     | •<br>Sofern Implementierungen des NFC-basierten eTicketing auf existierenden<br>Systemen aufsetzen und deren Dateninhalt verwenden, ist es ausreichend<br>nachzuweisen, dass diese Systeme einen angemessenen Sicherheitsstan<br>dard aufweisen. |                                                |  |
|     | MAC oder Signaturen:                                                                                                                                                                                                                             |                                                |  |
|     | •<br>Die Integrität der Datenübertragung wird durch MAC-Sicherung oder durch<br>Signaturen gewährleistet.                                                                                                                                        |                                                |  |
|     | •<br>MAC- und Signaturverfahren sind nach [ALGK_BSI] zu wählen.                                                                                                                                                                                  |                                                |  |
| 3   | •<br>Die Art und Stärke des Mechanismus ist an künftige Entwicklungen ent<br>sprechend [ALGK_BSI] anzupassen.                                                                                                                                    |                                                |  |
|     | •<br>Sofern Implementierungen des NFC-basierten eTicketing auf existierenden<br>Systemen aufsetzen und deren Dateninhalt verwenden, ist es ausreichend<br>nachzuweisen, dass diese Systeme einen angemessenen Sicherheitsstan<br>dard aufweisen. |                                                |  |

### **Tabelle 8–28 Schutz des Gesamtsystems durch Sicherung der Datenintegrität bei der Datenübertragung**

| MS8 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                | Adressierte Gefährdungen |
|-----|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|     | Sicherung der Datenintegrität bei der Speiche<br>rung von Daten                                                                                                                                              | GS3, GS7                 |
| 1   | Daten werden gemäß MS6 zugriffsgeschützt in einem gesicherten Umfeld ge                                                                                                                                      |                          |
| 2   | speichert.                                                                                                                                                                                                   |                          |
| 3   | Checksummen:<br>•<br>Zum Schutz gegen technisch bedingte Integritätsfehler wird eine Check<br>summe (CRC, Hamming Codes, ) verwendet, die auch vom jeweiligen Be<br>triebssystem bereitgestellt werden kann. |                          |
|     | •<br>Sofern Implementierungen des NFC-basierten eTicketing auf existierenden                                                                                                                                 |                          |

<span id="page-81-0"></span>

| MS8 | Kurzbezeichnung der Maßnahmen                                                                                                                                    | Adressierte Gefährdungen |
|-----|------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|     | Sicherung der Datenintegrität bei der Speiche<br>rung von Daten                                                                                                  | GS3, GS7                 |
|     | Systemen aufsetzen und deren Dateninhalt verwenden, ist es ausreichend<br>nachzuweisen, dass diese Systeme einen angemessenen Sicherheitsstan<br>dard aufweisen. |                          |

#### **Tabelle 8–29 Schutz des Gesamtsystems durch Sicherung der Datenintegrität bei der Datenspeicherung**

| MS9           | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                         | Adressierte Gefährdungen |
|---------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|               | Sicherung der Systemfunktionen gegen DoS<br>Angriffe an den Schnittstellen                                                                                                                                                                                                                                                                                                                            | GS4                      |
| Allge<br>mein | Das System kann durch bauliche, technische und organisatorische Maßnahmen<br>gegen DoS-Angriffe an den Systemschnittstellen bzw. den Übertragungswegen<br>gesichert werden. Je nach Sicherheitsstufe können hier verschiedene Maßnah<br>men Anwendung finden.                                                                                                                                         |                          |
| 1             | Einfache bauliche, technische und organisatorische Maßnahmen:<br>•<br>Bauliche Maßnahmen: Schutz der Übertragungswege gegen mutwillige<br>Zerstörung, z. B. durch Verwendung zerstörungsresistenter Materialien<br>oder Abschirmung der Datenleitungen. Schaffung gesicherter Bereiche,<br>•<br>Organisatorische Maßnahmen: Einfache Zutrittskontrolle zu gesicherten<br>Bereichen (Lichtbildausweis) |                          |
| 2             | Erweiterte bauliche, technische und organisatorische Maßnahmen:<br>•<br>Zusätzliche organisatorische Maßnahmen, wie z. B. Einführung eines Rol<br>lenmodells mit einhergehendem Berechtigungskonzept. Aufwändigere me<br>chanische Absicherung.                                                                                                                                                       |                          |
| 3             | Sicherheitskonzeption<br>Siehe 1, außerdem:<br>•<br>Umsetzung baulicher und technischer Maßnahmen gemäß Sicherheitskon<br>zeption.<br>Technische Maßnahmen: Technische Sicherung der Zutrittskontrolle                                                                                                                                                                                                |                          |

### **Tabelle 8–30 Schutz des Gesamtsystems durch Sicherung der Systemfunktionen gegen DoS-Angriffe**

| MS10 | Kurzbezeichnung der Maßnahmen                                                                                                                                        | Adressierte Gefährdungen |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|      | Sicherung der Funktion des Systems gegen<br>Fehlbedienung durch Mitarbeiter und Nutzer                                                                               | GS4                      |
| 1    | Tests, Personal und Benutzerführung:                                                                                                                                 |                          |
| 2    | •<br>Definition von Anforderungen an die Benutzerführung, Überprüfung der<br>Komponenten<br>anhand<br>der<br>Anforderungen<br>Empirische<br>Tests<br>Einsatz<br>fach |                          |

<span id="page-82-0"></span>

|      | Kurzbezeichnung der Maßnahmen                                                          | Adressierte Gefährdungen |
|------|----------------------------------------------------------------------------------------|--------------------------|
| MS10 | Sicherung der Funktion des Systems gegen<br>Fehlbedienung durch Mitarbeiter und Nutzer | GS4                      |
| 3    |                                                                                        |                          |

#### **Tabelle 8–31 Schutz des Gesamtsystems durch Sicherung der Funktion des Systems gegen Fehlbedienung**

|      | Kurzbezeichnung der Maßnahmen                                                                                                     | Adressierte Gefährdungen |
|------|-----------------------------------------------------------------------------------------------------------------------------------|--------------------------|
| MS11 | Sicherung der Funktion des Systems zur Ver<br>meidung technischer Fehler von Komponen<br>ten und Übertragungswegen                | GS4, GS5                 |
|      | Herstellererklärung:                                                                                                              |                          |
| 1    | •<br>Gewährleistung der Funktionssicherheit entsprechend der Spezifikation<br>durch interne Qualitätssicherung beim Hersteller.   |                          |
|      | Prüfen nach Prüfspezifikation:                                                                                                    |                          |
| 2    | •<br>Ausarbeitung von Prüfspezifikationen für die einzelnen Systemkomponen<br>ten.                                                |                          |
|      | •<br>Technische Überprüfung der Komponenten nach den jeweiligen Prüfvor<br>schriften.                                             |                          |
|      | •<br>Spezifikation und Durchführung von Integrationstests in Test- und Wirkum<br>gebungen.                                        |                          |
|      | Evaluierung von Komponenten:                                                                                                      |                          |
| 3    | Siehe 2, außerdem:                                                                                                                |                          |
|      | •<br>Die Überprüfung relevanter Systemkomponenten (zumindest Lesegerät und<br>Trägermedien) erfolgt durch unabhängige Prüflabore. |                          |
|      | •<br>Es erfolgt eine Zertifizierung der relevanten Systemkomponenten durch ein<br>unabhängiges Institut.                          |                          |
|      | •<br>Etablierung eines Freigabeprozesses für die Systemkomponenten                                                                |                          |

#### **Tabelle 8–32 Schutz des Gesamtsystems durch Sicherung der Funktion des Systems gegen technische Fehler**

|               | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Adressierte Gefährdungen |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
| MS12          | Spezifikation Systemkonzept und Anforderun<br>gen an die Komponenten                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | GS5                      |
|               | Die Eigenschaften eines Systems bezüglich der wesentlichen Betriebsprozesse<br>sind zu spezifizieren und sicherzustellen. Dabei ist zu beachten, dass oftmals<br>existierende Komponenten integriert werden müssen. Nichtsdestoweniger müs<br>sen die wesentlichen Parameter und Eigenschaften des Gesamtsystems spezi<br>fiziert und erreicht werden. Dies gilt insbesondere für die Performanz oder die<br>Verfügbarkeit gewisser Prozesse. Um eine diesbezügliche Integration in das<br>Gesamtsystem zu ermöglichen, müssen die Anforderungen in Bezug auf die<br>Interaktion mit dem Gesamtsystem für jede Systemkomponente spezifiziert sein<br>und eingehalten werden.<br>Ein besonderer Schwerpunkt soll auf das Einbringen neuer Anwendungen und |                          |
| Allge<br>mein |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                          |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                          |

<span id="page-83-0"></span>

|      | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                    | Adressierte Gefährdungen |
|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
| MS12 | Spezifikation Systemkonzept und Anforderun<br>gen an die Komponenten                                                                                                                                                             | GS5                      |
|      | Produkte gelegt werden.                                                                                                                                                                                                          |                          |
| 1    | Herstellererklärung:                                                                                                                                                                                                             |                          |
|      | •<br>Die Einhaltung der Spezifikation wird vom Hersteller zugesichert.                                                                                                                                                           |                          |
|      | Integrationstest sowie Konformitätserklärung:                                                                                                                                                                                    |                          |
| 2    | •<br>Ausarbeitung von Integrationstests (vgl. MS11) sowie deren Durchführung<br>•<br>Etablierung eines Freigabeprozesses<br>•<br>Die Konformität ist anhand von Integrationstests nachzuweisen.                                  |                          |
|      | Interfunktionsfähigkeitstests nach Testkonzeption, Evaluierung:                                                                                                                                                                  |                          |
| 3    | •<br>Ausarbeitung von Integrationstests (vgl. MS11) sowie deren Durchführung<br>•<br>Etablierung eines Freigabeprozesses<br>•<br>Evaluierung der Komponenten durch unabhängige Prüflabore<br>•<br>Zertifizierung der Komponenten |                          |

#### **Tabelle 8–33 Schutz des Gesamtsystems durch Spezifikation des Systems und der Komponenten**

| MS13          | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                    | Adressierte Gefährdungen |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|               | Ergonomische Benutzerführung                                                                                                                                                                                                                                                                                                                     | GS4, GR4, GNMD3          |
| Allge<br>mein | Das Design aller Hardwarekomponenten hat ergonomischen Gesichtspunkten<br>zu genügen. Zu den ergonomischen Anforderungen gehören neben Forderun<br>gen an die Optik (Wiedererkennbarkeit, Farbe der Tastatur, Lesbarkeit von Dis<br>plays, ) auch Forderungen an die Bedienbarkeit (auch für Schwerbehinderte)<br>und die Verletzungssicherheit. |                          |
| 1             | Herstellererklärung:<br>•<br>Hersteller erklärt, dass ergonomische Prinzipien angewendet wurden.<br>•<br>Abbildung der relevanten Anwendungsfälle der generischen Betriebspro<br>zesse (z. B. Verkauf, Check-in, etc) bei der Nutzerführung für Kunden und<br>Personal durch den Hersteller                                                      |                          |
| 2             | Praxistest:<br>•<br>Hersteller erklärt, dass ergonomische Prinzipien angewendet wurden.<br>•<br>Überprüfung der Akzeptanz der Nutzer in einem Praxistest                                                                                                                                                                                         |                          |

<span id="page-84-0"></span>

| MS13 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                              | Adressierte Gefährdungen |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|      | Ergonomische Benutzerführung                                                                                                                                                                                                               | GS4, GR4, GNMD3          |
|      | Spezifikation, Umsetzung und Test eines Gesamtkonzepts zur Ergonomie und<br>Nutzerführung:                                                                                                                                                 |                          |
| 3    | •<br>Es sind systemweite Festlegungen bzgl. Ergonomie und Benutzerführung<br>zu treffen. Diese sollen gewährleisten, dass alle Komponenten innerhalb<br>des Systems denselben Standards genügen. Eine sukzessive Umsetzung<br>ist möglich. |                          |
|      | •<br>Umsetzung einheitlicher Benutzerführungen pro Anwendung                                                                                                                                                                               |                          |
|      | •<br>Praxistest zur Prüfung der Nutzerakzeptanz                                                                                                                                                                                            |                          |
|      | •<br>Freigabeprozedur zur Gesamt- und Komponentenspezifikation                                                                                                                                                                             |                          |

**Tabelle 8–34 Schutz des Gesamtsystems durch ergonomische Benutzerführung** 

| MS14 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                   | Adressierte Gefährdungen |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|      | Support                                                                                                                                                                                                                                                                                                         | GS4, GS5                 |
| 1    | Herstellersupport:<br>•<br>Der Hersteller der Systemkomponente hat Maßnahmen zu ergreifen, die<br>Dienstleister im Betrieb zu unterstützen (z. B. Helpdesk, 1st, 2nd, 3rd-Level<br>Support, …). Der Support unterliegt bilateralen vertraglichen Regelungen<br>(SLAs) zwischen Hersteller und Dienstleister.    |                          |
| 2    | Entitätsweiter Support:<br>•<br>Festlegungen eines Supportkonzepts, für das System einer Entität (z. B.<br>Dienstleiter, Produktanbieter)                                                                                                                                                                       |                          |
| 3    | Systemweiter Support:<br>•<br>Festlegungen eines übergreifenden Supportkonzepts, das jeweils die Sys<br>teme der einzelnen Entitäten abdeckt (siehe 2) und zusätzlich definierte<br>Schnittstellen zu den anderen Entitäten ausweist. Ziel ist es, systemweite<br>Probleme in definierter Zeit lösen zu können. |                          |

| Tabelle 8–35 |  | Schutz des Gesamtsystems durch Support |  |
|--------------|--|----------------------------------------|--|
|--------------|--|----------------------------------------|--|

| MS15 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                        | Adressierte Gefährdungen |  |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|      | Trennung von Applikationen                                                                                                                                                                                                                                                           | GS2, GS3, GS6, GS7, GS8  |  |
| 1    | Getrennte Speicherung und Verarbeitung von Daten:                                                                                                                                                                                                                                    |                          |  |
| 2    | •<br>Um Fehlfunktionen und den Missbrauch von Schlüsselmaterial und Daten<br>zu vermeiden, sind die Applikationen in allen Komponenten des Systems<br>voneinander zu trennen. Chipbasierte Komponenten (NFC-Mobiltelefon,<br>Trägermedien, SAM) werden an anderer Stelle betrachtet. |                          |  |
| 3    |                                                                                                                                                                                                                                                                                      |                          |  |

**Tabelle 8–36 Schutz des Gesamtsystems durch Trennung von Applikationen** 

<span id="page-85-0"></span>

| MS16          | Kurzbezeichnung der Maßnahmen                                                                                                                                 | Adressierte Gefährdungen |  |  |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|--|
|               | Identifikation des Kunden bei Verkauf und<br>Produktübergabe                                                                                                  | GS9                      |  |  |
| Allge<br>mein | Beim Anlegen eines Kundenkontos, der Bestellung und Abholen personalisierter<br>Produkte und bei deren Sperrung muss die Identität des Kunden geklärt sein.   |                          |  |  |
|               | Erklärung des Kunden:                                                                                                                                         |                          |  |  |
| 1             | •<br>Der Kunde übergibt die Angaben zu seiner Identität mündlich oder per In<br>ternet                                                                        |                          |  |  |
|               | Antragsformular, Kundenkarten:                                                                                                                                |                          |  |  |
|               | •<br>Der Kunde erklärt sich schriftlich und bestätigt die Richtigkeit durch Unter<br>schrift. Der Produktanbieter überprüft die Angaben mit normalen Mitteln: |                          |  |  |
| 2             | •<br>Adressüberprüfung                                                                                                                                        |                          |  |  |
|               | •<br>Versendung des Kundenmediums an die angegebene Anschrift                                                                                                 |                          |  |  |
|               | •<br>Die Identitätsdaten werden aus einem existierenden sicheren Kundenmedi<br>um ins System übernommen (Internet, Automat)                                   |                          |  |  |
|               | Ausweiskontrolle beim Anlegen eines Kundenkontos und Übergabe der Berech<br>tigung:                                                                           |                          |  |  |
| 3             | •<br>Es wird ein sicherer Identitätsnachweis mit Lichtbild vorgelegt                                                                                          |                          |  |  |
|               | •<br>Die Identitätsdaten werden aus einem sicheren elektronischen Identitäts<br>nachweis (eID) ins System übernommen.                                         |                          |  |  |

| Tabelle 8–37<br>Schutz des Gesamtsystems durch Identifikation des Kunden |
|--------------------------------------------------------------------------|
|--------------------------------------------------------------------------|

| MS17          | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                         | Adressierte Gefährdungen |  |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|               | Umsetzung des Gebots zur Datensparsamkeit                                                                                                                                                                                                                                                                                             | GS10                     |  |
| Allge<br>mein | Umsetzung des Gebots zur Datensparsamkeit gemäß der jeweils gültigen ge<br>setzlichen Grundlagen zum Datenschutz.                                                                                                                                                                                                                     |                          |  |
| 1             | Umsetzung der gesetzlichen Anforderungen:                                                                                                                                                                                                                                                                                             |                          |  |
| 2             | •<br>Bei der Definition der Prozesse und Systeme des Gesamtsystems wird das<br>Prinzip der Datensparsamkeit entsprechend der gesetzlichen Grundlagen<br>umgesetzt.                                                                                                                                                                    |                          |  |
|               | Besondere Maßnahmen                                                                                                                                                                                                                                                                                                                   |                          |  |
|               | Zusätzlich zu den in MS17.2 genannten, werden folgende Maßnahmen ergrif<br>fen:                                                                                                                                                                                                                                                       |                          |  |
| 3             | •<br>Exakte zweckbezogene Definition der Dateninhalte, der Gewinnung und<br>Speicherung der Daten und der Zugriffs- und Verwendungsberechtigungen<br>unter Verwendung des Rollenmodells des Gesamtsystems<br>•<br>Unterrichtung des Kunden über die zweckbezogene Gewinnung, Speiche<br>rung und Nutzung von personenbezogenen Daten. |                          |  |

# **Tabelle 8–38 Schutz des Gesamtsystems durch Umsetzung des Gebots der Datensparsamkeit**

# <span id="page-86-1"></span><span id="page-86-0"></span>**8.4.3 Maßnahmen in Bezug auf das Trägermedium (NFC-Mobiltelefon im passiven Modus)**

| MT1 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                  | Adressierte Gefährdungen                                                         |  |  |
|-----|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|--|--|
|     | Hard- und Software-Zugriffsschutz (Lese- und<br>Schreibzugriff)                                                                                                                                                                                                                                                                                                                | GT1, GT2, GT3, GT4, GT5,<br>GT6, GT7, GT8, GT10, GTR1,<br>GTR2, GTR3, GTR4, GTR6 |  |  |
|     | Schreibschutz:                                                                                                                                                                                                                                                                                                                                                                 |                                                                                  |  |  |
| 1   | •<br>Die Berechtigungsdaten und die Entwertungsdaten werden nach dem Ein<br>bringen in die jeweiligen Speicherbereiche irreversibel gegen Überschrei<br>ben geschützt. Ein Leseschutz besteht nicht.                                                                                                                                                                           |                                                                                  |  |  |
|     | Einfacher Zugriffsschutz:                                                                                                                                                                                                                                                                                                                                                      |                                                                                  |  |  |
|     | •<br>Alternativ oder zusätzlich wird ein einfacher Zugriffsschutz eingesetzt. Der<br>Zugriffsschutz wird über einen Passwortschutz oder einen Authentifikati<br>onsmechanismen realisiert.                                                                                                                                                                                     |                                                                                  |  |  |
| 2   | Spezifischer Zugriffsschutz:                                                                                                                                                                                                                                                                                                                                                   |                                                                                  |  |  |
|     | •<br>Durchführung einer gegenseitigen Authentifikation mit dem Lesegerät auf<br>Basis von Zufallszahlen und im Trägermedium gespeicherten geheimen<br>Schlüsseln vor jedem Zugriff.                                                                                                                                                                                            |                                                                                  |  |  |
|     | •<br>Einführung von anwendungs- und berechtigungsspezifischen Zugriffsrech<br>ten und Schlüsseln                                                                                                                                                                                                                                                                               |                                                                                  |  |  |
|     | •<br>Verwendung von diversifizierten Schlüsseln                                                                                                                                                                                                                                                                                                                                |                                                                                  |  |  |
|     | •<br>Als Verfahren zur Authentifikation kommen TDES, AES128 oder vergleich<br>bare offene Verfahren in Frage. Die Art und Stärke des Mechanismus ist an<br>künftige Entwicklungen entsprechend [ALGK_BSI] anzupassen.                                                                                                                                                          |                                                                                  |  |  |
|     | Erweiterter Zugriffsschutz:                                                                                                                                                                                                                                                                                                                                                    |                                                                                  |  |  |
|     | •<br>Durchführung einer gegenseitigen Authentifikation mit dem Lesegerät auf<br>Basis von Zufallszahlen und im Trägermedium gespeicherten geheimen<br>Schlüsseln vor jedem Zugriff.                                                                                                                                                                                            |                                                                                  |  |  |
|     | •<br>Einführung von anwendungs- und berechtigungsspezifischen, hierarchi<br>schen Zugriffsrechten und Schlüsseln                                                                                                                                                                                                                                                               |                                                                                  |  |  |
|     | •<br>Verwendung von diversifizierten Schlüsseln                                                                                                                                                                                                                                                                                                                                |                                                                                  |  |  |
| 3   | Als Authentifikationmechanismen kommen standardisierte symmetrische Ver<br>fahren (TDES, AES128 oder vergleichbare offene Verfahren) oder asymmetri<br>sche Verfahren (RSA, ECC) in Betracht. Für RSA und ECC gelten die jeweils<br>aktuellen Vorgaben des [ALGK_BSI]. Die Art und Stärke des Mechanismus ist<br>an künftige Entwicklungen entsprechend [ALGK_BSI] anzupassen. |                                                                                  |  |  |
|     | •<br>Schutzmechanismen gegen Hardware-Attacken sind gefordert.<br>•<br>Der Chip wird nach CC [HW_PP1] oder [HW_PP2] oder vergleichbaren CC<br>Schutzprofilen zertifiziert                                                                                                                                                                                                      |                                                                                  |  |  |

**Tabelle 8–39 Schutz des Transponders durch Zugriffsschutz für den EPC** 

<span id="page-87-0"></span>

| MT2 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                      | Adressierte Gefährdungen |
|-----|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|     | Schutz vor Klonen des Trägermediums inkl.<br>Dateninhalt                                                                                                                                                                                                           | GT3, GTR3, GTR6          |
|     | Einfacher Schutz vor dem Klonen des Trägermediums:                                                                                                                                                                                                                 |                          |
| 1   | •<br>Implementierung des Zugriffsschutzes nach MT1.1 zur Verhinderung des<br>Auslesens des Dateninhalts.                                                                                                                                                           |                          |
|     | •<br>Sofern vorhanden, Nutzung der UID, eine weltweit eindeutige, unveränder<br>bare Kennung des Chips zur Verhinderung von Duplikaten des Trägerme<br>diums und der Berechtigung durch Integration der UID in die kryptografi<br>sche Sicherung der Berechtigung. |                          |
|     | •<br>Optionale Einführung einer Authentisierung auf Basis eines nicht auslesba<br>ren geheimen Schlüssels.                                                                                                                                                         |                          |
|     | •<br>Verwendung einfacher optischer Sicherheitsmerkmale                                                                                                                                                                                                            |                          |
|     | •<br>Einführung eines Zero-Balance – Verfahrens bei der Verwaltung von unper<br>sonalisierten Trägermedien.                                                                                                                                                        |                          |
|     | Schutz vor dem Klonen des Trägermediums und des Dateninhalts:                                                                                                                                                                                                      |                          |
| 2   | •<br>Implementierung des Zugriffsschutzes nach MT1.2 zur Verhinderung des<br>Auslesens des Dateninhalts.                                                                                                                                                           |                          |
|     | •<br>Nutzung der UID, eine weltweit eindeutige, unveränderbare Kennung des<br>Chips zur Verhinderung von Duplikaten des Trägermediums, der Anwen<br>dungen und der Berechtigungen durch Integration der UID in das Konzept<br>zur Zugriffssicherung.               |                          |
|     | •<br>Verwendung optischer Sicherheitsmerkmale                                                                                                                                                                                                                      |                          |
|     | •<br>Die Einführung einer Authentisierung auf Basis eines nicht auslesbaren,<br>geheimen Schlüssels gewährleistet einen Kopierschutz.                                                                                                                              |                          |
|     | •<br>Einführung eines Zero-Balance – Verfahrens bei der Verwaltung von unper<br>sonalisierten Trägermedien.                                                                                                                                                        |                          |
|     | Erweiterter Schutz vor dem Klonen des Trägermediums:                                                                                                                                                                                                               |                          |
| 3   | •<br>Implementierung des Zugriffsschutzes nach MT1.3 zur Verhinderung des<br>Auslesens des Dateninhalts.                                                                                                                                                           |                          |
|     | •<br>Nutzung der UID, eine weltweit eindeutige, unveränderbare Kennung des<br>Chips zur Verhinderung von Duplikaten des Trägermediums, der Anwen<br>dungen und der Berechtigungen durch Integration der UID in das Konzept<br>zur Zugriffssicherung.               |                          |
|     | •<br>Verwendung optischer Sicherheitsmerkmale                                                                                                                                                                                                                      |                          |
|     | •<br>Einführung eines Zero-Balance – Verfahrens bei der Verwaltung von unper<br>sonalisierten, bedruckten Trägermedien                                                                                                                                             |                          |

#### **Tabelle 8–40 Schutz des Transponders vor Klonen**

| MT3           | Kurzbezeichnung der Maßnahmen                                                                                                                                                    | Adressierte Gefährdungen |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|               | Schutz vor Emulation                                                                                                                                                             | GT4, GTR4, GTR6          |
| Allge<br>mein | Die Funktionalität des Trägermediums und dessen Dateninhalt kann theoretisch<br>von programmierbaren Geräten (z. B. PDA) mit kontaktloser Schnittstelle nach<br>gebildet werden. |                          |

<span id="page-88-0"></span>

| MT3 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                    | Adressierte Gefährdungen |  |
|-----|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|     | Schutz vor Emulation                                                                                                                                                                                                                                             | GT4, GTR4, GTR6          |  |
|     | Voraussetzung für die Emulation ist die Auslesbarkeit des kompletten Datenin<br>halts und der vollen Funktion des Trägermediums inklusive der UID.                                                                                                               |                          |  |
|     | Eine Emulation einfacher Speicherchips durch programmierbare kontaktlose<br>Chips mit COS ist mit handelsüblichen Controllerchips nicht möglich, da die UID<br>nicht programmiert werden kann. Mit speziell entwickelter Hardware ist eine<br>Emulation denkbar. |                          |  |
|     | Einfacher Emulationsschutz:                                                                                                                                                                                                                                      |                          |  |
|     | •<br>Passwortschutz zur Verhinderung des Auslesens der Daten oder                                                                                                                                                                                                |                          |  |
| 1   | •<br>Einführung einer Authentifikation auf Basis eines nicht auslesbaren gehei<br>men Schlüssels zur Verhinderung der Emulation -> Authentifikation schlägt<br>bei Emulation aufgrund des Fehlens des geheimen Schlüssels fehl.                                  |                          |  |
|     | •<br>Verhinderung von Transfers der Anwendungen und der Berechtigungen auf<br>eine programmierbare Chipkarte durch Integration der UID in das Konzept<br>zur Zugriffssicherung.                                                                                  |                          |  |
|     | •<br>Operative Maßnahmen zur Kontrolle des Trägermediums: z. B. Kontrolle<br>durch Personal, Nutzung des Trägermediums im Sichtbereich des Fahrers.<br>Wirkt nicht bei Nutzung z. B. von NFC-Mobiltelefonen als legales Träger<br>medium.                        |                          |  |
|     | Emulationsschutz:                                                                                                                                                                                                                                                |                          |  |
|     | •<br>Implementierung des Zugriffsschutzes nach MT1.2 zur Verhinderung des<br>Auslesens des Dateninhalts.                                                                                                                                                         |                          |  |
|     | •<br>Nutzung von geheimen, nicht auslesbaren Schlüsseln zur Authentifikation.                                                                                                                                                                                    |                          |  |
| 2   | •<br>Verhinderung von Transfers der Anwendungen und der Berechtigungen auf<br>eine programmierbare Chipkarte durch Integration der UID in das Konzept<br>zur Zugriffssicherung.                                                                                  |                          |  |
|     | •<br>Monitoring der Trägermedien im Systembetrieb                                                                                                                                                                                                                |                          |  |
|     | •<br>Operative Maßnahmen zur Kontrolle des Trägermediums: z. B. Kontrolle<br>durch Personal, Nutzung des Trägermediums im Sichtbereich des Fahrers.<br>Wirkt nicht bei Nutzung z. B. von NFC-Mobiltelefonen als legales Träger<br>medium.                        |                          |  |
|     | Erweiterter Emulationsschutz:                                                                                                                                                                                                                                    |                          |  |
|     | •<br>Implementierung des Zugriffsschutzes nach MT1.3 zur Verhinderung des<br>Auslesens des Dateninhalts.                                                                                                                                                         |                          |  |
|     | •<br>Nutzung von geheimen, nicht auslesbaren Schlüsseln zur Authentifikation.                                                                                                                                                                                    |                          |  |
| 3   | •<br>Verhinderung von Transfers der Anwendungen und der Berechtigungen auf<br>eine programmierbare Chipkarte durch Integration der UID in das Konzept<br>zur Zugriffssicherung.                                                                                  |                          |  |
|     | •<br>Monitoring der Trägermedien im Systembetrieb                                                                                                                                                                                                                |                          |  |
|     | •<br>Operative Maßnahmen zur Kontrolle des Trägermediums: z. B. Kontrolle<br>durch Personal, Nutzung des Trägermediums im Sichtbereich des Fahrers.<br>Wirkt nicht bei Nutzung z. B. von NFC-Mobiltelefonen als legales Träger<br>medium.                        |                          |  |

**Tabelle 8–41 Schutz des Transponders vor Emulation** 

<span id="page-89-0"></span>

| MT4           | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                           | Adressierte Gefährdungen |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|               | Schutz der personenbezogenen Daten gegen<br>Auslesen und Schreiben/Manipulation                                                                                                                                                                                                                                                                         | GT5, GT6                 |
|               | Personenbezogene Daten sind:                                                                                                                                                                                                                                                                                                                            |                          |
|               | •<br>Informationen zur Person,                                                                                                                                                                                                                                                                                                                          |                          |
| Allge<br>mein | •<br>Abrechnungsdaten (z. B. Bewegungsdaten)                                                                                                                                                                                                                                                                                                            |                          |
|               | •<br>andere personenbezogene Nutzungsdaten, die mit Hilfe der Berechtigung<br>erzeugt und ggf. auf dem Trägermedium in der Anwendung abgelegt wer<br>den.                                                                                                                                                                                               |                          |
|               | Schutz personenbezogener Daten:                                                                                                                                                                                                                                                                                                                         |                          |
|               | •<br>Schreibschutz oder Zugriffschutz entsprechend MT1.1                                                                                                                                                                                                                                                                                                |                          |
| 1             | •<br>Wenn seitens des Chips nur Schreibschutz bestehen sollte, muss als Me<br>chanismus für den Schutz der Informationen zur Person nach heutigem<br>Stand TDES, AES128 oder ein offenes Verfahren vergleichbarer Stärke an<br>gewandt werden. Die Art und Stärke des Mechanismus ist an künftige Ent<br>wicklungen entsprechend [ALGK_BSI] anzupassen. |                          |
|               | •<br>Daten werden entsprechend MS2.1 verschlüsselt übertragen und im Chip<br>abgelegt. Personenbezogene Daten und Berechtigungen werden mit ver<br>schiedenen Schlüsseln geschützt.                                                                                                                                                                     |                          |
|               | •<br>Diversifikation von Schlüsseln                                                                                                                                                                                                                                                                                                                     |                          |
|               | Spezifischer Zugriffschutz auf personenbezogene Daten:                                                                                                                                                                                                                                                                                                  |                          |
|               | •<br>Zugriffschutz entsprechend MT1.2                                                                                                                                                                                                                                                                                                                   |                          |
| 2             | •<br>Daten werden entsprechend MS2.2 gesichert übertragen und anwendungs<br>spezifisch im Chip abgelegt. Personenbezogene Daten und Berechtigungen<br>werden mit verschiedenen Schlüsseln geschützt.                                                                                                                                                    |                          |
|               | •<br>Ggf. werden die Daten systemseitig gegen Manipulation gesichert (z. B.<br>durch MAC)                                                                                                                                                                                                                                                               |                          |
|               | •<br>Diversifikation von Schlüsseln                                                                                                                                                                                                                                                                                                                     |                          |
|               | Erweiterter Zugriffschutz auf personenbezogene Daten, Interfunktionsfähigkeit:                                                                                                                                                                                                                                                                          |                          |
|               | •<br>Zugriffschutz entsprechend MT1.3                                                                                                                                                                                                                                                                                                                   |                          |
| 3             | •<br>Daten werden entsprechend MS2.3 gesichert übertragen und anwendungs<br>spezifisch im Chip abgelegt. Personenbezogene Daten und Berechtigungen<br>werden mit verschiedenen Schlüsseln geschützt.                                                                                                                                                    |                          |
|               | •<br>Ggf. werden die Daten systemseitig gegen Manipulation gesichert (z. B.<br>durch MAC, Signaturen). Dies gilt insbesondere für Abrechnungsdaten,<br>wenn Interfunktionsfähigkeit gefordert ist.                                                                                                                                                      |                          |
|               | •<br>Diversifikation von Schlüsseln                                                                                                                                                                                                                                                                                                                     |                          |

**Tabelle 8–42 Schutz von personenbezogenen Daten im Transponder** 

| MT5    | Kurzbezeichnung der Maßnahmen                                             | Adressierte Gefährdungen |
|--------|---------------------------------------------------------------------------|--------------------------|
|        | Schutz der Abrechnungsdaten gegen Ausle<br>sen und Schreiben/Manipulation | GT7, GT8                 |
| Allge- | Abrechnungsdaten werden aus den personenbezogenen Nutzungsdaten gene      |                          |

<span id="page-90-0"></span>

| MT5  | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                      | Adressierte Gefährdungen |  |
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|      | Schutz der Abrechnungsdaten gegen Ausle<br>sen und Schreiben/Manipulation                                                                                                                                                                                                          | GT7, GT8                 |  |
| mein | riert und dienen zur Abrechnung der Vergütung für die Leistung des<br>Dienstleisters. Bei Produkten mit automatischer Fahrpreisberechnung dienen<br>die Abrechnungsdaten auch zur Erstellung der Rechnung des Kunden.                                                              |                          |  |
|      | Bei einfacheren Produkten kann die im Trägermedium zur Berechtigung gespei<br>cherte Entwertungsinformation auch als Abrechnungsdatum angesehen werden.                                                                                                                            |                          |  |
|      | Abrechnungsdaten werden beim Zutritt oder beim An- oder Abmelden im Trä<br>germedium und im Terminal abgelegt.<br>Sofern Interfunktionsfähigkeit gefordert ist, müssen Abrechnungsdaten auch<br>gegen interne Angriffe geschützt werden.                                           |                          |  |
|      |                                                                                                                                                                                                                                                                                    |                          |  |
|      | Schutz von Abrechnungsdaten:                                                                                                                                                                                                                                                       |                          |  |
| 1    | •<br>Schreibschutz oder Zugriffschutz entsprechend MT1.1<br>•<br>Daten werden entsprechend MS2.1 verschlüsselt übertragen und im Chip<br>abgelegt. Abrechnungsdaten und Berechtigungen werden mit verschiede<br>nen Schlüsseln geschützt.<br>•<br>Diversifikation von Schlüsseln   |                          |  |
|      |                                                                                                                                                                                                                                                                                    |                          |  |
|      | Spezifischer Zugriffs- und Manipulationsschutz:<br>•<br>Zugriffschutz entsprechend MT1.2                                                                                                                                                                                           |                          |  |
| 2    | •<br>Daten werden entsprechend MS2.2 gesichert übertragen und anwendungs<br>spezifisch im Chip abgelegt. Abrechnungsdaten und Berechtigungen wer<br>den mit verschiedenen Schlüsseln geschützt.                                                                                    |                          |  |
|      | •<br>Ggf. werden die Abrechnungsdaten systemseitig gegen Manipulation gesi<br>chert (z. B. durch MAC)                                                                                                                                                                              |                          |  |
|      | •<br>Diversifikation von Schlüsseln                                                                                                                                                                                                                                                |                          |  |
|      | Zugriffs- und Manipulationsschutz bei Interfunktionsfähigkeit:                                                                                                                                                                                                                     |                          |  |
| 3    | •<br>Zugriffschutz entsprechend MT1.3                                                                                                                                                                                                                                              |                          |  |
|      | •<br>Daten werden entsprechend MS2.3 gesichert übertragen und anwendungs<br>spezifisch im Chip abgelegt. Die verschiedenen Abrechnungsdaten werden<br>nach festgelegtem Rollenmodell mit definierten Zugriffsrechten und spezifi<br>schen, unterschiedlichen Schlüsseln geschützt. |                          |  |
|      | •<br>Sofern Interfunktionsfähigkeit im System gefordert ist, werden die Abrech<br>nungsdaten systemseitig gegen Manipulation gesichert (z. B. durch MAC,<br>Signaturen).                                                                                                           |                          |  |
|      | •<br>Diversifikation von Schlüsseln                                                                                                                                                                                                                                                |                          |  |

| Tabelle 8–43 | Schutz von Abrechnungsdaten im Transponder |
|--------------|--------------------------------------------|
|--------------|--------------------------------------------|

| MT6 | Kurzbezeichnung der Maßnahmen                                | Adressierte Gefährdungen |
|-----|--------------------------------------------------------------|--------------------------|
|     | Trennung von Anwendungen                                     | GT6, GT9                 |
| 1   | Es wird keine besondere Trennung von Anwendungen unterstützt |                          |
| 2   | Trennung von Anwendungen:                                    |                          |

<span id="page-91-0"></span>

| MT6 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                               | Adressierte Gefährdungen |
|-----|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|     | Trennung von Anwendungen                                                                                                                                                                                                                                                                                                                                                    | GT6, GT9                 |
|     | •<br>Aufbringen von Anwendungen in sicherer Umgebung.<br>•<br>Implementierung eines anwendungsspezifischen Zugriffskonzepts entspre<br>chend MT1.2. Schlüssel- und Rechtevergabe entsprechend des Rollenmo<br>dels der Entitäten des Gesamtsystems.<br>•<br>Diversifikation von Schlüsseln                                                                                  |                          |
| 3   | Sichere Trennung von Anwendungen:<br>•<br>Implementierung eines anwendungsspezifischen Zugriffskonzepts entspre<br>chend MT1.3. Schlüssel- und Rechtevergabe entsprechend des Rollenmo<br>dels der Entitäten des Gesamtsystems.<br>•<br>Anwendung der Maßnahme MT10a.3 sowie ggf. MT10b.3 zum sicheren<br>Nachladen von Anwendungen.<br>•<br>Diversifikation von Schlüsseln |                          |

| Tabelle 8–44 | Schutz durch Trennung von Anwendungen im Transponder |
|--------------|------------------------------------------------------|
|--------------|------------------------------------------------------|

| MT7           | Kurzbezeichnung der Maßnahmen                                                                                                                                                       | Adressierte Gefährdungen |  |
|---------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|               | Spezifikation der Eigenschaften des Träger<br>mediums.                                                                                                                              | GT10, GTR7               |  |
| Allge<br>mein | Die Eigenschaften des Trägermediums bezüglich der zu unterstützenden An<br>wendungen und Betriebsprozesse sind zu spezifizieren und sicherzustellen.<br>Dies gilt insbesondere für: |                          |  |
|               | •<br>Performanz                                                                                                                                                                     |                          |  |
|               | •<br>Haltbarkeit bei mechanischer Belastung                                                                                                                                         |                          |  |
|               | •<br>Schutz gegen DoS-Angriffe                                                                                                                                                      |                          |  |
|               | Herstellererklärung:                                                                                                                                                                |                          |  |
| 1             | •<br>Die Einhaltung der Spezifikation wird vom Hersteller zugesichert.                                                                                                              |                          |  |
| 2             | Tests sowie Konformitätserklärung:                                                                                                                                                  |                          |  |
|               | •<br>Ausarbeitung von Prüfvorschriften und Durchführung der Prüfungen.                                                                                                              |                          |  |
|               | •<br>Etablierung eines Freigabeprozesses                                                                                                                                            |                          |  |
| 3             | Interfunktionsfähigkeitstests nach Testkonzeption, Evaluierung:                                                                                                                     |                          |  |
|               | •<br>Ausarbeitung von Prüfvorschriften                                                                                                                                              |                          |  |
|               | •<br>Etablierung eines Freigabeprozesses                                                                                                                                            |                          |  |
|               | •<br>Evaluierung des Trägermediums durch unabhängige Prüflabore                                                                                                                     |                          |  |
|               | •<br>Zertifizierung der Komponenten durch ein unabhängiges Institut.                                                                                                                |                          |  |

#### **Tabelle 8–45 Schutz durch Spezifikation des Trägermediums**

<span id="page-92-0"></span>

| MT8 | Kurzbezeichnung der Maßnahmen                                                                                                            | Adressierte Gefährdungen |
|-----|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|     | Einführung der Nahbereichstechnik nach<br>ISO/IEC14443                                                                                   | GT11                     |
| 1   | Einführung der Nahbereichstechnik nach ISO/IEC14443                                                                                      |                          |
| 2   |                                                                                                                                          |                          |
|     | Erhöhter Schutz:                                                                                                                         |                          |
| 3   | •<br>Verwendung einer zufälligen Kennnummer zur Antikollision (Random-UID)<br>•<br>Deaktivieren des RF-Interfaces bei NFC-Mobiltelefonen |                          |

**Tabelle 8–46 Schutz durch Einführung der Nahbereichstechnik nach ISO/IEC14443** 

| MT9           | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Adressierte Gefährdungen |
|---------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|               | Rückfalllösung bei Fehlfunktion des Träger<br>mediums                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | GT12, GTR8               |
| Allge<br>mein | Im Falle von Fehlfunktionen können elektronische Maßnahmen auf Seiten des<br>Trägermediums für den Notfall nicht greifen, da ein Auslesen der Chipdaten<br>nicht mehr gewährleistet werden kann.<br>Um die Sicherheitsziele nicht zu gefährden, ist zunächst festzustellen, ob der<br>Kunde im Besitz einer gültigen Berechtigung ist.                                                                                                                                                                                                                                                                                                                                                                                              |                          |
| 1             | Einführung von geeigneten Rückfalllösungen:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                          |
| 2             | •<br>Bei personalisierten Trägermedien: Optische Personalisierung<br>•<br>Bereitstellung eines operativen Rückfallprozesses (z. B. Regelungen zur<br>Nutzung des Dienstes, Service Desk für den Kunden)<br>•<br>Rückfalllösungen müssen in den vertraglichen Vereinbarungen zwischen<br>Kunden, Dienstleistern und Anbietern benannt und deren Folgen berück<br>sichtigt werden.<br>•<br>Hinreichende Dimensionierung der Kapazität der Rückfalllösung zur Ab<br>wehr von DoS-Angriffen über die Überlastung der Rückfalllösung<br>•<br>Speicherung der Nutzungs- und Abrechnungsdaten im System<br>•<br>Backup der im Trägermedium gespeicherten Anwendungen und Berechti<br>gungen (inkl. der personenbezogenen Daten) im System. |                          |
| 3             | Umsetzung nach Rückfallkonzept:<br>•<br>Zusätzlich zu 1, 2:<br>•<br>Es muss eine Systemkonzept erstellt werden, dass die Rückfalllösungen<br>mit Verfügbarkeitszeiten explizit festlegt.<br>•<br>Ggf. muss eine ausreichende Anzahl von Austausch-Trägermedien zur Ver<br>fügung stehen, so dass die geforderte Verfügbarkeit erfüllt werden kann.                                                                                                                                                                                                                                                                                                                                                                                  |                          |

**Tabelle 8–47 Schutz durch Rückfalllösung bei Fehlfunktion des Trägermediums** 

|       | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                         | Adressierte Gefährdungen |  |
|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
| MT10a | Nachladen von Anwendungen - Sichern der<br>Anwendungen hinsichtlich Authentizität und<br>Integrität                                                                                                                                                                                                                                   | GT9                      |  |
|       | Kein Nachlademechanismus:                                                                                                                                                                                                                                                                                                             |                          |  |
| 1     | •<br>Es wird kein Nachlademechanismus angeboten. Anwendungen werden nur<br>einzeln ausgegeben. Multiapplikationsfähigkeit ist nicht gegeben.                                                                                                                                                                                          |                          |  |
| 2     | Implementieren eines Nachlademechanismus gem. ISO 7816-13 mit SM                                                                                                                                                                                                                                                                      |                          |  |
|       | I. Vorbemerkung                                                                                                                                                                                                                                                                                                                       |                          |  |
|       | Beim Nachladen von Anwendungen sind:                                                                                                                                                                                                                                                                                                  |                          |  |
|       | •<br>Datenstrukturen für die Anwendungsdaten und Kundendaten und<br>•<br>Anwendungsschlüssel aufzubringen.                                                                                                                                                                                                                            |                          |  |
|       | Die erforderliche Trennung von Applikationen setzt Trägermedien voraus, die in<br>der Lage sind, eine solche Trennung (security boundaries) zu ermöglichen.<br>Hierzu muss das Trägermedium eine geeignete card management application<br>enthalten, die in der Lage ist, die in ISO 7816-13 definierten Kommandos zu<br>verarbeiten. |                          |  |
|       | Für ein Nachladen einer Applikation muss diese beim Anwendungsanbieter vor<br>legen. Hierzu ist diese gesichert und auf Aktualität, Integrität und Authentizität<br>geprüft zu übertragen.                                                                                                                                            |                          |  |
|       | II Ausführung des Nachladens                                                                                                                                                                                                                                                                                                          |                          |  |
| 3     | Zum Nachladen von Anwendungen werden Kommandosequenzen gemäß dem<br>Standard ISO 7816-13 verwendet. Im Standard werden die folgenden Komman<br>dos definiert:                                                                                                                                                                         |                          |  |
|       | •<br>Application management request – Einleiten einer Nachladeprozedur                                                                                                                                                                                                                                                                |                          |  |
|       | •<br>Load Application – Nachladen einer Anwendung                                                                                                                                                                                                                                                                                     |                          |  |
|       | •<br>Remove Application – Enfernen einer Anwendung                                                                                                                                                                                                                                                                                    |                          |  |
|       | Zum Aufbringen einer Applikation werden daher die beiden Kommandos Appli<br>cation management request und Load Application benötigt.                                                                                                                                                                                                  |                          |  |
|       | Die Ausführung der Kommandos aus ISO 7816-13 wird mit secure messaging<br>vorgeschrieben. Dadurch wird sichergestellt, dass die neue Applikation authen<br>tisch eingebracht und sicher betrieben werden kann. In den folgenden Abschnit<br>ten wird die Anwendung des ISO-Standards für diesen Anwendungsfall näher<br>erläutert.    |                          |  |
|       | Hinweis:<br>Grundsätzlich können neue Applikationen auch ohne SM eingebracht werden.<br>Dies beeinflusst die Sicherheit der vorhandene Applikationen nicht, sichert je<br>doch nicht die Authentizität der neuen Anwendung.                                                                                                           |                          |  |
|       | Da der Standard ISO7816-13 nur den Rahmen vorgibt, in dem Applikationen auf<br>hierfür geeignete Trägermedien eingebracht werden können, sind für diesen<br>Anwendungsfall folgende Festlegungen konkret zu treffen:                                                                                                                  |                          |  |

<span id="page-94-0"></span>

|       | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Adressierte Gefährdungen |
|-------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
| MT10a | Nachladen von Anwendungen - Sichern der<br>Anwendungen hinsichtlich Authentizität und<br>Integrität                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | GT9                      |
|       | •<br>Um eine eindeutige Trennung zwischen den Anwendungen zu gewährleis<br>ten, ist jeder Anwendung eine Anwendungs-ID zuzuordnen.<br>•<br>Ferner sind allen Organisationen eindeutige Organisations-IDs zuzuweisen,<br>die eine eindeutige Zuordnung von Schlüsseln und Anwendungsdaten er<br>möglicht.<br>•<br>Anwendungen werden nur beim Anwendungsherausgeber ausgegeben,<br>also nicht von beliebigen weiteren Instanzen.<br>•<br>Der für die Durchführung von secure messaging notwendige secure mes<br>saging-Schlüssel muss bei der ersten Personalisierung des Trägermediums<br>in diesem (applikationsübergreifend) gespeichert werden, damit die Ausfüh<br>rung der Kommandos möglich wird. Gleichermaßen muss der Anwen<br>dungsanbieter diesen Schlüssel ebenfalls besitzen. Trägermedien, die die<br>sen Schlüssel nicht besitzen, können keine Sessionkeys mit dem Anwen<br>dungsanbieter aushandeln und eine Übertragung von Daten im Rahmen<br>des Kommandos Load Application ist nicht möglich. |                          |
|       | III Anmerkungen zur Sicherung der Anwendungen bzgl. Authentizität und Integ<br>rität.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                          |
|       | •<br>Die Verwendung des Secure Messaging Mechanismus setzt eine online<br>Verbindung zum Anwendungsanbieter voraus bzw. zu der Stelle, die den<br>SM-Schlüssel zum Applikationsdownload besitzt. Eine sichere Betriebsum<br>gebung ist hierzu nicht erforderlich                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                          |
|       | •<br>Im Rahmen des Keymanagements des in diesem Dokument benannten<br>Anwendungsfalls muss sichergestellt werden, dass die gegenseitige Au<br>thentifikation zwischen Anwendungsanbieter (also der "aufspielenden Stel<br>le") und dem Trägermedium erfolgen kann. Dies kann einerseits dadurch<br>realisiert werden, dass der SM-Schlüssel zum Anwendungsnachladen vom<br>Anwendungsherausgeber an den Anwendungsanbieter verteilt wird (oder<br>beide Instanzen identisch sind) oder indem eine vertrauenswürdige dritte<br>Instanz diesen Schlüssel erzeugt und dieser im Vorfeld in Sicherheitsmodu<br>le und Trägermedien eingebracht wird.                                                                                                                                                                                                                                                                                                                                                                   |                          |
|       | IV Beispiel für eine Kommandosequenz:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                          |
|       | 1<br>Select <<card manager AID>><br>Selektieren der card manager Anwendung über die AID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                          |
|       | 2<br>Get Data <<management service template>><br>Auslesen des Card management service template, welches Informationen<br>hierüber enthält, in welchem Status des Lebenszyklus sich die Applikation<br>befindet und in welchen anderen Status sie übergehen kann.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                          |
|       | 3<br>Select <<AID übergeordnete Anwendung>>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                          |
|       | 4<br>Authenticate<br>Je nach Sicherheitsstufe (der Applikation) kann im Anschluss eine gegen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                          |
|       | seitige Authentifikation erfolgen.<br>5<br>Application Management Request                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                          |

|       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                  | Adressierte Gefährdungen |
|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
| MT10a | Nachladen von Anwendungen - Sichern der<br>Anwendungen hinsichtlich Authentizität und<br>Integrität                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                | GT9                      |
|       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Mögliche Übergabe der AID der zu managenden Anwendung zusammen<br>mit Zertifikat und Hashwert über die Anwendungsdaten, herausgegeben<br>vom Kartenherausgeber. Dabei können weitere Daten wie z. B. Anwen<br>dungsherausgeber-ID, Kartenherausgeber-ID, etc. an die Karte gesendet<br>werden. |                          |
|       | 6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Load Application                                                                                                                                                                                                                                                                               |                          |
|       | Mehrteiliges Kommando zum tatsächlichen Laden der Applikation. Das<br>Kommando Load Application enthält im Datenfeld Kommandos zum Anle<br>gen der Applikationsstruktur. Da die einzubringenden Anwendungen unter<br>schiedlich definiert sein können und auch unterschiedliche Anforderungen<br>an Sicherheit, Berechtigungen etc. haben, enthält das Kommand je nach<br>Applikation unterschiedliche Dateninhalte (respektive Chipkartenkomman<br>dos) Die Umsetzung dieses Kommandos ist stark vom zugrundeliegenden<br>Betriebssystem abhängig und von der Art der einzubringenden Anwendung. |                                                                                                                                                                                                                                                                                                |                          |
|       | 7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Application Management Request<br>Setzen des Status auf "operational activated", damit die Anwendung in Be<br>trieb genommen werden kann und die damit verbundenen spezifischen Si<br>cherheitszustände im Trägermedium gesetzt werden.                                                        |                          |
|       | Für das Entfernen von Anwendungen auf bereits ausgegebenen Karten kann<br>analog vorgegangen werden. Hierzu ist im Standard das Kommando Remove<br>Application definiert, was in die oben genannten Sequenzen eingebettet wird.                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                |                          |

#### **Tabelle 8–48 Schutz durch Sichern von Authentizität und Integrität beim Nachladen von Anwendungen**

| MT10b | Kurzbezeichnung der Maßnahmen                                                                                                                                                    | Adressierte Gefährdungen |
|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|       | Nachladen von Anwendungen - Sichern der<br>Anwendungen hinsichtlich Vertraulichkeit                                                                                              | GT9                      |
| 1     | Kein Nachlademechanismus:<br>•<br>Es wird kein Nachlademechanismus angeboten. Anwendungen werden nur<br>einzeln ausgegeben. Multiapplikationsfähigkeit ist nicht gegeben. Da die |                          |
|       | Aufbringung der einzigen Applikation in einer sicheren Umgebung erfolgt,<br>ist die Vertraulichkeit der Anwendungsdaten per se gegeben.                                          |                          |
| 2     | Implementieren eines Nachlademechanismus gem. ISO 7816-13 mit SM:                                                                                                                |                          |

• Siehe MT10a. Im Rahmen von Secure messaging wird nicht nur die Authentizität durch MACs sondern zusätzlich auch die Vertraulichkeit durch Verschlüsselung gesichert.

### Anmerkung:

Beim Nachladen von Anwendungen werden neben öffentlichen Daten in der Regel auch kryptographische Geheimnisse übertragen. Daher werden üblicherweise die Maßnahmen MT10a und MT10b zusammen verwendet (secure messaging mit Aushandlung je eines Sessionkeys zur Authentifikationssicherung und zur Verschlüsselung).

<span id="page-96-0"></span>

| MT10b | Kurzbezeichnung der Maßnahmen                                                       | Adressierte Gefährdungen |
|-------|-------------------------------------------------------------------------------------|--------------------------|
|       | Nachladen von Anwendungen - Sichern der<br>Anwendungen hinsichtlich Vertraulichkeit | GT9                      |
| 3     |                                                                                     |                          |

#### **Tabelle 8–49 Schutz durch Sichern von Vertraulichkeit beim Nachladen von Anwendungen**

| MT11a         | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                         | Adressierte Gefährdungen |  |
|---------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|               | Nachladen von Berechtigung - Sichern der<br>Berechtigungen hinsichtlich Authentizität und<br>Integrität                                                                                                                                                                                                                                                                                                                                               | GT2, GT9                 |  |
|               | Anmerkungen zu Stufe 2 und 3:                                                                                                                                                                                                                                                                                                                                                                                                                         |                          |  |
| Allge<br>mein | •<br>Es wird vorausgesetzt, dass die Applikation, für die Berechtigungen nach<br>zuladen sind, bereits existiert. Existiert diese noch nicht, so lässt sich der<br>Fall "Nachladen von Berechtigungen" auf den Fall "Nachladen von Applika<br>tionen" zurückführen.                                                                                                                                                                                   |                          |  |
|               | •<br>Es ist zu gewährleisten, dass Berechtigungen eindeutig referenzierbar auf<br>dem Trägermedium hinterlegt werden.                                                                                                                                                                                                                                                                                                                                 |                          |  |
|               | •<br>Sind Berechtigungsschlüssel auf das Trägermedium aufzubringen, so ist in<br>jedem Fall eine Verschlüsselung der Daten erforderlich (vgl. MT11b).                                                                                                                                                                                                                                                                                                 |                          |  |
|               | Kein Nachlademechanismus:                                                                                                                                                                                                                                                                                                                                                                                                                             |                          |  |
| 1             | •<br>Es wird kein Nachlademechanismus zum Nachladen von Berechtigungen<br>angeboten; Berechtigungen werden nur einzeln ausgegeben.                                                                                                                                                                                                                                                                                                                    |                          |  |
|               | Proprietäre kryptographische Sicherung des Nachladens:                                                                                                                                                                                                                                                                                                                                                                                                |                          |  |
| 2             | •<br>Die Integrität der Übertragung der Berechtigungsdaten wird durch MAC<br>Sicherung mit statischen MAC-Schlüsseln gewährleistet. MAC-Verfahren<br>sind nach [ALGK_BSI] zu wählen.                                                                                                                                                                                                                                                                  |                          |  |
|               | Komplexes symmetrisches Authentifikationskonzept mit Aushandlung von Ses<br>sion Keys:                                                                                                                                                                                                                                                                                                                                                                |                          |  |
| 3             | •<br>Die Integrität der Datenübertragung wird durch MAC-Sicherung mit einem<br>zwischen dem Nachladeterminal und dem Trägermedium mittels eines star<br>ken standardisierten Authentifikationsverfahrens ausgehandelten symmetri<br>schen MAC-Schlüssel gewährleistet. Die Kommunikation zwischen Termi<br>nal und Trägermedium kann dabei z. B. über Secure-Messaging-gesicherte<br>Standardkommandos wie Update Record oder Update Binary erfolgen. |                          |  |
|               | •<br>Mögliche symmetrische Algorithmen: Standardisierte symmetrische Authen<br>tifikation mit Aushandlung der Session Keys nach [ALGK_BSI]. MAC<br>Verfahren sind ebenfalls nach [ALGK_BSI] zu wählen.                                                                                                                                                                                                                                                |                          |  |
|               | •<br>Die Art und Stärke des zum Nachladen verwendeten Mechanismus ist an<br>künftige Entwicklungen entsprechend [ALGK_BSI] anzupassen.                                                                                                                                                                                                                                                                                                                |                          |  |
| 3+            | Komplexes asymmetrisches Authentifikationskonzept mit Aushandlung der Ses<br>sion Keys, Einführung einer Public Key Infrastruktur (PKI):                                                                                                                                                                                                                                                                                                              |                          |  |
|               | •<br>Jede Entität des ÖPV-Systems erhält einen eigenen asymmetrischen Au<br>thentifikationsschlüssel, der von einer Certification Authority (CA) zertifiziert                                                                                                                                                                                                                                                                                         |                          |  |

<span id="page-97-0"></span>

|       | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Adressierte Gefährdungen |
|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
| MT11a | Nachladen von Berechtigung - Sichern der<br>Berechtigungen hinsichtlich Authentizität und<br>Integrität                                                                                                                                                                                                                                                                                                                                                                                                                         | GT2, GT9                 |
|       | wurde. Das gesamte System untersteht einer gemeinsamen Root-CA.                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                          |
|       | •<br>Vor einer Authentifikation müssen das Trägermedium auf der einen und das<br>Sicherheitsmodul (SAM) im System des Anwendungsanbieters auf der an<br>deren Seite die Zertifikate ihrer öffentlichen Authentifikationsschlüssel aus<br>tauschen, diese gegenseitig (z. B. mit Verify Certificate) verifizieren und<br>damit den jeweiligen öffentlichen Schlüssel der jeweils anderen Entität ein<br>bringen. Die Authentifikation erfolgt dann mittels eines standardisierten<br>asymmetrischen Authentifikationsverfahrens. |                          |
|       | •<br>Wie in Stufe 3 werden die Berechtigungsdaten mittels des zwischen den<br>Parteien ausgehandelten Sessionkeys MAC-gesichert.                                                                                                                                                                                                                                                                                                                                                                                                |                          |
|       | •<br>Auswahl der Algorithmen: Authentifikation mit RSA oder ECC (Schlüssel<br>längen gemäß [ALGK_BSI] für Authentifikationsschlüssel und CA<br>Schlüssel); MAC-Sicherung gemäß [ALGK_BSI].                                                                                                                                                                                                                                                                                                                                      |                          |
|       | •<br>Auch in Stufe 3+ ist die Art und Stärke des zum Nachladen verwendeten<br>Mechanismus an künftige Entwicklungen entsprechend [ALGK_BSI] anzu<br>passen.                                                                                                                                                                                                                                                                                                                                                                     |                          |
|       | Beispiel VDV-Kernapplikation:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                          |
|       | •<br>Die VDV-Kernapplikation basiert auf einer komplexen PKI, bei der jede Enti<br>tät (d.h. u.A. auch jedes VDV-SAM und jedes Nutzermedium) ein eigenes,<br>von einer CA signiertes Zertifikat für ihren Authentifikationsschlüssel bein<br>haltet.                                                                                                                                                                                                                                                                            |                          |
|       | •<br>Bei der Ausgabe einer Berechtigung wird zunächst eine ein- oder mehrstu<br>fige Zertifikatsverifikation mit anschließender asymmetrische Authentifikati<br>on zwischen dem VDV-Nutzermedium und dem VDV-SAM durchgeführt, bei<br>der gemeinsame Sessionkeys zur MAC-Sicherung und Verschlüsselung<br>ausgehandelt werden.                                                                                                                                                                                                  |                          |
|       | •<br>Eine Berechtigung besteht dann aus eindeutigen Berechtigungsdaten und<br>symmetrischen Berechtigungsschlüsseln. Diese wird nach der Authentifika<br>tion mittels des Standardkommandos Put Data Secure-Messaging-gesichert<br>auf das Trägermedium aufgebracht. Das VDV-SAM ist hierbei in der Lage,<br>die zugehörigen Kommandonachrichten für die Nutzermedien zu generie<br>ren. Vgl. hierzu die Spezifikation des Kundenmediums der VDV<br>Kernapplikation, siehe [VDV_KM].                                            |                          |

### **Tabelle 8–50 Schutz durch Sichern von Authentizität und Integrität beim Nachladen von Berechtigungen**

| MT11b         | Kurzbezeichnung der Maßnahmen                                                                                                                                                            | Adressierte Gefährdungen |
|---------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|               | Nachladen von Berechtigungen - Sichern der<br>Berechtigungen hinsichtlich Vertraulichkeit                                                                                                | GT2, GT9                 |
|               | Anmerkung zu Stufe 2 und 3:                                                                                                                                                              |                          |
| Allge<br>mein | •<br>Da beim Nachladen Berechtigungen neben öffentlichen Daten oftmals auch<br>kryptographische Geheimnisse übertragen werden, sind MT11a und MT11b<br>in der Regel zusammen umzusetzen. |                          |

<span id="page-98-0"></span>

| MT11b | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                    | Adressierte Gefährdungen |
|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|       | Nachladen von Berechtigungen - Sichern der<br>Berechtigungen hinsichtlich Vertraulichkeit                                                                                                                                                                                        | GT2, GT9                 |
|       | Kein Nachlademechanismus:                                                                                                                                                                                                                                                        |                          |
| 1     | •<br>Es wird kein Nachlademechanismus angeboten. Berechtigungen werden<br>nur einzeln ausgegeben. Da die Berechtigung dann bereits auf dem Trä<br>germedium gespeichert ist, ist die Vertraulichkeit per se gegeben.                                                             |                          |
|       | Proprietäre kryptographische Sicherung des Nachladens:                                                                                                                                                                                                                           |                          |
| 2     | •<br>Siehe MT11a; bei der Kommunikation zwischen dem Trägermedium und<br>der externen Komponente wird nicht nur die Authentizität durch MACs son<br>dern zusätzlich auch die Vertraulichkeit durch Verschlüsselung gesichert                                                     |                          |
|       | •<br>Mögliche symmetrische Algorithmen: Verschlüsselung mit TDES, AES128<br>oder vergleichbare offene Verfahren.                                                                                                                                                                 |                          |
|       | Komplexes symmetrisches Authentifikationskonzept mit Aushandlung der Ses<br>sion Keys:                                                                                                                                                                                           |                          |
| 3     | •<br>Siehe MT11a; im Rahmen der Authentifikation zwischen Trägermedium und<br>der externen Komponente wird neben dem MAC- auch ein Verschlüsse<br>lungsschlüssel ausgehandelt und damit ein sicherer Kanal aufgebaut.                                                            |                          |
|       | •<br>Mögliche symmetrische Algorithmen: Standardisierte symmetrische Authen<br>tifikation mit Aushandlung der Session Keys mittels TDES, AES128 oder<br>einem vergleichbaren offenen Verfahren; Verschlüsselung mit TDES,<br>AES128 oder einem vergleichbaren offenen Verfahren. |                          |
|       | •<br>Die Art und Stärke des zum Nachladen verwendeten Mechanismus ist an<br>künftige Entwicklungen entsprechend [ALGK_BSI] anzupassen.                                                                                                                                           |                          |

**Tabelle 8–51 Schutz durch Sichern von Vertraulichkeit beim Nachladen von Berechtigungen** 

# **8.4.4 Maßnahmen in Bezug auf das aktive NFC-Mobiltelefon**

| MNMD<br>1     | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                              | Adressierte Gefährdungen       |
|---------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|               | Vermitteln der Abläufe und der Nutzungsbe<br>dingungen                                                                                                                                                                                                                                                                                                     | GNMD2, GNMD3, GNMD8,<br>GNMD10 |
| Allge<br>mein |                                                                                                                                                                                                                                                                                                                                                            |                                |
| 1             | Information bei Bestellung:<br>•<br>Der Kunde ist bei Abschluss des Vertrages über den genauen Handlungs<br>ablauf des Check-in mittels NFC-Mobiltelefon und die Vorbedingungen, die<br>vor Antritt der Fahrt erfüllt sein müssen, zu informieren. Die rechtlichen<br>Konsequenzen sind in den AGB niederzulegen und zusätzlich dem Kunden<br>zu erklären. |                                |
| 2             | Information vor Ort:<br>•<br>Aufstellen von Informationstafeln in der Nähre der lokalen Transponder.                                                                                                                                                                                                                                                       |                                |

<span id="page-99-0"></span>

| MNMD<br>1 | Kurzbezeichnung der Maßnahmen                                                | Adressierte Gefährdungen       |
|-----------|------------------------------------------------------------------------------|--------------------------------|
|           | Vermitteln der Abläufe und der Nutzungsbe<br>dingungen                       | GNMD2, GNMD3, GNMD8,<br>GNMD10 |
| 3         | Proaktive Aufklärung:                                                        |                                |
|           | •<br>Kundenaufklärung an speziellen Helpdesks oder durch "Check-in Stewards" |                                |

| Tabelle 8–52 | Schutz durch Vermitteln der Abläufe und Nutzungsbedingungen |
|--------------|-------------------------------------------------------------|
|--------------|-------------------------------------------------------------|

| MNMD<br>2     | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                   | Adressierte Gefährdungen      |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|               | Ausweichen auf alternativen Vertriebskanal                                                                                                                                                                      | GNMD2, GNMD8, GNMD10,<br>GTR8 |
| Allge<br>mein | Es muss auf einen anderen Vertriebskanal ausgewichen werden. Der Kunde ist<br>entsprechend zu informieren. Gleichzeitig muss die nicht komplettierte Buchung<br>im Kontrollsystem storniert werden.             |                               |
| 1             | Information des Kunden:<br>•<br>Kunde wird in Nutzungsbedingungen und durch Informationen vor Ort im<br>Fehlerfall an anderen Vertriebskanal verwiesen.                                                         |                               |
| 2             | Lokale Information / Vorhalten von Kapazitäten:                                                                                                                                                                 |                               |
| 3             | •<br>Kunde wird in Nutzungsbedingungen und durch Informationen vor Ort im<br>Fehlerfall an anderen lokalen Vertriebskanal verwiesen. Entsprechende<br>Kapazitäten werden für diesen Vertriebskanal vorgehalten. |                               |

| Tabelle 8–53 | Schutz durch Ausweichen auf alternativen Vertriebskanal |
|--------------|---------------------------------------------------------|
|--------------|---------------------------------------------------------|

| MNMD<br>3     | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                              | Adressierte Gefährdungen |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|               | Schutz von Daten und Schlüsseln im NFC<br>Mobiltelefon                                                                                                                                                                                                                                                                                     | GNMD4, GNMD5. GNMD9      |
| Allge<br>mein | Anwendungen und Berechtigungen müssen im NFC-Mobiltelefon sicher ver<br>wahrt werden. Ggf. müssen auch Daten aus dem lokalen Transponder im NFC<br>Mobiltelefon zwischengespeichert werden.                                                                                                                                                |                          |
| 1             | Daten und Schlüssel müssen im NFC-Mobiltelefon in einem sicheren Speicher<br>abgelegt werden.                                                                                                                                                                                                                                              |                          |
| 2             | Sicherer Speicher:<br>•<br>Daten und Schlüssel müssen im NFC-Mobiltelefon in einem sicheren Spei<br>cher abgelegt werden.<br>•<br>Zugriff auf die Daten ist nur nach Authentisierung gestattet.<br>•<br>Im NFC-Mobiltelefon sind kryptographische Algorithmen zur Authentisie<br>rung und Verschlüsselung der Übertragung bereitzustellen. |                          |

<span id="page-100-0"></span>

| MNMD<br>3 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                            | Adressierte Gefährdungen |
|-----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|           | Schutz von Daten und Schlüsseln im NFC<br>Mobiltelefon                                                                                                                                                                   | GNMD4, GNMD5. GNMD9      |
|           | Sichere Plattform:                                                                                                                                                                                                       |                          |
| 3         | •<br>Daten und Schlüssel müssen im NFC-Mobiltelefon in einem sicheren, zerti<br>fizierten Speicher abgelegt werden. Zugriff auf die Daten ist nur nach Au<br>thentisierung gestattet.                                    |                          |
|           | •<br>Kryptographische Algorithmen zu Authentisierung und Verschlüsselung der<br>Übertragung und die Software zur Ablaufsteuerung sind als sichere Soft<br>ware auf einer zertifizierten Chipplattform zu implementieren. |                          |

| Tabelle 8–54 | Schutz von Daten und Schlüsseln im NFC-Mobiltelefon |
|--------------|-----------------------------------------------------|
|              |                                                     |

| MNMD<br>4     | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                           | Adressierte Gefährdungen |  |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|               | Schutz der Transponderdaten im NFC-Mobil<br>telefon                                                                                                                                                                                                                                                                                                                                                                                     | GNMD7                    |  |
| Allge<br>mein | Ggf. müssen Daten aus dem lokalen Transponder im NFC-Mobiltelefon zwi<br>schengespeichert werden.                                                                                                                                                                                                                                                                                                                                       |                          |  |
| 1             | Die aus dem lokalen Transponder gelesenen Daten müssen im NFC<br>Mobiltelefon in einem sicheren Speicher abgelegt werden.                                                                                                                                                                                                                                                                                                               |                          |  |
| 2             | Sicherer Speicher:<br>•<br>Die aus dem lokalen Transponder gelesenen Daten müssen im NFC<br>Mobiltelefon in einem sicheren Speicher abgelegt werden. Zugriff auf die<br>Daten ist nur nach Authentisierung gestattet.<br>•<br>Im NFC-Mobiltelefon sind kryptographische Algorithmen zur Authentisie<br>rung und Verschlüsselung der Übertragung bereitzustellen.                                                                        |                          |  |
| 3             | Sichere Plattform:<br>•<br>Daten und Schlüssel müssen im NFC-Mobiltelefon in einem sicheren, zerti<br>fizierten Speicher abgelegt werden. Zugriff auf die Daten ist nur nach Au<br>thentisierung gestattet.<br>•<br>Kryptographische Algorithmen zu Authentisierung und Verschlüsselung der<br>Übertragung und die Software zur Ablaufsteuerung sind als sichere Soft<br>ware auf einer zertifizierten Chipplattform zu implementieren. |                          |  |

| MNMD<br>5     | Kurzbezeichnung der Maßnahmen                                                                                                                                                                              | Adressierte Gefährdungen |  |
|---------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|               | Überprüfung der Funktion des NFC-Mobil<br>telefons/Displays                                                                                                                                                | GNMD10                   |  |
| Allge<br>mein | Bei Verdacht auf Manipulation des Displays-Inhalts soll die Funktion des NFC<br>Mobiltelefons und insbesondere des Displays in Kombination mit der betreffen<br>den eTicketing-Anwendung überprüft werden. |                          |  |
| 1             | Folgende Prüfmöglichkeiten sollen an speziellen Servicestellen vorgehalten                                                                                                                                 |                          |  |
| 2             | werden:<br>•<br>Prüfung<br>des<br>Berechtigungsstatus<br>durch<br>klassisches<br>Kontrollgerät                                                                                                             |                          |  |

<span id="page-101-0"></span>

| MNMD<br>5 | Kurzbezeichnung der Maßnahmen                               | Adressierte Gefährdungen |
|-----------|-------------------------------------------------------------|--------------------------|
|           | Überprüfung der Funktion des NFC-Mobil<br>telefons/Displays | GNMD10                   |
| 3         |                                                             |                          |

**Tabelle 8–56 Schutz durch Überprüfung des NFC-Mobiltelefons/Displays** 

# **8.4.5 Maßnahmen in Bezug auf den lokalen Transponder beim Online-Check-in und Check-out**

Beim Online-Check-in wird zunächst mit Hilfe des NFC-Mobiltelefons (active mode) über das Internet eine direkte Kommunikation zwischen dem Kontrollserver und dem lokalen Transponder aufgebaut. Der Kontrollserver steuert den Lesevorgang und baut üblicherweise einen sicheren Kanal auf, über den die Transponderdaten dann geschützt übertragen werden. Das NFC-Mobiltelefon kommt mit den Transponderdaten nicht in Berührung.

Nach dem Lesen und Auswerten der Transponderdaten baut der Erfassungsserver einen sicheren Kanal zum sicheren Speicher des NFC-Mobiltelefons auf, prüft die Berechtigung und schreibt die Check-in bzw. Check-out-Daten in die Anwendung im sicheren Speicher des NFC-Mobiltelefons.

Der Erfassungsserver bewahrt sämtliche nötigen Schlüssel in SAM.

# **8.4.6 Maßnahmen in Bezug auf den lokalen Transponder beim Offline-Check-in und Check-out**

Wesentliche Gefährdungen, denen lokale Transponders ausgesetzt sein könnten, können durch Schutzmaßnahmen beantwortet werden, die für passive Trägermedien wirksam sind. Diese Maßnahmen sind in Kapitel [8.4.3](#page-86-1) beschrieben.

In diesem Kapitel finden sich deshalb nur Maßnahmen, die speziell für lokale Transponder ausgelegt sind.

| MTR1          | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                   | Adressierte Gefährdungen |  |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|               | Sichern der Authentizität der Ortsinformation                                                                                                                                                                                                                                                                                                                                   | GTR9                     |  |
| Allge<br>mein | Es wird davon ausgegangen, dass ein Schlüsselmanagement im NFC<br>Mobiltelefon nur sehr begrenzt möglich ist. Deshalb scheiden Verfahren, die<br>große Mengen an Schlüsseln oder hohen Schutzbedarf für Schlüssel beinhalten<br>aus.                                                                                                                                            |                          |  |
| 1             | Schreibschutz:<br>•<br>Die Daten werden im Transponder gegen Überschreiben geschützt. Eine<br>Authentizitätssicherung bei der Übertragung findet nicht statt.                                                                                                                                                                                                                   |                          |  |
| 2             | Sicherung durch asymmetrische Verfahren:                                                                                                                                                                                                                                                                                                                                        |                          |  |
| 3             | •<br>Die Daten werden im Transponder gegen Überschreiben geschützt.<br>•<br>Bei der Kommunikation zwischen lokalem Transponder und NFC<br>Mobiltelefon wird die Integrität der Ortsinformationen durch Signatur gesi<br>chert. Zur Verhinderung von Replay-Attacken darf das Tag jedoch nicht nur<br>die Ortsinformationen, sondern muss zusätzlich auch eine von der signatur- |                          |  |

<span id="page-102-0"></span>

| MTR1 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Kurzbezeichnung der Maßnahmen | Adressierte Gefährdungen |
|------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|--------------------------|
|      | Sichern der Authentizität der Ortsinformation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                               | GTR9                     |
|      | verifizierenden Instanz (NFC-Mobiltelefon bzw. Nutzermedium oder Hinter<br>grundsystem) generierte Zufallszahl signieren.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                               |                          |
|      | •<br>Die Prüfung der Authentizität kann prinzipiell in jeder Instanz erfolgen, die<br>den öffentlichen Schlüssel bzw. das Zertifikat des Transponders besitzt. Ei<br>ne Prüfung im NFC-Mobiltelefon ist möglich und empfehlenswert. Erfolgt die<br>Prüfung im Kontrollsystem, so kann der zur Verifikation benötigte öffentliche<br>Schlüssel des Transponders dort vorgehalten werden; erfolgt die Prüfung<br>im NFC-Mobiltelefon, so muss der zur Prüfung der Signatur nötige öffentli<br>che Schlüssel des Transponders vor Prüfung der Signatur authentisch in<br>das NFC-Mobiltelefon eingebracht werden.<br>•<br>Die Art und Stärke des Mechanismus ist dem heutigen Stand und künftigen<br>Entwicklungen entsprechend [ALGK_BSI] anzupassen. |                               |                          |
|      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                               |                          |

| Tabelle 8–57 | Schutz durch Sichern der Authentizität der Ortsinformation |
|--------------|------------------------------------------------------------|
|--------------|------------------------------------------------------------|

| MTR2          | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                          | Adressierte Gefährdungen |  |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|               | Schutz vor Vandalismus / DoS                                                                                                                                                                                                                                                                                                                                                                                                                           | GTR7, GTR5               |  |
| Allge<br>mein |                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                          |  |
|               | Schutz vor Vandalismus / DoS - Gut einsehbarer Aufstellungsort:                                                                                                                                                                                                                                                                                                                                                                                        |                          |  |
| 1             | •<br>Die Transponder werden an einem durch vertrauenswürdiges Personal gut<br>einsehbarem Aufstellungsort platziert.                                                                                                                                                                                                                                                                                                                                   |                          |  |
| 2             | Schutz vor Vandalismus / DoS – Funktionsprüfung:                                                                                                                                                                                                                                                                                                                                                                                                       |                          |  |
| 3             | •<br>Die individuelle Nutzungsrate aller Transponder wird im Kontrollsystem<br>ausgewertet. Sollten sich dabei für spezielle Transponder Auffälligkeiten er<br>geben (z. B. keine, sehr hohe oder stark veränderte Nutzung), so wird eine<br>individuelle Funktionsprüfung durchgeführt.<br>•<br>Zusätzlich wird in festen Intervallen (mindestens monatlich) an jedem loka<br>len Transponder eine Funktionsprüfung durchgeführt. Dabei wird auch der |                          |  |
|               | Dateninhalt und die Sicherheitsfunktion geprüft.                                                                                                                                                                                                                                                                                                                                                                                                       |                          |  |

**Tabelle 8–58 Schutz vor Vandalismus / DoS-Attacken** 

| MTR3          | Kurzbezeichnung der Maßnahmen                                                                        | Adressierte Gefährdungen |  |
|---------------|------------------------------------------------------------------------------------------------------|--------------------------|--|
|               | Schutz der Installation von Transpondern                                                             | GTR7, GTR5               |  |
| Allge<br>mein | Diese Maßnahmen betreffen die Installation des Transponders vor Ort.                                 |                          |  |
| 1             | Feste Installation:                                                                                  |                          |  |
|               | •<br>Der Transponder wird durch mechanische Maßnahmen (z. B. Aufkleben)<br>gegen Entfernen geschützt |                          |  |
| 2             | Schutz der Installation von Transpondern -Sicherstellen der Authentizität:                           |                          |  |
|               | •<br>Der Transponder wird durch mechanische Maßnahmen (z. B. durch den                               |                          |  |

Einbau in feste Installationen) gegen Entfernen geschützt.

<span id="page-103-0"></span>

| MTR3 | Kurzbezeichnung der Maßnahmen            | Adressierte Gefährdungen |
|------|------------------------------------------|--------------------------|
|      | Schutz der Installation von Transpondern | GTR7, GTR5               |
| 3    |                                          |                          |

**Tabelle 8–59 Schutz der Installation des Transponders** 

# **8.4.7 Maßnahmen in Bezug auf die Lesegeräte**

| MR1 | Kurzbezeichnung der Maßnahmen                                                                                                                   | Adressierte Gefährdungen |  |
|-----|-------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|     | Einführung von Schnittstellentests und Frei<br>gabeverfahren                                                                                    | GIF1                     |  |
|     | Schnittstellentest:                                                                                                                             |                          |  |
| 1   | •<br>Verwendung von existierenden Prüfvorschriften des BSI und der ISO für die<br>kontaktlose Schnittstelle des PCD nach ISO/IEC14443.          |                          |  |
|     | •<br>Erstellung und Verwendung von spezifischen Testvorschriften für die an<br>wendungsspezifischen Funktionen der Schnittstelle des Lesegeräts |                          |  |
| 2   | Komponentenfreigabe:                                                                                                                            |                          |  |
|     | •<br>s. o., zusätzlich Komponentenfreigabe (Trägermedium, Lesegeräte, Schlüs<br>selmanagement)                                                  |                          |  |
| 3   | Zertifizierung:                                                                                                                                 |                          |  |
|     | •<br>s. o., zusätzlich Zertifizierung durch unabhängiges Institut für Trägermedi<br>um, Lesegeräte                                              |                          |  |

| MR2           | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                              | Adressierte Gefährdungen |  |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|               | Schützen der Referenzinformationen gegen<br>Auslesen, Datenfehler und Manipulationen                                                                                                                                                                                                                                                                                                                                                                                       | GR1, GR2                 |  |
| Allge<br>mein | Referenzinformationen werden z. B. zur Kommunikation mit den Trägermedien,<br>zum Aufbringen und Auswertung von Berechtigungen und zur Generierung und<br>Speicherung von Nutzungsdaten (CICO-Daten, Verkaufsdaten) benötigt:<br>•<br>Kennungen (ID)<br>•<br>Schlüssel<br>•<br>Sperrlisten oder White Lists<br>•<br>Algorithmen zur Auswertung<br>Referenzinformationen und Nutzungsdaten können sich in Abhängigkeit von<br>Anwendungen und Berechtigungen unterscheiden. |                          |  |
| 1             | Prüfsumme und physikalischer Schutz:<br>•<br>Angemessener physikalischer Zugriffschutz auf die Geräte (z. B. gekapsel<br>tes Gehäuse, mechanischer Abtrennungsschutz von LAN-Kabeln)<br>•<br>Prüfsummen bei Datenübernahme zur Vermeidung von Übertragungsfeh<br>lern – schützt nicht vor Manipulationen, da Prüfsummen durch fast jede                                                                                                                                    |                          |  |

<span id="page-104-0"></span>

| MR2 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                       | Adressierte Gefährdungen |  |  |  |
|-----|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|--|--|
|     | Schützen der Referenzinformationen gegen<br>GR1, GR2<br>Auslesen, Datenfehler und Manipulationen                                                                                                                    |                          |  |  |  |
|     | Software automatisch berechnet werden und ohne Geheimnis auskommen.                                                                                                                                                 |                          |  |  |  |
|     | •<br>Speicherung der kryptographischen Schlüssel und Algorithmen in SAM<br>oder in einem geschützten Bereich der Software.                                                                                          |                          |  |  |  |
|     | •<br>Einführung eines Zugriffschutz für Daten und Verwaltungsfunktionen des<br>Lesegeräts                                                                                                                           |                          |  |  |  |
|     | Authentifikation, Gesicherte Übertragung:                                                                                                                                                                           |                          |  |  |  |
| 2   | •<br>Mechanismen zur Erkennung von Datenmanipulationen im Gerät, wie z. B.<br>MAC-gesicherte Speicherung.                                                                                                           |                          |  |  |  |
|     | •<br>Übernahmen von Daten von Hintergrundsystemen im Lesegerät nur nach<br>vorheriger gegenseitiger Authentifikation, mindestens jedoch einseitiger Au<br>thentifikation der an das Lesegerät übertragenden Instanz |                          |  |  |  |
|     | •<br>Geschützte Datenübertragung zum Trägermedium, sofern diese zu über<br>nehmen sind.                                                                                                                             |                          |  |  |  |
|     | •<br>Anwendungsspezifische Trennung von Algorithmen, Referenzdaten, Nut<br>zungsdaten und Schlüsseln.                                                                                                               |                          |  |  |  |
|     | •<br>Speicherung der Schlüssel in SAM oder in einem geschützten Bereich der<br>Software.                                                                                                                            |                          |  |  |  |
|     | •<br>Einführung eines anwendungsspezifischen Zugriffschutz für Daten und<br>Verwaltungsfunktionen des Lesegeräts                                                                                                    |                          |  |  |  |
|     | Erweiterter Schutz:                                                                                                                                                                                                 |                          |  |  |  |
|     | •<br>Mechanismen zur Erkennung von Datenmanipulationen im Gerät, wie z. B.<br>MAC-gesicherte Speicherung.                                                                                                           |                          |  |  |  |
|     | •<br>Übernahmen von Daten von Hintergrundsystemen im Lesegerät nur nach<br>vorheriger gegenseitiger Authentifikation des Lesegeräts mit der jeweiligen<br>Instanz, mit der es kommuniziert.                         |                          |  |  |  |
|     | •<br>Geschützte Datenübertragung zum Trägermedium.                                                                                                                                                                  |                          |  |  |  |
| 3   | •<br>Anwendungsspezifische Trennung von Algorithmen, Referenzdaten, Nut<br>zungsdaten und Schlüsseln.                                                                                                               |                          |  |  |  |
|     | •<br>Speicherung der Schlüssel in anwendungsspezifischen SAM                                                                                                                                                        |                          |  |  |  |
|     | •<br>Speicherung und Ausführung kryptografischer Algorithmen in anwendungs<br>spezifischen SAM                                                                                                                      |                          |  |  |  |
|     | •<br>Einführung eines mandantenfähigen, anwendungsspezifischen Zugriff<br>schutz für Daten und Verwaltungsfunktionen des Lesegeräts entsprechend<br>des Rollenmodells.                                              |                          |  |  |  |

| MR3           | Kurzbezeichnung der Maßnahmen                                                                                                                          | Adressierte Gefährdungen |  |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|               | Schutz des Lesegeräts gegen Fehlfunktionen                                                                                                             | GR3                      |  |
| Allge<br>mein | Allgemeine Maßnahmen sind:                                                                                                                             |                          |  |
|               | •<br>Erstellung einer Spezifikation, die die Eigenschaften des Lesegeräts bzgl.<br>Performanz, Verfügbarkeit, Ablaufsteuerung und Funktion beschreibt. |                          |  |

| MR3 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Adressierte Gefährdungen |  |
|-----|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|     | Schutz des Lesegeräts gegen Fehlfunktionen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | GR3                      |  |
|     | •<br>Erstellung einer Testspezifikation<br>•<br>Offlinefähigkeit sofern Datennetzanbindung nicht garantiert ist.<br>•<br>Referenzdaten und Nutzungsdaten müssen lokal gesichert gespeichert<br>werden können. Kapazität muss entsprechend den Einsatzgegebenhei<br>ten ausgelegt werden.<br>•<br>Einführung einer Unterbrechungsfreie Stromversorgung (USV) sofern ex<br>terne Netzversorgung nicht garantiert ist.<br>•<br>Die USV muss mindestens in der Lage sein, einen spezifizierten Zeit<br>raum zu überbrücken.                                                                                                                                                                                                                                                                                                             |                          |  |
| 1   | Spezifikationsgemäße Umsetzung:<br>•<br>Spezifikationsgemäße Umsetzung der Systemeigenschaften insbesondere<br>hinsichtlich Performanz, Verfügbarkeit, Ablaufsteuerung und Funktion. (Dies<br>setzt das Vorhandensein einer hinreichend genauen Spezifikation voraus.)<br>•<br>Einfache Integritätssicherung von Systemsoftware zum Feststellen von Ma<br>nipulationen an Softwaremodulen (z. B. der Berechtigungsprüfung)<br>•<br>Physikalischer Schutz der Geräte (z. B. gekapseltes Gehäuse, mechani<br>scher Abtrennungsschutz von LAN-Kabeln)<br>•<br>Einfacher Zugriffsschutz in Form von Passwörtern und ID auf Lesegeräte<br>für sensitive Aufgaben wie z. B. de, Einspielen neuer Softwareversionen<br>•<br>Spezifizieren und Implementieren eines Verfahrens zur Unterstützung neu<br>er Berechtigungen und Trägermedien. |                          |  |
| 2   | Umsetzungsnachweis:<br>•<br>Integritätssicherung von Systemsoftware zum Feststellen von Manipulatio<br>nen an Softwaremodulen (z. B. der Berechtigungsprüfung)<br>•<br>Physikalischer Schutz der Geräte (z. B. gekapseltes Gehäuse, mechani<br>scher Abtrennungsschutz von LAN-Kabeln)<br>•<br>Zugriffsschutz in Form von Passwörtern und ID auf Lesegeräte für sensitive<br>Aufgaben wie z. B. Einspielen neuer Softwareversionen<br>•<br>Spezifizieren und Implementieren eines Verfahrens zur Unterstützung neu<br>er Trägermedien, Anwendungen und Berechtigungen.<br>•<br>Nachweis der korrekten Umsetzung der spezifizierten Eigenschaften hin<br>sichtlich Performanz, Verfügbarkeit, Ablaufsteuerung, Funktion durch Tests,<br>die gezielt Fehlfunktionen oder Fehlbedienungen provozieren.                                 |                          |  |

<span id="page-106-0"></span>

| MR3 |                                                                                                                      | Kurzbezeichnung der Maßnahmen                                                                                                                                                                               | Adressierte Gefährdungen |  |
|-----|----------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|     | Schutz des Lesegeräts gegen Fehlfunktionen                                                                           |                                                                                                                                                                                                             | GR3                      |  |
|     |                                                                                                                      | Evaluierung:                                                                                                                                                                                                |                          |  |
|     | •                                                                                                                    | Vereinbarung von Service Level und Sicherstellen von Support im Fehler<br>fall, damit die Auswirkungen von Fehlfunktionen begrenzt werden können.                                                           |                          |  |
|     | •                                                                                                                    | Integritätssicherung von Systemsoftware zum Feststellen von Manipulatio<br>nen an Softwaremodulen (z. B. der Berechtigungsprüfung); Signaturen oder<br>MAC geeigneter Mechanismenstärke und Schlüssellänge. |                          |  |
| 3   | •<br>Physikalischer Schutz der Geräte (z. B. gekapseltes Gehäuse, mechani<br>scher Abtrennungsschutz von LAN-Kabeln) |                                                                                                                                                                                                             |                          |  |
|     | •                                                                                                                    | Zugriff auf alle Verwaltungsfunktionen des Terminals, wie z. B. Softwareup<br>dates nur nach Authentifikation der anfragenden Instanz                                                                       |                          |  |
|     | •                                                                                                                    | Spezifizieren und Implementieren eines Verfahrens zur Unterstützung neu<br>er Trägermedien, Anwendungen und Berechtigungen.                                                                                 |                          |  |
|     | •                                                                                                                    | Evaluierung und Zertifizierung von Systemsoftware und Hardware durch<br>unabhängige Prüflabore nach festgelegten Kriterien.                                                                                 |                          |  |

| Tabelle 8–62 | Schutz des Lesegerätes gegen Fehlfunktion |
|--------------|-------------------------------------------|
|              |                                           |

Weitere Maßnahmen in Bezug auf die Lesegeräte sind in Abschnitt [8.4.2](#page-76-1) benannt.

# **8.4.8 Maßnahmen in Bezug auf das Schlüsselmanagement**

| MK1           | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                 | Adressierte Gefährdungen |  |
|---------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|               | Sichere Erzeugung und Einbringung von<br>Schlüsseln                                                                                                                                                                                                                           | GK1                      |  |
| Allge<br>mein | Spezifikation der erforderlichen Schlüssel und Schlüsseleigenschaften bezogen<br>auf Trägermedien, Anwendungen, Berechtungen unter Berücksichtigung des<br>gültigen Rollenmodells.                                                                                            |                          |  |
|               | Schlüsselerzeugung gemäß Spezifikation:                                                                                                                                                                                                                                       |                          |  |
| 1             | •<br>Einsatz eines geeigneten Schlüsselgenerators gemäß [GSHB].                                                                                                                                                                                                               |                          |  |
|               | •<br>Sämtliche Schlüssel sind in einer sicheren Umgebung zu erzeugen, kryp<br>tographisch gesichert zu speichern und -abgesehen von definierten Aus<br>nahmen mit speziellen zusätzlichen Schutzmassnahmen- in der gesicherten<br>Umgebung auf das Trägermedium aufzubringen. |                          |  |
|               | •<br>Erzeugung spezifischer Schlüssel mit definierten Eigenschaften entspre<br>chend der Spezifikation                                                                                                                                                                        |                          |  |
|               | •<br>Unterstützung des Diversifizierens von Schlüsseln für die Anwendung mit<br>Trägermedien und dort gespeicherten Informationen (Spezifikation, Imple<br>mentierung, Prüfung und Bereitstellung der spezifischen Algorithmen)                                               |                          |  |
|               | •<br>Einbringen der Schlüssel in spezifische SAM:                                                                                                                                                                                                                             |                          |  |
|               | •<br>SAM basierend auf sicherer Chip-HW entsprechend [HW_PP1] oder<br>[HW_PP2].                                                                                                                                                                                               |                          |  |
|               | •<br>SAM können nicht ausgelesen werden                                                                                                                                                                                                                                       |                          |  |
|               | •<br>Zur Aktivierung des SAM ist eine Authentisierung erforderlich                                                                                                                                                                                                            |                          |  |

<span id="page-107-0"></span>

| MK1 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Adressierte Gefährdungen |  |
|-----|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|     | Sichere Erzeugung und Einbringung von<br>Schlüsseln                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | GK1                      |  |
| 2   | Evaluierung durch Prüflabor:<br>•<br>Einsatz eines geeigneten Schlüsselgenerators gemäß [GSHB].<br>•<br>Sämtliche Schlüssel sind in einer sicheren Umgebung zu erzeugen, kryp<br>tographisch gesichert zu speichern und -abgesehen von definierten Aus<br>nahmen mit speziellen zusätzlichen Schutzmassnahmen- in der gesicherten<br>Umgebung auf das Trägermedium aufzubringen.<br>•<br>Erzeugung spezifischer Schlüssel mit definierten Eigenschaften entspre<br>chend der Spezifikation<br>•<br>Unterstützung des Diversifizierens von Schlüsseln für die Anwendung mit<br>Trägermedien und dort gespeicherten Informationen (Spezifikation, Imple<br>mentierung, Prüfung und Bereitstellung der spezifischen Algorithmen)<br>•<br>Einbringen der Schlüssel in spezifische SAM:<br>•<br>SAM basieren auf sicherer Chip-HW entsprechend [HW_PP1] oder<br>[HW_PP2].<br>•<br>SAM können nicht ausgelesen werden |                          |  |
|     | •<br>Zur Aktivierung des SAM ist eine Authentisierung erforderlich<br>Die Güte des Schlüsselgenerators ist von einem unabhängigen Prüflabor zu<br>bestätigen.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                          |  |
|     | Evaluierung und Zertifizierung nach CC oder einem gleichwertigen Verfahren                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                          |  |
|     | •<br>Einsatz eines geeigneten Schlüsselgenerators gemäß [GSHB].                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                          |  |
| 3   | •<br>Sämtliche Schlüssel sind in einer sicheren Umgebung zu erzeugen, kryp<br>tographisch gesichert zu speichern und -abgesehen von definierten Aus<br>nahmen mit speziellen zusätzlichen Schutzmassnahmen- in der gesicherten<br>Umgebung auf das Trägermedium aufzubringen.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                          |  |
|     | •<br>Erzeugung spezifischer Schlüssel mit definierten Eigenschaften entspre<br>chend der Spezifikation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                          |  |
|     | •<br>Unterstützung des Diversifizierens von Schlüsseln für die Anwendung mit<br>Trägermedien und dort gespeicherten Informationen (Spezifikation, Imple<br>mentierung, Prüfung und Bereitstellung der spezifischen Algorithmen)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                          |  |
|     | •<br>Einbringen der Schlüssel in spezifische SAM:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                          |  |
|     | •<br>SAM basieren auf sicherer Chip-HW entsprechend CC [HW_PP1] oder<br>[HW_PP2].                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                          |  |
|     | •<br>SAM können nicht ausgelesen werden                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                          |  |
|     | •<br>Zur Aktivierung des SAM ist eine Authentisierung erforderlich.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                          |  |
|     | Sämtliche Anforderungen sind zu evaluieren und nach CC, EAL4 Mechanis<br>menstärke hoch oder einem vergleichbaren Verfahren zu zertifizieren.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                          |  |

#### **Tabelle 8–63 Schutz durch sichere Erzeugung und Einbringung von Schlüsseln**

<span id="page-108-0"></span>

| MK2           | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Adressierte Gefährdungen |  |  |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|--|
|               | Einführung eines Schlüsselmanagement für<br>symmetrische und asymmetrische Schlüssel<br>mit ausreichender Schlüssellänge                                                                                                                                                                                                                                                                                                                                                                                                                                 | Alle GK                  |  |  |
|               | Ein Schlüsselmanagement ist bestimmt durch folgende Parameter:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                          |  |  |
| Allge<br>mein | •<br>Schlüssellänge<br>•<br>Verwendeter Algorithmus<br>•<br>Schlüsselspeicherung (siehe auch MK7)<br>•<br>Erzeugung von Schlüsseln (siehe MK1)                                                                                                                                                                                                                                                                                                                                                                                                           |                          |  |  |
|               | •<br>Schlüsselverteilung                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                          |  |  |
|               | •<br>Identifizierung von Schlüsseln                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                          |  |  |
|               | Technische und organisatorische Verzahnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                          |  |  |
|               | Schlüsselmanagementkonzept und Umsetzung                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                          |  |  |
|               | •<br>Schlüssel werden über IDs eindeutig identifiziert.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                          |  |  |
|               | •<br>Der Zweck des Schlüssels sowie dessen zugehörige Entität wird eindeutig<br>identifiziert (z. B. Produktanbieter-ID, Anwendungs-ID, Dienstleister-ID)                                                                                                                                                                                                                                                                                                                                                                                                |                          |  |  |
|               | •<br>Algorithmen zur Erzeugung von Schlüsseln sind entsprechend [ALGK_BSI]<br>(vorrangig) und [TR_ECARD] zu wählen.                                                                                                                                                                                                                                                                                                                                                                                                                                      |                          |  |  |
|               | •<br>Statische Schlüssel können generell nur in abgegrenzten, überschaubaren<br>Bereichen verwendet werden, wo ein Schlüsseltausch der Hauptkomponen<br>ten einfach möglich und die Anzahl an nach dem Tausch nicht mehr ver<br>wendbaren Trägermedien gering ist. Sollte ein statisches Verfahren zum<br>Einsatz kommen muss einhergehend ein sicherer Schlüsselnachladepro<br>zess definiert werden, der den Austausch der Schlüssel auf dem Träger<br>medium ermöglicht.<br>Die Empfehlung ist daher, der Einsatz abgeleiteter Schlüssel unter Verwen |                          |  |  |
|               | dung von eindeutigen Identifikationsnummern (z. B. Chipkarten-ID, UID und<br>einem Masterkey). Dies erzeugt komponentenindividuelle Schlüssel.                                                                                                                                                                                                                                                                                                                                                                                                           |                          |  |  |
| 1             | •<br>Die eingesetzte Schlüssellänge wird für die jeweiligen Funktionen individuell<br>bestimmt und spezifiziert. Grundsätzlich soll [ALGK_BSI] angewendet wer<br>den.                                                                                                                                                                                                                                                                                                                                                                                    |                          |  |  |
|               | •<br>Schlüssel sollten in Lesegeräten generell in gekapselten Sicherheitsmodu<br>len (SAM) gespeichert werden. Dies gilt insbesondere für offline-fähige<br>Terminals, Kontrollgeräte und Automaten. Auch für die Hintergrundsysteme<br>empfiehlt sich eine Speicherung in Sicherheitsmodulen wie z. B. SAM.                                                                                                                                                                                                                                             |                          |  |  |
|               | •<br>Schlüsselverteilung kann auf zwei Wegen erfolgen:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                          |  |  |
|               | a<br>Personalisierung von Schlüsseln in Trägermedien und Komponenten<br>in sicherer Umgebung und                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                          |  |  |
|               | b<br>Nachladen von Schlüsseln (siehe dazu MK8 - Nachladeprozess)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                          |  |  |
|               | •<br>Das Schlüsselmanagement wird vom Systemmanager konzipiert. Die betei<br>ligten Entitäten setzen ein Schlüsselmanagementkonzept um. Dazu gehört<br>auch, dass Verantwortliche für das Schlüsselmanagement existieren, um<br>auf korrekte Umsetzung zu achten sowie aktuelle Entwicklungen der Kryp<br>tographie zu beobachten, um Gefährdungen des Gesamtsystems frühzeitig<br>entgegenzuwirken.                                                                                                                                                     |                          |  |  |
| 2             | Schlüsselmanagementkonzept und Umsetzung (hochwertigere Verfahren)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                          |  |  |
|               | Zusätzlich zu den in 1 definierten Punkten werden in Stufe 2 in der Regel fol                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                          |  |  |

| MK2                                            | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                            | Adressierte Gefährdungen |  |
|------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
|                                                | Einführung eines Schlüsselmanagement für<br>symmetrische und asymmetrische Schlüssel<br>mit ausreichender Schlüssellänge                                                                                                                                                                 | Alle GK                  |  |
|                                                | gende Punkte umgesetzt:                                                                                                                                                                                                                                                                  |                          |  |
|                                                | •<br>Zusätzlich zur Erzeugung komponentenindividueller Schlüssel können zur<br>Kommunikation Session Keys ausgehandelt werden, die auf Basis änderba<br>rer Daten (z. B. Zufallszahlen) dynamisiert werden. Dies Verhindert wirksam<br>das Abhören oder Wiedereinspielen von Nachrichten |                          |  |
| Sicheres, flexibles Schlüsselmanagementkonzept |                                                                                                                                                                                                                                                                                          |                          |  |
| 3                                              | Zusätzlich zu den in 1 und 2 definierten Punkten kann für Stufe 3 folgendes<br>sinnvoll sein:                                                                                                                                                                                            |                          |  |
|                                                | •<br>Es wird ein komplexes asymmetrisches Key-Management-Verfahren mit<br>einer Root-CA, mehreren Sub-CAs und zertifizierten Authentifikations- und<br>Verschlüsselungsschlüsseln eingesetzt.                                                                                            |                          |  |
|                                                | •<br>Die Längen der asymmetrischen Schlüssel sollen grundsätzlich<br>[ALGK_BSI] (vorrangig) und [TR_ECARD] folgen.                                                                                                                                                                       |                          |  |
|                                                | Die Art und Stärke des zum Nachladen verwendeten Mechanismus ist an künf<br>tige Entwicklungen entsprechend [ALGK_BSI] anzupassen.                                                                                                                                                       |                          |  |

| Tabelle 8–64 | Schutz durch Einführung eines Schlüsselmanagements |
|--------------|----------------------------------------------------|
|--------------|----------------------------------------------------|

| MK3           | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Adressierte Gefährdungen |
|---------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|               | Zugriffschutz auf kryptographische Schlüssel<br>(Lese- und Schreibzugriff)                                                                                                                                                                                                                                                                                                                                                                                                                | GK2, GK3                 |
| Allge<br>mein | Spezifikation der Erfordernisse bzgl. Zugriffschutzes für alle Einsatzorte von<br>Schlüsseln unter Berücksichtigung des gültigen Rollenmodells.                                                                                                                                                                                                                                                                                                                                           |                          |
| 1             | Herstellererklärung:<br>•<br>Schlüssel und Passwörter auf den Trägermedien sind gegen das Auslesen<br>und Manipulationsangriffe geschützt.<br>•<br>Nach der Speicherung in SAM oder anderen sicheren Speichern für<br>Schlüssel in Systemkomponenten wird das Auslesen von Schlüssel durch<br>Softwaremaßnahmen unveränderbar gesperrt.<br>•<br>Nachladen von Schlüsseln wird gemäß MK8 ausgeführt.<br>Der Zugriffsschutz ist anhand von Herstellererklärungen zu belegen.                |                          |
| 2             | Evaluierung durch Prüflabor:<br>•<br>Schlüssel und Passwörter auf den Trägermedien sind gegen das Auslesen<br>und Manipulationsangriffe geschützt.<br>•<br>Nach der Speicherung in SAM oder anderen sicheren Speichern für<br>Schlüssel in Systemkomponenten wird das Auslesen von Schlüssel durch<br>Softwaremaßnahmen unveränderbar gesperrt.<br>•<br>Nachladen von Schlüsseln wird gemäß MK8 ausgeführt.<br>Der Zugriffsschutz ist anhand von Prüfberichten unabhängiger Prüflabore zu |                          |

<span id="page-110-0"></span>

| MK3 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Adressierte Gefährdungen |
|-----|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|     | Zugriffschutz auf kryptographische Schlüssel<br>(Lese- und Schreibzugriff)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | GK2, GK3                 |
|     | belegen.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                          |
| 3   | Evaluierung und Zertifizierung nach CC oder einem gleichwertigen Verfahren:<br>•<br>Schlüssel und Passwörter auf den Trägermedien sind gegen das Auslesen<br>und Manipulationsangriffe geschützt.<br>•<br>Nach der Speicherung in SAM oder anderen sicheren Speichern für<br>Schlüssel in Systemkomponenten wird das Auslesen von Schlüssel durch<br>Softwaremaßnahmen unveränderbar gesperrt.<br>•<br>Nachladen von Schlüsseln wird gemäß MK8 ausgeführt.<br>Der Zugriffsschutz ist anhand von Prüfberichten unabhängiger Prüflabore zu<br>belegen. Für Trägermedien und SAM wird eine Zertifizierung entsprechend CC<br>[HW_PP1] oder [HW_PP2] durchgeführt. |                          |

| Tabelle 8–65 | Schutz durch Zugriffsschutz auf kryptographische Schlüssel |
|--------------|------------------------------------------------------------|
|--------------|------------------------------------------------------------|

| MK4           | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                    | Adressierte Gefährdungen |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|               | Sicherung der Funktion der Sicherheitskom<br>ponenten                                                                                                                                                                                                                            | GK4                      |
| Allge<br>mein | Komponenten, die zur Speicherung und Verarbeitung von Schlüsseln - im Fol<br>genden auch Sicherheitskomponenten genannt - verwendet werden, sind hin<br>sichtlich Ihrer Vertrauenswürdigkeit zu überprüfen. Hierzu stehen je nach Stufe<br>verschiedene Maßnahmen zur Verfügung. |                          |
| 1             | Herstellererklärungen:                                                                                                                                                                                                                                                           |                          |
|               | •<br>Gewährleistung der Funktionssicherheit entsprechend der Spezifikation<br>durch interne Qualitätssicherung beim Hersteller.                                                                                                                                                  |                          |
| 2             | Prüfen nach Prüfspezifikation:                                                                                                                                                                                                                                                   |                          |
|               | •<br>Ausarbeitung von Prüfspezifikationen für die einzelnen Sicherheitskompo<br>nenten.                                                                                                                                                                                          |                          |
|               | •<br>Technische Überprüfung der Komponenten nach den jeweiligen Prüfvor<br>schriften.                                                                                                                                                                                            |                          |
|               | •<br>Spezifikation und Durchführung von Integrationstests in Test- und Wirkum<br>gebungen.                                                                                                                                                                                       |                          |
|               | Evaluierung:                                                                                                                                                                                                                                                                     |                          |
| 3             | Siehe 2, außerdem:                                                                                                                                                                                                                                                               |                          |
|               | •<br>Die Überprüfung der Sicherheitskomponenten erfolgt durch unabhängige<br>Prüflabore.                                                                                                                                                                                         |                          |
|               | •<br>Es erfolgt eine Zertifizierung der relevanten Sicherheitskomponenten durch<br>ein unabhängiges Institut.                                                                                                                                                                    |                          |
|               | •<br>Etablierung eines Freigabeprozesses für die Sicherheitskomponenten                                                                                                                                                                                                          |                          |

#### **Tabelle 8–66 Schutz durch Sicherung der Funktion der Sicherheitskomponenten**

<span id="page-111-0"></span>

| MK5             | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                   | Adressierte Gefährdungen |
|-----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|                 | Verfügbarkeit des Schlüsselmanagements<br>(Rückfalllösung)                                                                                                                                                      | GK4, GK5                 |
| 1               | Offlinefähigkeit und sicheres Backup:                                                                                                                                                                           |                          |
| 2               | •<br>Schlüssel müssen prinzipiell (zumindest temporär) auch autark ohne Hin<br>tergrundsystem bzw. bei Ausfall von Systemschnittstellen verfügbar sein.                                                         |                          |
|                 | •<br>Systemweite Schlüssel sind an mindestens zwei verschiedenen Stellen<br>(Original und Backup) räumlich getrennt voneinander in gesicherten Umge<br>bungen zu speichern.2                                    |                          |
|                 | •<br>Es ist zu gewährleisten, dass das Backup den gleichen Sicherheitsanforde<br>rungen wie das Original genügt.                                                                                                |                          |
|                 | •<br>Der Austausch defekter Schlüsselkomponenten ist zu regeln.                                                                                                                                                 |                          |
|                 | Umsetzung nach Rückfallkonzept und Backup von Schlüsseln im Trustcenter:                                                                                                                                        |                          |
| Siehe 1, zudem: |                                                                                                                                                                                                                 |                          |
| 3               | •<br>Es muss ein Systemkonzept erstellt werden, dass die Verfügbarkeit und<br>Rückfalllösungen mit Verfügbarkeitszeiten sowie die Abstimmung zwischen<br>den Entitäten explizit festlegt                        |                          |
|                 | •<br>Kritische Komponenten müssen über eine USV und weitere Sicherungsme<br>chanismen (wie RAID) verfügen, so dass der Ausfall von Teilkomponenten<br>die Verfügbarkeit des Gesamtsystems nicht beeinträchtigt. |                          |
|                 | •<br>Es muss eine ausreichende Anzahl von Austausch-Systemkomponenten<br>(im Cold- oder Warm-Standby) zur Verfügung stehen, so dass die geforder<br>te Verfügbarkeit erfüllt werden kann.                       |                          |
|                 | •<br>Das Backup der systemweiten Schlüssel ist durch das Trustcenter zu reali<br>sieren.                                                                                                                        |                          |

| Tabelle 8–67 | Schutz durch Verfügbarkeit des Schlüsselmanagements |
|--------------|-----------------------------------------------------|
|              |                                                     |

|               | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                            | Adressierte Gefährdungen  |  |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|--|
| MK6           | Definition des Verhaltens im Kompromittie<br>rungsfall von Schlüsseln                                                                                                                                                                                                    | GK5, allgemeines Vorgehen |  |
| Allge<br>mein | Die Maßnahme ist unabhängig von möglichen Maßnahmen zur Unterbindung<br>der Kompromittierung zu sehen.                                                                                                                                                                   |                           |  |
|               | Kompromittierung von diversifizierten Schlüsseln:                                                                                                                                                                                                                        |                           |  |
| 1             | •<br>Das betroffene Kundenmedium wird eingezogen und gesperrt.                                                                                                                                                                                                           |                           |  |
| 2             | Kompromittierung von nicht diversifizierten Schlüsseln                                                                                                                                                                                                                   |                           |  |
| 3             | •<br>Auf den SAMs und Trägermedien werden zu jedem Schlüssel Regulär- und<br>Notfallversion hinterlegt. Im Kompromittierungsfall werden die Schlüssel auf<br>den Sicherheitsmodulen umgeschaltet, so dass ab dann nur noch die Not<br>fallversion verwendet werden kann. |                           |  |
|               | •<br>Bei jeder Kommunikation eines RFID-Trägermediums mit dem Terminal                                                                                                                                                                                                   |                           |  |

<sup>2</sup> Unter systemweiten Schlüsseln sind alle symmetrischen Schlüssel sowie die nichtkartenindividuellen asymmetrischen Schlüssel zu verstehen.

<span id="page-112-0"></span>

| MK6 | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                         | Adressierte Gefährdungen  |
|-----|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|
|     | Definition des Verhaltens im Kompromittie<br>rungsfall von Schlüsseln                                                                                                                                                                                                                                                                                 | GK5, allgemeines Vorgehen |
|     | wird – sofern noch nicht geschehen – im Trägermedium anstelle der Regu<br>lärversion die Notfallversion verwendet. Hierzu sind im Trägermedium ge<br>eignete Mechanismen bereit zu halten, die eine spätere Verwendung der<br>Regulärversion unterbinden.                                                                                             |                           |
|     | •<br>Sind die Sicherheitsmodule insgesamt kompromittiert und ist keine Notfall<br>version der Schlüssel vorhanden, so sind die Sicherheitsmodule und damit<br>auch die Trägermedien umgehend auszutauschen. Bis zum kompletten<br>Austausch der Sicherheitsmodule und Trägermedien sind die Daten im Sys<br>tem als nicht vertrauenswürdig anzusehen. |                           |

#### **Tabelle 8–68 Schutz durch Definition des Verhaltens bei Kompromittierung von Schlüsseln**

| MK7 | Kurzbezeichnung der Maßnahmen                                                                                                                                   | Adressierte Gefährdungen |
|-----|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|     | Trennung von Schlüsseln                                                                                                                                         | GK2, GK3                 |
| 1   | Getrennte Speicherung und Verarbeitung von Schlüsseln                                                                                                           |                          |
| 2   | Um Fehlfunktionen und den Missbrauch von Schlüsselmaterial zu vermeiden,<br>sind die Applikationen in allen Komponenten des Systems voneinander zu tren<br>nen. |                          |
| 3   |                                                                                                                                                                 |                          |

| Tabelle 8–69 | Schutz durch Trennung von Schlüsseln |  |
|--------------|--------------------------------------|--|
|--------------|--------------------------------------|--|

|               | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Adressierte Gefährdungen |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
| MK8           | Nachladen von Schlüsseln - Sichern der Be<br>rechtigungen hinsichtlich Authentizität und<br>Integrität                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | GK3                      |
| Allge<br>mein | Schlüssel sollten eindeutig mit einer Anwendung oder einer Berechtigung ver<br>bunden sein und im Rahmen des Aufbringens der Anwendung bzw. Berechti<br>gung vom SAM abgeleitet in das Trägermedium einbebracht werden. Ein autar<br>ker Nachladeprozess für Schlüssel ist insbesondere für SAMs relevant und in<br>allen Stufen sinnvoll.                                                                                                                                                                                                                                                                                                                                                                                  |                          |
| 1             | Einfaches Authentifikationskonzept                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                          |
| 2             | I. Vorbemerkung<br>1<br>Schlüsseln muss eine eindeutige Kennung zugewiesen werden. Diese<br>muss eine Information zur herausgebenden Organisation, eine eindeutige<br>ID und eine Versionsnummer beinhalten.<br>2<br>Es sollte Möglichkeiten geben, aufgebrachte Schlüssel zu löschen oder zu<br>sperren.<br>3<br>Das Nachladen von Schlüsseln auf das SAM wird vom Systemmanager<br>oder dessen Beauftragten von einem Schlüsselmanagement durchgeführt<br>und setzt zwangsläufig eine Onlineverbindung voraus.<br>4<br>Schlüssel sind in jedem Fall vertraulich einzubringen. Hierzu muss ein Ent<br>schlüsselungsschlüssel auf dem SAM vorliegen.<br>5<br>Zum Nachladen wird ein symmetrisches Verfahren verwendet. Beim |                          |

<span id="page-113-0"></span>

|     | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                   | Adressierte Gefährdungen |  |
|-----|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|--|
| MK8 | Nachladen von Schlüsseln - Sichern der Be<br>rechtigungen hinsichtlich Authentizität und<br>Integrität                                                                                                                                                                                                                                                                                                                                                          | GK3                      |  |
|     | Schlüsselherausgeber liegt hierzu ein symmetrischer Masterschlüssel<br>KM_Storekey vor und in den SAMs sind hieraus abgeleitete kartenindividu<br>elle Schlüssel hinterlegt (siehe II.)                                                                                                                                                                                                                                                                         |                          |  |
|     | II. Allgemeine Vorgehensweise                                                                                                                                                                                                                                                                                                                                                                                                                                   |                          |  |
|     | Das Nachladen von Schlüsseln erfolgt nach folgendem Schema:<br>1<br>Das Trägermedium sendet seine ID an das Terminal, das diese an das<br>SAM weiterleitet.<br>2<br>Das SAM leitet hiermit aus dem Masterschlüssel KM_Storekey den karten<br>individuellen Schlüssel K_Storekey ab.<br>3<br>Mittels des Schlüssels K_Storekey wird eine Authentifikation zwischen SAM<br>und Kundenmedium durchgeführt. Hierbei wird ein gemeinsamer Session<br>key vereinbart. |                          |  |
|     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                          |  |
|     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                          |  |
|     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                          |  |
|     | 4<br>Nach erfolgreicher Authentifikation werden die Schlüssel mit dem Session<br>key verschlüsselt in das SAM eingebracht.                                                                                                                                                                                                                                                                                                                                      |                          |  |
|     | Komplexes Authentifikationskonzept                                                                                                                                                                                                                                                                                                                                                                                                                              |                          |  |
|     | I. Vorbemerkung                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                          |  |
|     | 1<br>Schlüsseln muss eine eindeutige Kennung zugewiesen werden. Diese<br>muss eine Information zur herausgebenden Organisation, eine eindeutige<br>ID und eine Versionsnummer beinhalten.                                                                                                                                                                                                                                                                       |                          |  |
|     | 2<br>Es sollte Möglichkeiten geben, aufgebrachte Schlüssel zu löschen oder zu<br>sperren.                                                                                                                                                                                                                                                                                                                                                                       |                          |  |
|     | 3<br>Das Nachladen von Schlüsseln auf das SAM wird vom Systemmanager<br>oder dessen Beauftragten von einem Schlüsselmanagement durchgeführt<br>und setzt zwangsläufig eine Onlineverbindung voraus.                                                                                                                                                                                                                                                             |                          |  |
|     | 4<br>Schlüssel sind in jedem Fall vertraulich einzubringen. Hierzu muss ein Ent<br>schlüsselungsschlüssel auf dem SAM vorliegen.                                                                                                                                                                                                                                                                                                                                |                          |  |
| 3   | 5<br>Das Nachladen von Schlüsseln in ein SAM wird ein asymmetrisches Ver<br>fahren verwendet. Hierzu ist eine PKI mit einer CA zu etablieren, durch die<br>alle asymmetrischen Schlüssel zertifiziert werden.                                                                                                                                                                                                                                                   |                          |  |
|     | II. Allgemeine Vorgehensweise                                                                                                                                                                                                                                                                                                                                                                                                                                   |                          |  |
|     | Das Nachladen von Schlüsseln kann z. B. nach folgendem Verfahren erfolgen:                                                                                                                                                                                                                                                                                                                                                                                      |                          |  |
|     | 1<br>Der Schlüsselherausgeber (bzw. Schlüsselmanagement) sendet seinen von<br>einer CA zertifizierten öffentlichen Schlüssel an das Terminal                                                                                                                                                                                                                                                                                                                    |                          |  |
|     | 2<br>Das SAM verifiziert das Zertifikat (z. B. mit Verify Certificate) und speichert<br>den öffentlichen Schlüssel des Schlüsselherausgebers temporär.                                                                                                                                                                                                                                                                                                          |                          |  |
|     | 3<br>Der Schlüsselherausgeber verschlüsselt den einzubringenden Schlüssel<br>sowie dessen Zusatzinformationen (Key-ID, Keyversion, Bedienzähler, …)<br>mit dem öffentlichen Verschlüsselungsschlüssel des SAM, signiert das<br>Kryptogramm mit dem eigenen privaten Schlüssel und sendet Kryptogramm                                                                                                                                                            |                          |  |

|     | Kurzbezeichnung der Maßnahmen                                                                                                                                                                                                                                                                                              |  | Adressierte Gefährdungen |
|-----|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--------------------------|
| MK8 | Nachladen von Schlüsseln - Sichern der Be<br>rechtigungen hinsichtlich Authentizität und<br>Integrität                                                                                                                                                                                                                     |  | GK3                      |
|     | und Signatur an das SAM.<br>4<br>Das SAM prüft die Signatur mit dem öffentlichen Signaturschlüssel des<br>Schlüsselherausgebers, entschlüsselt nach erfolgreicher Signaturprüfung<br>das Kryptogramm mit seinem privaten Entschlüsselungsschlüssel und spei<br>chert Schlüssel und Schlüsselzusatzinformationen permanent. |  |                          |
|     |                                                                                                                                                                                                                                                                                                                            |  |                          |

**Tabelle 8–70 Schutz durch Sicherung der Authentizität und Integrität beim Nachladen von Schlüsseln** 

# <span id="page-115-0"></span>**9 Definition produktspezifischer Einsatzszenarien**

Die in den Kapiteln [6](#page-32-1) und [7](#page-41-1) beschriebenen Prozesse sollen für die Umsetzung spezieller Produkte exemplarisch betrachtet werden.

Dabei soll ein Produktmix verwendet werden, wie er im öffentlichen Fern- und Nahverkehr üblicherweise auftreten kann.

Folgende Produkte sollen betrachtet werden:

- 1 Mehrfahrtenberechtigung Nahbereich (Wert von max. 20€, nicht interoperabel)
- 2 Interfunktionsfähige Fahrpreisermittlung und Multiapplikationsfähigkeit

In Kapitel [11](#page-151-1) sollen die ausgewählten Einsatzszenarien für diese Produkte näher beschrieben werden.

# **9.1 Einsatzszenario "Interfunktionsfähige, personalisierte Dauerberechtigung mit automatischer Fahrpreisermittlung"**

### Produkt

Der Erwerb dieses personalisierten Produkts berechtigt zur Inanspruchnahme jeder beliebigen Beförderungsleistung in jedem Gebiet und auf jeder Strecke. Die Berechtigung ist interoperabel. Das heißt, sie gilt zu jeder Zeit bei allen Dienstleistern, die die spezielle Anwendung und Produkt unterstützen. Der Kunde muss sich bei Beginn der Fahrt mit seinem NFC-Mobiltelefon an einem lokalen Transponder einchecken und nach Beendigung der Beförderung wieder auschecken. Der Fahrpreis wird automatisch entsprechend der lokalen Tarife ermittelt.

Das Implementierungsbeispiel für dieses Produkt liefert die VDV Kernapplikation. Der Kunde kann bei allen ÖPV-Dienstleistern, die kompatible Kontrolltechnik einsetzen, ohne Kenntnis der Tarife und Zonen die Beförderungsleistung in Anspruch nehmen.

### Kommerzieller Wert

Der kommerzielle Wert der Berechtigung kann zwischen einigen 10 und mehreren 1000€ variieren.

### Trägermedien

Folgende Trägermedien können zur Nutzung der Berechtigung eingesetzt werden:

| Trägermedium     | Verwendungsmodell                                                                                                                                               | Eigenschaften                                                                                                                                                                               |
|------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| NFC-Mobiltelefon | Laden der personalisierten An<br>wendung und der Berechtigung<br>in den sicheren Speicher. Nach<br>laden von Anwendungen und<br>Produkten im Feld erforderlich. | Gespeicherte Daten:<br>Anwendung inkl. Personenda<br>ten, 1 Berechtigung, ggf. Be<br>zahlart.<br>Weitere Anwendungen evtl.<br>vorhanden -> Multiapplikation<br>Im Display angezeigte Daten: |

<span id="page-116-0"></span>

| Trägermedium | Verwendungsmodell | Eigenschaften                                    |
|--------------|-------------------|--------------------------------------------------|
|              |                   | Gültigkeitsbereich und –dauer,<br>Nutzungsstatus |

#### **Tabelle 9–1 Trägermedien für die Nutzung der "Interfunktionsfähigen Dauerberechtigung mit automatischer Fahrpreisermittlung"**

Relevante Prozesse

Der übliche Anwendungsfall ist das Nachladen der Anwendung und der Berechtigung auf ein existierendes NFC-Mobiltelefon.

Es ist allerdings auch denkbar, dass neue NFC-Mobiltelefone mit diesem Produkt ausgegeben werden. Deshalb soll dieser Fall ebenfalls betrachtet werden.

| Folgende Prozesse aus Kapitel 6 müssen pro Trägermedium betrachtet werden: |  |  |
|----------------------------------------------------------------------------|--|--|

| Trägermedium                 | Relevante Prozesse                                       | Bemerkungen                                                                                                                                         |  |
|------------------------------|----------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Sicheres NFC<br>Mobiltelefon | P1A.1, P1A.2, P1A.3, P1A.4<br>P2A.1, P2A.2, P2A.3, P2A.4 | Nachladen von Anwendung und<br>Produkten "Over-the-Air" und über<br>die kontaktlose Schnittstelle.                                                  |  |
|                              | P3.2                                                     | Die Prozesse P2A.1 – P2A.3 sind<br>nur relevant, wenn ein initialisiertes<br>und mit Berechtigung versehenes<br>NFC-Mobiltelefon ausgeliefert wird. |  |

**Tabelle 9–2 Relevante Prozesse für die Nutzung der Dauerberechtigung mit automatischer Fahrpreisermittlung** 

# Implementierung

Es wird in diesem Einsatzszenario davon ausgegangen, dass während Check-In- und Check-Out-Prozesses nur zeitweise eine Online-Verbindung zum Kontrollserver besteht. És werden demzufolge die Anwendungsfälle "Offline-Check-In" und "Offline-Check-Out" betrachtet.

# **9.2 Einsatzszenario "Mehrfahrtenberechtigung Nahbereich"**

# Berechtigung

Der Erwerb des Produkts "Mehrfahrtenberechtigung Nahbereich" berechtigt zur mehrfachen Nutzung für Einzelfahrten im Nahverkehr innerhalb eines Verbundes. Interfunktionsfähigkeit ist hier nicht gefordert. Die Berechtigung ist nicht personalisiert.

### Kommerzieller Wert

Der kommerzielle Wert beträgt normalerweise weniger als 20 €. Sollte dieser Wert überschritten werden, dann sollten entsprechende Lösungen für die Komponenten zum Einsatz kommen.

Trägermedien

<span id="page-117-0"></span>

| Trägermedium     | Verwendungsmodell                                                                                                      | Eigenschaften                                                                                                                                                                                   |
|------------------|------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| NFC-Mobiltelefon | Laden der anonymen Anwen<br>dung, der Berechtigung und der<br>Sitzplatzdaten in den sicheren<br>Speicher Over-the-Air. | Gespeicherte Daten:<br>Anwendung, 1 Berechtigung.<br>Weitere Anwendungen evtl.<br>vorhanden -> Multiapplikation<br>Im Display angezeigte Daten:<br>Gültigkeitsbereich und –dauer,<br>Entwertung |

**Tabelle 9–3 Trägermedien für die Nutzung der Mehrfahrtenberechtigung Nahbereich** 

Relevante Prozesse

Der übliche Anwendungsfall ist das Nachladen der Anwendung und der Berechtigung auf ein existierendes NFC-Mobiltelefon. Es ist nicht zu erwarten, dass neue NFC-Mobiltelefone mit diesem Produkt ausgegeben werden. Deshalb soll dieser Fall nicht betrachtet werden.

Folgende Prozesse aus Kapitel [6](#page-32-1) müssen pro Trägermedium betrachtet werden:

| Trägermedium     | Prozessnummern                              | Bemerkungen                                                                                                                                                                                                                                                                                  |
|------------------|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| NFC-Mobiltelefon | P1B.1, P1B.2, P1B.3<br>P2B.2, P2B.3<br>P3.2 | Existierendes personalisiertes<br>NFC-Mobiltelefon. Nachladen der<br>anonymen Anwendung und Be<br>rechtigung nach P2B.2 "Over<br>theAir" oder über die kontaktlose<br>Schnittstelle. Über P2B.3 Nachla<br>den der Berechtigung "Over-the<br>Air" oder über die kontaktlose<br>Schnittstelle. |

**Tabelle 9–4 Relevante Prozesse für die Nutzung der Mehrfahrtenberechtigung Nahbereich** 

### Implementierung

Es wird in diesem Einsatzszenario davon ausgegangen, dass während des gesamten Check-In- und Check-Out-Prozesses eine Online-Verbindung zum Kontrollserver besteht. És werden demzufolge die Anwendungsfälle "Online-Check-In" und "Online-Check-Out" betrachtet.

# <span id="page-118-1"></span><span id="page-118-0"></span>**10 Umsetzungsvorschläge zum Gesamtsystem**

In diesem Kapitel wird das Gesamtsystem für das Einsatzgebiet "NFC-basiertes eTicketing" exemplarisch beschrieben.

Das Gesamtsystem besteht aus der eTicketing-Infrastruktur und den Trägermedien, also den NFC-Mobiltelefonen. Unter dem Begriff eTicketing-Infrastruktur werden alle von den Produktanbietern, den Dienstleistern und dem Systemmanager installierten Systemkomponenten und deren Schnittstellen zusammengefasst.

Die hier vorgestellte Lösung kann die vorstehend genannten Rollenbeschreibungen, Prozesse und Einsatzszenarien in der maximalen Komplexität abdecken. Bei speziellen Implementierungen im Feld sind auch andere Varianten denkbar. Insbesondere werden Vereinfachungen im Rollenmodell, bei der Anzahl der verschiedenen Medien, Anwendungen, Produkte und Zahl der involvierten ÖPV-Entitäten auch Vereinfachungen im System und den Prozessen zur Folge haben.

Der Schwerpunkt der Betrachtung und der Vorschläge zu Schutzmaßnahmen liegt auf der Implementierung der RF-Schnittstelle und der direkt verbundenen Komponenten NFC-Mobiltelefon, lokaler Transponder und Kontrollgerät.

Die folgende Abbildung zeigt das Gesamtsystem und dessen wesentliche Komponenten.

![](_page_118_Figure_7.jpeg)

#### **Abbildung 10–1 Exemplarische Darstellung des Gesamtsystems "NFC-basiertes eTicketing"**

<span id="page-118-2"></span>Die Systemdarstellung der Referenzimplementierung "Touch & Travel" ist in der [Abbildung](#page-119-1)  [10–2](#page-119-1) dargestellt:

<span id="page-119-0"></span>![](_page_119_Figure_1.jpeg)

**Abbildung 10–2 Systemdarstellung der Referenzimplementierung "Touch & Travel"** 

# <span id="page-119-1"></span>**10.1 Umsetzungsvorschläge zur eTicketing-Infrastruktur**

# <span id="page-119-2"></span>**10.1.1 Ermittlung des Schutzbedarfs für die eTicketing-Infrastruktur**

Für die eTicketing-Infrastruktur sollen folgende Randbedingungen gelten, die in die Bestimmung des Schutzbedarfs einfließen sollen:

- 1 Die Systeme aus [Abbildung 10–1](#page-118-2) sollen verschiedene Produkte entsprechend den vorgeschlagenen Einsatzszenarien gleichzeitig unterstützen.
- 2 Personenbezogenen Daten müssen verwaltet und bearbeitet werden.
- 3 Nutzungsdaten fallen an und müssen verarbeitet werden.
- 4 Abrechnungsdaten müssen erhoben und weitergeleitet werden sofern Anwendungen und Produkte "Automatische Fahrpreisberechnung" unterstützt werden. Interfunktionsfähigkeit ist gefordert.
- 5 Optional soll auch der Fall betrachtet werden, bei dem Interfunktionsfähigkeit durch Vereinbarungen der Entitäten sichergestellt wird.

Basierend auf den in Kapitel [8.2.5](#page-64-1) dargelegten Kriterien kann die eTicketing-Infrastruktur folgenden Schutzbedarfsklassen zugeordnet werden:

| Sicherheitsziel |                              | Schutz<br>bedarfs<br>klasse | Kriterien zur Einordnung in Schutzbedarfsklassen                                                  |
|-----------------|------------------------------|-----------------------------|---------------------------------------------------------------------------------------------------|
| SF1             | Technische<br>Kompatibilität | 1                           | Alle Systemkomponenten sind vom gleichen Lieferan<br>ten. Der Lieferant sorgt für Kompatibilität. |

| Sicherheitsziel |                                                                                                  | Schutz<br>bedarfs<br>klasse | Kriterien zur Einordnung in Schutzbedarfsklassen                                                                                                                                                                          |  |
|-----------------|--------------------------------------------------------------------------------------------------|-----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|                 |                                                                                                  | 2                           | System muss mit Komponenten von wenigen definier<br>ten Lieferanten funktionieren. Der Systemmanager<br>oder ein SI sorgen für Kompatibilität.                                                                            |  |
|                 |                                                                                                  |                             | Offenes System, dass mit Komponenten von allen<br>Marktteilnehmern funktionieren soll.                                                                                                                                    |  |
|                 |                                                                                                  | 3                           | System wird üblicherweise durch eine offene Aus<br>schreibung beschafft.                                                                                                                                                  |  |
|                 |                                                                                                  | 1                           | Fehlfunktion betrifft einzelne Kunden                                                                                                                                                                                     |  |
|                 |                                                                                                  | 2                           | Fehlfunktion betrifft größere Kundenmenge                                                                                                                                                                                 |  |
| SF2             | Rückfalllösung<br>bei Fehlfunkti                                                                 | 3                           | Fehlfunktion betrifft eine großen Teil der Kunden                                                                                                                                                                         |  |
|                 | onen                                                                                             |                             | Fehlfunktionen des Systems (Verkaufssystem, lokale<br>Transponder, Mobilnetz, Kontrollsystem, Schlüssel<br>management) betreffen eine große Menge an Kunden<br>und Berechtigungen.                                        |  |
|                 |                                                                                                  | 1                           | Intuitiv nicht bedienbar von einzelne Kunden                                                                                                                                                                              |  |
|                 | Intuitive, feh<br>lertolerante<br>Nutzung                                                        | 2                           | Intuitiv nicht bedienbar von größeren Kundenmengen                                                                                                                                                                        |  |
| SF3             |                                                                                                  | 3                           | Intuitiv nicht bedienbar von einem großen Teil der<br>Kunden                                                                                                                                                              |  |
|                 |                                                                                                  |                             | Das Prinzip des Check-in / Check-out muss allen<br>Kunden vertraut sein.                                                                                                                                                  |  |
|                 | Schutz der<br>personenbe<br>zogenen Da<br>ten (inkl. per<br>sonenbezoge<br>ne Nutzungs<br>daten) | 1                           | Kunde wird in seinem Ansehen geschädigt.                                                                                                                                                                                  |  |
|                 |                                                                                                  | 2                           | Kunde wird in seiner sozialen Existenz geschädigt.                                                                                                                                                                        |  |
| SI1             |                                                                                                  |                             | Sofern im System gespeicherte personengebundenen<br>Abrechnungsinformationen oder Zahlungsdaten ent<br>wendet oder manipuliert werden, können erhebliche<br>kommerzielle und soziale Folgen für den Kunden ein<br>treten. |  |
|                 |                                                                                                  | 3                           | Kunde wird in seiner physischen Existenz geschädigt.                                                                                                                                                                      |  |
| SI2             | Schutz der<br>Berechtigun<br>gen                                                                 | 1                           | Erwarteter produktbezogener Umsatzverlust durch<br>Fälschung, Stören oder Manipulation <0.5%                                                                                                                              |  |
|                 |                                                                                                  | 2                           | Erwarteter produktbezogener Umsatzverlust durch<br>Fälschung, Stören oder Manipulation <3%                                                                                                                                |  |
|                 |                                                                                                  |                             | Erwarteter produktbezogener Umsatzverlust durch<br>Fälschung, Stören oder Manipulation >3%                                                                                                                                |  |
|                 |                                                                                                  | 3                           | DoS-Angriffe auf das System können zur Störung des<br>gesamten Betriebs führen und damit erhebliche kom<br>merzielle Einbussen verursachen.                                                                               |  |

| Sicherheitsziel |                                                                     | Schutz<br>bedarfs<br>klasse | Kriterien zur Einordnung in Schutzbedarfsklassen                                                                                                                                                                                                                   |
|-----------------|---------------------------------------------------------------------|-----------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                 | Schutz der<br>Logistikdaten<br>(anonymisierte<br>Nutzungsda<br>ten) | 1                           | Daten werden Dritten bekannt                                                                                                                                                                                                                                       |
|                 |                                                                     |                             | Daten gehen verloren                                                                                                                                                                                                                                               |
| SI3             |                                                                     | 2                           | Der Verlust der Logistikdaten kann auch durch techni<br>sche Defekte auftreten und zu betrieblichen Schwie<br>rigkeiten führen.                                                                                                                                    |
|                 |                                                                     | 3                           | Daten werden verfälscht.                                                                                                                                                                                                                                           |
|                 |                                                                     | 1                           | Daten sind zeitweise nicht verfügbar                                                                                                                                                                                                                               |
|                 | Zuverlässige                                                        | 2                           | Daten sind verloren                                                                                                                                                                                                                                                |
| SI4             | Abrechnung                                                          |                             | Daten wurden verfälscht, missbraucht, etc                                                                                                                                                                                                                          |
|                 | (personalisiert)                                                    | 3                           | In einem System mit mehreren Akteuren, die sich nicht<br>vertrauen, ist Abrechnungsbetrug zwischen den Ak<br>teuren nicht auszuschließen.                                                                                                                          |
| SI5             | Schutz von<br>Anwendungen<br>und Berechti<br>gungen                 | 1                           | Anwendungen werden vom selben Anwendungsher<br>ausgeber und Berechtigungen vom selben Produktei<br>gentümer herausgegeben.                                                                                                                                         |
|                 |                                                                     | 2                           | Anwendungen werden von unterschiedlichen Anwen<br>dungsherausgebern und Berechtigungen von unter<br>schiedlichen Produkteigentümern, Produktanbietern<br>und Dienstleistern herausgegeben. Mehrere Unter<br>nehmen kooperieren und "vertrauen" sich gegenseitig.   |
|                 |                                                                     | 3                           | Anwendungen werden von unterschiedlichen Anwen<br>dungsanbietern und Berechtigungen von unterschied<br>lichen Produkteigentümern, Produktanbietern und<br>Dienstleistern herausgegeben. Mehrere Unternehmen<br>kooperieren und "vertrauen" sich nicht gegenseitig. |
|                 |                                                                     |                             | Beim Aufbringen der Berechtigung NFC-Mobiltelefone<br>ist grundsätzlich davon auszugehen, dass sich An<br>wendungen fremder Akteure auf dem Kundenmedium<br>befinden.                                                                                              |
| SP3             | Datenspar<br>samkeit                                                | 1                           | Es werden keine personenbezogenen Daten verwen<br>det.                                                                                                                                                                                                             |
|                 |                                                                     | 2                           | Es werden personenbezogene Daten verwendet, aber<br>keine Nutzungsdaten gesammelt.                                                                                                                                                                                 |
|                 |                                                                     | 3                           | Es werden personenbezogene Daten und personen<br>bezogene Nutzungs- und Abrechnungsdaten verwen<br>det.                                                                                                                                                            |

<span id="page-122-0"></span>

| Sicherheitsziel |                                                          | Schutz<br>bedarfs<br>klasse | Kriterien zur Einordnung in Schutzbedarfsklassen    |
|-----------------|----------------------------------------------------------|-----------------------------|-----------------------------------------------------|
| SP4             | Schutz vor der<br>Erzeugung von<br>Bewegungs<br>profilen | 1                           | Kunde wird in seinem Ansehen geschädigt             |
|                 |                                                          | 2                           | Kunde wird in seiner sozialen Existenz geschädigt   |
|                 |                                                          | 3                           | Kunde wird in seiner physischen Existenz geschädigt |

**Tabelle 10–1 Schutzbedarf des Systems** 

# <span id="page-122-1"></span>**10.1.2 Schnittstellen des Gesamtsystems**

Das in [Abbildung 10–1](#page-118-2) dargestellte System ist auf ein Zusammenspiel aller Systemkomponenten angewiesen. Um die in Kapitel [6](#page-32-1) dargestellten Geschäftsprozesse abbilden zu können, müssen die technischen Schnittstellen und die operative Interaktion zwischen den Komponenten spezifiziert werden.

Weiterhin sind Vereinbarungen zwischen den Entitäten zu treffen, die die Verantwortlichkeiten und die betrieblichen Abläufe regeln.

# **10.1.2.1 Relevante Gefährdungen für die eTicketing Infrastruktur**

Aufgrund der Sicherheitsziele zur Ermittlung des Schutzbedarfs aus Kapitel [10.1.1](#page-119-2) lassen sich für die Schnittstellen des Gesamtsystems folgende relevanten Gefährdungen benennen.

| Gefährdungen der kontaktlo<br>se Schnittstelle |                                                                                 | Schutz<br>bedarf | Bemerkungen                                                                                                                                                                                                                                                                                                                |
|------------------------------------------------|---------------------------------------------------------------------------------|------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GIF1                                           | Mangelnde Kompa<br>tibilität der Schnitt<br>stellen Trägermedi<br>um -Lesegerät | 3                | Mangelnde Kompatibilität der Schnittstellen<br>führt zu Nichtfunktion beim Aufbringen und der<br>Nutzung von Berechtigungen, der Kontrolle,<br>etc. Das Resultat ist ähnlich einer DoS-Angriff<br>auf das System. Eine Vielzahl von Kunden<br>bzw. Berechtigungen wäre möglicherweise<br>betroffen.                        |
| GIF2                                           | Abhören                                                                         | 3                | Unberechtigtes Belauschen der Kommunikati<br>on zwischen einem Trägermedium und einem<br>Lesegerät.                                                                                                                                                                                                                        |
| GIF3                                           | DoS-Angriff auf die<br>RF-Schnittstelle                                         | 1                | 1<br>Stören der RFID-Kommunikation (Jam<br>ming)<br>2<br>Stören des Antikollisionsmechanismus zur<br>Selektierung des Trägermediums (Blocker<br>Tag)<br>3<br>Abschirmung des elektromagnetischen<br>Feldes des Lesegerätes (Shielding)<br>4<br>Verstimmen der Resonanzfrequenz von<br>Reader oder Trägermedium (De-Tuning) |

| Tabelle 10–2 | Relevante Gefährdungen der kontaktlosen Schnittstelle |
|--------------|-------------------------------------------------------|
|--------------|-------------------------------------------------------|

<span id="page-123-0"></span>

| Gefährdungen des Gesamt<br>systems |                                                           | Schutz<br>bedarf | Bemerkungen                                                                                                                                                                                                                                                                                                                                                                                        |
|------------------------------------|-----------------------------------------------------------|------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GS1                                | Fehlen einer Rück<br>falllösung                           | 3                | Das Fehlen einer Rückfalllösung beim Ausfall<br>von Systemschnittstellen wie Ticketverkaufs<br>system, Verwaltungssystem für Trägermedien<br>und Berechtigungen, Kontrollsystem kann zu<br>Komplettausfällen von Services führen (Ver<br>kauf, Abrechnung, Akzeptanz, etc)                                                                                                                         |
| GS2                                | Unberechtigtes Aus<br>lesen von Referenz<br>daten         | 3                | Zwischen den Systemkomponenten werden<br>Schlüssel sowie Informationen zu den Medien,<br>den Berechtigungen, der Nutzung sowie ggf.<br>personenbezogene Daten und Abrechnungs<br>daten über Schnittstellen übertragen. Das Aus<br>lesen dieser Daten durch Unberechtigte würde<br>das System diskreditieren und die Möglichkeit<br>für Angriffe schaffen.                                          |
| GS3                                | Manipulieren von<br>Referenzdaten im<br>System            | 3                | Zwischen den Systemkomponenten werden<br>Schlüssel sowie Informationen zu den Medien,<br>den Berechtigungen, der Nutzung sowie ggf.<br>personenbezogene Daten und Abrechnungs<br>daten über Schnittstellen übertragen. Das Ma<br>nipulieren dieser Daten durch Unberechtigte ist<br>ein schwerwiegender Angriff.                                                                                   |
| GS4                                | Fehlfunktion des<br>Systems                               | 3                | Fehlfunktionen der Schnittstellen zwischen den<br>Systemen können durch technische Fehler,<br>Fehlbedienung oder DoS-Angriffe in verschie<br>denen Szenarien herbeigeführt werden:<br>1<br>Störung der Schnittstellen<br>2<br>Mangelnde Verfügbarkeit der Schnittstel<br>len<br>3<br>Fehler in der Stromversorgung<br>4<br>Unterbrechung der Anbindung an das<br>Netz<br>5<br>Physische Zerstörung |
| GS5                                | Mangelnde Kompa<br>tibilität der Schnitt<br>stellen       | 3                | Mangelnde Kompatibilität der Schnittstellen<br>führt zu Fehlfunktion. Das Resultat ist ähnlich<br>einer DoS-Angriff auf das System. Eine Viel<br>zahl von Kunden bzw. Berechtigungen wäre<br>möglicherweise betroffen.                                                                                                                                                                             |
| GS10                               | Ungerechtfertigtes<br>Sammeln und Spei<br>chern von Daten | 3                | Das Konzept der automatischen Fahrpreiser<br>mittlung verwendet personenbezogene Nut<br>zungs- und Abrechnungsdaten.                                                                                                                                                                                                                                                                               |

**Tabelle 10–3 Relevante Gefährdungen des Systems** 

### <span id="page-124-0"></span>**10.1.2.2 Definition von Schutzmaßnahmen für die Schnittstellen des Gesamtsystems**

Ausgehend von den relevanten Gefährdungen aus dem vorangegangenen Kapitel werden hier generelle Umsetzungsvorschläge und Schutzmaßnahmen für das Gesamtsystem und die Systemkomponenten definiert. Diese Maßnahmen sind in Kapitel [8.4](#page-75-1) im Detail beschrieben.

| Gefährdung |                                                                                   | Maßnahmen                         | Maßnahme         |                                                                                                                                                                                                                                                                                                                                                                                                            |  |
|------------|-----------------------------------------------------------------------------------|-----------------------------------|------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| GIF1       | Mangelnde Kom<br>patibilität der<br>Schnittstellen<br>Trägermedium -<br>Lesegerät | MS1.3                             | 1                | Einführung von Schnittstellentests und<br>Freigabeverfahren - Zertifizierung                                                                                                                                                                                                                                                                                                                               |  |
| GIF2       | Abhören                                                                           | MS2.3<br>MS3.3                    | 1<br>2           | Sicherung der Vertraulichkeit der<br>Kommunikation zwischen RFID<br>Trägermedium und Terminal zur Ab<br>wehr von Abhören – Gegenseitige, dy<br>namische Authentisierung bei der Über<br>tragung.<br>Einführung der kontaktlosen Schnittstel<br>le nach ISO/IEC14443                                                                                                                                        |  |
| GIF3       | DoS-Angriff auf<br>die RF<br>Schnittstelle                                        | MS3.1                             | 1                | Einführung der kontaktlosen Schnittstel<br>le nach ISO/IEC14443                                                                                                                                                                                                                                                                                                                                            |  |
| GS1        | Fehlen einer<br>Rückfalllösung                                                    | MS4.3                             | 1                | Definition von Rückfalllösungen beim<br>Ausfall von Systemschnittstellen und<br>Systemkomponenten - Umsetzung<br>nach Rückfallkonzept                                                                                                                                                                                                                                                                      |  |
| GS2        | Unberechtigtes<br>Auslesen von<br>Referenzdaten                                   | MS5.3<br>MS6.3<br>MS15.3          | 1<br>2<br>3      | Sicherung der Vertraulichkeit von Daten<br>bei der Kommunikation innerhalb des<br>Systems – Sicherer Kommunikations<br>kanal<br>Vertrauliche Speicherung von Daten -<br>Einhaltung Datenschutz durch mandan<br>tenfähigen Zugriffsschutz<br>Trennung von Anwendungen – Ge<br>trennte Speicherung und Verarbeitung<br>von Daten                                                                             |  |
| GS3        | Manipulieren von<br>Referenzdaten im<br>System                                    | MS6.3<br>MS7.3<br>MS8.3<br>MS15.3 | 1<br>2<br>3<br>4 | Vertrauliche Speicherung von Daten -<br>Mandantenfähigen Zugriffsschutz, Rol<br>lenmodell<br>Sicherung der Datenintegrität zum<br>Schutz vor Manipulationen bei der Da<br>tenübertragung innerhalb des Systems<br>– MAC oder Signaturen<br>Sicherung der Datenintegrität bei der<br>Speicherung von Daten – Checksum<br>men<br>Trennung von Applikationen – Getrenn<br>te Speicherung und Verarbeitung von |  |

<span id="page-125-0"></span>

| Gefährdung  |                                                                       | Maßnahmen                                              | Maßnahme                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|-------------|-----------------------------------------------------------------------|--------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|             |                                                                       |                                                        | Daten                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| GS4         | Fehlfunktion des<br>Systems                                           | MS4.3<br>MS9.3<br>MS10.3<br>MS11.3<br>MS13.3<br>MS14.3 | 1<br>Definition einer Rückfalllösung beim<br>Ausfall von Systemschnittstellen und<br>Systemkomponenten – Umsetzung<br>nach Ausfallkonzept<br>2<br>Sicherung der Systemfunktionen gegen<br>DOS-Angriffe an den Schnittstellen -<br>Sicherheitskonzeption<br>3<br>Sicherung der Funktion des Systems<br>gegen Fehlbedienung durch Mitarbeiter<br>und Nutzer - Tests, Personal und Be<br>nutzerführung.<br>4<br>Sicherung der Funktion des Systems<br>zur Vermeidung technischer Fehler von<br>Komponenten und Übertragungswegen<br>- Evaluierung von Komponenten<br>5<br>Ergonomische Benutzerführung<br>6<br>Support -Systemweiter Support |
| GS5<br>GS10 | Mangelnde Kom<br>patibilität der<br>Schnittstellen<br>Ungerechtfertig | MS1.3<br>MS11.3<br>MS12.3<br>MS17.3                    | 1<br>Einführung von Schnittstellentests und<br>Freigabeverfahren - Zertifizierung<br>2<br>Sicherung der Funktion des Systems<br>zur Vermeidung technischer Fehler von<br>Komponenten und Übertragungswegen<br>- Evaluierung von Komponenten<br>3<br>Spezifikation Systemkonzept und An<br>forderungen an die Komponenten mit<br>dem Ziel der Integration und Interfunk<br>tionsfähigkeit - Interfunktionsfähigkeits<br>tests nach Testkonzeption, Evaluierung<br>1<br>Umsetzung des Gebots zur Datenspar                                                                                                                                  |
|             | tes Sammeln und<br>Speichern von<br>Daten                             |                                                        | samkeit – Besondere Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |

| Tabelle 10–4 | Schutzmaßnahmen für das Gesamtsystem |
|--------------|--------------------------------------|
|--------------|--------------------------------------|

# **10.1.2.3 Verbleibende Risiken**

Aus technischen oder wirtschaftlichen Gründen ist es nicht immer möglich, Gefährdungen durch Maßnahmen vollständig zu neutralisieren. In solchen Fällen verbleibt ein Risiko bestehen.

Das Restrisiko bezüglich des Schlüsselmanagement ist für die jeweilige Implementierung zu bestimmen und zu benennen.

# **10.1.3 Lesegeräte nach ISO/IEC14443**

Für die Kontrolle im Fahrzeug werden klassische Lesegeräte nach ISO/IEC14443 eingesetzt.

Auch ist es grundsätzlich möglich, Berechtigungen oder Wertguthaben über ein Lesegerät nach ISO/IEC14443, das die NFC -Schnittstelle des NFC-Mobiltelefons anspricht, in den sicheren Speicher des NFC-Mobiltelefons zu schreiben. Das NFC-Mobiltelefon arbeitet in beiden Fällen im passiven Modus entsprechend einem PICC nach ISO/IEC 14443.

Lesegeräte steuern den Informationsfluss zum Lesen oder Schreiben über das kontaktlose Kommunikationsprotokoll mit dem Trägermedium. Dem Lesegerät (PCD nach ISO/IEC14443) fällt dabei die aktive Rolle (Master) zu. Das Trägermedium (PICC nach ISO/IEC14443) agiert passiv (Slave).

Lesegeräte sind in verschiedenen Systemkomponenten integriert:

- 1 Verkaufssysteme in Vertriebsstellen
- 2 Verkaufsautomaten
- 3 Service Desk
- 4 Mobile Kontrollgeräte (Kontrollterminals)

Die mobilen Kontrollgeräte müssen mindestens folgende Eigenschaften aufweisen:

- 1 Kontaktloses Lese-/Schreibgerät mit Schnittstelle nach ISO/IEC14443A/B Teil 1-4.
- 2 Offline-Fähigkeit
- 3 Fähigkeit zur Speicherung aller Nutzungsdaten für die Dauer bis zum nächsten Datenaustausch mit dem Zentralsystem.
- 4 Parallele Unterstützung mehrerer Trägermedien, Anwendungen und Produkte (Selektion über ID)
- 5 Kryptographische Grundfunktionen.
- 6 Unterstützung von SAM. Es sollten mehrere SAM-Slots verfügbar sein.
- 7 Das Ergebnis der Auswertung muss optisch dargestellt werden.

Für alle anderen Lesegeräte, die z. B. in Verkaufsautomaten eingebaut sein können, gelten im Prinzip die gleichen Anforderungen. Allerdings ist nicht immer die Fähigkeit zum Offline-Betrieb gefordert.

<span id="page-127-0"></span>![](_page_127_Figure_1.jpeg)

# **Abbildung 10–3 Beispiel eines Lesegeräts mit Smart Card bzw. Smart Label**

# **10.1.3.1 Relevante Gefährdungen für das Lesegerät**

Aufgrund der Annahmen zur Ermittlung des Schutzbedarfs aus Kapitel [10.1.1](#page-119-2) lassen sich für die Schnittstellen des Gesamtsystems folgende relevanten Gefährdungen benennen.

| Gefährdungen der kontaktlo<br>se Schnittstelle |                                                                                 | Schutz<br>bedarf | Bemerkungen                                                                                                                                                                                                                                                                                           |
|------------------------------------------------|---------------------------------------------------------------------------------|------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GIF1                                           | Mangelnde Kompa<br>tibilität der Schnitt<br>stellen Trägermedi<br>um -Lesegerät | 3                | Mangelnde Kompatibilität der Schnittstellen<br>führt zu Nichtfunktion beim Aufbringen und der<br>Nutzung von Berechtigungen, der Kontrolle,<br>etc. Das Resultat ist ähnlich eines DoS<br>Angriffs auf das System. Eine Vielzahl von<br>Kunden bzw. Berechtigungen wäre möglicher<br>weise betroffen. |
| GIF2                                           | Abhören                                                                         | 3                | Unberechtigtes Belauschen der Kommunikati<br>on zwischen einem Trägermedium und einem<br>Lesegerät.                                                                                                                                                                                                   |

<span id="page-128-0"></span>

| Gefährdungen der kontaktlo<br>se Schnittstelle |                                         | Schutz<br>bedarf | Bemerkungen                                                                                                                                                                                                                                                                                                                |  |
|------------------------------------------------|-----------------------------------------|------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| GIF3                                           | DoS-Angriff auf die<br>RF-Schnittstelle | 3                | 1<br>Stören der RFID-Kommunikation (Jam<br>ming)<br>2<br>Stören des Antikollisionsmechanismus zur<br>Selektierung des Trägermediums (Blocker<br>Tag)<br>3<br>Abschirmung des elektromagnetischen<br>Feldes des Lesegerätes (Shielding)<br>4<br>Verstimmen der Resonanzfrequenz von<br>Reader oder Trägermedium (De-Tuning) |  |

**Tabelle 10–5 Relevante Gefährdungen der kontaktlosen Schnittstelle** 

| Gefährdung des Lesegeräts |                                                              | Schutz<br>bedarf | Bemerkungen                                                                                                                                                                                                  |  |
|---------------------------|--------------------------------------------------------------|------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| GR1                       | Unberechtigte Mani<br>pulation der Refe<br>renzinformationen | 3                | Manipulation der Referenzinformationen<br>(Schlüssel, Auswertealgorithmen, Black- oder<br>Whitelists) kann zur unberechtigten Nutzung<br>oder zu DoS verwendet werden.                                       |  |
| GR2                       | Unberechtigtes Aus<br>lesen der Referenz<br>informationen    | 3                | Auslesen der Referenzinformationen (Schlüs<br>sel, Auswertealgorithmen, Black- oder White<br>lists) kann zur unberechtigten Nutzung (Z. B.<br>Fälschung von Berechtigungen) oder zu DoS<br>verwendet werden. |  |
| GR3                       | Fehlfunktion des<br>Lesegerät                                |                  | Fehlfunktionen des Lesegeräts können durch<br>technische Fehler, Fehlbedienung oder DoS<br>Angriffe in verschiedenen Szenarien herbeige<br>führt werden:                                                     |  |
|                           |                                                              |                  | 1<br>Störung der kontaktlosen Schnittstelle<br>2<br>Störung der Referenzinformationen<br>(Schlüssel, Sperrlisten, etc)                                                                                       |  |
|                           |                                                              | 3                | 3<br>Störung der Anwendungsimplementierung<br>4<br>Störung der Auswertealgorithmen für Be<br>rechtigungen                                                                                                    |  |
|                           |                                                              |                  | 5<br>Fehler in der Stromversorgung                                                                                                                                                                           |  |
|                           |                                                              |                  | 6<br>Unterbrechung der Anbindung an das<br>Zentralsystem                                                                                                                                                     |  |
|                           |                                                              |                  | 7<br>Physische Zerstörung                                                                                                                                                                                    |  |
|                           |                                                              |                  | 8<br>Störung der Funktionen zur Nutzerführung                                                                                                                                                                |  |
| GR4                       | Mangelnde Bedie<br>nerführung                                | 3                | Mangelnde Bedienerfreundlichkeit an Automa<br>ten und Terminals für Entwertung bzw. Check<br>in / Check-out kann zu erheblichen operativen<br>Problemen führen.                                              |  |
| GS1                       | Fehlen einer Rück<br>falllösung                              | 3                | Das Fehlen einer Rückfalllösung beim Ausfall<br>von Systemschnittstellen wie Ticketverkaufs<br>system, Verwaltungssystem für Trägermedien<br>und Berechtigungen, Kontrollsystem kann zu                      |  |

<span id="page-129-0"></span>

| Gefährdung des Lesegeräts |                                                     | Schutz<br>bedarf | Bemerkungen                                                                                                                                                                                                             |
|---------------------------|-----------------------------------------------------|------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                           |                                                     |                  | Komplettausfällen von Services führen (Ver<br>kauf, Abrechnung, CICO, etc)                                                                                                                                              |
| GS5                       | Mangelnde Kompa<br>tibilität der Schnitt<br>stellen | 3                | Mangelnde Kompatibilität der Schnittstellen<br>führt zu Fehlfunktion. Das Resultat ist ähnlich<br>eines DoS-Angriffs auf das System. Eine Viel<br>zahl von Kunden bzw. Berechtigungen wäre<br>möglicherweise betroffen. |

| Tabelle 10–6<br>Relevante Gefährdungen des Lesegeräts |
|-------------------------------------------------------|
|-------------------------------------------------------|

### **10.1.3.2 Definition von Schutzmaßnahmen für das Lesegerät und dessen Anwendungen**

Ausgehend von den relevanten Gefährdungen aus dem vorangegangenen Kapitel werden hier generelle Umsetzungsvorschläge und Schutzmaßnahmen für das Lesegerät und dessen Anwendungen definiert. Diese Maßnahmen sind in Kapitel [8.4](#page-75-1) im Detail beschrieben.

| Gefährdung |                                                                                   | Maßnahmen      |        | Maßnahme                                                                                                                                                                                                                                                            |
|------------|-----------------------------------------------------------------------------------|----------------|--------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GIF1       | Mangelnde Kom<br>patibilität der<br>Schnittstellen<br>Trägermedium -<br>Lesegerät | MS1.3<br>MR1.3 | 1      | Einführung von Schnittstellentests und<br>Freigabeverfahren - Zertifizierung                                                                                                                                                                                        |
| GIF2       | Abhören                                                                           | MS2.3<br>MS3.3 | 1<br>2 | Sicherung der Vertraulichkeit der<br>Kommunikation zwischen RFID<br>Trägermedium und Terminal zur Ab<br>wehr von Abhören – Gegenseitige, dy<br>namische Authentisierung bei der Über<br>tragung.<br>Einführung der kontaktlosen Schnittstel<br>le nach ISO/IEC14443 |
| GIF3       | DoS-Angriff auf<br>die RF<br>Schnittstelle                                        | MS3.1          | 1      | Einführung der kontaktlosen Schnittstel<br>le nach ISO/IEC14443                                                                                                                                                                                                     |
| GR1        | Unberechtigte<br>Manipulation der<br>Referenzinforma<br>tionen                    | MR2.3          | 1      | Schützen der Referenzinformationen<br>gegen Auslesen, Datenfehler und Ma<br>nipulationen - Erweiterter Schutz                                                                                                                                                       |
| GR2        | Unberechtigtes<br>Auslesen der<br>Referenzinforma<br>tionen                       | MR2.3          | 1      | Schützen der Referenzinformationen<br>gegen Auslesen, Datenfehler und Ma<br>nipulationen - Erweiterter Schutz                                                                                                                                                       |
| GR3        | Fehlfunktion des<br>Lesegerät                                                     | MR3.3          | 1      | Schutz des Lesegeräts gegen Fehlfunk<br>tionen - Evaluierung                                                                                                                                                                                                        |
| GR4        | Mangelnde Be<br>dienerführung                                                     | MS13.3         | 1      | Ergonomische Benutzerführung                                                                                                                                                                                                                                        |

<span id="page-130-0"></span>

| Gefährdung |                                                    | Maßnahmen                 | Maßnahme                                                                                                                                                                                                                                                                                                                                  |  |
|------------|----------------------------------------------------|---------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| GS1        | Fehlen einer<br>Rückfalllösung                     | MS4.3                     | 1<br>Definition von Rückfalllösungen beim<br>Ausfall von Systemschnittstellen und<br>Systemkomponenten - Umsetzung<br>nach Rückfallkonzept                                                                                                                                                                                                |  |
| GS5        | Mangelnde Kom<br>patibilität der<br>Schnittstellen | MS1.3<br>MS11.3<br>MS12.3 | 1<br>Einführung von Schnittstellentests und<br>Freigabeverfahren - Zertifizierung<br>2<br>Sicherung der Funktion des Systems<br>zur Vermeidung technischer Fehler von<br>Komponenten und Übertragungswegen<br>- Evaluierung von Komponenten<br>3<br>Spezifikation Systemkonzept und An<br>forderungen an die Komponenten -<br>Evaluierung |  |

| Tabelle 10–7 | Schutzmaßnahmen für das Lesegerät und dessen Anwendungen |  |
|--------------|----------------------------------------------------------|--|
|--------------|----------------------------------------------------------|--|

# **10.1.3.3 Verbleibende Risiken**

Aus technischen oder wirtschaftlichen Gründen ist es nicht immer möglich, Gefährdungen durch Maßnahmen vollständig zu neutralisieren. In solchen Fällen verbleibt ein Risiko bestehen.

Das Restrisiko bezüglich der Lesegeräte ist für die jeweilige Implementierung zu bestimmen und zu benennen.

# **10.1.4 Verkaufs-, Kontroll- und Managementsysteme**

### **10.1.4.1 Verkaufssysteme**

Der Zugang zu den Produkten muss für alle potentiellen Kunden einfach und kostengünstig möglich sein. Deshalb sind verschiedene Vertriebsschnittstellen zum Kunden zu unterstützen. Diese sind im Folgenden beschrieben:

### **Verkaufsstelle (VKS)**

Hierbei handelt es sich z. B. um die Geschäftsstelle eines Verkehrsunternehmens (*z. B. KA Kundenvertragspartner*) oder ein Reisebüro.

### Verkaufsvorgang

Der Kunde sucht die VKS persönlich auf und wickelt den Kauf vor Ort ab:

- Die Identifizierung, wenn erforderlich, erfolgt durch Vorlage des Ausweises.
- Die Buchung erfolgt im Dialog mit dem Kunden vor Ort.
- Die Bezahlung erfolgt direkt in der VKS.

Sofern die Berechtigung auf ein existierendes Kundenmedium aufgebracht werden kann (siehe "*Technische Ausstattung*"), kann der Kunde das Produkt direkt mitnehmen. Ansonsten wird das Produkt mit dem Trägermedium per Post zugestellt oder liegt zu einem späteren Zeitpunkt zur Abholung in der VKS bereit.

### Technische Ausstattung

Die VKS hat einen Direktzugang zum Ticketverkaufssystem. Dies ist die Voraussetzung für die direkte Buchung von z. B. Sitzplatzreservierungen.

In der VKS kann durch ein einfaches kontaktloses Lesegerät die Möglichkeit zum Nachladen einer Berechtigung auf ein existierendes Kundenmedium geschaffen werden. Wenn ein solches kontaktloses Lesegerät vorhanden ist, könnte künftig ggf. ein elektronischer Identitätsnachweis für eine sichere, automatisierte Übernahme der personenbezogenen Daten in das Ticketsystem (z. B. zum Zwecke des Anlegen eines Kundenkontos) oder zur sicheren Identifizierung verwendet werden.

Personal und IT-Infrastruktur in der Verkaufsstelle sind nicht immer vertrauenswürdig.

### **Verkaufsautomat**

Am Verkaufsautomaten werden der Verkauf und die Ausgabe der Berechtigung in direkter Interaktion zwischen dem Automaten und dem Kunden abgewickelt oder ein Wertguthaben anonym aufgeladen.

Automaten werden im Kundenzentrum, im Bahnhof, an der Haltestelle und auch mobil im Fahrzeug eingesetzt. Sie eignen sich insbesondere für den anonymen Vertrieb von Produkten.

Bei Automaten, die mobil eingesetzt werden, ist generell Offline-Fähigkeit gefordert. Der Datenaustausch mit einem Verkaufssystem ist nur in gewissen Intervallen möglich.

Im einfachsten Fall werden Berechtigungen und Wertguthaben über ein im Automaten eingebautes kontaktloses Lesegerät in das NFC-Mobiltelefon geschrieben.

Der Kunde wickelt den Kauf oder die Abholung am Automaten ab:

- Die Buchung erfolgt am Automaten.
- Die Bezahlung erfolgt direkt z. B. über Maestro, Kreditkarte oder über ein systemspezifisches Bezahlverfahren.
- Die Berechtigung und/oder das Wertguthaben werden direkt auf das NFC-Mobiltelefon geladen.

# **Internet, Call Center, Bestellung per Post**

### Verkaufsvorgang

Der Kunde wickelt die Bestellung von jedem beliebigen Ort via Telefon, im Internet oder per Fax ab:

- Die Buchung, die Sitzplatzwahl, etc. kann bei Nutzung des Internet oder telefonisch in direkter Interaktion erfolgen. Bei einer schriftlichen Bestellung ist dies nicht möglich.
- Die Bezahlung erfolgt über Maestro, Kreditkarte oder per Lastschrift oder über ein systemspezifisches Bezahlverfahren.
- Zur sicheren Identifizierung ist ggf. eine gesonderte Überprüfung der vom Kunden übermittelten personenbezogenen Daten und der Kenndaten des NFC-Mobiltelefons (Vertrag, technische Eigenschaften, etc) erforderlich.

Es kann das Nachladen der Anwendung und der Berechtigung auf ein existierendes NFC-Mobiltelefon unterstützt werden. Das Nachladen erfolgt "Over-the-Air". Alternativ kann das <span id="page-132-0"></span>NFC-Mobiltelefon initialisiert und mit der gewünschten Berechtigung versehen per Post zugestellt werden.

### Technische Ausstattung

Der Produktanbieter benötigt eine Internet-Vertriebsplattform bzw. ein Call Center. Der Kunde benötigt keine besondere technische Ausstattung.

### **Internet**

### Verkaufsvorgang

Der Kunde wickelt die Bestellung via Internet von jedem beliebigen Ort (z. B. von zuhause) interaktiv ab.

Wenn der Kunde über ein Kundenmedium verfügt, das die erforderliche Anwendung bereits besitzt, so kann das gewünschte Produkt nachgeladen werden. Beim NFC-Mobiltelefon erfolgt das Nachladen üblicherweise "Over the Air":

- Die Buchung, *die Sitzplatzwahl,* etc. kann bei Nutzung des Internet in direkter Interaktion erfolgen.
- Die Identifizierung erfolgt über das Kundenmedium mittels der in der Anwendung gespeicherten Personendaten.
- Die Bezahlung erfolgt über Maestro, Kreditkarte, per Lastschrift oder über ein systemspezifisches Bezahlverfahren.

Die Berechtigung wird direkt in die Anwendung auf dem Kundenmedium geladen.

Falls noch kein Kundenmedium, jedoch ein kontaktloses Lesegerät vorhanden ist, kann künftig ggf. mit Hilfe des ePA eine sichere Identifizierung des Kunden erfolgen und dadurch die Bestellung eines Kundenmediums sicher und bequem getätigt werden.

### Technische Ausstattung

Der Produktanbieter benötigt eine Internet-Vertriebsplattform, die wiederum mit dem Schlüssel- und Träger- und Anwendungsmanagement verbunden ist. Der Kunde benötigt ein NFC Mobile Device, auf dem die passende Anwendung bereits aufgebracht ist und ggf. zum Anlegen eines Kundenkontos einen ePA und ein kontaktloses Heimlesegerät.

### **10.1.4.2 Ticketsystem**

Das Ticketsystem unterstützt wesentliche Prozesse des Verkaufs und der Abwicklung:

- 1 Anmeldung/Registrierung und Bestellung
- 2 Erstellung der Berechtigung
- 3 Zahlung und Überprüfung der Bonität
- 4 Verwaltung der verkauften Berechtigungen
- 5 Übergabe der erforderlichen Daten an das Kontrollsystem

Im Ticketsystem werden die Kundendaten und die Bestellungen abgelegt. Sofern die Beförderungsdienstleistung und das Produkt dieses vorsehen, ist mittels hinterlegter Sitzpläne des Fahrzeugs eine Sitzplatzzuordnung möglich. Das Ticketsystem umfasst weiterhin eine Ab<span id="page-133-0"></span>laufsteuerung, die z. B. für einen Adressabgleich und eine Zahlungsabwicklung mit Bonitätsprüfung sorgt, Kundenmedien erfasst und Berechtigungen erstellen und versenden lässt.

![](_page_133_Figure_2.jpeg)

**Abbildung 10–4 Exemplarisches Ticketsystem mit möglichem Prozessablauf** 

Ein Ticketsystem verfügt über Schnittstellen zum Schlüsselmanagement und zum Verwaltungssystem für Trägermedien und Anwendungen. Alle erforderlichen Informationen (außer denjenigen, die im Schlüsselmanagement übergeben werden) werden vom Ticketsystem zusammengeführt und über eine definierte Schnittstelle an den Dienstleister übergeben.

Weitere Schnittstellen existieren zu den Vertriebsstellen und zu den Produktionsstätten für die Trägermedien. Dies umfasst auch den Vertrieb und die Steuerung des Aufbringens von Anwendungen und Produkten auf existierende Medien über das Internet.

Es kann davon ausgegangen werden, dass ein Ticketsystem in einer sicheren Umgebung untergebracht ist. Personalisierer-SAM müssen angeschlossen werden, um Berechtigungen zu erstellen und auf Trägermedien aufbringen zu können.

Aus Sicht des Dienstleisters kann mehr als ein Ticketsystem zum Einsatz kommen.

# **10.1.4.3 Zentrales Kontrollsystem**

Das Kontrollsystem hilft dem Dienstleister, die Fahrtberechtigungen der Kunden zu kontrollieren und die abrechnungsrelevanten Informationen zu sammeln und weiterzuleiten. Dazu sind folgende Funktionen erforderlich:

- 1 Unterstützung des Prozesses P3 zu Check-in, Check-out und ggf. Entwertung
- 2 Unterstützung der spezifischen Trägermedien, Anwendungen und Produkte
- <span id="page-134-0"></span>a Implementierung der technischen Verfahren, die zur Nutzung der Trägermedien, Anwendungen und Produkte erforderlich sind.
- b Implementierung und Steuerung der SAM
- 3 Übernahme, Verteilung und Nutzung der von den Ticketsystemen bereitgestellten Informationen.
- 4 Übernahme , Verteilung und Nutzung der vom Systemmanager und Registrar bereitgestellten Schlüssel und Kennungen.
- 5 Rückmeldung der abrechnungsrelevanten Daten und der Nutzungshistorie an die Ticketsysteme

Im ÖPV sind die Terminals üblicherweise nicht ständig in das Datennetz eingebunden. Dies gilt insbesondere für Kontrollgeräte in den Fahrzeugen. Das bedeutet, dass alle für den Zutritt, die Aus- und Entwertung der Berechtigungen und ggf. der Fahrpreisermittlung nötigen Informationen lokal in diesen Terminals vorgehalten werden müssen.

# **10.1.4.4 Service-Desk**

Im realen Betrieb muss mit einem gewissen Anteil von defekten Kundenmedien, nicht sachgerechter Bedienung, Angriffen auf die Sicherheit und auch Betrugsversuchen gerechnet werden. Der Service-Desk dient als Anlaufstelle bei Problemen beim Check-in und Checkout.

Gültige Berechtigung verfallen bei Fehlfunktionen der Kontrolltechnik, des Kundenmediums und auch bei Fehlverhalten des Kunden nicht. Über den Service-Desk der vom Dienstleister oder vom Produktanbieter betrieben wird, wird dem Kunden eine Ersatzberechtigung ausgestellt oder Erstattung geleistet.

Dazu ist es erforderlich den Prozess P4 "Sperrung von Berechtigungen und Trägermedien" und die Ausgabe eines Ersatzmediums effizient und schnell durchführen zu können.

Am Service Desk werden folgende Aufgaben ausgeführt:

1 Überprüfen der Funktion des Trägermediums und des Status der Berechtigung.

Bei Fehlverhalten folgt:

2 Überprüfung der Echtheit des Mediums und / oder Überprüfung der Identität des Kunden.

Bei positivem Resultat folgt:

- 3 Sperrung des vorgelegten Mediums und der Berechtigung.
- 4 Update der Informationen im Ticketsystem und dem Träger- und Anwendungsmanagement.
- 5 Übertragung der Informationen vom Ticketsystem an das Kontrollsystem.

# **10.1.4.5 Managementsystem für NFC-Mobiltelefone und Anwendungen**

Für die Prozesse des Aufbringens von Anwendungen und Berechtigungen und für die Prozesse, bei denen das NFC-Mobiltelefon für die Identifizierung und die Nutzung von Verkehrsmitteln genutzt wird, ist es wichtig, den Status des jeweilig benutzten NFC-Mobiltelefons und der auf ihm gespeicherten Anwendungen zu kennen.

Aus diesem Grund muss der Lebenszyklus eines Trägermediums, das im Bereich des Systems verwendet werden soll, zuverlässig dokumentiert werden. Dazu wird z. B. eine Datenbank verwendet, die mit dem Ticketsystem und dem Schlüsselmanagement durch Schnitt<span id="page-135-0"></span>stellen verbunden ist. Hier werden für jedes Trägermedium z. B. folgende Informationen eingetragen:

- ID Trägermedium
- Typ, Version
- Anbieter des Trägermediums (ID via Registrar)
- Herausgeber des Trägermediums (ID via Registrar)
- Kunde
- Status (z. B. neu/aktiv/gesperrt)
- Gespeicherte Anwendungen (siehe unten)

In gleicher Weise muss auch der Lebenszyklus der auf dem Trägermedium gespeicherten Anwendungen dokumentiert werden. Es können mehrere verschiedene Anwendungen gespeichert sein.

- ID Anwendung
- Typ, Version, Gültigkeit
- Anwendungsanbieter (ID via Registrar)
- Anwendungsherausgeber (ID via Registrar)
- Kunde
- Status (z. B. neu/aktiv/gesperrt/löschen)
- Gespeicherte Produkte inkl. ID des Produktanbieters
- Aktive Produkte / löschbare Produkte

# **10.1.4.6 Managementsystem für lokale Transponder**

Der Lebenszyklus eines lokalen Transponders, der im Bereich des Systems verwendet werden soll, muss zuverlässig dokumentiert werden. Dazu wird eine Datenbank verwendet. Hier werden für jeden lokalen Transponder z. B. folgende Informationen eingetragen:

- ID lokaler Transponder
- Typ, Version, Gültigkeit
- Herausgeber des lokalen Transponders (ID via Registrar)
- Dienstleister
- Status (z. B. nicht initialisiert/initialisiert/gesperrt)
- Unterstützte Anwendungen (siehe unten)
- Ortszuordnung
- etc.

In gleicher Weise muss auch der Lebenszyklus der auf dem NFC-Mobiltelefon gespeicherten Anwendung dokumentiert werden. Es wird davon ausgegangen, dass lokale Transponder immer nur eine Anwendung unterstützen.

- ID Anwendung
- Typ, Version, Gültigkeit
- Anwendungsanbieter (ID via Registrar)
- Anwendungsherausgeber (ID via Registrar)
- Kunde
- Status (z. B. unpersonalisiert/personalisiert/aktiv/gesperrt/löschen)

### <span id="page-136-0"></span>**10.1.4.7 Relevante Gefährdungen für die Ticket-, Kontroll- und Managementsysteme**

Aufgrund der Annahmen zur Ermittlung des Schutzbedarfs aus Kapitel [10.1.1](#page-119-2) lassen sich für die Schnittstellen des Gesamtsystems folgende relevanten Gefährdungen benennen.

| Gefährdungen der Verkaufs,-<br>Kontroll und Management<br>systeme |                                                     | Schutz<br>bedarf | Bemerkungen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|-------------------------------------------------------------------|-----------------------------------------------------|------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GS1                                                               | Fehlen einer Rück<br>falllösung                     | 3                | Das Fehlen einer Rückfalllösung beim Ausfall<br>von Systemkomponenten wie Ticketverkaufs<br>system, Verwaltungssystem für Trägermedien<br>und Berechtigungen, Kontrollsystem kann zu<br>Komplettausfällen von Services führen (Ver<br>kauf, Abrechnung, CICO, etc)                                                                                                                                                                                                                                            |
| GS2                                                               | Unberechtigtes Aus<br>lesen von Referenz<br>daten   | 3                | In den Hintergrundsystemen sind Informatio<br>nen zu den Medien, den Berechtigungen, der<br>Nutzung sowie ggf. personenbezogene Daten<br>und Abrechnungsdaten gespeichert. Das Aus<br>lesen dieser Daten durch Unberechtigte würde<br>das System diskreditieren und die Möglichkeit<br>für Angriffe schaffen.                                                                                                                                                                                                 |
| GS3                                                               | Manipulieren von<br>Referenzdaten im<br>System      | 3                | In den Hintergrundsystemen sind Informatio<br>nen zu den Medien, den Berechtigungen, der<br>Nutzung sowie ggf. personenbezogene Daten<br>und den Abrechnungsdaten gespeichert. Das<br>Manipulieren dieser Daten durch Unberechtig<br>te ist ein schwerwiegender Angriff.                                                                                                                                                                                                                                      |
| GS4                                                               | Fehlfunktion des<br>Systems                         | 3                | Fehlfunktionen einzelner Systemkomponenten<br>können durch technische Fehler, Fehlbedie<br>nung oder DoS-Angriffe in verschiedenen Sze<br>narien herbeigeführt werden:<br>1<br>Störung der lokalen und zentralen Syste<br>me<br>2<br>Mangelnde Verfügbarkeit der lokalen und<br>zentralen Systeme<br>3<br>Störung der Datenspeicher<br>4<br>Fehler in der Stromversorgung<br>5<br>Unterbrechung der Anbindung an das<br>Zentralsystem<br>6<br>Schutz gegen physikalische Angriffe (De<br>montage, Zerstörung) |
| GS5                                                               | Mangelnde Kompa<br>tibilität der Schnitt<br>stellen | 3                | Mangelnde Kompatibilität der Schnittstellen<br>führt zu Fehlfunktion. Das Resultat ist ähnlich<br>eines DoS-Angriffs auf das System. Eine Viel<br>zahl von Kunden bzw. Berechtigungen wäre<br>möglicherweise betroffen.                                                                                                                                                                                                                                                                                       |

<span id="page-137-0"></span>

| Gefährdungen der Verkaufs,-<br>Kontroll und Management<br>systeme |                                                                                   | Schutz<br>bedarf | Bemerkungen                                                                                                                                                                                                                                                                                                                                                                               |
|-------------------------------------------------------------------|-----------------------------------------------------------------------------------|------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GS6                                                               | Unerlaubtes Ausle<br>sen der Verkaufs<br>und Abrechnungsda<br>ten                 | 3                | Unerlaubtes aktives Auslesen der Abrech<br>nungsdaten                                                                                                                                                                                                                                                                                                                                     |
| GS7                                                               | Unerlaubtes Schrei<br>ben / Manipulieren<br>der Verkaufs- und<br>Abrechnungsdaten | 3                | Unerlaubtes Schreiben von Abrechnungsdaten<br>in das Trägermedium zum Zwecke der Mani<br>pulation bzw. Kompromittierung.                                                                                                                                                                                                                                                                  |
| GS8                                                               | Schutz von mandan<br>tenspezifischen An<br>wendungen und<br>Berechtigungen        | 3                | Sofern mehrere Entitäten mit Verkaufsdaten,<br>Berechtigung und Anwendungen von den Sys<br>temen unterstützt werden, könnten diese bei<br>wechselseitiger Benutzung beeinflusst oder<br>beschädigt werden.                                                                                                                                                                                |
| GS9                                                               | Fälschung von Iden<br>tifikationsdaten                                            | 2                | Beim Anlegen eines Kundenkontos, Kauf oder<br>Abholung eines Produktes ist ggf. eine Identifi<br>zierung des Kunden erforderlich. Das Vortäu<br>schen einer falschen Identität erlaubt z. B. das<br>Erschleichen von Berechtigungen zu Lasten<br>anderer Kunden oder des Produktanbieters.<br>Der Schutzbedarf bzgl. SI2 (Schutz der Be<br>rechtigungen) ist hier als 2 eingestuft, da An |
|                                                                   |                                                                                   |                  | griffe nur auf einzelne Berechtigungen wirken.                                                                                                                                                                                                                                                                                                                                            |
| GS10                                                              | Ungerechtfertigtes<br>Sammeln und Spei<br>chern von Daten                         | 3                | Das Konzept der automatischen Fahrpreiser<br>mittlung verwendet personenbezogene Nut<br>zungs- und Abrechnungsdaten.                                                                                                                                                                                                                                                                      |

**Tabelle 10–8 Relevante Gefährdungen für die Ticket-, Kontroll- und Managementsysteme** 

### **10.1.4.8 Definition von Schutzmaßnahmen für die Ticket-, Kontroll- und Managementsysteme**

Ausgehend von den relevanten Gefährdungen aus dem vorangegangenen Kapitel werden hier generelle Umsetzungsvorschläge und Schutzmaßnahmen definiert. Diese Maßnahmen sind in Kapitel 8.4 im Detail beschrieben.

| Gefährdung |                                                 | Maßnahmen                | Maßnahme                                                                                                                                   |
|------------|-------------------------------------------------|--------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|
| GS1        | Fehlen einer<br>Rückfalllösung                  | MS4.3                    | 1<br>Definition einer Rückfalllösung beim<br>Ausfall von Systemschnittstellen und<br>Systemkomponenten - Umsetzung<br>nach Rückfallkonzept |
| GS2        | Unberechtigtes<br>Auslesen von<br>Referenzdaten | MS5.3<br>MS6.3<br>MS15.3 | 1<br>Sicherung der Vertraulichkeit von Daten<br>bei der Kommunikation innerhalb des<br>Systems – Sicherer Kommunikations<br>kanal          |
|            |                                                 |                          | 2<br>Vertrauliche Speicherung von Daten -<br>Einführung mandantenfähigen Zugriffs-                                                         |

<span id="page-138-0"></span>

| Gefährdung |                                                    | Maßnahmen                                              | Maßnahme                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|------------|----------------------------------------------------|--------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|            |                                                    |                                                        | schutz, Rollenmodell<br>3<br>Trennung von Anwendungen – Ge<br>trennte Speicherung und Verarbeitung<br>von Daten                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| GS3        | Manipulieren von<br>Referenzdaten im<br>System     | MS6.3<br>MS7.3<br>MS8.3<br>MS15.3                      | 1<br>Vertrauliche Speicherung von Daten -<br>Einhaltung Datenschutz durch mandan<br>tenfähigen Zugriffsschutz, Rollenmodell<br>2<br>Sicherung der Datenintegrität zum<br>Schutz vor Manipulationen bei der Da<br>tenübertragung innerhalb des Systems<br>– MAC oder Signaturen<br>3<br>Sicherung der Datenintegrität bei der<br>Speicherung von Daten – Checksum<br>men<br>4<br>Trennung von Anwendungen – Ge<br>trennte Speicherung und Verarbeitung<br>von Daten                                                                                                                                                                       |
| GS4        | Fehlfunktion des<br>Systems                        | MS4.3<br>MS9.3<br>MS10.3<br>MS11.3<br>MS13.3<br>MS14.3 | 1<br>Definition einer Rückfalllösung beim<br>Ausfall von Systemschnittstellen und<br>Systemkomponenten – Umsetzung<br>nach Ausfallkonzept<br>2<br>Sicherung der Systemfunktionen gegen<br>DOS-Angriffe an den Schnittstellen -<br>Sicherheitskonzeption<br>3<br>Sicherung der Funktion des Systems<br>gegen Fehlbedienung durch Mitarbeiter<br>und Nutzer - Tests, Personal und Be<br>nutzerführung.<br>4<br>Sicherung der Funktion des Systems<br>zur Vermeidung technischer Fehler von<br>Komponenten und Übertragungswegen<br>- Evaluierung von Komponenten<br>5<br>Ergonomische Nutzerführung<br>6<br>Support – Systemweiter Support |
| GS5        | Mangelnde Kom<br>patibilität der<br>Schnittstellen | MS1.3<br>MS11.3<br>MS12.3                              | 1<br>Einführung von Schnittstellentests und<br>Freigabeverfahren - Zertifizierung<br>2<br>Sicherung der Funktion des Systems<br>zur Vermeidung technischer Fehler von<br>Komponenten und Übertragungswegen<br>- Evaluierung von Komponenten<br>3<br>Spezifikation Systemkonzept und An<br>forderungen an die Komponenten mit<br>dem Ziel der Integration und Interfunk<br>tionsfähigkeit - Interfunktionsfähigkeits<br>tests nach Testkonzeption, Evaluierung                                                                                                                                                                            |
| GS6        | Unerlaubtes Aus<br>lesen der Ver<br>kaufs- und Ab  | MS5.3<br>MS6.3                                         | 1<br>Sicherung der Vertraulichkeit von Daten<br>bei der Kommunikation innerhalb des<br>Systems – VPN o.ä.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |

<span id="page-139-0"></span>

| Gefährdung |                                                                                          | Maßnahmen                         | Maßnahme                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|------------|------------------------------------------------------------------------------------------|-----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|            | rechnungsdaten                                                                           | MS15.3                            | 2<br>Vertrauliche Speicherung von Daten –<br>Einführung eines mandantenfähigen<br>Zugriffsschutz entsprechend Rollenmo<br>dell<br>3<br>Trennung von Applikationen – Getrenn<br>te Speicherung und Verarbeitung von<br>Daten                                                                                                                                                                                                                                             |
| GS7        | Unerlaubtes<br>Schreiben / Ma<br>nipulieren der<br>Verkaufs- und<br>Abrechnungsda<br>ten | MS6.3<br>MS7.3<br>MS8.3<br>MS15.3 | 1<br>Vertrauliche Speicherung von Daten –<br>Einführung eines mandantenfähigen<br>Zugriffsschutz entsprechend Rollenmo<br>dell<br>2<br>Sicherung der Datenintegrität zum<br>Schutz vor Manipulationen bei der Da<br>tenübertragung innerhalb des Systems<br>– MAC oder Signaturen<br>3<br>Sicherung der Datenintegrität bei der<br>Speicherung von Daten – Checksum<br>men<br>4<br>Trennung von Applikationen – Getrenn<br>te Speicherung und Verarbeitung von<br>Daten |
| GS8        | Schutz von man<br>dantenspezifi<br>schen Anwen<br>dungen und Be<br>rechtigungen          | MS6.3<br>MS15.3                   | 1<br>Vertrauliche Speicherung von Daten -<br>Einhaltung Datenschutz durch mandan<br>tenfähigen Zugriffsschutz, Rollenmodell<br>2<br>Trennung von Applikationen – Getrenn<br>te Speicherung und Verarbeitung von<br>Daten                                                                                                                                                                                                                                                |
| GS9        | Fälschung von<br>Identifikationsda<br>ten                                                | MS16.2                            | 1<br>Identifikation des Kunden – Antrags<br>formular, Kundenmedium                                                                                                                                                                                                                                                                                                                                                                                                      |
| GS10       | Ungerechtfertig<br>tes Sammeln und<br>Speichern von<br>Daten                             | MS17.3                            | 1<br>Umsetzung des Gebots zur Datenspar<br>samkeit – Besondere Maßnahmen                                                                                                                                                                                                                                                                                                                                                                                                |

**Tabelle 10–9 Schutzmaßnahmen für die Ticket-, Kontroll- und Managementsysteme** 

# **10.1.4.9 Verbleibende Risiken**

Aus technischen oder wirtschaftlichen Gründen ist es nicht immer möglich, Gefährdungen durch Maßnahmen vollständig zu neutralisieren. In solchen Fällen verbleibt ein Risiko bestehen.

Das Restrisiko bezüglich des Schlüsselmanagement ist für die jeweilige Implementierung zu bestimmen und zu benennen.

# <span id="page-140-0"></span>**10.1.5 Schlüsselmanagement**

Das Schlüsselmanagement hat die Aufgabe, Schlüssel, die von mehreren Entitäten genutzt werden, für alle im System verwendeten Trägermedien, Anwendungen und Produkte sicher und zuverlässig bereitzustellen. Das Schlüsselmanagement obliegt dem Sicherheitsmanager. Einige Anwendungsfälle sind in Kapitel [7.10](#page-49-1) beschrieben. Als generelle Anleitung zur Implementierung kann [GSHB] herangezogen werden.

Schlüssel werden für den jeweiligen Einsatzzweck individuell erzeugt. Dabei werden, sofern möglich, für die verschiedenen Formen der Interaktion (z. B. Aufbringen von Anwendungen, Schreiben von Berechtigungen, Lesen von Berechtigungen, Schreiben von Nutzungsdaten) individuell Schlüssel vergeben. Die genauen Eigenschaften müssen für jedes Einsatzszenario im Rahmen der Erstellung des spezifischen Sicherkonzepts im Einklang mit dem Rollenmodell ermittelt werden.

Die Schlüssel werden in einer sicheren Umgebung erzeugt und in einer sicheren Datenbank gespeichert. In dieser sicheren Umgebung werden auch die verschiedenen Formen von SAM erstellt. Die Dokumentation des Lebenszyklus der erstellten und ausgegebenen SAM ist ebenfalls Aufgabe des Schlüsselmanagement.

SAM und Schlüssel werden nach Bedarf des jeweiligen Nutzers vom Sicherheitsmanager oder dessen Beauftragten erstellt. Grundsätzlich werden folgende Arten von SAM unterstützt:

| Initialisierer-SAM  | Initialisierer-SAM werden zur Initialisierung von Trägermedien<br>und zum Aufbringen von Anwendungen benötigt.                                                                               |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Personalisierer-SAM | Personalisierer-SAM werden zum Einbringen von Berechtigun<br>gen in passende Anwendungen benötigt.                                                                                           |
| Dienstleister-SAM   | Dienstleister-SAM werden vom Dienstleister zum Lesen und<br>Entwerten, Sperren, Entsperren der Berechtigungen und ggf.<br>zum Einbringen der Nutzungsdaten in das Trägermedium benö<br>tigt. |

Weiterhin kann es bei Bedarf besondere SAM geben, die helfen, die Produktkennung des Anbieters von Trägermedien, Anwendungen und Berechtigungen sicher auf das Trägermedium aufzubringen.

Üblicherweise werden in einem SAM Schlüsselinformationen nach Bedarf des Nutzers eingebracht. Ziel eines Initialisierers ist es z. B., alle in seinem Bereich anfallenden Trägermedien mit den geforderten Anwendungen ohne Wechsel des SAM initialisieren zu können.

Die Konfiguration solcher nutzerspezifischen SAM muss in Absprache zwischen Nutzer und dem Systemmanager erfolgen.

Das SAM soll das sichere Nachladen von Schlüsseln über ein Netzwerk unterstützen. Idealerweise könnte das Update dann direkt vom Sicherheitsmanager erfolgen.

# **10.1.5.1 Schlüsselmanagement beim ÖPV-Dienstleister / SAM für Dienstleister**

Zur Auswertung der Berechtigungen sind die spezifischen Schlüsselinformationen erforderlich. Die Zuverlässigkeit und Sicherheit des damit verbundenen Schlüsselmanagements ist von elementarer Bedeutung für das Gesamtkonzept. Stimmen die Schlüssel beim Dienstleister nicht mit denen der zum Zutritt verwendeten Trägermedien und Berechtigungen überein, dann funktioniert die Auswertung der Berechtigungen nicht. Gehen Schlüssel verloren oder werden diese öffentlich, dann ist das gesamte Sicherheitskonzept diskreditiert.

<span id="page-141-0"></span>Nach dem vorliegenden Vorschlag werden dem Dienstleister als Betreiber des Kontrollsystems spezielle SAM zur Verfügung gestellt. Diese Dienstleister-SAM enthalten die für seine Dienstleistung relevanten Schlüsselinformationen und müssen in die Terminals integriert werden.

Bei der Verwendung von Dienstleister-SAM beschränkt sich das Schlüsselmanagement auf die Übernahme, die Handhabung und Verwaltung der SAM. Da die Schlüssel selbst bei Verwendung von SAM nicht zugänglich sind, ist das Risiko und damit auch der Schutzaufwand begrenzt. Gleichzeitig reduziert die Verwendung von standardisierten SAM den Aufwand bei der Anpassung an neue Anwendungen.

# **10.1.5.2 Relevante Gefährdungen für das Schlüsselmanagement**

Aufgrund der Annahmen zur Ermittlung des Schutzbedarfs aus Kapitel [10.1.1](#page-119-2) lassen sich für die Schnittstellen des Gesamtsystems folgende relevanten Gefährdungen benennen.

| Gefährdungen des Schlüs<br>selmanagements |                                                    | Schutz<br>bedarf | Bemerkungen                                                                                                                                                                                                                                                                                                                                                                       |
|-------------------------------------------|----------------------------------------------------|------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GK1                                       | Mangelnde Qualität<br>der Schlüsseldaten           | 3                | Mangelnde Qualität der Schlüssel steigert die<br>Erfolgschancen von Angriffen.                                                                                                                                                                                                                                                                                                    |
| GK2                                       | Unberechtigtes Aus<br>lesen von Schlüs<br>seldaten | 3                | Das Auslesen von Schlüsseldaten durch Unbe<br>rechtigte kann das Systems diskreditieren und<br>z. B. Angriffe auf alle kryptographisch ge<br>schützten Daten und Funktionen begünstigen.                                                                                                                                                                                          |
| GK3                                       | Manipulieren von<br>Schlüsseldaten                 | 3                | Manipulation von Schlüsseldaten kann das<br>Sicherheitskonzept des Systems diskreditieren<br>und z. B. Angriffe auf alle kryptographisch ge<br>schützten Daten und Funktionen begünstigen.<br>Die Manipulation kann die Erstellung von<br>Schlüsseln, die Erstellung von Schlüsselträ<br>gern, die Übertragung von Schlüsseln und die<br>lokale Nutzung von Schlüsseln betreffen. |
| GK4                                       | Fehlfunktion des<br>Schlüsselmanage<br>mentsystems |                  | Fehlfunktionen des Schlüsselmanagements<br>können durch technische Fehler, Fehlbedie<br>nung oder DoS-Angriffe in verschiedenen Sze<br>narien herbeigeführt werden:<br>1<br>Störung der lokalen und zentralen Syste<br>me                                                                                                                                                         |
|                                           |                                                    | 3                | 2<br>Mangelnde Verfügbarkeit der lokalen und<br>zentralen Systeme<br>3<br>Störung der Datenspeicher<br>4<br>Störung der spezifischen Anwendungs<br>implementierung<br>5<br>Störung der Auswertealgorithmen für Be<br>rechtigungen<br>6<br>Fehler in der Stromversorgung<br>7<br>Unterbrechung der Anbindung an das<br>Zentralsystem<br>8<br>Physische Zerstörung                  |

<span id="page-142-0"></span>

|     | Gefährdungen des Schlüs<br>selmanagements | Schutz<br>bedarf | Bemerkungen                                                                                                                                                                                                                                          |
|-----|-------------------------------------------|------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GK5 | Fehlen einer Rück<br>falllösung           | 3                | Die Verfügbarkeit der benötigten Schlüsselin<br>formationen ist die Grundvoraussetzung für die<br>Funktion des Gesamtsystems. Bei Fehlfunktio<br>nen des Schlüsselmanagement wäre ohne<br>Rückfalllösung die Funktion des Gesamtsys<br>tems bedroht. |

#### **Tabelle 10–10 Relevante Gefährdungen des Schlüsselmanagements**

### **10.1.5.3 Definition von Schutzmaßnahmen für das Schlüsselmanagement**

Ausgehend von den relevanten Gefährdungen aus dem vorangegangenen Kapitel werden hier generelle Umsetzungsvorschläge und Schutzmaßnahmen definiert. Diese Maßnahmen sind in Kapitel [8.4.](#page-75-1) im Detail beschrieben.

| Gefährdung |                                                    | Maßnahmen               | Maßnahme                                                                                                                                                                                                                                                                                                                                                                                                                 |
|------------|----------------------------------------------------|-------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GK1        | Mangelnde Quali<br>tät der Schlüssel<br>daten      | MK1.3<br>MK2.3          | 1<br>Sichere Erzeugung und Einbringung<br>von Schlüsseln - Evaluierung und Zerti<br>fizierung nach CC oder einem gleich<br>wertigen Verfahren<br>2<br>Einführung eines Schlüsselmanage<br>ment für symmetrische und asymmetri<br>sche Schlüssel mit ausreichender<br>Schlüssellänge –Sicheres, flexibles<br>Schlüsselmanagementkonzep                                                                                    |
| GK2        | Unberechtigtes<br>Auslesen von<br>Schlüsseldaten   | MK3.3<br>MK7.3          | 1<br>Zugriffschutz auf kryptographische<br>Schlüssel (Lese- und Schreibzugriff) -<br>Evaluierung und Zertifizierung nach CC<br>oder einem gleichwertigen Verfahren<br>2<br>Trennung von Schlüsseln – Getrennte<br>Speicherung und Verarbeitung von<br>Schlüsseln                                                                                                                                                         |
| GK3        | Manipulieren von<br>Schlüsseldaten                 | MK3.3<br>MK7.3<br>MK8.3 | 1<br>Zugriffschutz auf kryptographische<br>Schlüssel (Lese- und Schreibzugriff) -<br>Evaluierung und Zertifizierung nach CC<br>oder einem gleichwertigen Verfahren<br>2<br>Trennung von Schlüsseln – Getrennte<br>Speicherung und Verarbeitung von<br>Schlüsseln<br>3<br>Nachladen von Schlüsseln - Sichern<br>der Berechtigungen hinsichtlich Authen<br>tizität und Integrität - Komplexes Au<br>thentifikationskonzept |
| GK4        | Fehlfunktion des<br>Schlüsselmana<br>gementsystems | MK4.3<br>MK5.3          | 1<br>Spezifizieren der Performanz und der<br>geforderte Sicherung der Funktion der<br>Sicherheitskomponenten - Evaluierung<br>2<br>Verfügbarkeit des Schlüsselmanage<br>ments (Rückfalllösung) - Umsetzung                                                                                                                                                                                                               |

<span id="page-143-0"></span>

| Gefährdung |                                | Maßnahmen      | Maßnahme                                                                                                                                                                                                                                                                    |
|------------|--------------------------------|----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|            |                                |                | nach Ausfallkonzept und Backup von<br>Schlüsseln im Trustcenter                                                                                                                                                                                                             |
| GK5        | Fehlen einer<br>Rückfalllösung | MK5.3<br>MK6.3 | 1<br>Verfügbarkeit des Schlüsselmanage<br>ments (Rückfalllösung) - Umsetzung<br>nach Rückfallkonzept und Backup von<br>Schlüsseln im Trustcenter<br>2<br>Definition des Verhaltens im Kompro<br>mittierungsfall – Kompromittierung von<br>nicht diversifizierten Schlüsseln |

| Tabelle 10–11 | Schutzmaßnahmen für das Schlüsselmanagement |  |
|---------------|---------------------------------------------|--|
|               |                                             |  |

# **10.1.5.4 Verbleibende Risiken**

Aus technischen oder wirtschaftlichen Gründen ist es nicht immer möglich, Gefährdungen durch Maßnahmen vollständig zu neutralisieren. In solchen Fällen verbleibt ein Risiko bestehen.

Das Restrisiko bezüglich des Schlüsselmanagement ist für die jeweilige Implementierung zu bestimmen und zu benennen.

# **10.2 Lokaler Transponder**

Der lokale Transponder wird fest an einem Ort montiert und speichert Informationen zu diesem Ort, die dann durch ein NFC-Mobiltelefon im aktiven Modus ausgelesen werden können. Diese Information wird zum Check-in und beim Check-Out oder zur Entwertung beim NFC-basierten eTicketing verwendet.

Der lokale Transponder entspricht in seiner elektrischen Funktion einem passiven Transponder nach ISO/IEC14443.

Besondere Anforderungen erwachsen aus den folgenden Tatsachen:

- 1 Der lokale Transponder ist an einem öffentlich zugänglichen, oftmals unbewachten Ort angebracht. Der lokale Transponder ist damit in besonderem Masse durch Vandalismus gefährdet. Auch gezielte Angriffe auf die Funktion und die Sicherheit der Daten sind wahrscheinlich.
- 2 Durch die Fehlfunktion eines lokalen Transponders kann eine große Zahl von Kunden betroffen sein.

Chipprodukte der folgenden Kategorien können für die den lokalen Transponder eingesetzt werden:

| Chipkategorie            | Sicherheitsfunktionen                                                                                    | Funktionen                                                                                            | Kommerzielle Aspekte                                                                                          |
|--------------------------|----------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
| Kostengüns<br>tiger Spei | •<br>Eindeutige Ken<br>nung (UID)                                                                        | •<br>Schnittstelle nach<br>ISO14443 Teil 1-3                                                          | •<br>Chipkosten < 50€<br>Cent                                                                                 |
| cherchip                 | •<br>OTP-Speicher<br>•<br>Schreibschutz von<br>gewissen Spei<br>cherbereichen<br>•<br>Zugriffsschutz für | •<br>Eindeutige Ken<br>nung (UID)<br>•<br>Lese/ Schreibbe<br>reich in festen Blö<br>cken organisiert. | •<br>Proprietäre<br>Schnittstellen- und<br>Anwendungs<br>kommandos > ggf.<br>Anpassungsauf<br>wand am Lesege- |

| Chipkategorie                         | Sicherheitsfunktionen                                                                                                                                                                                                                                                                                                                                                                                        | Funktionen                                                                                                                                                                                                                                                                                                                                                                                                              | Kommerzielle Aspekte                                                                                                                                                                                                                                                                                      |  |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|                                       | einzelne Spei<br>cherbereiche                                                                                                                                                                                                                                                                                                                                                                                | Insgesamt <<br>1kByte<br>•<br>Datenhaltung max.<br>2 Jahre                                                                                                                                                                                                                                                                                                                                                              | rät<br>•<br>Proprietäre, feste<br>Speicheraufteilung<br>> ggf. Anpas<br>sungsaufwand bei<br>Berechtigungen.<br>•<br>Minimaler Zeitauf<br>wand bei Initiali<br>sierung und Per<br>sonalisierung                                                                                                            |  |
| Sicherer<br>Speicherchip              | •<br>Eindeutige Ken<br>nung (UID)<br>•<br>Symmetrische<br>Kryptographie<br>(TDES, AES oder<br>vergleichbare of<br>fene Verfahren).<br>•<br>Mutual authentica<br>te<br>•<br>Sichere Kommuni<br>kation ( geschützt<br>mit MAC oder/und<br>verschlüsselt)<br>•<br>Zugriffsschutz,<br>individueller<br>Schutz für einzel<br>ne Dateien und<br>Dateisysteme                                                       | •<br>Schnittstelle nach<br>ISO14443 Teil 1-4<br>•<br>Datensicherung<br>bei Übertragung<br>über kontaktlose<br>Schnittstelle<br>•<br>Lese/ Schreibbe<br>reich 1kByte<br>8kByte<br>•<br>Flexibles Datei<br>handling<br>•<br>Fester Befehlssatz<br>mit hoher Perfor<br>manz<br>•<br>Multiapplikation<br>•<br>Datenhaltung min.<br>10 Jahre                                                                                 | •<br>Chipkosten < 1 €<br>•<br>Ggf. proprietäre<br>Anwendungs<br>kommandos: An<br>passungsaufwand<br>am Lesegerät<br>•<br>Flexible Dateifor<br>mate: erlauben<br>standardisierte<br>Formate für Be<br>rechtigungen.<br>•<br>Moderater Zeit<br>aufwand bei Initia<br>lisierung und Per<br>sonalisierung     |  |
| Sicherer<br>Controllerchip<br>mit COS | •<br>Eindeutige Ken<br>nung (UID)<br>•<br>Random UID<br>•<br>Symmetrische<br>Kryptographie<br>(TDES, AES oder<br>vergleichbare of<br>fene Verfahren)<br>•<br>Asymmetrische<br>Kryptographie<br>(RSA, ECC)<br>•<br>Mutual authentica<br>te<br>•<br>Sichere Kommuni<br>kation (geschützt<br>mit MAC und/oder<br>verschlüsselt)<br>•<br>Zugriffsschutz,<br>individueller<br>Schutz für einzel<br>ne Dateien und | •<br>Schnittstelle nach<br>ISO14443 Teil 1-4<br>(bis 848kBit/s)<br>•<br>Eindeutige Ken<br>nung (UID)<br>•<br>Lese / Schreibbe<br>reich ca. 10kByte<br>150kByte<br>•<br>Flexibles Datei<br>handling<br>•<br>COS/Anwendungs<br>-SW in ROM oder<br>EEPROM<br>•<br>Befehlssatz mit<br>COS definierbar<br>•<br>Multiapplikation<br>inkl. Sicherem<br>Nachladen von<br>Anwendungen im<br>Feld (z. B. nach<br>Global Platform) | •<br>Chipkosten < 3 €<br>(ohne SW<br>Lizenzkosten)<br>•<br>Kosten für COS<br>und Anwendungs<br>software<br>•<br>Kommandosatz<br>durch COS be<br>stimmt, erlaubt<br>Flexibilität<br>•<br>Flexible Spei<br>cheraufteilung<br>•<br>Hoher Initialauf<br>wand für Initialisie<br>rung und Persona<br>lisierung |  |

<span id="page-145-0"></span>

| Chipkategorie | Sicherheitsfunktionen                                                            | Funktionen                         | Kommerzielle Aspekte |
|---------------|----------------------------------------------------------------------------------|------------------------------------|----------------------|
|               | Dateisysteme<br>•<br>Sensoren gegen<br>Hardware<br>Attacken                      | •<br>Datenhaltung min.<br>10 Jahre |                      |
|               | •<br>Sicheres HW<br>Design                                                       |                                    |                      |
|               | •<br>CC-Zertifizierung<br>der Chip<br>Hardware nach<br>[HW_PP1] oder<br>[HW_PP2] |                                    |                      |

| Tabelle 10–12 | Kategorisierung der Chipprodukte |
|---------------|----------------------------------|
|               |                                  |

# **10.2.1 Initialisierung von lokalen Transpondern**

Die Initialisierung von Trägermedien folgt dem Prozess P2 und den Anwendungsfällen der Kapitel [7.11.](#page-52-2) Die Initialisierung erfolgt üblicherweise durch einen speziellen Dienstleister vor der Montage des Transponders.

Die entsprechenden Verfahren und Prozesse müssen in den Initialisierungssystemen entsprechend den Spezifikationen des Trägermediums und der Anwendungen implementiert werden. Für das Schlüsselmanagement kommen oftmals Initialisierer-SAM zum Einsatz, die in das Initialisierungssystem integriert werden müssen.

# **10.2.2 Aufbringen der Ortsinformation**

Das Aufbringen des Transponders erfolgt entweder in einem Zug mit der Initialisierung oder durch den Dienstleister kurz vor der Montage.

Die entsprechenden Verfahren und Prozesse müssen in den Personalisierungssystemen entsprechend den Spezifikationen des lokalen Transponders und der Anwendung implementiert werden. Für das Schlüsselmanagement kommen Personalisierer-SAM zum Einsatz, die in das Personalisierungssystem integriert werden müssen.

# **10.2.3 Ermittlung des Schutzbedarfs für den lokalen Transponder**

Die lokalen Transponder sind Bestandteil der eTicketing-Infrastruktur. Es wird angenommen, dass die Transponder für alle Produkte, die im System unterstützt werden, in gleicher Weise verwendet werden. Deshalb gelten die Betrachtungen zum Schutzbedarf aus [Tabelle 10–1.](#page-122-1)

Sollten alternativ produktspezifische lokale Transponder verwendet werden, dann ist eine spezifische Schutzbedarfsanalyse zum spezifischen Einsatzszenario sinnvoll.

# **10.2.4 Gefährdungen für den lokalen Transponder**

Die folgende Tabelle enthält die potentiellen Gefährdungen für den lokalen Transponder.

<span id="page-146-0"></span>

| Gefährdung |                                                                                      | Schutz<br>bedarf | Bemerkungen                  |
|------------|--------------------------------------------------------------------------------------|------------------|------------------------------|
| GIF1       | Mangelnde Kompa<br>tibilität der Schnitt<br>stellen Transponder<br>–NFC-Mobiltelefon | 3                |                              |
| GIF2       | Abhören                                                                              | -                | Abhängig vom Einsatzszenario |
| GTR1       | Unerlaubtes Ausle<br>sen der Ortsinforma<br>tion                                     | -                | Abhängig vom Einsatzszenario |
| GTR2       | Unerlaubtes Schrei<br>ben / Manipulieren<br>der Ortsinformation                      | 3                |                              |
| GTR3       | Klonen des lokalen<br>Transponders                                                   | 3                |                              |
| GTR4       | Emulieren des loka<br>len Transponders                                               | 3                |                              |
| GTR5       | Umplatzieren des<br>lokalen Transpon<br>ders                                         | 3                |                              |
| GTR6       | Ausbringen zusätzli<br>cher Transponder                                              | 3                |                              |
| GTR7       | Fehlfunktion des<br>lokalen Transpon<br>ders                                         | 3                |                              |
| GTR8       | Fehlen einer Rück<br>falllösung bei Fehl<br>funktion                                 | 3                |                              |

**Tabelle 10–13 Relevante Gefährdungen für den lokalen Transponder** 

# **10.2.5 Definition spezifischer Maßnahmen**

Die Zuordnung von Schutzmassnahmen ist vom jeweiligen Einsatzszenario abhängig. Dies erfolgt deshalb in Kapitel [11.](#page-151-1)

# **10.3 NFC-Mobiltelefon**

# **10.3.1 Eigenschaften des NFC-Mobiltelefons**

In den beiden folgenden Tabellen werden die Eigenschaften und die Sicherheitsfunktionen des NFC-Mobiltelefons beschrieben.

<span id="page-147-0"></span>

| Katego<br>rie           | Eigenschaften des Trägermediums                                                                                                                                                                                                                                                                                                     | Sicherheitsfunktionen des Kartenkör<br>pers                                                                                                                                                                                  |
|-------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| NFC<br>Mobilte<br>lefon | Mobilgerät mit NFC-Schnittstelle:<br>•<br>Display (Anzeige von relevanten<br>Informationen)<br>•<br>Tastatur<br>•<br>Möglichkeit zur Änderung von<br>Applikationsdaten durch den Nut<br>zer<br>•<br>Over-the-Air Applikationsmana<br>gement (Aufbringen, Personalisie<br>ren, Löschen, Versionsmanage<br>ment) durch Dienstanbieter | •<br>Ein- und Ausschalten der kontakt<br>losen Schnittstelle durch Nutzer<br>•<br>Identifizierung und Authentisie<br>rung durch SIM-Karte<br>•<br>Sperrung der Applikation "Over<br>the-Air" durch Dienstanbieter<br>möglich |

**Tabelle 10–14 Kategorisierung der Trägermedien** 

Die Sicherheitsfunktionen des NFC-Mobiltelefons basieren auf integrierten Chipprodukten mit den folgenden Eigenschaften:

| Chipka<br>tegorie                         | Sicherheitsfunktionen                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Funktionen                                                                                                                                                                                                                                                                                                                                                                                                                  |  |
|-------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Sicherer<br>Control<br>lerchip<br>mit COS | •<br>Eindeutige Kennung (UID)<br>•<br>Random UID<br>•<br>Symmetrische Kryptographie<br>(TDES, AES oder vergleichbare<br>offene Verfahren.)<br>•<br>Asymmetrische Kryptographie<br>(RSA, ECC)<br>•<br>Mutual authenticate<br>•<br>Sichere Kommunikation (ge<br>schützt mit MAC und/oder ver<br>schlüsselt)<br>•<br>Zugriffsschutz, individueller<br>Schutz für einzelne Dateien und<br>Dateisysteme<br>•<br>Sensoren gegen Hardware<br>Attacken<br>•<br>Sicheres HW-Design<br>•<br>CC Zertifizierung der Chip<br>Hardware nach [PP_HW1] oder<br>[PP_HW2]. | •<br>Schnittstelle nach ISO14443 Teil<br>1-4 (bis 848kBit/s)<br>•<br>Eindeutige Kennung (UID)<br>•<br>Lese / Schreibbereich ca.<br>10kByte-150kByte<br>•<br>Flexibles Dateihandling<br>•<br>COS/Anwendungs-SW in ROM<br>oder EEPROM<br>•<br>Befehlssatz mit COS definierbar<br>•<br>Multiapplikation inkl. Sicherem<br>Nachladen von Anwendungen im<br>Feld (z. B. nach Global Platform)<br>•<br>Datenhaltung min. 10 Jahre |  |

**Tabelle 10–15 Eigenschaften der im NFC-Mobiltelefon integrierten Chipprodukte** 

# **10.3.2 Initialisierung des NFC-Mobiltelefons**

Die Initialisierung von Trägermedien folgt dem Prozess P2 und den Anwendungsfällen der Kapitel [7.2,](#page-41-2) [7.3](#page-42-2), [7.10.2.](#page-50-2) Es gibt verschiedene Möglichkeiten der Umsetzung:

1 Initialisierung durch einen speziellen Dienstleister.

- <span id="page-148-0"></span>2 Aus dem Ticketsystem gesteuerte Initialisierung im Automaten oder einem Ticketdrucker.
- 3 Aus dem Ticketsystem gesteuertes Aufbringen von Anwendungen auf existierende Kundenmedien.

Die entsprechenden Verfahren und Prozesse müssen in den Initialisierungssystemen entsprechend den Spezifikationen des Trägermediums und der Anwendungen implementiert werden. Für das Schlüsselmanagement kommen oftmals Initialisierer-SAM zum Einsatz, die in das Initialisierungssystem integriert werden müssen.

# **10.3.3 Personalisierung des NFC-Mobiltelefons**

Das Aufbringen der Berechtigung folgt dem Prozess P2 und den Anwendungsfällen der Kapitel [7.4](#page-43-2), [7.10.3](#page-51-2).

Die entsprechenden Verfahren und Prozesse müssen in den Personalisierungssystemen entsprechend den Spezifikationen des Trägermediums und der Anwendungen implementiert werden. Für das Schlüsselmanagement kommen Personalisierer-SAM zum Einsatz, die in das Personalisierungssystem integriert werden müssen.

# **10.3.4 Ermittlung des Schutzbedarfs für das NFC-Mobiltelefon**

Die Wahl der Schutzbedarfsklasse ist vom jeweiligen Einsatzszenario abhängig. Dies erfolgt deshalb in Kapitel [11](#page-151-1).

# **10.3.5 Gefährdungen für das NFC-Mobiltelefon**

Die folgenden Tabellen enthalten die Gefährdungen für das NFC-Mobiltelefon. Die Zuordnung von Schutzklassen ist stark vom unterstützten Produkt und damit vom jeweiligen Einsatzszenario abhängig. Dies erfolgt deshalb in Kapitel [11.](#page-151-1)

# **10.3.5.1 Gefährdungen im aktiven Modus (PCD-Mode)**

Die folgende Tabelle enthält die speziellen Gefährdungen für dieses Einsatzszenario.

| Gefährdung |                                                     | Schutz<br>bedarf | Bemerkungen                                                                          |
|------------|-----------------------------------------------------|------------------|--------------------------------------------------------------------------------------|
| GNM<br>D1  | Mangelnde Kompa<br>tibilität der Schnitt<br>stellen | 3                |                                                                                      |
| GNM<br>D2  | Fehlfunktion des<br>NFC-Mobiltelefons               | 2                | Gründe für erhöhte Fehlererwartung sind:<br>•<br>Akku leer<br>•<br>Kein Mobilempfang |
| GNM<br>D3  | Handhabungsprob<br>leme                             | -                | Abhängig vom Einsatzszenario                                                         |
| GNM<br>D4  | Unerlaubtes Ausle<br>sen der Berechti<br>gung       | -                | Abhängig vom Einsatzszenario                                                         |

<span id="page-149-0"></span>

| Gefährdung |                                        | Schutz<br>bedarf | Bemerkungen                          |
|------------|----------------------------------------|------------------|--------------------------------------|
| GNM<br>D5  | Manipulation der<br>Berechtigung       | -                | Abhängig vom Einsatzszenario         |
| GNM<br>D6  | Offenlegung Orts<br>Informationen      | -                | Abhängig vom Einsatzszenario         |
| GNM<br>D7  | Manipulation der<br>Orts-Informationen | -                | Abhängig vom Einsatzszenario         |
| GNM<br>D8  | Schutz vor DoS<br>Angriffen            | -                | Abhängig vom Einsatzszenario         |
| GNM<br>D9  | Schutz der Perso<br>nendaten           | -                | Abhängig vom Einsatzszenario         |
| GNM<br>D10 | Manipulation von<br>Display-Texten     | 1                | Betrifft im Falle nur wenige Kunden. |

#### **Tabelle 10–16 Relevante Gefährdungen des aktiven NFC-Mobiltelefons im Einsatzszenario "Dauerberechtigung mit Fahrpreisermittlung"**

# **10.3.5.2 Gefährdungen im passiven Modus**

| Gefährdung |                                                                                 | Schutz<br>bedarf | Bemerkungen                                                                                                                                   |
|------------|---------------------------------------------------------------------------------|------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|
| GIF1       | Mangelnde Kompa<br>tibilität der Schnitt<br>stellen Trägermedi<br>um -Lesegerät | 3                |                                                                                                                                               |
| GIF2       | Abhören                                                                         | -                | Abhängig vom Einsatzszenario. Bei durch<br>MAC geschützten Berechtigungen ist keine<br>Gefährdung gegeben und keine Maßnahme<br>erforderlich. |
| GT1        | Unerlaubtes Ausle<br>sen der Berechti<br>gung                                   | -                | Abhängig vom Einsatzszenario                                                                                                                  |
| GT2        | Unerlaubtes Schrei<br>ben / Manipulieren<br>der Berechtigung                    | -                | Abhängig vom Einsatzszenario                                                                                                                  |
| GT3        | Klonen des Medi<br>ums inkl. Berechti<br>gung                                   | -                | Abhängig vom Einsatzszenario                                                                                                                  |
| GT4        | Emulieren der An<br>wendung und Be<br>rechtigung                                | -                | Abhängig vom Einsatzszenario                                                                                                                  |
| GT5        | Unerlaubtes Ausle<br>sen der personen<br>bezogenen Daten                        | -                | Abhängig vom Einsatzszenario                                                                                                                  |

<span id="page-150-0"></span>

| Gefährdung |                                                                             | Schutz<br>bedarf | Bemerkungen                  |
|------------|-----------------------------------------------------------------------------|------------------|------------------------------|
| GT6        | Unerlaubtes Schrei<br>ben / Manipulieren<br>der personenbezo<br>genen Daten | -                | Abhängig vom Einsatzszenario |
| GT7        | Unerlaubtes Ausle<br>sen der Abrech<br>nungsdaten                           | -                | Abhängig vom Einsatzszenario |
| GT8        | Unerlaubtes Schrei<br>ben / Manipulieren<br>der Abrechnungsda<br>ten        | -                | Abhängig vom Einsatzszenario |
| GT9        | Schutz von zusätzli<br>chen Anwendungen<br>und Berechtigungen               | -                | Abhängig vom Einsatzszenario |
| GT10       | Fehlfunktion des<br>Trägermediums                                           | -                | Abhängig vom Einsatzszenario |
| GT11       | Tracking durch un<br>berechtigtes Ausle<br>sen der UID                      | 1                |                              |
| GT12       | Fehlen einer Rück<br>falllösung bei Fehl<br>funktion                        | -                | Abhängig vom Einsatzszenario |

**Tabelle 10–17 Relevante Gefährdungen für das NFC-Mobiltelefon (passiver Modus)** 

# **10.3.6 Definition spezifischer Maßnahmen**

Die Zuordnung von Schutzmassnahmen ist vom jeweiligen Einsatzszenario abhängig. Dies erfolgt deshalb in Kapitel [11.](#page-151-1)

# <span id="page-151-1"></span><span id="page-151-0"></span>**11 Umsetzungsvorschläge zu den produktspezifischen Einsatzszenarien**

# **11.1 Einsatzszenario "Interfunktionsfähige Dauerberechtigung mit automatischer Fahrpreisermittlung"**

# **11.1.1 Ermittlung der Schutzbedarfsklasse**

Für das Einsatzszenario "Dauerberechtigung mit Fahrpreisermittlung" gelten folgende Randbedingungen, die bei der Bestimmung des Schutzbedarfs beachtet werden sollen:

- 1 Hoher kommerzieller Wert
- 2 Personenbezogenen Daten (z. B. Daten zur Person und personenbezogene Bewegungsdaten)
- 3 Interfunktionsfähigkeit zwischen den Entitäten muss technisch gewährleistet werden:
	- a Verkaufsdaten
	- b Nutzungsdaten
	- c Abrechnungsdaten
- 4 Das NFC-Mobiltelefon wird vom Nutzer ständig mitgeführt.
- 5 Kombination mit anderen Einsatzszenarien bzw. Produkten. Das Produkt wird im Einsatzgebiet mit Produkten geringeren Werts kombiniert. Bei der Ermittlung des Schutzbedarfs muss berücksichtigt werden, dass dieses Szenario ggf. über andere Produktimplementierungen gefährdet sein könnten.

# Spezielle Randbedingungen

Die Ausgabe des Trägermediumtyps "NFC-Mobiltelefon" ist aufgrund der Kosten und operativer Gründe als Beigabe zu einer Berechtigung nicht darstellbar. Es wird deshalb in diesem Einsatzszenario davon ausgegangen, das Berechtigungen des Produkttyps "Dauerberechtigung mit Fahrpreisermittlung" auf ein Trägermedium des Typs "NFC-Mobiltelefon", das bereits im Besitz des Kunden ist, im Nachhinein aufgeladen werden. Das bedeutet, dass – sofern diese noch nicht vorhanden ist- auch eine entsprechende Anwendung in den sicheren Speicher des NFC-Mobiltelefons nachgeladen werden muss.

Bei der Verwendung eines existierenden NFC-Mobiltelefons ist grundsätzlich davon auszugehen, dass bereits andere Anwendungen und Berechtigungen auf dem Trägermedium existieren. Diese anderen Anwendungen und Berechtigungen können von verschiedenen Entitäten stammen, die nicht notwendigerweise gemeinsame Nutzungs- und Verhaltensregeln vereinbart haben.

Das Aufbringen der Anwendung erfolgt in diesem Beispiel "Over-the-Air".

Das Aufbringen der Berechtigung erfolgt "Over-the-Air" in der Verkaufsstelle oder an einem Automaten.

Check-in und Check-out erfolgen teilweise Offline und sind im Anwendungsfall "Offline Check-in" und "Offline Check-out" beschrieben.

Basierend auf den in Kapitel [8.2.5](#page-64-1) dargelegten Kriterien kann das Einsatzszenario folgenden Schutzbedarfsklassen zugeordnet werden:

| Sicherheitsziel |                                                                                                  | Schutz<br>bedarfs<br>klasse | Kriterien zur Einordnung in Schutzbedarfsklassen                                                                                                                                                                          |  |
|-----------------|--------------------------------------------------------------------------------------------------|-----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| SF1             | Technische<br>Kompatibilität                                                                     | 1                           | Alle Systemkomponenten sind vom gleichen Lieferan<br>ten. Der Lieferant sorgt für Kompatibilität.                                                                                                                         |  |
|                 |                                                                                                  | 2                           | System muss mit Komponenten von wenigen definier<br>ten Lieferanten funktionieren. Der Systemmanager<br>oder ein SI sorgen für Kompatibilität.                                                                            |  |
|                 |                                                                                                  | 3                           | Offenes System, dass mit Komponenten von allen<br>Marktteilnehmern funktionieren soll.                                                                                                                                    |  |
|                 |                                                                                                  |                             | System wird üblicherweise durch eine offene Aus<br>schreibung beschafft.                                                                                                                                                  |  |
|                 |                                                                                                  | 1                           | Fehlfunktion betrifft einzelne Kunden                                                                                                                                                                                     |  |
|                 |                                                                                                  |                             | Fehlfunktion betrifft größere Kundenmenge                                                                                                                                                                                 |  |
| SF2             | Rückfalllösung<br>bei Fehlfunkti<br>onen                                                         | 2                           | Bei neuen Technologien und Nutzungsprozessen ist<br>während einer Lernphase mit Nutzungsproblemen zu<br>rechnen. Außerdem müssen recht häufig vorkommen<br>de Fehler (z. B. "Akku leer") berücksichtigt werden.           |  |
|                 |                                                                                                  | 3                           | Fehlfunktion betrifft eine großen Teil der Kunden                                                                                                                                                                         |  |
|                 |                                                                                                  | 1                           | Intuitiv nicht bedienbar von einzelne Kunden                                                                                                                                                                              |  |
|                 |                                                                                                  | 2                           | Intuitiv nicht bedienbar von größeren Kundenmengen                                                                                                                                                                        |  |
| SF3             | Intuitive, feh<br>lertolerante<br>Nutzung                                                        |                             | Intuitiv nicht bedienbar von einem großen Teil der<br>Kunden                                                                                                                                                              |  |
|                 |                                                                                                  | 3                           | Das Prinzip des Check-in / Check-out muss allen<br>Kunden explizit nahe gebracht werden.                                                                                                                                  |  |
|                 |                                                                                                  | 1                           | Kunde wird in seinem Ansehen geschädigt.                                                                                                                                                                                  |  |
|                 | Schutz der<br>personenbe<br>zogenen Da<br>ten (inkl. per<br>sonenbezoge<br>ne Nutzungs<br>daten) |                             | Kunde wird in seiner sozialen Existenz geschädigt.                                                                                                                                                                        |  |
| SI1             |                                                                                                  | 2                           | Sofern im System gespeicherte personengebundenen<br>Abrechnungsinformationen oder Zahlungsdaten ent<br>wendet oder manipuliert werden, können erhebliche<br>kommerzielle und soziale Folgen für den Kunden ein<br>treten. |  |
|                 |                                                                                                  | 3                           | Kunde wird in seiner physischen Existenz geschädigt.                                                                                                                                                                      |  |
| SI2             | Schutz der<br>Berechtigun<br>gen                                                                 | 1                           | Erwarteter produktbezogener Umsatzverlust durch<br>Fälschung, Stören oder Manipulation <0.5%                                                                                                                              |  |
|                 |                                                                                                  | 2                           | Erwarteter produktbezogener Umsatzverlust durch<br>Fälschung, Stören oder Manipulation <3%                                                                                                                                |  |
|                 |                                                                                                  | 3                           | Erwarteter produktbezogener Umsatzverlust durch<br>Fälschung, Stören oder Manipulation >3%                                                                                                                                |  |
|                 |                                                                                                  |                             | DoS-Angriffe auf das System können zur Störung des<br>gesamten Betriebs führen und damit erhebliche kom                                                                                                                   |  |

| Sicherheitsziel |                                                                     | Schutz<br>bedarfs<br>klasse | Kriterien zur Einordnung in Schutzbedarfsklassen                                                                                                                                                                                                                   |
|-----------------|---------------------------------------------------------------------|-----------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                 |                                                                     |                             | merzielle Einbussen verursachen.                                                                                                                                                                                                                                   |
| SI3             | Schutz der<br>Logistikdaten<br>(anonymisierte<br>Nutzungsda<br>ten) | 1                           | Daten werden Dritten bekannt                                                                                                                                                                                                                                       |
|                 |                                                                     |                             | Daten gehen verloren                                                                                                                                                                                                                                               |
|                 |                                                                     | 2                           | Der Verlust der Logistikdaten kann auch durch techni<br>sche Defekte auftreten und zu betrieblichen Schwie<br>rigkeiten führen.                                                                                                                                    |
|                 |                                                                     | 3                           | Daten werden verfälscht.                                                                                                                                                                                                                                           |
| SI4             | Zuverlässige<br>Abrechnung<br>(personalisiert)                      | 1                           | Daten sind zeitweise nicht verfügbar                                                                                                                                                                                                                               |
|                 |                                                                     | 2                           | Daten sind verloren                                                                                                                                                                                                                                                |
|                 |                                                                     |                             | Daten wurden verfälscht, missbraucht, etc                                                                                                                                                                                                                          |
|                 |                                                                     | 3                           | In einem System mit mehreren Akteuren, die sich nicht<br>vertrauen, ist Abrechnungsbetrug zwischen den Ak<br>teuren nicht auszuschließen.                                                                                                                          |
| SI5             | Schutz von<br>Anwendungen<br>und Berechti<br>gungen                 | 1                           | Anwendungen werden vom selben Anwendungsher<br>ausgeber und Berechtigungen vom selben Produktei<br>gentümer herausgegeben.                                                                                                                                         |
|                 |                                                                     | 2                           | Anwendungen werden von unterschiedlichen Anwen<br>dungsherausgebern und Berechtigungen von unter<br>schiedlichen Produkteigentümern, Produktanbietern<br>und Dienstleistern herausgegeben. Mehrere Unter<br>nehmen kooperieren und "vertrauen" sich gegenseitig.   |
|                 |                                                                     | 3                           | Anwendungen werden von unterschiedlichen Anwen<br>dungsanbietern und Berechtigungen von unterschied<br>lichen Produkteigentümern, Produktanbietern und<br>Dienstleistern herausgegeben. Mehrere Unternehmen<br>kooperieren und "vertrauen" sich nicht gegenseitig. |
|                 |                                                                     |                             | Beim Aufbringen der Berechtigung NFC-Mobiltelefone<br>ist grundsätzlich davon auszugehen, dass sich An<br>wendungen fremder Akteure auf dem Kundenmedium<br>befinden.                                                                                              |
|                 | Schutz vor der<br>Erzeugung von<br>Bewegungs<br>profilen            | 1                           | Kunde wird in seinem Ansehen geschädigt                                                                                                                                                                                                                            |
| SP3             |                                                                     | 2                           | Kunde wird in seiner sozialen Existenz geschädigt                                                                                                                                                                                                                  |
|                 |                                                                     | 3                           | Kunde wird in seiner physischen Existenz geschädigt                                                                                                                                                                                                                |

<span id="page-154-0"></span>

| Sicherheitsziel |                      | Schutz<br>bedarfs<br>klasse | Kriterien zur Einordnung in Schutzbedarfsklassen                                                        |
|-----------------|----------------------|-----------------------------|---------------------------------------------------------------------------------------------------------|
| SP4             | Datenspar<br>samkeit | 1                           | Es werden keine personenbezogenen Daten verwen<br>det.                                                  |
|                 |                      | 2                           | Es werden personenbezogene Daten verwendet, aber<br>keine Nutzungsdaten gesammelt.                      |
|                 |                      | 3                           | Es werden personenbezogene Daten und personen<br>bezogene Nutzungs- und Abrechnungsdaten verwen<br>det. |

**Tabelle 11–1 Schutzbedarf Einsatzszenario "Dauerberechtigung mit automatischer Fahrpreisermittlung"** 

# **11.1.2 Schutz des passiven NFC-Mobiltelefons**

### <span id="page-154-1"></span>**11.1.2.1 Relevante Gefährdungen des passiven NFC-Mobiltelefons**

Die folgende Tabelle enthält die speziellen Gefährdungen für dieses Einsatzszenario.

| Gefährdung |                                                                                 | Schutz<br>bedarf | Bemerkungen |
|------------|---------------------------------------------------------------------------------|------------------|-------------|
| GIF1       | Mangelnde Kompa<br>tibilität der Schnitt<br>stellen Trägermedi<br>um -Lesegerät | 3                |             |
| GIF2       | Abhören                                                                         | 3                |             |
| GT1        | Unerlaubtes Ausle<br>sen der Berechti<br>gung                                   | 3                |             |
| GT2        | Unerlaubtes Schrei<br>ben / Manipulieren<br>der Berechtigung                    | 3                |             |
| GT3        | Klonen des Medi<br>ums inkl. Berechti<br>gung                                   | 3                |             |
| GT4        | Emulieren der An<br>wendung und Be<br>rechtigung                                | 3                |             |
| GT5        | Unerlaubtes Ausle<br>sen der personen<br>bezogenen Daten                        | 3                |             |
| GT6        | Unerlaubtes Schrei<br>ben / Manipulieren<br>der personenbezo<br>genen Daten     | 3                |             |

<span id="page-155-0"></span>

| Gefährdung |                                                                      | Schutz<br>bedarf | Bemerkungen                                                                                                                                                   |
|------------|----------------------------------------------------------------------|------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GT7        | Unerlaubtes Ausle<br>sen der Abrech<br>nungsdaten                    | 3                |                                                                                                                                                               |
| GT8        | Unerlaubtes Schrei<br>ben / Manipulieren<br>der Abrechnungsda<br>ten | 3                |                                                                                                                                                               |
| GT9        | Schutz von zusätzli<br>chen Anwendungen<br>und Berechtigungen        | 3                |                                                                                                                                                               |
| GT10       | Fehlfunktion des<br>Trägermediums                                    | 1                | Die Erwartung von erhöhten Fehlerraten ist auf<br>den aktiven Modus des NFC-Mobiltelefons<br>beschränkt. Im passiven Modus ist die Klasse<br>"1" ausreichend. |
| GT11       | Tracking durch un<br>berechtigtes Ausle<br>sen der UID               | 1                |                                                                                                                                                               |
| GT12       | Fehlen einer Rück<br>falllösung bei Fehl<br>funktion                 | 1                |                                                                                                                                                               |

**Tabelle 11–2 Relevante Gefährdungen des passiven NFC-Mobiltelefons im Einsatzszenario "Dauerberechtigung mit Fahrpreisermittlung"** 

# **11.1.2.2 Definition relevanter Anwendungsfälle für das passive NFC-Mobiltelefon**

Die in Kapitel [11.1.2.1](#page-154-1) benannten Gefährdungen sollen für folgende Anwendungsfälle betrachtet werden:

| Anwendungsfall                                   | Relevanz | Bemerkungen                                                                                            |
|--------------------------------------------------|----------|--------------------------------------------------------------------------------------------------------|
| Identifizierung bei Anmel<br>dung und Bestellung | +        | Anlegen eines Kundenkontos und Bestellung des<br>Produkts (ggf zusammen mit einem NFC<br>Mobiltelefon) |
| Initialisieren des NFC<br>Mobiltelefons          | +        |                                                                                                        |
| Nachladen der Anwen<br>dung                      | +        | Üblicher Anwendungsfall                                                                                |
| Einbringen der Berechti<br>gung                  | +        | ggf. sind auch vorkonfigurierte NFC-Mobiltelefone<br>über den Produktanbieter erhältlich               |
| Nachladen der Berechti<br>gung                   | +        | Üblicher Anwendungsfall                                                                                |
| Auslieferung                                     | +        | ggf. sind auch vorkonfigurierte NFC-Mobiltelefone<br>über den Produktanbieter erhältlich               |

<span id="page-156-0"></span>

| Anwendungsfall      | Relevanz | Bemerkungen |
|---------------------|----------|-------------|
| Check-in (offline)  | +        |             |
| Check-out (offline) | +        |             |
| Check-in (online)   | -        |             |
| Check-out (online)  | -        |             |
| Kontrolle           | +        |             |
| Sperrung            | +        |             |
| Schlüsselmanagement | +        |             |

#### **Tabelle 11–3 Relevante Anwendungsfälle Einsatzszenario "Dauerberechtigung mit Fahrpreisermittlung"**

Für die einzelnen Trägermedien sollen in den folgenden Unterkapiteln auf Basis der benannten Gefährdungen und der relevanten Anwendungsfälle Maßnahmen definiert werden.

# **11.1.2.3 Definition von Schutzmaßnahmen für das passive NFC-Mobiltelefon**

Ausgehend von den relevanten Gefährdungen und Anwendungsfällen aus den beiden vorangegangenen Kapiteln werden hier spezifische Schutzmassnahmen definiert. Diese Maßnahmen sind in Kapitel [8.4](#page-75-1) beschrieben.

| Gefährdung |                                                                                   | Maßnahmen                   | Maßnahme                                                                                                                                                                                                                                                                                                                                                                                     |
|------------|-----------------------------------------------------------------------------------|-----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GIF1       | Mangelnde Kom<br>patibilität der<br>Schnittstelle Trä<br>germedium -<br>Lesegerät | MS1.3                       | 1<br>Einführung von Schnittstellentests und<br>Freigabeverfahren - Zertifizierung                                                                                                                                                                                                                                                                                                            |
| GIF2       | Abhören                                                                           | MS2.3<br>MS3.3              | 1<br>Sicherung der Vertraulichkeit der<br>Kommunikation zwischen Trägermedi<br>um und Lesegerät zur Abwehr von Ab<br>hören - Gegenseitige, dynamische Au<br>thentisierung bei der Übertragung<br>2<br>Einführung der kontaktlosen Schnittstel<br>le nach ISO/IEC14443                                                                                                                        |
| GT1        | Unerlaubtes Aus<br>lesen der Berech<br>tigung                                     | MT1.3                       | 1<br>Hard- und Software-Zugriffsschutz (Le<br>se- und Schreibzugriff) – Erweiterter<br>Zugriffsschutz                                                                                                                                                                                                                                                                                        |
| GT2        | Unerlaubtes<br>Schreiben / Ma<br>nipulieren der<br>Berechtigung                   | MT1.3<br>MT11a.3<br>MT11b.3 | 1<br>Hard- und Software-Zugriffsschutz (Le<br>se- und Schreibzugriff) – Erweiterter<br>Zugriffsschutz<br>2<br>Nachladen von Berechtigungen – Si<br>chern der Berechtigung hinsichtlich Au<br>thentizität und Integrität – Komplexes<br>Authentifikationskonzept.<br>3<br>Nachladen von Berechtigungen – Si<br>chern der Berechtigung hinsichtlich<br>Vertraulichkeit – Komplexes Authentifi- |

<span id="page-157-0"></span>

| Gefährdung |                                                                                | Maßnahmen                   | Maßnahme                                                                                                                                                                                                                                                                                              |  |
|------------|--------------------------------------------------------------------------------|-----------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|            |                                                                                |                             | kationskonzept                                                                                                                                                                                                                                                                                        |  |
| GT3        | Klonen des Medi<br>ums inkl. Berech<br>tigung                                  | MT1.3<br>MT2.3              | 1<br>Hard- und Software-Zugriffsschutz (Le<br>se- und Schreibzugriff) – Erweiterter<br>Zugriffsschutz<br>2<br>Schutz vor Klonen des Trägermediums<br>inkl. Berechtigung – Erweiterter Schutz<br>vor dem Klonen des Trägermediums<br>und des Dateninhalts                                              |  |
| GT4        | Emulieren der<br>Anwendung und<br>Berechtigung                                 | MT1.3<br>MT3.3              | 1<br>Hard- und Software-Zugriffsschutz (Le<br>se- und Schreibzugriff) – Erweiterter<br>Zugriffsschutz<br>2<br>Schutz vor Emulation - Erweiterter<br>Emulationsschutz                                                                                                                                  |  |
| GT5        | Unerlaubtes Aus<br>lesen der perso<br>nenbezogenen<br>Daten                    | MT1.3<br>MT4.3              | 1<br>Hard- und Software-Zugriffsschutz (Le<br>se- und Schreibzugriff) - Erweiterter<br>Zugriffsschutz<br>2<br>Schutz der personenbezogenen Daten<br>gegen Auslesen und Schrei<br>ben/Manipulation - Erweiterter Zugriff<br>schutz auf personenbezogene Daten                                          |  |
| GT6        | Unerlaubtes<br>Schreiben / Ma<br>nipulieren der<br>personenbezoge<br>nen Daten | MT1.3<br>MT4.3<br>MT6.3     | 1<br>Hard- und Software-Zugriffsschutz (Le<br>se- und Schreibzugriff) - Erweiterter<br>Zugriffsschutz<br>2<br>Schutz der personenbezogenen Daten<br>gegen Auslesen und Schrei<br>ben/Manipulation - Erweiterter Zugriff<br>schutz auf personenbezogene Daten<br>3<br>Sichere Trennung von Anwendungen |  |
| GT7        | Unerlaubtes Aus<br>lesen der Ab<br>rechnungsdaten                              | MT1.3<br>MT5.3              | 1<br>Hard- und Software-Zugriffsschutz (Le<br>se- und Schreibzugriff) – Erweiterter<br>Zugriffsschutz<br>2<br>Schutz der Abrechnungsdaten gegen<br>Auslesen und Schreiben/Manipulation -<br>Zugriffs- und Manipulationsschutz bei<br>Interfunktionsfähigkeit                                          |  |
| GT8        | Unerlaubtes<br>Schreiben / Ma<br>nipulieren der<br>Abrechnungsda<br>ten        | MT1.3<br>MT5.3              | 1<br>Hard- und Software-Zugriffsschutz (Le<br>se- und Schreibzugriff) – Erweiterter<br>Zugriffsschutz<br>2<br>Schutz der Abrechnungsdaten gegen<br>Auslesen und Schreiben/Manipulation -<br>Zugriffs- und Manipulationsschutz bei<br>Interfunktionsfähigkeit                                          |  |
| GT9        | Schutz von zu<br>sätzlichen An<br>wendungen und<br>Berechtigungen              | MT6.3<br>MT10a.3<br>MT10b.3 | 1<br>Trennung von Anwendungen - Sichere<br>Trennung von Anwendungen<br>2<br>Nachladen von Anwendungen - Sichern<br>der Anwendungen hinsichtlich Authen<br>tizität und Integrität - Implementieren                                                                                                     |  |

<span id="page-158-0"></span>

| Gefährdung |                                                      | Maßnahmen | Maßnahme                                                                                                                                                               |
|------------|------------------------------------------------------|-----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|            |                                                      | MT11a.3   | eines Nachlademechanismus gem. ISO<br>7816-13 mit SM                                                                                                                   |
|            |                                                      | MT11b.3   | 3<br>Nachladen von Anwendungen - Sichern<br>der Anwendungen hinsichtlich Vertrau<br>lichkeit - Implementieren eines Nachla<br>demechanismus gem. ISO 7816-13 mit<br>SM |
|            |                                                      |           | 4<br>Nachladen von Berechtigungen - Si<br>chern der Berechtigungen hinsichtlich<br>Authentizität und Integrität- Komplexes<br>Authentifikationskonzept                 |
|            |                                                      |           | 5<br>Nachladen von Berechtigungen - Si<br>chern der Berechtigungen hinsichtlich<br>Vertraulichkeit - Komplexes Authentifi<br>kationskonzept                            |
| GT10       | Fehlfunktion des<br>Trägermediums                    | MT7.1     | 1<br>Spezifikation der Eigenschaften des<br>Trägermediums – Herstellererklärung                                                                                        |
| GT11       | Tracking durch<br>unberechtigtes<br>Auslesen der UID | MT8.1     | 1<br>Einführung der Nahbereichstechnik<br>nach ISO/IEC14443 und ISO/IEC<br>21481                                                                                       |
| GT12       | Fehlen einer<br>Rückfalllösung<br>bei Fehlfunktion   | MT9.1     | 1<br>Rückfalllösung bei Fehlfunktion des<br>Trägermediums - Einführung von ge<br>eigneten Rückfalllösungen                                                             |

#### **Tabelle 11–4 Maßnahmen zum passiven NFC-Mobiltelefon im Einsatzszenario "Dauerberechtigung mit Fahrpreisermittlung"**

# **11.1.3 Schutz des aktiven NFC-Mobiltelefons**

# <span id="page-158-1"></span>**11.1.3.1 Relevante Gefährdungen des aktiven NFC-Mobiltelefons**

Die folgende Tabelle enthält die speziellen Gefährdungen für dieses Einsatzszenario.

| Gefährdung |                                                     | Schutz<br>bedarf | Bemerkungen                                                                          |
|------------|-----------------------------------------------------|------------------|--------------------------------------------------------------------------------------|
| GNM<br>D1  | Mangelnde Kompa<br>tibilität der Schnitt<br>stellen | 3                |                                                                                      |
| GNM<br>D2  | Fehlfunktion des<br>NFC-Mobiltelefons               | 2                | Gründe für erhöhte Fehlererwartung sind:<br>•<br>Akku leer<br>•<br>Kein Mobilempfang |
| GNM<br>D3  | Handhabungsprob<br>leme                             | 3                |                                                                                      |
| GNM<br>D4  | Unerlaubtes Ausle<br>sen der Berechti-              | 3                |                                                                                      |

<span id="page-159-0"></span>

| Gefährdung |                                        | Schutz<br>bedarf | Bemerkungen                          |
|------------|----------------------------------------|------------------|--------------------------------------|
|            | gung                                   |                  |                                      |
| GNM<br>D5  | Manipulation der<br>Berechtigung       | 3                |                                      |
| GNM<br>D6  | Offenlegung Orts<br>Informationen      | -                | Keine Relevanz                       |
| GNM<br>D7  | Manipulation der<br>Orts-Informationen | 3                |                                      |
| GNM<br>D8  | Schutz vor DoS<br>Angriffen            | 2                |                                      |
| GNM<br>D9  | Schutz der Perso<br>nendaten           | 3                |                                      |
| GNM<br>D10 | Manipulation von<br>Display-Texten     | 1                | Betrifft im Falle nur wenige Kunden. |

**Tabelle 11–5 Relevante Gefährdungen des aktiven NFC-Mobiltelefons im Einsatzszenario "Dauerberechtigung mit Fahrpreisermittlung"** 

# **11.1.3.2 Definition relevanter Anwendungsfälle für das aktive NFC-Mobiltelefon**

Die in Kapitel [11.1.3.1](#page-158-1) benannten Gefährdungen sollen für folgende Anwendungsfälle betrachtet werden:

| Anwendungsfall      | Relevanz | Bemerkungen |
|---------------------|----------|-------------|
| Check-in (offline)  | +        |             |
| Check-out (offline) | +        |             |
| Check-in (online)   | -        |             |
| Check-out (online)  | -        |             |
| Schlüsselmanagement | +        |             |

### **Tabelle 11–6 Relevante Anwendungsfälle Einsatzszenario "Dauerberechtigung mit Fahrpreisermittlung"**

Für die einzelnen Trägermedien sollen in den folgenden Unterkapiteln auf Basis der benannten Gefährdungen und der relevanten Anwendungsfälle Maßnahmen definiert werden.

# **11.1.3.3 Definition von Schutzmaßnahmen für das aktive NFC-Mobiltelefon**

Ausgehend von den relevanten Gefährdungen und Anwendungsfällen aus den beiden vorangegangenen Kapiteln werden hier spezifische Schutzmassnahmen definiert. Diese Maßnahmen sind in Kapitel [8.4](#page-75-1) beschrieben.

| Gefährdung |                                  | Maßnahmen | Maßnahme                                                                          |
|------------|----------------------------------|-----------|-----------------------------------------------------------------------------------|
| GNM<br>D1  | Mangelnde Kom<br>patibilität der | MS1.3     | 1<br>Einführung von Schnittstellentests und<br>Freigabeverfahren - Zertifizierung |

<span id="page-160-0"></span>

| Gefährdung |                                               | Maßnahmen                 | Maßnahme                                                                                                                                                                                                                                                                                                                                                                                                              |
|------------|-----------------------------------------------|---------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|            | Schnittstellen                                |                           |                                                                                                                                                                                                                                                                                                                                                                                                                       |
| GNM<br>D2  | Fehlfunktion des<br>NFC<br>Mobiltelefons      | MNMD1.2<br>MNMD2.2        | 1<br>Vermitteln des Ablaufs und der Nut<br>zungsbedingungen - Information vor Ort<br>2<br>Ausweichen auf alternativen Vertriebs<br>kanal .- Lokale Information / Vorhalten<br>von Kapazitäten                                                                                                                                                                                                                         |
| GNM<br>D3  | Handhabungs<br>probleme                       | MNMD1.3<br>MS13.3         | 1<br>Vermitteln des Ablaufs und der Nut<br>zungsbedingungen - Proaktive Aufklä<br>rung<br>2<br>Ergonomische Benutzerführung - Spe<br>zifikation, Umsetzung und Test eines<br>Gesamtkonzepts zur Ergonomie und<br>Nutzerführung:                                                                                                                                                                                       |
| GNM<br>D4  | Unerlaubtes Aus<br>lesen der Berech<br>tigung | MNMD3.3<br>MS5.3<br>MS7.3 | 1<br>Schutz von Daten und Schlüsseln im<br>NFC-Mobiltelefon - Sichere Plattform<br>2<br>Sicherung der Vertraulichkeit von Daten<br>bei der Kommunikation innerhalb des<br>Systems Berechtigung hinsichtlich Ver<br>traulichkeit – Sicherer Kommunikati<br>onskanal<br>3<br>Sicherung der Datenintegrität zum<br>Schutz vor Manipulationen bei der Da<br>tenübertragung innerhalb des Systems<br>- MAC oder Signaturen |
| GNM<br>D5  | Manipulation der<br>Berechtigung              | MNMD3.3<br>MS5.3<br>MS7.3 | 1<br>Schutz von Daten und Schlüsseln im<br>NFC-Mobiltelefon - Sichere Plattform<br>2<br>Sicherung der Vertraulichkeit von Daten<br>bei der Kommunikation innerhalb des<br>Systems Berechtigung hinsichtlich Ver<br>traulichkeit – Sicherer Kommunikati<br>onskanal<br>3<br>Sicherung der Datenintegrität zum<br>Schutz vor Manipulationen bei der Da<br>tenübertragung innerhalb des Systems<br>- MAC oder Signaturen |
| GNM<br>D6  | Offenlegung Orts<br>Informationen             |                           | Nicht relevant                                                                                                                                                                                                                                                                                                                                                                                                        |
| GNM<br>D7  | Manipulation der<br>Orts<br>Informationen     | MNMD4.3<br>MS5.3<br>MS7.3 | 1<br>Schutz der Transponderdaten im NFC<br>Mobiltelefon - Sichere Plattform<br>2<br>Sicherung der Vertraulichkeit von Daten<br>bei der Kommunikation innerhalb des<br>Systems Berechtigung hinsichtlich Ver<br>traulichkeit – Sicherer Kommunikati<br>onskanal<br>3<br>Sicherung der Datenintegrität zum<br>Schutz vor Manipulationen bei der Da<br>tenübertragung innerhalb des Systems                              |

<span id="page-161-0"></span>

| Gefährdung |                                    | Maßnahmen                     | Maßnahme                                                                                                                                                                                                                                                                                                                                                                                                              |
|------------|------------------------------------|-------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|            |                                    |                               | - MAC oder Signaturen                                                                                                                                                                                                                                                                                                                                                                                                 |
| GNM<br>D8  | Schutz vor DoS<br>Angriffen        | MNMD1.2<br>MNMD2.2            | 1<br>Vermitteln des Ablaufs und der Nut<br>zungsbedingungen – Information vor<br>Ort<br>2<br>Ausweichen auf alternativen Vertriebs<br>kanal .- Lokale Information / Vorhalten<br>von Kapazitäten                                                                                                                                                                                                                      |
| GNM<br>D9  | Schutz der Per<br>sonendaten       | MNMD3.3<br>MS5.3<br>MS7.3     | 1<br>Schutz von Daten und Schlüsseln im<br>NFC-Mobiltelefon - Sichere Plattform<br>2<br>Sicherung der Vertraulichkeit von Daten<br>bei der Kommunikation innerhalb des<br>Systems Berechtigung hinsichtlich Ver<br>traulichkeit – Sicherer Kommunikati<br>onskanal<br>3<br>Sicherung der Datenintegrität zum<br>Schutz vor Manipulationen bei der Da<br>tenübertragung innerhalb des Systems<br>- MAC oder Signaturen |
| GNM<br>D10 | Manipulation von<br>Display-Texten | MNMD1.1<br>MNMD2.1<br>MNMD5.1 | 1<br>Vermitteln des Ablaufs und der Nut<br>zungsbedingungen – Information bei<br>Bestellung<br>2<br>Ausweichen auf alternativen Vertriebs<br>kanal .- Lokale Information / Vorhalten<br>von Kapazitäten<br>3<br>Überprüfung der Funktion des NFC<br>Mobiltelefons/Display                                                                                                                                             |

**Tabelle 11–7 Maßnahmen zum aktiven NFC-Mobiltelefon im Einsatzszenario "Dauerberechtigung mit Fahrpreisermittlung"** 

# **11.1.4 Schutz des lokalen Transponders**

# **11.1.4.1 Relevante Gefährdungen den lokalen Transponder**

Die folgende Tabelle enthält die speziellen Gefährdungen für dieses Einsatzszenario.

| Gefährdung |                                                                                      | Schutz<br>bedarf | Bemerkungen                                                                                                                 |
|------------|--------------------------------------------------------------------------------------|------------------|-----------------------------------------------------------------------------------------------------------------------------|
| GIF1       | Mangelnde Kompa<br>tibilität der Schnitt<br>stellen Transponder<br>–NFC-Mobiltelefon | 3                | Mangelnde Kompatibilität der Schnittstellen<br>von Infrastrukturkomponenten kann eine große<br>Anzahl von Kunden betreffen. |
| GIF2       | Abhören                                                                              | -                | Kein Schutzbedarf, da Transponderdaten bzgl.<br>Manipulation geschützt und Offenlegung der<br>Transponderdaten unkritisch   |
| GTR1       | Unerlaubtes Ausle<br>sen der Ortsinforma-                                            | -                | Kein Schutzbedarf, da Transponderdaten bzgl.<br>Manipulation geschützt und Offenlegung der                                  |

<span id="page-162-0"></span>

| Gefährdung |                                                                 | Schutz<br>bedarf | Bemerkungen                  |
|------------|-----------------------------------------------------------------|------------------|------------------------------|
|            | tion                                                            |                  | Transponderdaten unkritisch. |
| GTR2       | Unerlaubtes Schrei<br>ben / Manipulieren<br>der Ortsinformation | 3                |                              |
| GTR3       | Klonen des lokalen<br>Transponders                              | 3                |                              |
| GTR4       | Emulieren des loka<br>len Transponders                          | 3                |                              |
| GTR5       | Umplatzieren des<br>lokalen Transpon<br>ders                    | 3                |                              |
| GTR6       | Ausbringen zusätzli<br>cher Transponder                         | 3                |                              |
| GTR7       | Fehlfunktion des<br>lokalen Transpon<br>ders                    | 3                |                              |
| GTR8       | Fehlen einer Rück<br>falllösung bei Fehl<br>funktion            | 3                |                              |

**Tabelle 11–8 Relevante Gefährdungen des lokalen Transponder im Einsatzszenario "Dauerberechtigung mit Fahrpreisermittlung"** 

# **11.1.4.2 Definition relevanter Anwendungsfälle für den lokalen Transponder**

Die in Kapitel [11.1.3.1](#page-158-1) benannten Gefährdungen sollen für folgende Anwendungsfälle betrachtet werden:

| Anwendungsfall                                  | Relevanz | Bemerkungen                                                                                 |
|-------------------------------------------------|----------|---------------------------------------------------------------------------------------------|
| Identifizierung bei Anmeldung<br>und Bestellung | -        |                                                                                             |
| Initialisieren des lokalen<br>Transponders      | +        |                                                                                             |
| Nachladen der Anwendung                         | -        |                                                                                             |
| Einbringen der Ortsinformation                  | +        | Ggf. auch während der Initialisierung                                                       |
| Nachladen der Berechtigung                      | -        |                                                                                             |
| Auslieferung                                    | +        | ggf. sind auch vorkonfigurierte NFC<br>Mobiltelefone über den Produktanbieter<br>erhältlich |
| Check-in (offline)                              | +        |                                                                                             |
| Check-out (offline)                             | +        |                                                                                             |

<span id="page-163-0"></span>

| Anwendungsfall             | Relevanz | Bemerkungen                                    |
|----------------------------|----------|------------------------------------------------|
| Check-in (online)          | -        |                                                |
| Check-out (online)         | -        |                                                |
| Kontrolle des Transponders | +        | Einfacher Ausleseprozess                       |
| Sperrung des Transponders  | +        | Im Managementsystem für lokale Transpon<br>der |
| Schlüsselmanagement        | +        |                                                |

#### **Tabelle 11–9 Relevante Anwendungsfälle Einsatzszenario "Dauerberechtigung mit Fahrpreisermittlung"**

# **11.1.4.3 Definition von Schutzmaßnahmen für den lokalen Transponder**

Ausgehend von den relevanten Gefährdungen und Anwendungsfällen aus den beiden vorangegangenen Kapiteln werden hier spezifische Schutzmassnahmen definiert. Diese Maßnahmen sind in Kapitel [8.4](#page-75-1) beschrieben.

| Gefährdung |                                                                                         | Maßnahmen | Maßnahme                                                                                             |  |
|------------|-----------------------------------------------------------------------------------------|-----------|------------------------------------------------------------------------------------------------------|--|
| GIF1       | Mangelnde Kom<br>patibilität der<br>Schnittstellen<br>Transponder –<br>NFC-Mobiltelefon | MS1.3     | 1<br>Einführung von Schnittstellentests und<br>Freigabeverfahren - Zertifizierung                    |  |
| GIF2       | Abhören                                                                                 |           | nicht relevant                                                                                       |  |
| GTR1       | Unerlaubtes Aus<br>lesen der Ortsin<br>formation                                        |           | nicht relevant                                                                                       |  |
| GTR2       | Unerlaubtes<br>Schreiben / Ma<br>nipulieren der<br>Ortsinformation                      | MTR1.3    | 1<br>Sichern der Authentizität der Ortsinfor<br>mation - Sicherung durch asymmetri<br>sche Verfahren |  |
| GTR3       | Klonen des loka<br>len Transponders                                                     | MTR1.3    | 1<br>Sichern der Authentizität der Ortsinfor<br>mation - Sicherung durch asymmetri<br>sche Verfahren |  |
| GTR4       | Emulieren des<br>lokalen Transpon<br>ders                                               | MTR1.3    | 1<br>Sichern der Authentizität der Ortsinfor<br>mation - Sicherung durch asymmetri<br>sche Verfahren |  |
| GTR5       | Umplatzieren des<br>lokalen Transpon<br>ders                                            | MTR3.3    | 1<br>Schutz der Installation von Transpon<br>dern -Sicherstellen der Authentizität                   |  |
| GTR6       | Ausbringen zu<br>sätzlicher<br>Transponder                                              | MTR3.3    | 1<br>Schutz der Installation von Transpon<br>dern -Sicherstellen der Authentizität                   |  |
| GTR7       | Fehlfunktion des<br>lokalen Transpon                                                    | MTR2.3    | 1<br>Schutz vor Vandalismus / DoS - Funkti<br>onsprüfung                                             |  |

<span id="page-164-0"></span>

| Gefährdung |                                                    | Maßnahmen | Maßnahme                                                                                                 |
|------------|----------------------------------------------------|-----------|----------------------------------------------------------------------------------------------------------|
|            | ders                                               |           |                                                                                                          |
| GTR8       | Fehlen einer<br>Rückfalllösung<br>bei Fehlfunktion | MNMD2.1   | 1<br>Ausweichen auf alternativen Vertriebs<br>kanal .- Lokale Information / Vorhalten<br>von Kapazitäten |

| Tabelle 11–10 | Maßnahmen zum lokalen Transponder im Einsatzszenario "Dauerbe |
|---------------|---------------------------------------------------------------|
|               | rechtigung mit Fahrpreisermittlung"                           |

# **11.1.5 Verbleibende Risiken**

Aus technischen oder wirtschaftlichen Gründen ist es nicht immer möglich, Gefährdungen durch Maßnahmen vollständig zu neutralisieren. In solchen Fällen bleibt ein Risiko bestehen.

Das Restrisiko ist im Laufe der Planung der konkreten Implementierung zu bestimmen und zu dokumentieren.

# <span id="page-165-0"></span>**12 Referenzimplementierung Touch & Travel**

Die Referenzimplementierung Touch & Travel setzt auf der Spezifikation der VDV Kernapplikation auf.

Die Spezifikation der Systemlösung der VDV Kernapplikation wurde im Jahr 2004 abgeschlossen. Erste Implementierungen, die grundsätzlich den Einsatzszenarien "EFS Zeitkarte" und "Interfunktionsfähige Dauerberechtigung mit Fahrpreisermittlung" entsprechen, wurden ab 2005 bei mehreren Dienstleistern in den Echtbetrieb eingeführt. Für die VDV Kernapplikation gelten mithin die Aussagen zu Bestandsimplementierungen aus Kapitel [8.4.1](#page-75-2).

Die vorhandenen Implementierungen der VDV Kernapplikation weichen in einigen Punkten von den in den Kapiteln [10](#page-118-1) und [11](#page-151-1) beschriebenen Beispielen ab:

- 1 Bei der Übertragung von Berechtigungen ist auf Schutzmaßnahmen gegen Abhören entsprechend MS2 verzichtet worden. Die Kernapplikation ermöglicht die strikte Trennung der personenbezogenen Daten von den Berechtigungsdaten, so dass dann insbesondere keine personenbezogene Daten mit den Berechtigungsdaten übertragen werden. Das Sicherheitsziel des Schutzes der Berechtigung wird bei der Implementierung der VDV KA auch dann erfüllt, wenn die Berechtigung lesbar vorliegen sollte. Dazu wurden folgende Maßnahmen implementiert:
	- a Jede Berechtigungen wird gegen Manipulation durch ein MAC-Verfahren geschützt.
	- b Das Aufbringen einer Berechtigung auf ein gültiges Trägermedium bzw. das Ändern oder Löschen setzt immer die erfolgreiche Authentifikation zwischen dem Trägermedium und dem verwendeten Lesegerät voraus.
	- c Die Nutzung einer Berechtigung am CICO-Terminal oder am Kontrollgerät setzt ebenfalls die erfolgreiche Authentifikation zwischen dem Trägermedium und dem verwendeten Lesegerät voraus.

Damit ist nicht nur ein Schutz gegen die Manipulation sondern auch gegen das Kopieren und Emulieren von Berechtigungen gegeben.

- 2 Für die asymmetrische Authentifikation zwischen Trägermedium und Lesegerät wird das RSA-Verfahren mit 1024Bit Schlüssellänge verwendet. Der Root-Schlüssel hat eine Länge von mindestens 1984 Bit, die Sub-CA-Schlüssel eine Länge von 1536 Bit.
- 3 Für die symmetrische Authentifikation zwischen Trägermedium und Lesegerät wird das TDES-Verfahren mit mindestens 112 Bit Schlüssellänge verwendet.
- 4 Zur MAC-Sicherung kommt ein Retail-TDES-MAC mit einer Schlüssellänge von mindestens 112 Bit zum Einsatz.

Ohne das Ergebnis einer formalen Prüfung vorwegnehmen zu wollen, werden diese Abweichungen als unkritisch bewertet.. Allerdings sollten mit der nächsten Überarbeitung des Systems Verfahren gemäß [ALGK\_BSI] eingeführt werden.

# <span id="page-166-0"></span>**13 Literaturverzeichnis**

# [RIKCHA]

Bundesamt für Sicherheit in der Informationstechnik: RFID – Security Aspects and Prospective Applications of RFID Systems,

[http://www.bsi.de/english/publications/studies/rfid/RIKCHA\\_en.htm](http://www.bsi.de/english/publications/studies/rfid/RIKCHA_en.htm), Abruf vom 15.09.2008

[GSHB]

Bundesamt für Sicherheit in der Informationstechnik: IT-Grundschutz Kataloge, [http://www.bsi.de/gshb/deutsch/index.htm,](http://www.bsi.de/gshb/deutsch/index.htm) Abruf vom 15.09.2008

[ISO 24014]

International Organization for Standardization: ISO 24014-1:2007 Public transport - Interoperable Fare Management System - Part 1: Architecture, [http://www.iso.org/iso/iso\\_catalogue.htm,](http://www.iso.org/iso/iso_catalogue.htm) Abruf vom 15.09.2008

### [IOPTA]

DIN EN15320:2008-02 Identifikationskartensysteme - Landgebundene Transportanwendungen - Interoperable Anwendungen für den öffentlichen Verkehr – Rahmenwerk (Interoperable Public Transport Application - IOPTA),

<http://www.beuth.de/langanzeige/DIN+EN+15320/de/97592959.html>, Abruf vom 15.09.2008

### [VDV\_KM]

Verband Deutscher Verkehrsunternehmen (VDV): Spezifikation des Kundenmediums der VDV-Kernapplikation

### [ISO 7816-13]

International Organization for Standardization: ISO 7816-13 Identification Cards - Integrated Circuit Cards - Part 13: Commands for application management in a multi-application environment, [http://www.iso.org/iso/iso\\_catalogue.htm](http://www.iso.org/iso/iso_catalogue.htm), Abruf vom 15.09.2008

# [ALGK\_BSI]

Bundesamt für Sicherheit in der Informationstechnik: Technische Richtlinie Kryptographische Verfahren: Empfehlungen und Schlüssellängen (BSI- TR-02102), <http://www.bsi.de/literat/tr/tr02102/index.htm>, Abruf vom 15.09.2008

# [TR\_eCARD]

Bundesamt für Sicherheit in der Informationstechnik: Technische Richtlinie für die eCard-Projekte der Bundesregierung (BSI-TR-03116), <http://www.bsi.de/literat/tr/tr03116/index.htm>, Abruf vom 15.09.2008

### [BSI\_PICC\_TestSpec]

Bundesamt für Sicherheit in der Informationstechnik: Prüfkriterien für elektronische Reisedokumente / ePassport Conformity Testing (BSI TR-03105), Teil 2 PICC - Prüfungen auf den Ebenen 1-4: Bitübertragungs-, Sicherungs-, Vermittlungs- und Transportschicht / Test Plan For ICAO Compliant MRTD with Secure Contactless Integrated Circuit - Version 1.03.1, <http://www.bsi.de/literat/tr/tr03105/index.htm>, Abruf vom 15.09.2008

[BSI\_PCD\_TestSpec]

Bundesamt für Sicherheit in der Informationstechnik: Prüfkriterien für elektronische Reisedokumente / ePassport Conformity Testing (BSI TR-03105), Teil 4 PCD - Prüfungen auf den Ebenen 1-4: Bitübertragungs-, Sicherungs-, Vermittlungs- und Transportschicht / Test Plan For ICAO Compliant Proximity Coupling Device (PCD) Layer 1-4 - Version 0.6, <http://www.bsi.de/literat/tr/tr03105/index.htm>, Abruf vom 15.09.2008

### [NFCIP2]

International Organization for Standardization: [ISO/IEC 21481:2005](http://standards.iso.org/ittf/PubliclyAvailableStandards/c040261_ISO_IEC_21481_2005(E).zip) Information technology - Telecommunications and information exchange between systems - Near Field Communication Interface and Protocol -2 (NFCIP-2), [http://www.iso.org/iso/iso\\_catalogue.htm](http://www.iso.org/iso/iso_catalogue.htm), Abruf vom 15.09.2008

### [HW\_PP1]

Bundesamt für Sicherheit in der Informationstechnik: Smartcard IC Platform Protection Profile BSI-PP-0002-2001 Version 1.0, [http://www.bsi.de/zertifiz/zert/reporte/pp0002a.pdf,](http://www.bsi.de/zertifiz/zert/reporte/pp0002a.pdf) Abruf vom 15.09.2008

### [HW\_PP2]

Bundesamt für Sicherheit in der Informationstechnik: Security IC Platform Protection Profile BSI-PP-0035-2007 Version 1.0,<http://www.bsi.de/zertifiz/zert/reporte/pp0035a.pdf>, Abruf vom 15.09.2008

# <span id="page-168-0"></span>**14 Abkürzungsverzeichnis**

| CICO | Check-in / Check-out - Verfahren bei dem sich der Fahrgast vor<br>Antritt der Beförderung mit Hilfe des Mediums aktiv anmeldet<br>und nach Erreichen des Ziels aktiv abmeldet.            |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| DoS  | Denial of Service                                                                                                                                                                         |
| ECC  | Elliptic Curve Cryptography                                                                                                                                                               |
| EFS  | Elektronischer Fahrschein                                                                                                                                                                 |
| eID  | Elektronischer Identitätsnachweis                                                                                                                                                         |
| ePA  | Elektronischer Personalausweis. Kann möglicherweise die<br>Funktion der eID im Kontext dieser Richtlinie einnehmen.                                                                       |
| IFM  | Interfunktionsfähiges elektronisches Fahrgeldmanagement                                                                                                                                   |
| KA   | Kernapplikation. Interfunktionsfähiges ÖPV-eTicketing - Kon<br>zept des Verbands Deutscher Verkehrunternehmen.                                                                            |
| NFC  | Near Field Communication                                                                                                                                                                  |
| NMD  | NFC Mobile Device, NFC-Mobiltelefon, kann als passives RF<br>Trägermedium verwendet werden oder im "PCD-Mode" die<br>Kommunikation über die kontaktlose Schnittstelle steuern.            |
| ÖPV  | Öffentlicher Personenverkehr                                                                                                                                                              |
| OTA  | Over-The-Air. "Fern-Konfiguration" - Eine Möglichkeit Daten<br>ohne Kabel oder Infrarot etc. auf das Mobiltelefon zu senden.<br>Die Daten werden direkt über das Mobilfunknetz geschickt. |
| PA   | Personalausweis                                                                                                                                                                           |
| RF   | Radio Frequency                                                                                                                                                                           |
| RFID | Radio Frequency Identification                                                                                                                                                            |
| SAM  | Secure Authentification Module                                                                                                                                                            |
| UID  | Unique Identifier. Eindeutige, unveränderbare Kennung des<br>Chip                                                                                                                         |
| USV  | Unterbrechungsfreie Stromversorgung                                                                                                                                                       |
| VDV  | Verband Deutscher Verkehrunternehmen                                                                                                                                                      |