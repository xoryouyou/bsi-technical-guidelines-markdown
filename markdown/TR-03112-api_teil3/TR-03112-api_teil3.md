![](_page_0_Picture_0.jpeg)

![](_page_0_Picture_2.jpeg)

# Technical Guideline TR-03112-3 eCard-API-Framework – Management-Interface Version 1.1.5 7. April 2015

Bundesamt für Sicherheit in der Informationstechnik Postfach 20 03 63 53133 Bonn

E-Mail: ecard.api@bsi.bund.de Internet: https://www.bsi.bund.de © Bundesamt für Sicherheit in der Informationstechnik 2015

| 1.1<br>Key Words5<br>1.2<br>XML-Schema6<br>2<br>Overview of the Management-Interface7<br>2.1<br>Objective7<br>2.2<br>Functions7<br>2.2.1<br>Management of the eCard-API-Framework7 |  |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|                                                                                                                                                                                    |  |
|                                                                                                                                                                                    |  |
|                                                                                                                                                                                    |  |
|                                                                                                                                                                                    |  |
|                                                                                                                                                                                    |  |
|                                                                                                                                                                                    |  |
| 2.2.2<br>Card management8                                                                                                                                                          |  |
| 2.2.3<br>Card terminal management8                                                                                                                                                 |  |
| 2.2.4<br>Trusted viewer management8                                                                                                                                                |  |
| 2.2.5<br>Identity management8                                                                                                                                                      |  |
| 2.2.6<br>Service management9                                                                                                                                                       |  |
| 3<br>Specification of the eCard Management-Interface10                                                                                                                             |  |
| 3.1<br>Management of the eCard-API-Framework10                                                                                                                                     |  |
| 3.1.1<br>InitializeFramework10                                                                                                                                                     |  |
| 3.1.2<br>TerminateFramework11                                                                                                                                                      |  |
| 3.1.3<br>APIACLList12                                                                                                                                                              |  |
| 3.1.4<br>APIACLModify16                                                                                                                                                            |  |
| 3.1.5<br>FrameworkUpdate18                                                                                                                                                         |  |
| 3.1.6<br>GetDefaultParameters19                                                                                                                                                    |  |
| 3.1.7<br>SetDefaultParameters26                                                                                                                                                    |  |
| 3.2<br>Card management28                                                                                                                                                           |  |
| 3.2.1<br>GetCardInfoList28                                                                                                                                                         |  |
| 3.2.2<br>SetCardInfoList29                                                                                                                                                         |  |
| 3.2.3<br>AddCardInfoFiles31                                                                                                                                                        |  |
| 3.2.4<br>DeleteCardInfoFiles33                                                                                                                                                     |  |
| 3.3<br>Card terminal management34                                                                                                                                                  |  |
| 3.3.1<br>RegisterIFD34<br>3.3.2<br>UnregisterIFD37                                                                                                                                 |  |
|                                                                                                                                                                                    |  |
| 3.4<br>Trusted viewer management39                                                                                                                                                 |  |
| 3.4.1<br>GetTrustedViewerList39                                                                                                                                                    |  |
| 3.4.2<br>GetTrustedViewerConfiguration40<br>3.4.3<br>SetTrustedViewerConfiguration42                                                                                               |  |
| 3.4.4<br>AddTrustedViewer44                                                                                                                                                        |  |
| 3.4.5<br>DeleteTrustedViewer45                                                                                                                                                     |  |
| 3.5<br>Identity management46                                                                                                                                                       |  |
| 3.5.1<br>GetTrustedIdentities46                                                                                                                                                    |  |
| 3.5.2<br>AddTrustedCertificate49                                                                                                                                                   |  |
| 3.5.3<br>AddCertificate50                                                                                                                                                          |  |
| 3.5.4<br>ExportCertificate54                                                                                                                                                       |  |
| 3.5.5<br>DeleteCertificate55                                                                                                                                                       |  |
| 3.5.6<br>AddTSL56                                                                                                                                                                  |  |
| 3.5.7<br>ExportTSL59                                                                                                                                                               |  |
| 3.5.8<br>DeleteTSL60                                                                                                                                                               |  |
| 3.6<br>Service management62                                                                                                                                                        |  |
| 3.6.1<br>GetOCSPServices62                                                                                                                                                         |  |
| 3.6.2<br>SetOCSPServices64                                                                                                                                                         |  |

| 3.6.3 | GetDirectoryServices65 |  |
|-------|------------------------|--|
| 3.6.4 | SetDirectoryServices66 |  |
| 3.6.5 | GetTSServices68        |  |
| 3.6.6 | SetTSServices70        |  |

# <span id="page-4-0"></span>**1 Overview of the eCard-API-Framework**

The objective of the eCard-API-Framework is the provision of a simple and homogeneous interface to enable standardised use of the various smart cards (eCards) for different applications.

The eCard-API-Framework is sub-divided into the following layers:

- **•** Application-Layer
- **•** Identity-Layer
- **•** Service-Access-Layer
- **•** Terminal-Layer

The **Application-Layer** contains the various applications which use the eCard-API-Framework to access the eCards and their associated functions. Application-specific "convenience interfaces", in which the recurring invocation sequences may be encapsulated in application-specific calls, may also exist in this layer. However, these interfaces are currently *not* within the scope of the e-Card-API-framework.

The **Identity-Layer** comprises the eCard-Interface and the Management interface, and therefore functions for the use and management of electronic identities as well as for management of the eCard-API-Framework.

The *eCard-Interface* (refer to [TR-03112-2]) allows to request certificates as well as the encryption, signature and time-stamping of documents.

In the M*anagement-Interface* (refer to [TR-03112-3]), functions for updating the framework and the management of trusted identities, smart cards, card terminals, and default behaviour are available.

The **Service-Access-Layer** provides, in particular, functions for cryptographic primitives and biometric mechanisms in connection with cryptographic tokens, and comprises the ISO24727-3-Interface and the Support-Interface.

The *ISO24727-3-Interface* defined in the present document is a webservice-based implementation of the standard of the same name [ISO24727-3]. This interface contains functions to establish (cryptographically protected) connections to smart cards, to manage card applications, to read or write data, to perform cryptographic operations and to manage the respective key material (in the form of so-called "differential identities"). In the process, all functions which use or manage "differential identities" are parameterised by means of protocol-specific object identifiers so that the different protocols which are defined in the present document MAY be used with a standardised interface (refer to [TR-03112-7]).

The S*upport-Interface* (refer to [TR-03112-5]) contains a range of supporting functions.

The **Terminal-Layer** primarily contains the *IFD-Interface* (refer to [TR-03112-6]). This layer takes over the generalisation of specific card terminal types and various interfaces as well as communication with the smart card. For the user it is unimportant whether the card is addressed by PC/SC, a SICCT terminal or a proprietary interface, or whether it has contacts or is contact-less.

## **1.1 Key Words**

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in [RFC2119]. The key word "CONDITIONAL" is to be interpreted as follows:

CONDITIONAL: The usage of an item is dependent on the usage of other items. It is therefore further qualified under which conditions the item is REQUIRED or RECOMMENDED.

## **1.2 XML-Schema**

A XML-Schema is provided together with this Technical Guideline. In case of incongruencies, the specifications in this text take precedence. The graphical representations of the XML-Schema illustrate the schema. Note that the text of this Guideline might further restrict the presence or mulitplicity of elements as compared to the schema definition.

# <span id="page-6-0"></span>**2 Overview of the Management-Interface**

## **2.1 Objective**

The Management-Interface provides important administration functions for the eCard-API-Framework.

#### **2.2 Functions**

The Management-Interface provides the following function groups:

- **•** Management of the eCard-API-Framework
- **•** Card management
- **•** Card terminal management
- **•** Trusted viewer management
- **•** Identity management
- **•** Service management

#### **2.2.1 Management of the eCard-API-Framework**

This function group includes functions for the management of the eCard-API framework itself:

- **•** The InitializeFramework function initialises the eCard-API-Framework.
- **•** The TerminateFramework function terminates all sessions and services of the eCard-API-Framework.
- **•** The APIACLList function is OPTIONAL and MAY provide the currently defined access control regulations for access to the individual functions of the eCard-API-Framework. If this function is supported it MAY ONLY be made available to an *administrator* who is authenticated in accordance with the applicable security policies for the operation of the eCard-API-Framework.
- **•** The ACLModify function is OPTIONAL and MAY be used to modify the access control rules which govern the access to the functions of the eCard-API-Framework. Via this access control mechanism it is possible, for example, to grant or refuse access of an application to the Transmit function in the IFD-Interface (also refer to [TR-03112-6]) for the implementation of a "transparent channel" to a card. As a consequence, it is also possible to define whether and under which circumstances remote eCard-API-Frameworks are allowed to access a local eCard-API-Framework. If this function is supported it MAY ONLY be made available to an *administrator* who is authenticated in accordance with the applicable security policies applicable for operation of the eCard-API-Framework.
- **•** The FrameworkUpdate function checks whether an update is available for the eCard-API-Framework and performs such an update if necessary. The detailed processes during execution of this function are protocol-specific (refer to [TR-03112-7]).
- **•** GetDefaultParameters: Default behaviour can be specified for the eCard-API-Framework to also permit the easiest possible invocations by the client application for potentially complex operations (e.g. for creating and verifying electronic signatures, refer to [TR-03112-2], Section

3.2.1 - 3.2.2). The currently specified default parameters MAY be read out with the GetDefaultParameters function.

**•** The SetDefaultParameters function is used to write the default parameters, which then determine the standard behaviour of the eCard-API-Framework.

#### **2.2.2 Card management**

- **•** The GetCardInfoList function supplies the list of card types which are known from the CardInfo files.
- **•** The SetCardInfoList function saves an ordered list of card types in form of URIs, which determine the steps during the card recognition procedure.
- **•** With the AddCardInfoFiles function it is possible to add a series of CardInfo files.
- **•** The DeleteCardInfoFiles function deletes a series of CardInfo files.

#### **2.2.3 Card terminal management**

- **•** With the RegisterIFD function it is possible to add a card terminal with all configuration information.
- **•** The UnregisterIFD function deletes a card terminal.

#### **2.2.4 Trusted viewer management**

- **•** The GetTrustedViewerList function provides a list of available trustworthy display components (trusted viewer).
- **•** The GetTrustedViewerConfiguration function reads the configuration information for a specific trusted viewer which is stored in the eCard-API-Framework.
- **•** The SetTrustedViewerConfiguration function writes the configuration information for a specific trusted viewer.
- **•** With the AddTrustedViewer function, a trusted viewer can be added with all configuration information.
- **•** The DeleteTrustedViewer function deletes a trusted viewer.

#### **2.2.5 Identity management**

- **•** The GetTrustedIdentities function provides a list of the trustworthy identities in form of Trust-Service status lists (TSL) and trustworthy certificates.
- **•** With the AddTrustedCertificate function, a certificate can be added to the list of trusted certificates.
- **•** With the AddCertificate function, a non-trustworthy certificate which can be used for signature verification or encryption can be added to the certificate database.
- **•** With the ExportCertificate function, a (trustworthy or non-trustworthy) certificate can be exported.
- **•** The DeleteCertificate function deletes an existing (trustworthy or non-trustworthy) certificate from the certificate database.
- **•** With the AddTSL function, a Trust-Service status list can be added to the eCard-API-Framework.
- **•** With the ExportTSL function, a Trust-Service status list can be exported.
- **•** With the DeleteTSL function, a Trust-Service status list can be deleted from the list of trustworthy identities.

#### **2.2.6 Service management**

- **•** The GetOCSPServices function reads the list of available OCSP responders together with the corresponding configuration information.
- **•** The SetOCSPServices function writes the list of available OCSP responders together with the corresponding configuration information.
- **•** The GetDirectoryServices function reads the list of the directory services accessible via LDAP or HTTP with all corresponding configuration information.
- **•** The SetDirectoryServices function writes a list of the directory services accessible via LDAP or HTTP with all corresponding configuration information.
- **•** The GetTSServices function reads the list of time stamping services with all corresponding configuration information.
- **•** The SetTSServices function writes a list of time stamping services together with all corresponding configuration information.

# <span id="page-9-0"></span>**3 Specification of the eCard Management-Interface**

## **3.1 Management of the eCard-API-Framework**

#### **3.1.1 InitializeFramework**

| Name                     | InitializeFramework                                                                                                                           |                                                                                                                                                                                                                                                                                            |  |
|--------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Description              | The InitializeFramework function initialises the eCard-API-Framework<br>and can be used to query the version of the framework implementation. |                                                                                                                                                                                                                                                                                            |  |
| Invocation<br>parameters |                                                                                                                                               |                                                                                                                                                                                                                                                                                            |  |
|                          | Invocation of the InitializeFramework function.                                                                                               |                                                                                                                                                                                                                                                                                            |  |
|                          | No invocation parameters                                                                                                                      |                                                                                                                                                                                                                                                                                            |  |
| Return                   | Return of the InitializeFramework function.                                                                                                   |                                                                                                                                                                                                                                                                                            |  |
|                          | Name                                                                                                                                          | Description                                                                                                                                                                                                                                                                                |  |
|                          | dss:Result                                                                                                                                    | Contains the status information and the errors of an<br>executed action. This element is described in more<br>detail below.                                                                                                                                                                |  |
|                          | Version                                                                                                                                       | States the version of the eCard-API-Framework started<br>with this function and comprises up to three integers<br>Major, Minor (optional) and SubMinor (optional).<br>Compliance to this version of the<br>eCard-API-Framework SHALL be indicated by (Ma<br>jor.Minor.Subminor) = (1.1.5). |  |

|               | Status information and errors in InitializeFramework (also refer to<br>[TR-03112-1] Sections 4.1 and 4.2).                                                                                                                                          |                                                                                                                    |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------|
|               | Name                                                                                                                                                                                                                                                | Error codes                                                                                                        |
|               | ResultMajor                                                                                                                                                                                                                                         | •<br>/resultmajor#ok                                                                                               |
|               | ResultMinor                                                                                                                                                                                                                                         | •<br>/resultmajor#error<br>•<br>/resultminor/al/common#internalError<br>•<br>/resultminor/al/common#parameterError |
|               | ResultMessage                                                                                                                                                                                                                                       | MAY contain more detailed information on the<br>error which occurred if required.                                  |
| Precondition  | The service required for initialisation of the eCard-API-Framework with<br>InitializeFramework is started by mechanisms of the operating system.                                                                                                    |                                                                                                                    |
| Postcondition | The eCard-API-Framework is initialised, and the functions available according<br>to the APIACL (also refer to 3.1.3) can then be invoked by the client application.                                                                                 |                                                                                                                    |
| Note          | For initialisation of the eCard-API-Framework, the function Initialize<br>(also refer to [ISO24727-3]) is primarily invoked, and a context with the IFD<br>layer is established with the function EstablishContext (also refer to<br>[ISO24727-4]). |                                                                                                                    |
|               | As there is no error, if this function is called and the framework already has been<br>initialized, this function MAY be used at any time to query its version.                                                                                     |                                                                                                                    |

#### <span id="page-10-0"></span>**3.1.2 TerminateFramework**

| Name                     | TerminateFramework                                                                                                                                                     |                                                                                                                             |
|--------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|
| Description              | The TerminateFramework function terminates the eCard-API-Framework,<br>closes any open connections and executes any necessary updates (also refer to<br>[TR-03112-7]). |                                                                                                                             |
| Invocation<br>parameters | Invocation of the TerminateFramework function.                                                                                                                         |                                                                                                                             |
|                          | No invocation parameters                                                                                                                                               |                                                                                                                             |
| Return                   | Return of the TerminateFramework function.                                                                                                                             |                                                                                                                             |
|                          | Name                                                                                                                                                                   | Description                                                                                                                 |
|                          | dss:Result                                                                                                                                                             | Contains the status information and the errors of an<br>executed action. This element is described in more<br>detail below. |

|               | Status information and errors in Terminate (also refer to [TR-03112-1]<br>Sections 4.1 and 4.2).                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                   |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
|               | Name<br>Error codes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                   |
|               | ResultMajor                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | •<br>/resultmajor#ok                                                              |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | •<br>/resultmajor#error                                                           |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | •<br>/resultmajor#warning                                                         |
|               | ResultMinor                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | •<br>/resultminor/al/common#internalError                                         |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | •<br>/resultminor/al/common#parameterError                                        |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | •<br>/resultminor/al/common#<br>sessionTerminatedWarning                          |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | •<br>/resultminor/al/common#notInitialized                                        |
|               | ResultMessage                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | MAY contain more detailed information on the error<br>which occurred if required. |
| Precondition  | The eCard-API-Framework was initialised.                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                   |
| Postcondition | The eCard-API-Framework was terminated so that only the<br>InitializeFramework function can be invoked.                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                   |
| Note          | This function terminates all open card connections using<br>CardApplicationDisconnect (also refer to [TR-03112-4]) and<br>Disconnect (also refer to [TR-03112-6]) and then finally invokes<br>Terminate (also refer to [TR-03112-4]), ReleaseContext (also refer to<br>[TR-03112-6]) and TC_API_Close (also refer to [TR-03112-2]). In addition,<br>any necessary updates are performed as a final action (also refer to<br>[TR-03112-7]); these updates apply the next time the system is started. |                                                                                   |

#### <span id="page-11-0"></span>**3.1.3 APIACLList**

| Name                     | APIACLList                                                                                            |                                                                                                                                                                                                        |  |
|--------------------------|-------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Description              | The APIACLList function is OPTIONAL and returns the access control list<br>for the stated APICall(s). |                                                                                                                                                                                                        |  |
|                          |                                                                                                       | If this function is supported it MAY ONLY be made available to an<br>administrator who is authenticated in accordance with the applicable<br>security policy for operation of the eCard-API-Framework. |  |
| Invocation<br>parameters |                                                                                                       |                                                                                                                                                                                                        |  |
|                          | Invocation of the APIACLList function.                                                                |                                                                                                                                                                                                        |  |
|                          | Name                                                                                                  | Description                                                                                                                                                                                            |  |

<span id="page-12-0"></span>

|                   | APICall                                                                                                                                                                                  | MUST be supported. | MAY occur several times and contains the name of the<br>APICall of the eCard-API framework for which the<br>access control information is to be determined.<br>In this context access control information for all functions<br>defined in the framework of the eCard-API-Framework |  |
|-------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|                   | In addition, access control information for functions MAY<br>be managed in additional "convenience layers".                                                                              |                    |                                                                                                                                                                                                                                                                                    |  |
| Return parameters | Return of the APIACLList function.                                                                                                                                                       |                    |                                                                                                                                                                                                                                                                                    |  |
|                   |                                                                                                                                                                                          |                    |                                                                                                                                                                                                                                                                                    |  |
|                   | Name                                                                                                                                                                                     |                    | Description                                                                                                                                                                                                                                                                        |  |
|                   | dss:Result                                                                                                                                                                               |                    | Contains the status information and the<br>errors of an executed action. This<br>element is described in more detail<br>below.                                                                                                                                                     |  |
|                   | APIAccessControlList                                                                                                                                                                     |                    | Contains the access control information<br>for all stated APICalls of the<br>eCard-API-Framework (see below for<br>details).                                                                                                                                                       |  |
|                   |                                                                                                                                                                                          |                    |                                                                                                                                                                                                                                                                                    |  |
|                   | The APIAccessControlList element comprises a series of<br>APIAccessControlRule elements which each defines an access control<br>rule for access to the APICalls (see below for details). |                    |                                                                                                                                                                                                                                                                                    |  |
|                   | Name<br>Description                                                                                                                                                                      |                    |                                                                                                                                                                                                                                                                                    |  |
|                   | APIAccessRule                                                                                                                                                                            |                    | Contains an access control rule for an APICall<br>(see below for details).                                                                                                                                                                                                         |  |
|                   |                                                                                                                                                                                          |                    | In this context, the principle that an access which<br>is not explicitly permitted is forbidden applies.                                                                                                                                                                           |  |

|                                          | The APIAccessControlRule element is part of the<br>APIAccessControlList element above and contains the access control                                                                                                                                                                                                                                                                                                                                               |
|------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| information for an API function.<br>Name | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| APICall                                  | Contains the name of the API function. An<br>overview of the eCard-API-Framework is<br>provided in [TR-03112-1]. In addition, it<br>MUST be possible to manage access<br>control information for functions in<br>"convenience layers" so that in certain<br>application scenarios — and if necessary<br>for certain smart card types (e.g.<br>electronic health card) - only access to<br>well-defined and especially verified<br>special applications is possible. |
| Address                                  | MAY specify permissible IP addresses and<br>ports in the format Address:Port (d.h.<br>aaa.bbb.ccc.ddd:Port) to which the<br>respective access control rule refers.                                                                                                                                                                                                                                                                                                  |
|                                          | In this context, the wildcard "*" MAY also<br>be used (e.g. "77.87.*.*:*").<br>If this element is missing, the access<br>control rule refers to local access to the<br>eCard-API-Framework via the C- or<br>Java-interface (also refer to<br>[TR-03112-1]).                                                                                                                                                                                                         |
| TC_Protocol                              | MAY specify to which trusted channel<br>protocol (also refer to<br>CardApplicationPath in<br>[TR-03112-4]) the access control rule<br>refers.                                                                                                                                                                                                                                                                                                                       |
|                                          | If this element is missing, no trusted<br>channel protocol is assumed for the<br>respective access control rule.                                                                                                                                                                                                                                                                                                                                                    |

![](_page_14_Figure_0.jpeg)

|               | DIDStateQualifier      |                                                                                                                                                                                                                                                                                                                                             | MAY be used for certificate-based<br>authentication processes on cards (also refer<br>to [TR-03112-7]).<br>Specifies the certificate stored in the<br>certificate database which serves as trust<br>anchor in the event of a non-card based<br>authentication (e.g. by means of TLS, also<br>refer to CardApplicationPath in<br>[TR-03112-4] and TC_API_Open in<br>[TR-03112-7].). |  |  |
|---------------|------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|
|               | Certificate            |                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                    |  |  |
|               | AuthenticationState    |                                                                                                                                                                                                                                                                                                                                             | States whether the respective authentication<br>condition must be set or not (also refer to<br>[ISO24727-3] and [TR-03112-4]).                                                                                                                                                                                                                                                     |  |  |
|               | Sections 4.1 and 4.2). | Status information and errors in APIACLList (also refer to [TR-03112-1]                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                    |  |  |
|               | Name                   |                                                                                                                                                                                                                                                                                                                                             | Error codes                                                                                                                                                                                                                                                                                                                                                                        |  |  |
|               | ResultMajor            | •                                                                                                                                                                                                                                                                                                                                           | /resultmajor#ok                                                                                                                                                                                                                                                                                                                                                                    |  |  |
|               |                        | •                                                                                                                                                                                                                                                                                                                                           | /resultmajor#error                                                                                                                                                                                                                                                                                                                                                                 |  |  |
|               |                        | •                                                                                                                                                                                                                                                                                                                                           | /resultmajor#warning                                                                                                                                                                                                                                                                                                                                                               |  |  |
|               | ResultMinor            | •                                                                                                                                                                                                                                                                                                                                           | /resultminor/al/common#internalError                                                                                                                                                                                                                                                                                                                                               |  |  |
|               |                        | •                                                                                                                                                                                                                                                                                                                                           | /resultminor/al/common#parameterError                                                                                                                                                                                                                                                                                                                                              |  |  |
|               |                        | •                                                                                                                                                                                                                                                                                                                                           | /resultminor/al#unknownAPIFunction                                                                                                                                                                                                                                                                                                                                                 |  |  |
|               |                        | •                                                                                                                                                                                                                                                                                                                                           | /resultminor/dp#unknownChannelHandle                                                                                                                                                                                                                                                                                                                                               |  |  |
|               |                        | •                                                                                                                                                                                                                                                                                                                                           | /resultminor/sal#<br>securityConditionsNotSatisfied                                                                                                                                                                                                                                                                                                                                |  |  |
|               | ResultMessage          |                                                                                                                                                                                                                                                                                                                                             | MAY contain more detailed information on the error<br>which occurred if required.                                                                                                                                                                                                                                                                                                  |  |  |
| Precondition  |                        | For access to this function the administrator MUST be authenticated in<br>accordance with the applicable security policies for the operation of the<br>eCard-API-Framework.                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                    |  |  |
| Postcondition |                        |                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                    |  |  |
| Note          |                        |                                                                                                                                                                                                                                                                                                                                             | Also refer to CardApplicationACL in [TR-03112-4].                                                                                                                                                                                                                                                                                                                                  |  |  |
|               |                        | For successful access to card application services (also refer to<br>[TR-03112-4], Section 3.1.3 ff), the access control conditions for the<br>APICalls AND the specific card access control conditions MUST be met.<br>For this reason access to these [ISO24727-3] functions SHOULD be<br>permitted without restriction in general cases. |                                                                                                                                                                                                                                                                                                                                                                                    |  |  |

## **3.1.4 APIACLModify**

| Name        | APIACLModify                                                      |
|-------------|-------------------------------------------------------------------|
| Description | With the aid of the OPTIONAL APIACLModify function an access rule |

|                          | MAY be modified for a specific API function.                                                                                                                                                               |             |                                                                                                                                                                                                                            |  |
|--------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|                          | If this function is supported it MAY ONLY be made available to an<br>administrator who is authenticated in accordance with the applicable security<br>policy for the operation of the eCard-API-Framework. |             |                                                                                                                                                                                                                            |  |
|                          | Regardless of the support of this function it MUST be ensured that the<br>applicable access control policy for API-calls is enforced.                                                                      |             |                                                                                                                                                                                                                            |  |
| Invocation<br>parameters |                                                                                                                                                                                                            |             |                                                                                                                                                                                                                            |  |
|                          | Invocation of the APIACLModify function.                                                                                                                                                                   |             |                                                                                                                                                                                                                            |  |
|                          | Name                                                                                                                                                                                                       |             | Description                                                                                                                                                                                                                |  |
|                          | APIAccessControlList                                                                                                                                                                                       |             | Contains the modified access control list<br>for APICalls, which is activated at the<br>latest the next time the<br>eCard-API-Framework is started. Details<br>on the<br>APIAccessControlListType are<br>given on page 13. |  |
| Return parameters        |                                                                                                                                                                                                            |             |                                                                                                                                                                                                                            |  |
|                          | Return of the APIACLModify function.                                                                                                                                                                       |             |                                                                                                                                                                                                                            |  |
|                          | Name                                                                                                                                                                                                       | Description |                                                                                                                                                                                                                            |  |
|                          | dss:Result                                                                                                                                                                                                 | below.      | Contains the status information and the errors of an<br>executed action. This element is described in more detail                                                                                                          |  |
|                          | Status information and errors in APIACLModify (also refer to<br>[TR-03112-1] Sections 4.1 and 4.2).                                                                                                        |             |                                                                                                                                                                                                                            |  |
|                          | Name                                                                                                                                                                                                       | Error codes |                                                                                                                                                                                                                            |  |
|                          | ResultMajor                                                                                                                                                                                                | •           | /resultmajor#ok                                                                                                                                                                                                            |  |
|                          |                                                                                                                                                                                                            | •           | /resultmajor#error                                                                                                                                                                                                         |  |
|                          |                                                                                                                                                                                                            | •           | /resultmajor#warning                                                                                                                                                                                                       |  |

|               | ResultMinor                                                                                                                                                                                                                                                                                                                                                                               | •<br>/resultminor/al/common#internalError<br>•<br>/resultminor/al/common#parameterError<br>•<br>/resultminor/al#unknownAPIFunction<br>•<br>/resultminor/dp#unknownChannelHandle<br>•<br>/resultminor/sal#<br>invalidAccessControlInformation<br>•<br>/resultminor/sal#<br>securityConditionsNotSatisfied |
|---------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|               | ResultMessage                                                                                                                                                                                                                                                                                                                                                                             | MAY contain more detailed information on the error<br>which occurred if required.                                                                                                                                                                                                                        |
| Precondition  | For access to this function the administrator MUST be authenticated in<br>accordance with the definitive security policies applicable for operation of the<br>eCard framework.                                                                                                                                                                                                            |                                                                                                                                                                                                                                                                                                          |
| Postcondition | The modified access control information becomes effective when the<br>eCard-API-Framework is started the next time at the latest.                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                          |
| Note          | Also refer to CardApplicationACL in [TR-03112-4].<br>For successful access to card application services (also refer to [TR-03112-4],<br>Section 3.1.3 ff), the access control conditions for the APICalls AND the<br>specific card access control conditions MUST be met. For this reason access<br>to these [ISO24727-3] functions SHOULD be permitted without restriction as<br>a rule. |                                                                                                                                                                                                                                                                                                          |

## **3.1.5 FrameworkUpdate**

| Name                     | FrameworkUpdate                                                                                                                                                                                                                                                                                                                                |                                                                             |  |
|--------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|--|
| Description              | An installation of the eCard-API-Framework can be updated with the<br>FrameworkUpdate function. As a result of calling FrameworkUpdate the<br>eCard-API-Framework performs the "Basic Update Protocol" as specified in<br>[TR-03112-7] with the update server defined by the UpdateService-element of<br>the default parameters (cf. page 21). |                                                                             |  |
| Invocation<br>parameters |                                                                                                                                                                                                                                                                                                                                                | Invocation of the FrameworkUpdate function is performed without parameters. |  |
| Return                   | Return of the FrameworkUpdate function.                                                                                                                                                                                                                                                                                                        |                                                                             |  |
|                          | Name                                                                                                                                                                                                                                                                                                                                           | Description                                                                 |  |

| dss:Result<br>Contains the status information and the errors of<br>an executed action. This element is described in<br>more detail below.<br>Status information and errors with FrameworkUpdate (also refer to<br>[TR-03112-1] Sections 4.1 and 4.2).<br>Name<br>Error codes<br>ResultMajor<br>•<br>/resultmajor#ok<br>•<br>/resultmajor#error<br>•<br>/resultmajor#warning<br>ResultMinor<br>•<br>/resultminor/al/common#noPermission<br>•<br>/resultminor/al/common#internalError<br>•<br>/resultminor/al/common#parameterError<br>•<br>/resultminor/dp#unknownChannelHandle<br>•<br>/resultminor/dp#communicationError<br>•<br>/resultminor/dp#trustedChannelEstablishmentFailed<br>•<br>/resultminor/dp#unknownProtocol<br>•<br>/resultminor/dp#unknownWebserviceBinding<br>•<br>/resultminor/al/FrameworkUpdate#<br>serviceNotAvailable<br>•<br>/resultminor/al/FrameworkUpdate#unknownModule<br>•<br>/resultminor/al/FrameworkUpdate#<br>invalidVersionNumber<br>•<br>/resultminor/al/FrameworkUpdate#<br>operationSystemNotSupported<br>•<br>/resultminor/al/FrameworkUpdate#<br>noSpaceAvailable<br>•<br>/resultminor/al/FrameworkUpdate#<br>securityConditionsNotSatisfied<br>•<br>/resultminor/sal#digitalSignatureNotCorrect<br>•<br>/resultminor/il/signature#invalidSignatureFormat<br>ResultMessage<br>MAY contain more detailed information on the error which<br>occurred if required.<br>Precondition<br>Postcondition |      |  |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|--|
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |      |  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Note |  |

#### <span id="page-18-0"></span>**3.1.6 GetDefaultParameters**

| Name |
|------|
|------|

**Name GetDefaultParameters**

| Description              | The default parameters of the eCard-API-Framework are read out with the aid<br>of the GetDefaultParameters function. |                                                                                                                                                                                                    |  |  |
|--------------------------|----------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|--|
| Invocation<br>parameters | Invocation of the GetDefaultParameters function.                                                                     |                                                                                                                                                                                                    |  |  |
|                          | Name                                                                                                                 | Description                                                                                                                                                                                        |  |  |
|                          | ChannelHandle                                                                                                        | Optional parameter with which a remote system<br>can be addressed (also refer to<br>CardApplicationPath in [TR-03112-4]). If<br>the local system is to be addressed, this parameter<br>is omitted. |  |  |
| Return parameters        |                                                                                                                      | Return of the GetDefaultParameters function.                                                                                                                                                       |  |  |
|                          | Name                                                                                                                 | Description                                                                                                                                                                                        |  |  |
|                          | dss:Result                                                                                                           | Contains the status information and the errors<br>of an executed action. This element is described<br>in more detail below.                                                                        |  |  |
|                          | DefaultParameters                                                                                                    | Contains the configured default parameters of<br>the eCard-API-Framework (see below for<br>details).                                                                                               |  |  |

<span id="page-20-0"></span>![](_page_20_Figure_0.jpeg)

| DefaultVerifyOptions  | Specifies the default verification<br>options. The configured default<br>content is automatically added to the<br>dss:OptionalInputs-element<br>in VerifyRequest (refer to<br>[TR-03112-2], Section 3.2.2) as it<br>would be provided by the client<br>application. The default values MAY<br>be overridden by explicitly<br>providing an element of the same<br>name in dss:OptionalInputs. |
|-----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| DefaultEncryptOptions | Specifies the default encryption<br>options. The configured default<br>content is automatically added to the<br>dss:OptionalInputs-element<br>in EncryptRequest (refer to<br>[TR-03112-2], Section 3.2.1) as it<br>would be provided by the client<br>application. The default values MAY<br>be overridden by explicitly<br>providing an element of the same<br>name in dss:OptionalInputs.  |
| DefaultDecryptOptions | Specifies the default decryption<br>options. The configured default<br>content is automatically added to the<br>dss:OptionalInputs-element<br>in DecryptRequest (refer to<br>[TR-03112-2], Section 3.2.1) as it<br>would be provided by the client<br>application. The default values MAY<br>be overridden by explicitly<br>providing an element of the same<br>name in dss:OptionalInputs.  |
| DefaultHashAlgorithm  | Defines the standard hash algorithm<br>(also refer to [TR-03112-4], Annex<br>A.3).                                                                                                                                                                                                                                                                                                           |
| DefaultCipherSuite    | Defines the standard cipher suite<br>which is to be used in the<br>framework of TC_API_Open (also<br>refer to [TR-03112-2]).                                                                                                                                                                                                                                                                 |

| DefaultTSA                | Defines the standard time stamping<br>services (also refer to Sections 3.6.5<br>and 3.6.6).                                                          |
|---------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------|
|                           | If several time stamping services are<br>configured for a corresponding time<br>stamp type, the first suitable service<br>in the list is addressed.  |
|                           | If a time stamp service is referred to<br>with the address 127.0.1.0, the<br>eCard-API-Framework is instructed<br>to generate the time stamp itself. |
| DefaultMessages           | Defines the standard messages for<br>recording and modifying PINs on a<br>card terminal (see below for details).                                     |
| UpdateService             | Contains information on the update<br>service to be used (see below for<br>details).                                                                 |
| DefaultCardInfoRepository | MAY specify the address of the<br>standard CardInfo repository server<br>(also refer to GetCardInfoOr<br>ACD in [TR-03112-5]).                       |
| OtherParameters           | MAY contain other<br>(manufacturer-specific) parameters.                                                                                             |
|                           |                                                                                                                                                      |
| (see above).              | DefaultFrameworkBehaviour is part of DefaultParameters                                                                                               |
| Name                      | Description                                                                                                                                          |
| VerbosityLevel            | Specifies in how much detail the framework<br>reports on detailed processes. The following<br>values are provided:                                   |
|                           | •<br>0: No information is returned on the<br>individual steps                                                                                        |
|                           | •<br>>0: Information is returned on the<br>individual steps                                                                                          |
|                           | An additional differentiation of the positive<br>values for VerbosityLevel MAY be<br>defined by the manufacturer.                                    |

![](_page_23_Figure_0.jpeg)

![](_page_24_Figure_0.jpeg)

|               | UpdateFrequency<br>AutomaticInstallation                                                                    |             | Specifies the time interval after which an<br>enquiry request is to be automatically sent<br>to the update service.<br>If this element is missing, no automatic                                                                                |
|---------------|-------------------------------------------------------------------------------------------------------------|-------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|               |                                                                                                             |             | enquiry is sent to the update service.                                                                                                                                                                                                         |
|               |                                                                                                             |             | MAY specify which class of updates (also<br>refer to the UpdatePriority element in<br>[TR-03112-7]) should be automatically<br>loaded (when the eCard-API-Framework is<br>terminated with TerminateFramework,<br>also refer to Section 3.1.2). |
|               |                                                                                                             |             | If this element is missing, no updates are<br>automatically installed.                                                                                                                                                                         |
|               | Other                                                                                                       |             | MAY contain other parameters.                                                                                                                                                                                                                  |
|               | Status information and errors in GetDefaultParameters (also refer to<br>[TR-03112-1] Sections 4.1 and 4.2). |             |                                                                                                                                                                                                                                                |
|               |                                                                                                             |             |                                                                                                                                                                                                                                                |
|               | Name                                                                                                        | Error codes |                                                                                                                                                                                                                                                |
|               | ResultMajor                                                                                                 | •           | /resultmajor#ok                                                                                                                                                                                                                                |
|               |                                                                                                             | •           | /resultmajor#error                                                                                                                                                                                                                             |
|               | ResultMinor                                                                                                 | •           | /resultminor/al/common#noPermission                                                                                                                                                                                                            |
|               |                                                                                                             | •           | /resultminor/al/common#internalError                                                                                                                                                                                                           |
|               |                                                                                                             | •           | /resultminor/al/common#parameterError                                                                                                                                                                                                          |
|               |                                                                                                             | •           | /resultminor/dp#unknownChannelHandle                                                                                                                                                                                                           |
|               |                                                                                                             | MAY exist.  | In addition, other protocol specific error messages                                                                                                                                                                                            |
|               | ResultMessage                                                                                               |             | MAY contain more detailed information on the error<br>which occurred if required.                                                                                                                                                              |
| Precondition  |                                                                                                             |             |                                                                                                                                                                                                                                                |
| Postcondition |                                                                                                             |             |                                                                                                                                                                                                                                                |

#### **3.1.7 SetDefaultParameters**

| Name        | SetDefaultParameters                                                                                               |
|-------------|--------------------------------------------------------------------------------------------------------------------|
| Description | The default parameters of the eCard-API-Framework are stored with the aid<br>of the SetDefaultParameters function. |

| Invocation<br>parameters |                                                                                                             |                                                                                                                                                                                                    |  |
|--------------------------|-------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
|                          | Invocation of the SetDefaultParameters function.                                                            |                                                                                                                                                                                                    |  |
|                          | Name                                                                                                        | Description                                                                                                                                                                                        |  |
|                          | ChannelHandle                                                                                               | Optional parameter with which a remote<br>system can be addressed (also refer to<br>CardApplicationPath in<br>[TR-03112-4]). If the local system is to be<br>addressed, this parameter is omitted. |  |
|                          | DefaultParameters                                                                                           | Contains the configured default parameters of<br>the eCard-API-Framework (refer to page 21<br>for details).                                                                                        |  |
| Return parameters        | Return of the SetDefaultParameters function.                                                                |                                                                                                                                                                                                    |  |
|                          | Name                                                                                                        | Description                                                                                                                                                                                        |  |
|                          | dss:Result                                                                                                  | Contains the status information and the<br>errors of an executed action. This element is<br>described in more detail below.                                                                        |  |
|                          | Status information and errors in SetDefaultParameters (also refer to<br>[TR-03112-1] Sections 4.1 and 4.2). |                                                                                                                                                                                                    |  |
|                          | Name                                                                                                        | Error codes                                                                                                                                                                                        |  |
|                          | ResultMajor                                                                                                 | •<br>/resultmajor#ok                                                                                                                                                                               |  |
|                          |                                                                                                             | •<br>/resultmajor#error                                                                                                                                                                            |  |

|               | ResultMinor                                                                                               | •<br>/resultminor/al/common#noPermission<br>•<br>/resultminor/al/common#internalError<br>•<br>/resultminor/al/common#parameterError<br>•<br>/resultminor/al/TrustedViewer#invalidID<br>•<br>/resultminor/dp#unknownChannelHandle<br>•<br>/resultminor/il/algorithm#<br>hashAlgorithmNotSupported<br>•<br>/resultminor/il/encryption#<br>encryptionFormatNotSupported |
|---------------|-----------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|               |                                                                                                           | •<br>/resultminor/il/key#<br>encryptionAlgorithmNotSupported<br>•<br>/resultminor/il/signature#<br>signatureFormatNotSupported<br>•<br>/resultminor/il/signature#c                                                                                                                                                                                                   |
|               | ResultMessage                                                                                             | ertificateFormatNotCorrect<br>MAY contain more detailed information on the error<br>which occurred if required.                                                                                                                                                                                                                                                      |
| Precondition  |                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                      |
| Postcondition | The modified default parameters become effective the next time the<br>framework is started at the latest. |                                                                                                                                                                                                                                                                                                                                                                      |
| Note          |                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                      |

## **3.2 Card management**

## **3.2.1 GetCardInfoList**

| Name                     | GetCardInfoList                                                                                              |                                                                         |
|--------------------------|--------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------|
| Description              |                                                                                                              | The GetCardInfoList function supplies a list of known card types in the |
| Invocation<br>parameters | form of CardInfo-files (also refer to [TR-03112-4], Annex A).<br>Invocation of the GetCardInfoList function. |                                                                         |
|                          | Name                                                                                                         | Description                                                             |

|               | ChannelHandle                           | Optional parameter with which a remote<br>system can be addressed (also refer to<br>CardApplicationPath in [TR-03112-4]).<br>If the local system is to be addressed, this<br>parameter is omitted. |
|---------------|-----------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Return        | Return of the GetCardInfoList function. |                                                                                                                                                                                                    |
|               | Name                                    | Description                                                                                                                                                                                        |
|               | CardInfo                                | Contains the CardInfo structure which is used for<br>mapping of generic SAL-calls to card-specific<br>APDUs. Details on this topic are contained in<br>[TR-03112-4] (Annex A).                     |
|               | dss:Result                              | Contains the status information and the errors of an<br>executed action. This element is described in more<br>detail below.                                                                        |
|               | [TR-03112-1] Sections 4.1 and 4.2).     | Status information and errors in GetCardInfoList (also refer to                                                                                                                                    |
|               | Name                                    | Error codes                                                                                                                                                                                        |
|               | ResultMajor                             | •<br>/resultmajor#ok<br>•<br>/resultmajor#error                                                                                                                                                    |
|               | ResultMinor                             | •<br>/resultminor/al/common#noPermission<br>•<br>/resultminor/al/common#internalError<br>•<br>/resultminor/al/common#parameterError<br>•<br>/resultminor/dp#unknownChannelHandle                   |
|               | ResultMessage                           | MAY contain more detailed information on the error<br>which occurred if required.                                                                                                                  |
| Precondition  |                                         |                                                                                                                                                                                                    |
| Postcondition |                                         |                                                                                                                                                                                                    |
| Note          |                                         |                                                                                                                                                                                                    |
|               |                                         |                                                                                                                                                                                                    |

#### **3.2.2 SetCardInfoList**

| Name        | SetCardInfoList                                                         |
|-------------|-------------------------------------------------------------------------|
| Description | The SetCardInfoList function stores a list of CardInfo structures which |

![](_page_29_Figure_0.jpeg)

|               | Status information and errors in SetCardInfoList (also refer to<br>[TR-03112-1] Sections 4.1 and 4.2).                                                                   |                                                                                   |  |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|--|
|               | Name                                                                                                                                                                     | Error codes                                                                       |  |
|               | ResultMajor                                                                                                                                                              | •<br>/resultmajor#ok                                                              |  |
|               |                                                                                                                                                                          | •<br>/resultmajor#error                                                           |  |
|               | ResultMinor                                                                                                                                                              | •<br>/resultminor/al/CardInfo#incorrectFile                                       |  |
|               |                                                                                                                                                                          | •<br>/resultminor/al/common#noPermission                                          |  |
|               |                                                                                                                                                                          | •<br>/resultminor/al/common#internalError                                         |  |
|               |                                                                                                                                                                          | •<br>/resultminor/al/common#parameterError                                        |  |
|               |                                                                                                                                                                          | •<br>/resultminor/dp#unknownChannelHandle                                         |  |
|               | ResultMessage                                                                                                                                                            | MAY contain more detailed information on the error<br>which occurred if required. |  |
| Precondition  |                                                                                                                                                                          |                                                                                   |  |
| Postcondition |                                                                                                                                                                          |                                                                                   |  |
| Note          | The sequence of the transmitted CardInfo structures MAY have a significant<br>influence on the sequence of steps and the performance of the card recognition<br>process. |                                                                                   |  |

#### **3.2.3 AddCardInfoFiles**

| Description<br>The AddCardInfoFiles function provides a sequence of additional<br>CardInfo structures to the eCard-API-Framework. The new CardInfo<br>structures are added to the end of the existing list. During import of the                                                                                                                                                                                   | Name | AddCardInfoFiles                                                           |  |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|----------------------------------------------------------------------------|--|
| ensure that the CardInfo files can be used safely. The following tests MUST be<br>performed in particular (also refer to [TR-03112-4], Annex A.7):<br>•<br>Test for content-related consistency (e.g. that URIs for protocols and<br>algorithms are known)<br>•<br>Verification of any signatures<br>•<br>Verification that protected key references are not referenced from<br>unsigned parts of a CardInfo file. |      | CardInfo files, a series of semantic verifications must be performed which |  |

![](_page_31_Figure_0.jpeg)

|               | Status information and errors in AddCardInfoFiles (also refer to<br>[TR-03112-1] Sections 4.1 and 4.2). |                                                                                   |  |
|---------------|---------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|--|
|               | Name                                                                                                    | Error codes                                                                       |  |
|               | ResultMajor                                                                                             | •<br>/resultmajor#ok                                                              |  |
|               |                                                                                                         | •<br>/resultmajor#error                                                           |  |
|               | ResultMinor                                                                                             | •<br>/resultminor/al/CardInfo#addNotPossible                                      |  |
|               |                                                                                                         | •<br>/resultminor/al/CardInfo#alreadyExisting                                     |  |
|               |                                                                                                         | •<br>/resultminor/al/CardInfo#incorrectFile                                       |  |
|               |                                                                                                         | •<br>/resultminor/al/common#noPermission                                          |  |
|               |                                                                                                         | •<br>/resultminor/al/common#internalError                                         |  |
|               |                                                                                                         | •<br>/resultminor/al/common#parameterError                                        |  |
|               |                                                                                                         | •<br>/resultminor/dp#unknownChannelHandle                                         |  |
|               | ResultMessage                                                                                           | MAY contain more detailed information on the error<br>which occurred if required. |  |
| Precondition  |                                                                                                         |                                                                                   |  |
| Postcondition |                                                                                                         |                                                                                   |  |
| Note          |                                                                                                         |                                                                                   |  |

#### **3.2.4 DeleteCardInfoFiles**

| Name                     | DeleteCardInfoFiles                                                  |                                                                                                                                                                                                    |  |
|--------------------------|----------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Description              | The DeleteCardInfoFiles function deletes a series of CardInfo files. |                                                                                                                                                                                                    |  |
| Invocation<br>parameters | Invocation of the DeleteCardInfoFiles function.                      |                                                                                                                                                                                                    |  |
|                          | Name                                                                 | Description                                                                                                                                                                                        |  |
|                          | ChannelHandle                                                        | Optional parameter with which a remote system<br>can be addressed (also refer to<br>CardApplicationPath in [TR-03112-4]). If<br>the local system is to be addressed, this<br>parameter is omitted. |  |
| CardTypeIdentifier       |                                                                      | Contains a series of unique identifiers of the<br>CardInfo structures which are to be deleted<br>(also refer to [TR-03112-4], Annex A.3)                                                           |  |

| Return        | Return of the DeleteCardInfoFiles function.                                                                                       |                            |                                                                                                                                                                                                                                                    |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------|----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|               | Name                                                                                                                              |                            | Description                                                                                                                                                                                                                                        |
|               | dss:Result                                                                                                                        |                            | Contains the status information and the<br>errors of an executed action. This element is<br>described in more detail below.                                                                                                                        |
|               | Status information and errors in DeleteCardInfoFiles (also refer to<br>[TR-03112-1] Sections 4.1 and 4.2).<br>Name<br>Error codes |                            |                                                                                                                                                                                                                                                    |
|               |                                                                                                                                   |                            |                                                                                                                                                                                                                                                    |
|               | ResultMajor                                                                                                                       | •<br>•                     | /resultmajor#ok<br>/resultmajor#error                                                                                                                                                                                                              |
|               | ResultMinor                                                                                                                       | •<br>•<br>•<br>•<br>•<br>• | /resultminor/al/CardInfo#notExisting<br>/resultminor/al/CardInfo#deleteNotPossible<br>/resultminor/al/common#noPermission<br>/resultminor/al/common#internalError<br>/resultminor/al/common#parameterError<br>/resultminor/dp#unknownChannelHandle |
|               | ResultMessage                                                                                                                     |                            | MAY contain more detailed information on the error<br>which occurred if required.                                                                                                                                                                  |
| Precondition  |                                                                                                                                   |                            |                                                                                                                                                                                                                                                    |
| Postcondition |                                                                                                                                   |                            |                                                                                                                                                                                                                                                    |
| Note          |                                                                                                                                   |                            |                                                                                                                                                                                                                                                    |

## **3.3 Card terminal management**

#### **3.3.1 RegisterIFD**

| Name        | RegisterIFD                                                                                                                                                                                            |
|-------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Description | With the RegisterIFD function it is possible to add a card terminal with all<br>configuration information. Furthermore this function may be used to reactivate<br>one or all suspended card terminals. |

![](_page_34_Figure_0.jpeg)

|        | IFDConfiguration                    | Optionally contains the configuration information<br>for the card terminal addressed with IFDName.<br>The detailed specification of these configuration<br>parameters depends on the card terminal type and<br>is therefore dependent on the manufacturer. |
|--------|-------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|        |                                     | The IFDConfigurationType is defined as<br>follows:<br><complexType<br>name="IFDConfigurationType"><br><complexContent><br><extension base="anyType"><br><attribute name="IFDType"<br>type="anyURI" use="required" /><br></extension><br></complexContent>  |
|        |                                     | </complexType>                                                                                                                                                                                                                                             |
|        |                                     | Card terminal manufacturers SHOULD define<br>corresponding structures for their products if<br>required and register them at the Federal Office<br>for Information Security.                                                                               |
| Return |                                     |                                                                                                                                                                                                                                                            |
|        | Return of the RegisterIFD function. |                                                                                                                                                                                                                                                            |
|        | Name                                | Description                                                                                                                                                                                                                                                |
|        | dss:Result                          | Contains the status information and the errors of an<br>executed action. This element is described in more<br>detail below.                                                                                                                                |
|        | Sections 4.1 and 4.2).              | Status information and errors in RegisterIFD (also refer to [TR-03112-1]                                                                                                                                                                                   |
|        | Name                                | Error codes                                                                                                                                                                                                                                                |
|        | ResultMajor                         | •<br>/resultmajor#ok                                                                                                                                                                                                                                       |
|        |                                     | •<br>/resultmajor#error                                                                                                                                                                                                                                    |

|               | ResultMinor                                                                                                                                                                                                                                                                                                                                                                     | •<br>/resultminor/al/common#noPermission<br>•<br>/resultminor/al/common#internalError<br>•<br>/resultminor/al/common#parameterError<br>•<br>/resultminor/al/IFD#<br>writeConfigurationNotPossible<br>•<br>/resultminor/al/IFD#couldNotAdd<br>•<br>/resultminor/al/IFD#addNotPossible<br>•<br>/resultminor/dp#unknownChannelHandle<br>•<br>/resultminor/ifdl/terminal#accessError |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|               | ResultMessage                                                                                                                                                                                                                                                                                                                                                                   | MAY contain more detailed information on the error<br>which occurred if required.                                                                                                                                                                                                                                                                                                |
| Precondition  |                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                  |
| Postcondition | In case of a new IFD the IFDName and, if applicable, the configuration<br>parameters are added to the card terminal management of the<br>eCard-API-Framework. If the IFD addressed by the given IFDName has already<br>been registered and suspended it is reactivated. If no IFDName has been<br>provided all previously registered and possibly suspended IFDs are activated. |                                                                                                                                                                                                                                                                                                                                                                                  |
| Note          |                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                  |

#### **3.3.2 UnregisterIFD**

| Name                     | UnregisterIFD |                                                                                                                                                                                                 |
|--------------------------|---------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Description              |               | The UnregisterIFD function temporarily or permanently removes a card<br>terminal from the card terminal management of the eCard-API-Framework.                                                  |
| Invocation<br>parameters |               |                                                                                                                                                                                                 |
|                          |               | Invocation of the UnregisterIFD function.                                                                                                                                                       |
|                          | Name          | Description                                                                                                                                                                                     |
|                          | ChannelHandle | Optional parameter with which a remote system can be<br>addressed (also refer to CardApplicationPath in<br>[TR-03112-4]). If the local system is to be addressed, this<br>parameter is omitted. |
|                          | IFDName       | The name of the card terminal which is to be suspended or<br>deleted.                                                                                                                           |

|               | Mode                                                                                                 | follows:<br></simpleType>       | The Mode parameter specifies, whether the IFD is<br>temporarily or permanently deactivated. It is of type<br>UnregisterIFDModeType, which is defined as<br><simpleType name="UnregisterIFDModeType"><br><restriction base="string"><br><enumeration value="temporary" /><br><enumeration value="permanent" /><br></restriction> |  |
|---------------|------------------------------------------------------------------------------------------------------|---------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Return        | Return of the UnregisterIFD function.                                                                |                                 |                                                                                                                                                                                                                                                                                                                                 |  |
|               | Name                                                                                                 |                                 | Description                                                                                                                                                                                                                                                                                                                     |  |
|               | dss:Result                                                                                           |                                 | Contains the status information and the errors of<br>an executed action. This element is described in<br>more detail below.                                                                                                                                                                                                     |  |
|               | Status information and errors in UnregisterIFD (also refer to [TR-03112-1]<br>Sections 4.1 and 4.2). |                                 |                                                                                                                                                                                                                                                                                                                                 |  |
|               | Name                                                                                                 | Error codes                     |                                                                                                                                                                                                                                                                                                                                 |  |
|               | ResultMajor                                                                                          | •<br>•                          | /resultmajor#ok<br>/resultmajor#error                                                                                                                                                                                                                                                                                           |  |
|               | ResultMinor                                                                                          | •<br>•<br>•<br>•<br>•<br>•<br>• | /resultminor/al/common#noPermission<br>/resultminor/al/common#internalError<br>/resultminor/al/common#parameterError<br>/resultminor/al/IFD#deleteNotPossible<br>/resultminor/dp#unknownChannelHandle<br>/resultminor/ifdl/terminal#unknownIFD<br>/resultminor/ifdl/terminal#accessError                                        |  |
|               | ResultMessage                                                                                        |                                 | MAY contain more detailed information on the error which<br>occurred if required.                                                                                                                                                                                                                                               |  |
| Precondition  |                                                                                                      |                                 |                                                                                                                                                                                                                                                                                                                                 |  |
| Postcondition | management of the eCard-API-Framework.                                                               |                                 | The card terminal addressed with IFDName was removed from card terminal                                                                                                                                                                                                                                                         |  |
|               |                                                                                                      |                                 |                                                                                                                                                                                                                                                                                                                                 |  |

## **3.4 Trusted viewer management**

#### **3.4.1 GetTrustedViewerList**

| Name                     | GetTrustedViewerList                             |                                                                                                                                                                                                                               |
|--------------------------|--------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Description              | trustworthy display components (trusted viewer). | The GetTrustedViewerList function provides a list of available                                                                                                                                                                |
| Invocation<br>parameters |                                                  |                                                                                                                                                                                                                               |
|                          | Name                                             | Invocation of the GetTrustedViewerList function.<br>Description                                                                                                                                                               |
|                          | ChannelHandle                                    | Optional parameter with which a remote system<br>can be addressed (also refer to<br>CardApplicationPath in [TR-03112-4]). If<br>the local system is to be addressed, this parameter<br>is omitted.                            |
| Return                   | Return of the GetTrustedViewerList function.     |                                                                                                                                                                                                                               |
|                          | Name                                             | Description                                                                                                                                                                                                                   |
|                          | dss:Result                                       | Contains the status information and the errors of an<br>executed action. This element is described in more<br>detail below.                                                                                                   |
|                          | TrustedViewerId                                  | Contains the ID of the trusted viewer. The<br>TrustedViewerId is defined as follows:<br><simpleType name="TrustedViewerIdType"><br><restriction base="string"><br><maxLength value="64" /><br></restriction><br></simpleType> |

|               | Status information and errors in GetTrustedViewerList (also refer to<br>[TR-03112-1] Sections 4.1 and 4.2). |                                                                                   |
|---------------|-------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
|               | Name                                                                                                        | Error codes                                                                       |
|               | ResultMajor                                                                                                 | •<br>/resultmajor#ok                                                              |
|               |                                                                                                             | •<br>/resultmajor#error                                                           |
|               | ResultMinor                                                                                                 | •<br>/resultminor/al/common#noPermission                                          |
|               |                                                                                                             | •<br>/resultminor/al/common#internalError                                         |
|               |                                                                                                             | •<br>/resultminor/al/common#parameterError                                        |
|               |                                                                                                             | •<br>/resultminor/dp#unknownChannelHandle                                         |
|               | ResultMessage                                                                                               | MAY contain more detailed information on the<br>error which occurred if required. |
| Precondition  |                                                                                                             |                                                                                   |
| Postcondition |                                                                                                             |                                                                                   |
| Note          |                                                                                                             |                                                                                   |

#### **3.4.2 GetTrustedViewerConfiguration**

| Name                     | GetTrustedViewerConfiguration |                                                                                                                                                                                                    |
|--------------------------|-------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Description              | specific trusted viewer.      | The GetTrustedViewerConfiguration function reads the<br>configuration information which is saved in the eCard-API-Framework for a                                                                  |
| Invocation<br>parameters |                               | Invocation of the GetTrustedViewerConfiguration function.                                                                                                                                          |
|                          | Name                          | Description                                                                                                                                                                                        |
|                          | ChannelHandle                 | Optional parameter with which a remote system can<br>be addressed (also refer to<br>CardApplicationPath in [TR-03112-4]). If<br>the local system is to be addressed, this parameter is<br>omitted. |
|                          | TrustedViewerId               | Contains the ID of the trusted viewer for which the<br>configuration data are to be returned.                                                                                                      |

<span id="page-40-0"></span>![](_page_40_Figure_0.jpeg)

|               | MimeType      | States the supported document type in accordance with<br>[MIME].                                                     |  |
|---------------|---------------|----------------------------------------------------------------------------------------------------------------------|--|
|               | Application   | MAY associate an application with this Mime type.                                                                    |  |
|               | StyleSheet    | MAY contain a number of style sheets which are used<br>for depiction of specific XML-based data.                     |  |
|               |               | Status information and errors in GetTrustedViewerConfiguration<br>(also refer to [TR-03112-1] Sections 4.1 and 4.2). |  |
|               | Name          | Error codes                                                                                                          |  |
|               | ResultMajor   | •<br>/resultmajor#ok                                                                                                 |  |
|               |               | •<br>/resultmajor#error                                                                                              |  |
|               | ResultMinor   | •<br>/resultminor/al/common#noPermission                                                                             |  |
|               |               | •<br>/resultminor/al/common#internalError                                                                            |  |
|               |               | •<br>/resultminor/al/common#parameterError                                                                           |  |
|               |               | •<br>/resultminor/al/TrustedViewer#invalidID                                                                         |  |
|               |               | •<br>/resultminor/dp#unknownChannelHandle                                                                            |  |
|               | ResultMessage | MAY contain more detailed information on the error<br>which occurred if required.                                    |  |
| Precondition  |               |                                                                                                                      |  |
| Postcondition |               |                                                                                                                      |  |
| Note          |               |                                                                                                                      |  |

#### **3.4.3 SetTrustedViewerConfiguration**

| Description<br>The SetTrustedViewerConfiguration function stores the<br>configuration information for a specific trusted viewer.<br>Invocation<br>parameters<br>Invocation of the SetTrustedViewerConfiguration function. | Name | SetTrustedViewerConfiguration |             |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|-------------------------------|-------------|
|                                                                                                                                                                                                                           |      |                               |             |
|                                                                                                                                                                                                                           |      | Name                          | Description |

|               | ChannelHandle                                      |             | Optional parameter with which a remote<br>system can be addressed (also refer to<br>CardApplicationPath in<br>[TR-03112-4]). If the local system is to be<br>addressed, this parameter is omitted. |
|---------------|----------------------------------------------------|-------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|               | TrustedViewerId                                    |             | Contains the ID of the trusted viewer for<br>which the configuration data are stored.                                                                                                              |
|               | ViewerConfiguration                                |             | Contains the configuration information for the<br>stated trusted viewer (for details refer to page<br>41).                                                                                         |
| Return        |                                                    |             |                                                                                                                                                                                                    |
|               |                                                    |             | Return of the SetTrustedViewerConfiguration function.                                                                                                                                              |
|               | Name                                               |             | Description                                                                                                                                                                                        |
|               | dss:Result                                         |             | Contains the status information and the<br>errors of an executed action. This<br>element is described in more detail<br>below.                                                                     |
|               |                                                    |             |                                                                                                                                                                                                    |
|               | (also refer to [TR-03112-1] Sections 4.1 and 4.2). |             | Status information and errors in SetTrustedViewerConfiguration                                                                                                                                     |
|               | Name                                               | Error codes |                                                                                                                                                                                                    |
|               | ResultMajor                                        | •           | /resultmajor#ok                                                                                                                                                                                    |
|               |                                                    | •           | /resultmajor#error                                                                                                                                                                                 |
|               | ResultMinor                                        | •           | /resultminor/al/common#noPermission                                                                                                                                                                |
|               |                                                    | •           | /resultminor/al/common#internalError                                                                                                                                                               |
|               |                                                    | •           | /resultminor/al/common#parameterError                                                                                                                                                              |
|               |                                                    | •<br>•      | /resultminor/al/TrustedViewer#invalidID<br>/resultminor/al/TrustedViewer#<br>invalidConfiguration                                                                                                  |
|               |                                                    | •           | /resultminor/dp#unknownChannelHandle                                                                                                                                                               |
|               |                                                    | •           | /resultminor/ifdl/terminal#unknownIFD                                                                                                                                                              |
|               | ResultMessage                                      |             | MAY contain more detailed information on the error<br>which occurred if required.                                                                                                                  |
| Precondition  |                                                    |             |                                                                                                                                                                                                    |
| Postcondition |                                                    |             |                                                                                                                                                                                                    |

#### **3.4.4 AddTrustedViewer**

| Name                     | AddTrustedViewer                             |                                                                                                                                                                                                    |
|--------------------------|----------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Description              | configuration information.                   | With the AddTrustedViewer function, a trusted viewer can be added with all                                                                                                                         |
| Invocation<br>parameters |                                              |                                                                                                                                                                                                    |
|                          | Invocation of the AddTrustedViewer function. |                                                                                                                                                                                                    |
|                          | Name                                         | Description                                                                                                                                                                                        |
|                          | ChannelHandle                                | Optional parameter with which a remote system<br>can be addressed (also refer to<br>CardApplicationPath in [TR-03112-4]). If<br>the local system is to be addressed, this<br>parameter is omitted. |
|                          | TrustedViewerId                              | Contains the unique identifier of the trusted<br>viewer which is to be added to the<br>eCard-API-Framework.                                                                                        |
|                          | ViewerConfiguration                          | MAY contain the configurations of the trusted<br>viewer (for details refer to page 41).                                                                                                            |
| Return                   |                                              |                                                                                                                                                                                                    |
|                          | Return of the AddTrustedViewer function.     |                                                                                                                                                                                                    |
|                          | Name                                         | Description                                                                                                                                                                                        |
|                          | dss:Result                                   | Contains the status information and the errors of an<br>executed action. This element is described in more<br>detail below.                                                                        |

|               | Status information and errors in AddTrustedViewer (also refer to<br>[TR-03112-1] Sections 4.1 and 4.2). |                                                                                   |
|---------------|---------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
|               | Name                                                                                                    | Error codes                                                                       |
|               | ResultMajor                                                                                             | •<br>/resultmajor#ok                                                              |
|               |                                                                                                         | •<br>/resultmajor#error                                                           |
|               | ResultMinor                                                                                             | •<br>/resultminor/al/common#noPermission                                          |
|               |                                                                                                         | •<br>/resultminor/al/common#internalError                                         |
|               |                                                                                                         | •<br>/resultminor/al/common#parameterError                                        |
|               |                                                                                                         | •<br>/resultminor/al/TrustedViewer#invalidConfiguration                           |
|               |                                                                                                         | •<br>/resultminor/al/TrustedViewer#alreadyExisting                                |
|               |                                                                                                         | •<br>/resultminor/dp#unknownChannelHandle                                         |
|               |                                                                                                         | •<br>/resultminor/ifdl/terminal#unknownIFD                                        |
|               | ResultMessage                                                                                           | MAY contain more detailed information on the error which<br>occurred if required. |
| Precondition  |                                                                                                         |                                                                                   |
| Postcondition |                                                                                                         |                                                                                   |
| Note          |                                                                                                         |                                                                                   |

#### **3.4.5 DeleteTrustedViewer**

| Name                     | DeleteTrustedViewer                             |                                                                                                                                                                                                    |
|--------------------------|-------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Description              |                                                 | The DeleteTrustedViewer function removes a trusted viewer.                                                                                                                                         |
| Invocation<br>parameters | Invocation of the DeleteTrustedViewer function. |                                                                                                                                                                                                    |
|                          | Name                                            | Description                                                                                                                                                                                        |
|                          | ChannelHandle                                   | Optional parameter with which a remote system<br>can be addressed (also refer to<br>CardApplicationPath in [TR-03112-4]).<br>If the local system is to be addressed, this<br>parameter is omitted. |
|                          | TrustedViewerId                                 | Contains the ID of the trusted viewer which is to<br>be removed.                                                                                                                                   |

| Return        | Return of the DeleteTrustedViewer function. |                                                                                                                                                                                                                                                                                          |
|---------------|---------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|               | Name                                        | Description                                                                                                                                                                                                                                                                              |
|               | dss:Result                                  | Contains the status information and the errors of<br>an executed action. This element is described in<br>more detail below.                                                                                                                                                              |
|               | [TR-03112-1] Sections 4.1 and 4.2).         | Status information and errors in DeleteTrustedViewer (also refer to                                                                                                                                                                                                                      |
|               | Name<br>Error codes                         |                                                                                                                                                                                                                                                                                          |
|               | ResultMajor                                 | •<br>/resultmajor#ok<br>•<br>/resultmajor#error                                                                                                                                                                                                                                          |
|               | ResultMinor                                 | •<br>/resultminor/al/common#noPermission<br>•<br>/resultminor/al/common#internalError<br>•<br>/resultminor/al/common#parameterError<br>•<br>/resultminor/al/TrustedViewer#deleteNotPossible<br>•<br>/resultminor/al/TrustedViewer#invalidID<br>•<br>/resultminor/dp#unknownChannelHandle |
|               | ResultMessage                               | MAY contain more detailed information on the error which<br>occurred if required.                                                                                                                                                                                                        |
| Precondition  |                                             |                                                                                                                                                                                                                                                                                          |
| Postcondition |                                             |                                                                                                                                                                                                                                                                                          |
| Note          |                                             |                                                                                                                                                                                                                                                                                          |

## **3.5 Identity management**

#### **3.5.1 GetTrustedIdentities**

| Name        | GetTrustedIdentities                                                                                                                            |
|-------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| Description | The GetTrustedIdentities function creates a list of all trusted identities<br>in the form of Trust-Service status lists (TSL) and certificates. |

![](_page_46_Figure_0.jpeg)

<span id="page-47-1"></span><span id="page-47-0"></span>

|                               | Certificate                                                                                                        | MAY contain a series of trusted certificates.                                                                                                                                                                                                                                        |
|-------------------------------|--------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                               |                                                                                                                    | The ec:Certificate element is defined as<br>follows:                                                                                                                                                                                                                                 |
|                               |                                                                                                                    | <element name="Certificate"><br><complexType><br><simpleContent><br><extension<br>base="base64Binary"><br><attribute name="Type"<br>type="anyURI" use="optional"<br>default="urn:ietf:rfc:3280"><br></attribute><br></extension><br></simpleContent><br></complexType><br></element> |
|                               |                                                                                                                    | Here the type of the certificate MAY be specified<br>in the Type attribute (also refer to<br>CertificateType in [TR-03112-7]).                                                                                                                                                       |
|                               | The TSLType is used in the definition of GetTrustedIdentities<br>Response (see above), AddTSL (see Section 3.5.6). |                                                                                                                                                                                                                                                                                      |
|                               | Name                                                                                                               | Description                                                                                                                                                                                                                                                                          |
|                               | TSLv3.1.2                                                                                                          | This element contains a TSL according to [TS102231]<br>Version 3.1.2 as it is used by Bundesnetzagentur and<br>other European accreditation and supervision bodies<br>for qualified electronic signatures.                                                                           |
|                               | Other                                                                                                              | This element can be used to handle all other<br>TSL-types.                                                                                                                                                                                                                           |
|                               | [TR-03112-1] Sections 4.1 and 4.2).                                                                                | Status information and errors in GetTrustedIdentities (also refer to                                                                                                                                                                                                                 |
|                               | Name                                                                                                               | Error codes                                                                                                                                                                                                                                                                          |
|                               | ResultMajor                                                                                                        | •<br>/resultmajor#ok<br>•<br>/resultmajor#error                                                                                                                                                                                                                                      |
|                               | ResultMinor                                                                                                        | •<br>/resultminor/al/common#noPermission<br>•<br>/resultminor/al/common#internalError                                                                                                                                                                                                |
|                               |                                                                                                                    | •<br>/resultminor/al/common#parameterError                                                                                                                                                                                                                                           |
|                               |                                                                                                                    | •<br>/resultminor/dp#unknownChannelHandle                                                                                                                                                                                                                                            |
|                               |                                                                                                                    |                                                                                                                                                                                                                                                                                      |
|                               | ResultMessage                                                                                                      | In addition, other specific protocol error messages can exist.<br>MAY contain more detailed information on the error which                                                                                                                                                           |
|                               |                                                                                                                    | occurred if required.                                                                                                                                                                                                                                                                |
| Precondition<br>Postcondition |                                                                                                                    |                                                                                                                                                                                                                                                                                      |

### **3.5.2 AddTrustedCertificate**

| Name                     | AddTrustedCertificate                                                                                     |                                                                                                                                                                                                    |                                                                                                                             |
|--------------------------|-----------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|
| Description              | With the AddTrustedCertificate function, a certificate can be added to<br>the list of trusted identities. |                                                                                                                                                                                                    |                                                                                                                             |
| Invocation<br>parameters |                                                                                                           |                                                                                                                                                                                                    |                                                                                                                             |
|                          | Invocation of the AddTrustedCertificate function.<br>Name<br>Description                                  |                                                                                                                                                                                                    |                                                                                                                             |
|                          | ChannelHandle                                                                                             | Optional parameter with which a remote system can<br>be addressed (also refer to<br>CardApplicationPath in [TR-03112-4]). If the<br>local system is to be addressed, this parameter is<br>omitted. |                                                                                                                             |
|                          | ec:Certificate                                                                                            | 48).                                                                                                                                                                                               | Contains the trustworthy certificate which should be<br>added to the certificate database (also refer to page               |
|                          | CheckAlgorithms                                                                                           | Contains information on whether the current<br>suitability of the algorithms used in the certificate<br>should be verified.                                                                        |                                                                                                                             |
|                          |                                                                                                           |                                                                                                                                                                                                    | If an error occurs during this verification, the<br>certificate is not added.                                               |
|                          |                                                                                                           |                                                                                                                                                                                                    | If this element is missing, the configured<br>DefaultParameters (refer to page 21) are used.                                |
| Return                   | Return of the AddTrustedCertificate function.                                                             |                                                                                                                                                                                                    |                                                                                                                             |
|                          | Name                                                                                                      |                                                                                                                                                                                                    | Description                                                                                                                 |
|                          | dss:Result                                                                                                |                                                                                                                                                                                                    | Contains the status information and the errors of<br>an executed action. This element is described in<br>more detail below. |

|               | Status information and errors in AddTrustedCertificate (also refer to<br>[TR-03112-1] Sections 4.1 and 4.2).                                                                                                                                   |                                                                                   |  |
|---------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|--|
|               | Name                                                                                                                                                                                                                                           | Error codes                                                                       |  |
|               | ResultMajor                                                                                                                                                                                                                                    | •<br>/resultmajor#ok                                                              |  |
|               |                                                                                                                                                                                                                                                | •<br>/resultmajor#error                                                           |  |
|               | ResultMinor                                                                                                                                                                                                                                    | •<br>/resultminor/al/common#noPermission                                          |  |
|               |                                                                                                                                                                                                                                                | •<br>/resultminor/al/common#internalError                                         |  |
|               |                                                                                                                                                                                                                                                | •<br>/resultminor/al/common#parameterError                                        |  |
|               |                                                                                                                                                                                                                                                | •<br>/resultminor/dp#unknownChannelHandle                                         |  |
|               |                                                                                                                                                                                                                                                | •<br>/resultminor/il/algorithm#<br>hashAlgorithmNotSupported                      |  |
|               |                                                                                                                                                                                                                                                | •<br>/resultminor/il/algorithm#<br>signatureAlgorithmNotSupported                 |  |
|               |                                                                                                                                                                                                                                                | •<br>/resultminor/il/signature#<br>certificateFormatNotCorrect                    |  |
|               |                                                                                                                                                                                                                                                | •<br>/resultminor/il/signature#<br>signatureAlgorithmNotSuitable                  |  |
|               |                                                                                                                                                                                                                                                | •<br>/resultminor/il/signature#<br>hashAlgorithmNotSuitable                       |  |
|               |                                                                                                                                                                                                                                                | •<br>/resultminor/il/signature#<br>invalidCertificateExtension                    |  |
|               |                                                                                                                                                                                                                                                | •<br>/resultminor/sal#digitalSignatureNotCorrect                                  |  |
|               | ResultMessage                                                                                                                                                                                                                                  | MAY contain more detailed information on the error<br>which occurred if required. |  |
| Precondition  |                                                                                                                                                                                                                                                |                                                                                   |  |
| Postcondition |                                                                                                                                                                                                                                                |                                                                                   |  |
| Note          | Before the certificate is added to the list of trustworthy certificates, the digital<br>signature on the certificate is verified to ensure its mathematical validity and the<br>current suitability of the algorithms is checked if necessary. |                                                                                   |  |

#### <span id="page-49-0"></span>**3.5.3 AddCertificate**

| Name        | AddCertificate                                                                                                                                                                                                   |
|-------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Description | With the AddCertificate function, a sequence of non-trusted certificates can<br>be added to the certificate database. These certificates MAY be used for<br>encryption or to support the signature verification. |

![](_page_50_Figure_0.jpeg)

|        | CheckCertificatePath                   |             | This option stipulates that the certificate path<br>should be verified before the certificate is<br>added to the certificate database.                                                                                                                                                                      |
|--------|----------------------------------------|-------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|        |                                        |             | If an error occurs during this verification, the<br>certificate is not added.                                                                                                                                                                                                                               |
|        |                                        |             | If this element is missing, the configured<br>DefaultParameters (refer to page 21)<br>are used.                                                                                                                                                                                                             |
|        | CheckCertificateStatus                 |             | This option stipulates that the status of a<br>certificate should be verified before it is<br>added to the certificate database. If the<br>address of an OCSP responder is included in<br>a certificate, it SHOULD be used for the<br>verification. Alternatively, a corresponding<br>CRL MAY be evaluated. |
|        |                                        |             | If an error occurs during this verification, the<br>certificate is not added.                                                                                                                                                                                                                               |
|        |                                        |             | If this element is missing, the configured<br>DefaultParameters (refer to page 21)<br>are used.                                                                                                                                                                                                             |
| Return |                                        |             |                                                                                                                                                                                                                                                                                                             |
|        |                                        |             |                                                                                                                                                                                                                                                                                                             |
|        | Return of the AddCertificate function. |             |                                                                                                                                                                                                                                                                                                             |
|        | Name                                   |             | Description                                                                                                                                                                                                                                                                                                 |
|        | dss:Result                             |             | Contains the status information and the errors<br>of an executed action. This element is<br>described in more detail below.                                                                                                                                                                                 |
|        | Sections 4.1 and 4.2).                 |             | Status information and errors in AddCertificate (also refer to [TR-03112-1]                                                                                                                                                                                                                                 |
|        | Name                                   | Error codes |                                                                                                                                                                                                                                                                                                             |
|        | ResultMajor                            | •           | /resultmajor#ok                                                                                                                                                                                                                                                                                             |
|        |                                        | •           | /resultmajor#error                                                                                                                                                                                                                                                                                          |
|        |                                        | •           | /resultmajor#warning                                                                                                                                                                                                                                                                                        |

|               | ResultMinor   | •<br>/resultminor/al/common#noPermission                                           |
|---------------|---------------|------------------------------------------------------------------------------------|
|               |               | •<br>/resultminor/al/common#internalError                                          |
|               |               | •<br>/resultminor/al/common#parameterError                                         |
|               |               | •<br>/resultminor/dp#unknownChannelHandle                                          |
|               |               | •<br>/resultminor/il/algorithm#<br>hashAlgorithmNotSupported                       |
|               |               | •<br>/resultminor/il/algorithm#<br>signatureAlgorithmNotSupported                  |
|               |               | •<br>/resultminor/il/service#ocspResponderUnreachable                              |
|               |               | •<br>/resultminor/il/service#<br>directoryServiceUnreachable                       |
|               |               | •<br>/resultminor/il/signature#certificateNotFound                                 |
|               |               | •<br>/resultminor/il/signature#<br>certificateFormatNotCorrect                     |
|               |               | •<br>/resultminor/il/signature#<br>invalidCertificateReference                     |
|               |               | •<br>/resultminor/il/signature#<br>certificateChainInterrupted                     |
|               |               | •<br>/resultminor/il/signature#<br>improperRevocationInformation                   |
|               |               | •<br>/resultminor/il/signature#<br>signatureAlgorithmNotSuitable                   |
|               |               | •<br>/resultminor/il/signature#hashAlgorithmNotSuitable                            |
|               |               | •<br>/resultminor/il/signature#invalidCertificatePath                              |
|               |               | •<br>/resultminor/il/signature#certificateRevoked                                  |
|               |               | •<br>/resultminor/il/signature#<br>referenceTimeNotWithinCertificateValidityPeriod |
|               |               | •<br>/resultminor/il/signature#<br>invalidCertificateExtension                     |
|               |               | •<br>/resultminor/sal#digitalSignatureNotCorrect                                   |
|               |               | •<br>/resultminor/il/signature#<br>certificatePathNotValidatedWarning              |
|               |               | •<br>/resultminor/il/signature#<br>certificateStatusNotCheckedWarning              |
|               |               | •<br>/resultminor/il/signature#<br>suiteabilityOfAlgorithmsNotCheckedWarning.      |
|               | ResultMessage | MAY contain more detailed information on the error which<br>occurred if required.  |
| Precondition  |               |                                                                                    |
| Postcondition |               |                                                                                    |
| Note          |               |                                                                                    |
|               |               |                                                                                    |

### **3.5.4 ExportCertificate**

| Name                     | ExportCertificate                                                  |                                                                                                                                                                                                 |  |
|--------------------------|--------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Description              | A certificate may be exported with the ExportCertificate function. |                                                                                                                                                                                                 |  |
| Invocation<br>parameters |                                                                    |                                                                                                                                                                                                 |  |
|                          |                                                                    | Invocation of the ExportCertificate function.                                                                                                                                                   |  |
|                          | Name                                                               | Description                                                                                                                                                                                     |  |
|                          | ChannelHandle                                                      | Optional parameter with which a remote system can be<br>addressed (also refer to CardApplicationPath in<br>[TR-03112-4]). If the local system is to be addressed, this<br>parameter is omitted. |  |
|                          | Certificate                                                        | Specifies which certificates should be exported from the<br>database. The X509IssuerSerialType is defined in<br>[RFC3275].                                                                      |  |
| Return                   |                                                                    |                                                                                                                                                                                                 |  |
|                          | Return of the ExportCertificate function.<br>Name<br>Description   |                                                                                                                                                                                                 |  |
|                          | dss:Result                                                         | Contains the status information and the errors of an<br>executed action. This element is described in more detail<br>below.                                                                     |  |
|                          | ec:Certificate                                                     | MAY occur several times and contains the requested<br>certificate (also refer to page 48).                                                                                                      |  |

|               | Status information and errors in ExportCertificate (also refer to<br>[TR-03112-1] Sections 4.1 and 4.2). |                                                                                   |  |
|---------------|----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|--|
|               | Name                                                                                                     | Error codes                                                                       |  |
|               | ResultMajor                                                                                              | •<br>/resultmajor#ok                                                              |  |
|               |                                                                                                          | •<br>/resultmajor#error                                                           |  |
|               | ResultMinor                                                                                              | •<br>/resultminor/al/common#noPermission                                          |  |
|               |                                                                                                          | •<br>/resultminor/al/common#internalError                                         |  |
|               |                                                                                                          | •<br>/resultminor/al/common#parameterError                                        |  |
|               |                                                                                                          | •<br>/resultminor/dp#unknownChannelHandle                                         |  |
|               |                                                                                                          | •<br>/resultminor/il/signature#certificateNotFound                                |  |
|               |                                                                                                          | •<br>/resultminor/il/signature#<br>invalidCertificateReference                    |  |
|               | ResultMessage                                                                                            | MAY contain more detailed information on the error<br>which occurred if required. |  |
| Precondition  |                                                                                                          |                                                                                   |  |
| Postcondition |                                                                                                          |                                                                                   |  |
| Note          |                                                                                                          |                                                                                   |  |

#### **3.5.5 DeleteCertificate**

| Name                     | DeleteCertificate                                                                                                                 |                                                                                                                                                                                                 |
|--------------------------|-----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Description              | The DeleteCertificate function deletes an existing (trustworthy or<br>non-trustworthy) certificate from the certificate database. |                                                                                                                                                                                                 |
| Invocation<br>parameters | Invocation of the DeleteCertificate function.                                                                                     |                                                                                                                                                                                                 |
|                          | Name                                                                                                                              | Description                                                                                                                                                                                     |
|                          | ChannelHandle                                                                                                                     | Optional parameter with which a remote system can be<br>addressed (also refer to CardApplicationPath in<br>[TR-03112-4]). If the local system is to be addressed, this<br>parameter is omitted. |
|                          | Certificate                                                                                                                       | Specifies which certificate is to be deleted from the<br>database. The X509IssuerSerialType is defined in<br>[RFC3275].                                                                         |

| Return        |                                                                                                                                 | Return of the DeleteCertificate function.                                                                                   |  |
|---------------|---------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|--|
|               | Name                                                                                                                            | Description                                                                                                                 |  |
|               | dss:Result                                                                                                                      | Contains the status information and the errors of an<br>executed action. This element is described in more detail<br>below. |  |
|               | Status information and errors in DeleteCertificate (also refer to<br>[TR-03112-1] Sections 4.1 and 4.2).<br>Name<br>Error codes |                                                                                                                             |  |
|               |                                                                                                                                 |                                                                                                                             |  |
|               | ResultMajor                                                                                                                     | •<br>/resultmajor#ok<br>•<br>/resultmajor#error                                                                             |  |
|               | ResultMinor                                                                                                                     | •<br>/resultminor/al/common#noPermission<br>•<br>/resultminor/al/common#internalError                                       |  |
|               |                                                                                                                                 | •<br>/resultminor/al/common#parameterError                                                                                  |  |
|               | •<br>/resultminor/dp#unknownChannelHandle                                                                                       |                                                                                                                             |  |
|               |                                                                                                                                 | •<br>/resultminor/il/signature#invalidCertificateReference                                                                  |  |
|               | ResultMessage                                                                                                                   | MAY contain more detailed information on the error which<br>occurred if required.                                           |  |
| Precondition  |                                                                                                                                 |                                                                                                                             |  |
| Postcondition |                                                                                                                                 |                                                                                                                             |  |
| Note          |                                                                                                                                 |                                                                                                                             |  |

#### <span id="page-55-0"></span>**3.5.6 AddTSL**

| Name        | AddTSL                                                                                                   |
|-------------|----------------------------------------------------------------------------------------------------------|
| Description | A series of Trust-Service status lists according to [TS102231] can be added with<br>the AddTSL function. |

![](_page_56_Figure_0.jpeg)

|               | ResultMinor   | •<br>/resultminor/al/common#noPermission                                          |
|---------------|---------------|-----------------------------------------------------------------------------------|
|               |               | •<br>/resultminor/al/common#internalError                                         |
|               |               | •<br>/resultminor/al/common#parameterError                                        |
|               |               | •<br>/resultminor/dp#unknownChannelHandle                                         |
|               |               | •<br>/resultminor/il/algorithm#<br>hashAlgorithmNotSupported                      |
|               |               | •<br>/resultminor/il/algorithm#<br>signatureAlgorithmNotSupported                 |
|               |               | •<br>/resultminor/il/service#ocspResponderUnreachable                             |
|               |               | •<br>/resultminor/il/service#directoryServiceUnreachable                          |
|               |               | •<br>/resultminor/il/service#<br>timeStampServiceUnreachable                      |
|               |               | •<br>/resultminor/il/signature#certificateNotFound                                |
|               |               | •<br>/resultminor/il/signature#<br>certificateFormatNotCorrect                    |
|               |               | •<br>/resultminor/il/signature#<br>invalidCertificateReference                    |
|               |               | •<br>/resultminor/il/signature#certificateChainInterrupted                        |
|               |               | •<br>/resultminor/il/signature#<br>resolutionOfObjectReferenceImpossible          |
|               |               | •<br>/resultminor/il/signature#<br>transformationAlgorithmNotSupported            |
|               |               | •<br>/resultminor/il/signature#unknownViewer                                      |
|               |               | •<br>/resultminor/il/signature#<br>certificatePathNotValidated                    |
|               |               | •<br>/resultminor/il/signature#<br>certificateStatusNotCheckedWarning             |
|               |               | •<br>/resultminor/il/signature#<br>suiteabilityOfAlgorithmsNotCheckedWarning      |
|               |               | •<br>/resultminor/il/signature#<br>improperRevocationInformation                  |
|               |               | •<br>/resultminor/sal#securityConditionsNotSatisfied                              |
|               | ResultMessage | MAY contain more detailed information on the error which<br>occurred if required. |
| Precondition  |               |                                                                                   |
| Postcondition |               |                                                                                   |
| Note          |               |                                                                                   |

#### **3.5.7 ExportTSL**

| Name                     | ExportTSL                                                                                                  |                                                                                                                                                                                                                                                                                                                                   |  |
|--------------------------|------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Description              | With the ExportTSL function, a Trust-Service status list can be exported in<br>accordance with [TS102231]. |                                                                                                                                                                                                                                                                                                                                   |  |
| Invocation<br>parameters |                                                                                                            |                                                                                                                                                                                                                                                                                                                                   |  |
|                          | Invocation of the ExportTSL function.                                                                      |                                                                                                                                                                                                                                                                                                                                   |  |
|                          | Name                                                                                                       | Description                                                                                                                                                                                                                                                                                                                       |  |
|                          | ChannelHandle                                                                                              | Optional parameter with which a remote system can<br>be addressed (also refer to<br>CardApplicationPath in [TR-03112-4]). If the<br>local system is to be addressed, this parameter is<br>omitted.                                                                                                                                |  |
|                          | SchemeName                                                                                                 | MAY contain the name of a specific TSL scheme<br>(also refer to [TS102231]) in order to specify what<br>TSLs are to be exported.                                                                                                                                                                                                  |  |
|                          | TSLSequenceNumber                                                                                          | MAY contain the serial number of the requested<br>TSL, if the SchemeName is specified. If the<br>TSLSequenceNumber is present, but the<br>SchemeName is not specified, the<br>TSLSequenceNumber element will be ignored<br>and there will be a corresponding warning<br>(/resultminor/al/TSL#TSLSequence<br>NumberIgnoredWarning) |  |
|                          |                                                                                                            | If this element is missing, all available TSLs (of the<br>specified TSL scheme) are exported.                                                                                                                                                                                                                                     |  |

| Return        | Return of the ExportTSL function.                                                                |                                                                                                                                                 |  |
|---------------|--------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|--|
|               | Name                                                                                             | Description                                                                                                                                     |  |
|               | dss:Result                                                                                       | Contains the status information and the errors of an<br>executed action. This element is described in more detail<br>below.                     |  |
|               | TrustStatusList                                                                                  | MAY occur several times and contain a Trust-Service<br>Status List according to [TS102231]. See page 48 for more<br>information on the TSLType. |  |
|               | Status information and errors in ExportTSL (also refer to [TR-03112-1] Sections 4.1<br>and 4.2). |                                                                                                                                                 |  |
|               | Name                                                                                             | Error codes                                                                                                                                     |  |
|               | ResultMajor                                                                                      | •<br>/resultmajor#ok                                                                                                                            |  |
|               |                                                                                                  | •<br>/resultmajor#error                                                                                                                         |  |
|               |                                                                                                  | •<br>/resultmajor#warning                                                                                                                       |  |
|               | ResultMinor                                                                                      | •<br>/resultminor/al/common#noPermission                                                                                                        |  |
|               |                                                                                                  | •<br>/resultminor/al/common#internalError                                                                                                       |  |
|               |                                                                                                  | •<br>/resultminor/al/common#parameterError                                                                                                      |  |
|               |                                                                                                  | •<br>/resultminor/al/<br>TSL#TSLSequenceNumberIgnoredWarning                                                                                    |  |
|               |                                                                                                  | •<br>/resultminor/dp#unknownChannelHandle                                                                                                       |  |
|               | ResultMessage                                                                                    | MAY contain more detailed information on the error which<br>occurred if required.                                                               |  |
| Precondition  |                                                                                                  |                                                                                                                                                 |  |
| Postcondition |                                                                                                  |                                                                                                                                                 |  |
| Note          |                                                                                                  |                                                                                                                                                 |  |

#### **3.5.8 DeleteTSL**

| Name        | DeleteTSL                                                                                                                    |
|-------------|------------------------------------------------------------------------------------------------------------------------------|
| Description | With the DeleteTSL function, a sequence of Trust-Service status lists can be<br>deleted from the list of trusted identities. |

![](_page_60_Figure_0.jpeg)

|               | Status information and errors in DeleteTSL (also refer to [TR-03112-1] Sections<br>4.1 and 4.2). |                                                                                   |
|---------------|--------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
|               | Name                                                                                             | Error codes                                                                       |
|               | ResultMajor                                                                                      | •<br>/resultmajor#ok                                                              |
|               |                                                                                                  | •<br>/resultmajor#error                                                           |
|               |                                                                                                  | •<br>/resultmajor#warning                                                         |
|               | ResultMinor                                                                                      | •<br>/resultminor/al/common#noPermission                                          |
|               |                                                                                                  | •<br>/resultminor/al/common#internalError                                         |
|               |                                                                                                  | •<br>/resultminor/al/common#parameterError                                        |
|               |                                                                                                  | •<br>/resultminor/al/<br>TSL#TSLSequenceNumberIgnoredWarning                      |
|               |                                                                                                  | •<br>/resultminor/dp#unknownChannelHandle                                         |
|               | ResultMessage                                                                                    | MAY contain more detailed information on the error which<br>occurred if required. |
| Precondition  |                                                                                                  |                                                                                   |
| Postcondition |                                                                                                  |                                                                                   |
| Note          |                                                                                                  |                                                                                   |

## **3.6 Service management**

#### **3.6.1 GetOCSPServices**

| Name                     | GetOCSPServices |                                                                                                                                                                                                 |
|--------------------------|-----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Description              |                 | The GetOCSPServices function reads the list of known OCSP responders.                                                                                                                           |
| Invocation<br>parameters |                 | Invocation of the GetOCSPServices function.                                                                                                                                                     |
|                          | Name            | Description                                                                                                                                                                                     |
|                          | ChannelHandle   | Optional parameter with which a remote system can be<br>addressed (also refer to CardApplicationPath in<br>[TR-03112-4]). If the local system is to be addressed,<br>this parameter is omitted. |

<span id="page-62-0"></span>

| Return |                                                                                                                                             | Return of the GetOCSPServices function.                                                                                                                                                                                                                                                                                  |
|--------|---------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|        | Name                                                                                                                                        | Description                                                                                                                                                                                                                                                                                                              |
|        | dss:Result                                                                                                                                  | Contains the status information and the errors of an<br>executed action. This element is described in more detail<br>below.                                                                                                                                                                                              |
|        | OCSPService                                                                                                                                 | Contains information on the available OCSP responders<br>which MAY be used if a certificate which is to be verified<br>does not contain the address of the OCSP responder in the<br>authority information access extension (also refer to<br>[RFC3280], Section 4.2.2.1). Details on the<br>ServiceType are given below. |
|        |                                                                                                                                             |                                                                                                                                                                                                                                                                                                                          |
|        | An element of ServiceType is part of GetOCSPServicesResponse,<br>SetOCSPServices, GetDirectoryServicesResponse and<br>SetDirectoryServices. |                                                                                                                                                                                                                                                                                                                          |
|        | Name                                                                                                                                        | Description                                                                                                                                                                                                                                                                                                              |
|        | Name                                                                                                                                        | MAY contain the name of the service.                                                                                                                                                                                                                                                                                     |
|        | Address                                                                                                                                     | Contains the address of the service.                                                                                                                                                                                                                                                                                     |

|               | Status information and errors in GetOCSPServices (also refer to<br>[TR-03112-1] Sections 4.1 and 4.2). |                                                                                   |
|---------------|--------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
|               | Name                                                                                                   | Error codes                                                                       |
|               | ResultMajor                                                                                            | •<br>/resultmajor#ok                                                              |
|               |                                                                                                        | •<br>/resultmajor#error                                                           |
|               | ResultMinor                                                                                            | •<br>/resultminor/al/common#noPermission                                          |
|               |                                                                                                        | •<br>/resultminor/al/common#internalError                                         |
|               |                                                                                                        | •<br>/resultminor/al/common#parameterError                                        |
|               |                                                                                                        | •<br>/resultminor/dp#unknownChannelHandle                                         |
|               | ResultMessage                                                                                          | MAY contain more detailed information on the error which<br>occurred if required. |
| Precondition  |                                                                                                        |                                                                                   |
| Postcondition |                                                                                                        |                                                                                   |
| Note          |                                                                                                        |                                                                                   |

#### **3.6.2 SetOCSPServices**

| Name                     | SetOCSPServices                                                            |                                                                                                                                                                                                                                                                                                                                                                                                                              |
|--------------------------|----------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Description              | The SetOCSPServices function writes the list of available OCSP responders. |                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Invocation<br>parameters | Invocation of the SetOCSPServices function.                                |                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                          |                                                                            |                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                          | Name                                                                       | Description                                                                                                                                                                                                                                                                                                                                                                                                                  |
|                          | ChannelHandle                                                              | Optional parameter with which a remote system can be<br>addressed (also refer to CardApplicationPath in<br>[TR-03112-4]). If the local system is to be addressed,<br>this parameter is omitted.                                                                                                                                                                                                                              |
|                          | OCSPService                                                                | Contains information on the available OCSP responders<br>which MAY be used if a certificate which is to be<br>verified does not contain the address of the OCSP<br>responder in the authority information access extension<br>(also refer to [RFC3280], Section 4.2.2.1). Details on<br>the ServiceType are given on page 63.<br>When the list is written, the availability of the<br>configured OCSP responders is checked. |

| Return        |                                                                                                                                                                   |                  |                                                                                                                                                              |
|---------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
|               | Return of the SetOCSPServices function.<br>Name                                                                                                                   |                  | Description                                                                                                                                                  |
|               | dss:Result<br>more detail below.<br>Status information and errors in SetOCSPServices (also refer to [TR-03112-1]<br>Sections 4.1 and 4.2).<br>Name<br>Error codes |                  | Contains the status information and the errors of<br>an executed action. This element is described in                                                        |
|               |                                                                                                                                                                   |                  |                                                                                                                                                              |
|               |                                                                                                                                                                   |                  |                                                                                                                                                              |
|               | ResultMajor                                                                                                                                                       | •<br>•           | /resultmajor#ok<br>/resultmajor#error                                                                                                                        |
|               | ResultMinor                                                                                                                                                       | •<br>•<br>•<br>• | /resultminor/al/common#noPermission<br>/resultminor/al/common#internalError<br>/resultminor/al/common#parameterError<br>/resultminor/dp#unknownChannelHandle |
|               |                                                                                                                                                                   | •                | /resultminor/il/service#ocspResponderUnreachable                                                                                                             |
|               | ResultMessage                                                                                                                                                     |                  | MAY contain more detailed information on the error which<br>occurred if required.                                                                            |
| Precondition  |                                                                                                                                                                   |                  |                                                                                                                                                              |
| Postcondition |                                                                                                                                                                   |                  |                                                                                                                                                              |
| Note          |                                                                                                                                                                   |                  |                                                                                                                                                              |

#### **3.6.3 GetDirectoryServices**

| Name                     | GetDirectoryServices                                                                                       |  |
|--------------------------|------------------------------------------------------------------------------------------------------------|--|
| Description              | The GetDirectoryServices function reads the list of the directory services<br>accessible via LDAP or http. |  |
| Invocation<br>parameters | Invocation of the GetDirectoryServices function.                                                           |  |
|                          | Name<br>Description                                                                                        |  |

| Return        | ChannelHandle                                                                                               | Optional parameter with which a remote system can be<br>addressed (also refer to CardApplicationPath in<br>[TR-03112-4]). If the local system is to be addressed, this<br>parameter is omitted. |
|---------------|-------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|               | Return of the GetDirectoryServices function.                                                                |                                                                                                                                                                                                 |
|               | Name                                                                                                        | Description                                                                                                                                                                                     |
| dss:Result    |                                                                                                             | Contains the status information and the errors of an<br>executed action. This element is described in more detail<br>below.                                                                     |
|               | DirectoryService                                                                                            | Contains information on the available directory services<br>which can be used for retrieval of certificates or<br>blacklists (details on the ServiceType can be found<br>on page 63).           |
|               | Status information and errors in GetDirectoryServices (also refer to<br>[TR-03112-1] Sections 4.1 and 4.2). |                                                                                                                                                                                                 |
|               | Name                                                                                                        | Error codes                                                                                                                                                                                     |
|               | ResultMajor                                                                                                 | •<br>/resultmajor#ok<br>•<br>/resultmajor#error                                                                                                                                                 |
|               | ResultMinor                                                                                                 | •<br>/resultminor/al/common#noPermission<br>•<br>/resultminor/al/common#internalError<br>•<br>/resultminor/al/common#parameterError<br>•<br>/resultminor/dp#unknownChannelHandle                |
|               | ResultMessage                                                                                               | MAY contain more detailed information on the error which<br>occurred if required.                                                                                                               |
| Precondition  |                                                                                                             |                                                                                                                                                                                                 |
| Postcondition |                                                                                                             |                                                                                                                                                                                                 |
| Note          |                                                                                                             |                                                                                                                                                                                                 |

#### **3.6.4 SetDirectoryServices**

| Name        | SetDirectoryServices                                                                  |  |
|-------------|---------------------------------------------------------------------------------------|--|
| Description | The SetDirectoryServices function writes the list of available directory<br>services. |  |

![](_page_66_Figure_0.jpeg)

|               | ResultMessage | MAY contain more detailed information on the error which<br>occurred if required. |
|---------------|---------------|-----------------------------------------------------------------------------------|
| Precondition  |               |                                                                                   |
| Postcondition |               |                                                                                   |
| Note          |               |                                                                                   |

#### <span id="page-67-0"></span>**3.6.5 GetTSServices**

| Name                     | GetTSService                                                                                                             |                                                                                                                                                                                                 |  |
|--------------------------|--------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Description              | The GetTSServices function reads the list of time stamping services with the<br>corresponding configuration information. |                                                                                                                                                                                                 |  |
| Invocation<br>parameters | Invocation of the GetTSServices function.                                                                                |                                                                                                                                                                                                 |  |
|                          | Name                                                                                                                     | Description                                                                                                                                                                                     |  |
| Return                   | ChannelHandle                                                                                                            | Optional parameter with which a remote system can be<br>addressed (also refer to CardApplicationPath in<br>[TR-03112-4]). If the local system is to be addressed, this<br>parameter is omitted. |  |
|                          |                                                                                                                          |                                                                                                                                                                                                 |  |
|                          | Return of the GetTSServices function.                                                                                    |                                                                                                                                                                                                 |  |
|                          | Name<br>dss:Result                                                                                                       | Description<br>Contains the status information and the errors of an<br>executed action. This element is described in more<br>detail below.                                                      |  |
|                          | TimeStampingService                                                                                                      | MAY occur more than once and contains information<br>in each case about one time stamp service (see below<br>for details).                                                                      |  |

<span id="page-68-0"></span>![](_page_68_Figure_0.jpeg)

|               | Status information and errors in GetTSService (also refer to [TR-03112-1]<br>Sections 4.1 and 4.2). |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|---------------|-----------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|               | Name                                                                                                | Error codes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               | ResultMajor                                                                                         | •<br>/resultmajor#ok<br>•<br>/resultmajor#error                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               | ResultMinor                                                                                         | •<br>/resultminor/al/common#noPermission<br>•<br>/resultminor/al/common#internalError<br>•<br>/resultminor/al/common#parameterError<br>•<br>/resultminor/dp#unknownChannelHandle<br>•<br>/resultminor/dp#unknownCipherSuite<br>•<br>/resultminor/il/service#timeStampServiceUnreachable<br>•<br>/resultminor/il/signature#signatureFormatNotSupported<br>•<br>/resultminor/sal#nameAlreadyExisting<br>•<br>/resultminor/sal#unknownProtocol<br>•<br>/resultminor/sal#unknownCardType<br>•<br>/resultminor/sal#unknownDIDName<br>•<br>/resultminor/sal#fileNotFound |
|               | ResultMessage                                                                                       | MAY contain more detailed information on the error which<br>occurred if required.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Precondition  |                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Postcondition |                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Note          |                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |

## <span id="page-69-0"></span>**3.6.6 SetTSServices**

| Name                     | SetTSServices                                     |                                                                                 |
|--------------------------|---------------------------------------------------|---------------------------------------------------------------------------------|
| Description              | with all corresponding configuration information. | The SetTSServices function writes a list of the time stamping services together |
| Invocation<br>parameters | Invocation of the SetTSServices function.<br>Name | Description                                                                     |

| Return        | ChannelHandle<br>TimeStampingService                                                                 |                       | Optional parameter with which a remote system<br>can be addressed (also refer to<br>CardApplicationPath in [TR-03112-4]). If<br>the local system is to be addressed, this parameter<br>is omitted.<br>MAY occur several times and contains information<br>on a time stamping service (for details on the<br>TSServiceType refer to page 69). |
|---------------|------------------------------------------------------------------------------------------------------|-----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|               |                                                                                                      |                       |                                                                                                                                                                                                                                                                                                                                              |
|               | Return of the SetTSServices function.                                                                |                       |                                                                                                                                                                                                                                                                                                                                              |
|               | Name                                                                                                 | Description           |                                                                                                                                                                                                                                                                                                                                              |
|               | dss:Result                                                                                           | below.                | Contains the status information and the errors of an<br>executed action. This element is described in more detail                                                                                                                                                                                                                            |
|               | Status information and errors in SetTSServices (also refer to [TR-03112-1]<br>Sections 4.1 and 4.2). |                       |                                                                                                                                                                                                                                                                                                                                              |
|               | Name                                                                                                 | Error codes           |                                                                                                                                                                                                                                                                                                                                              |
|               | ResultMajor                                                                                          | •                     | /resultmajor#ok                                                                                                                                                                                                                                                                                                                              |
|               |                                                                                                      | •                     | /resultmajor#error                                                                                                                                                                                                                                                                                                                           |
|               | ResultMinor                                                                                          | •                     | /resultminor/al/common#noPermission                                                                                                                                                                                                                                                                                                          |
|               |                                                                                                      | •                     | /resultminor/al/common#internalError                                                                                                                                                                                                                                                                                                         |
|               |                                                                                                      | •                     | /resultminor/al/common#parameterError                                                                                                                                                                                                                                                                                                        |
|               |                                                                                                      | •                     | /resultminor/dp#unknownChannelHandle                                                                                                                                                                                                                                                                                                         |
|               |                                                                                                      | •                     | /resultminor/dp#unknownCipherSuite                                                                                                                                                                                                                                                                                                           |
|               |                                                                                                      | •                     | /resultminor/il/service#timeStampServiceUnreachable                                                                                                                                                                                                                                                                                          |
|               |                                                                                                      | •                     | /resultminor/il/signature#signatureFormatNotSupported                                                                                                                                                                                                                                                                                        |
|               |                                                                                                      | •                     | /resultminor/sal#nameAlreadyExisting                                                                                                                                                                                                                                                                                                         |
|               |                                                                                                      | •                     | /resultminor/sal#unknownProtocol                                                                                                                                                                                                                                                                                                             |
|               |                                                                                                      | •                     | /resultminor/sal#unknownCardType                                                                                                                                                                                                                                                                                                             |
|               |                                                                                                      | •                     | /resultminor/sal#unknownDIDName                                                                                                                                                                                                                                                                                                              |
|               |                                                                                                      | •                     | /resultminor/sal#fileNotFound                                                                                                                                                                                                                                                                                                                |
|               | ResultMessage                                                                                        | occurred if required. | MAY contain more detailed information on the error which                                                                                                                                                                                                                                                                                     |
| Precondition  |                                                                                                      |                       |                                                                                                                                                                                                                                                                                                                                              |
| Postcondition |                                                                                                      |                       |                                                                                                                                                                                                                                                                                                                                              |
| Note          |                                                                                                      |                       | When new time stamping services are added, their availability SHOULD be checked.                                                                                                                                                                                                                                                             |
|               |                                                                                                      |                       |                                                                                                                                                                                                                                                                                                                                              |

## **References**

| [TR-03112-1] | BSI: TR-03112-1: eCard-API-Framework – Part 1: Overview and Generic Mechanisms                                                                                   |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [TR-03112-2] | BSI: TR-03112-2: eCard-API-Framework – Part 2: eCard-Interface                                                                                                   |
| [TR-03112-3] | BSI: TR-03112-3: eCard-API-Framework – Part 3: Management-Interface                                                                                              |
| [TR-03112-4] | BSI: TR-03112-4: eCard-API-Framework – Part 4: ISO24727-3-Interface                                                                                              |
| [TR-03112-5] | BSI: TR-03112-5: eCard-API Framework – Part 5: Suppor- Interface                                                                                                 |
| [TR-03112-6] | BSI: TR-03112-6: eCard-API-Framework – Part 6: IFD-Interface                                                                                                     |
| [TR-03112-7] | BSI: TR-03112-7: eCard-API-Framework – Part 7: Protocols                                                                                                         |
| [TS102231]   | ETSI: TS 102 231: Provision of harmonized Trust Service Provider (TSP) status<br>information, Technical Specification                                            |
| [MIME]       | IANA: MIME Media Types                                                                                                                                           |
| [RFC2119]    | IETF: RFC 2119: S. Bradner: Key words for use in RFCs to Indicate Requirement Levels                                                                             |
| [RFC3161]    | IETF: RFC 3161: C. Adams, P. Cain, D. Pinkas, R. Zuccherato: Internet X.509 Public<br>Key Infrastructure Time-Stamp Protocol (TSP)                               |
| [RFC3275]    | IETF: RFC 3275: D. Eastlage, J. Reagle, D. Solo: (Extensible Markup Language)<br>XMLSignature Syntax and Processing                                              |
| [RFC3280]    | IETF: RFC 3280: R. Housley, W. Polk, W. Ford, D. Solo: Internet X.509 Public Key<br>Infrastructure, Certificate and Certificate Revocation List (CRL) Profile    |
| [ISO24727-3] | ISO: ISO/IEC 24727-3: Identification Cards — Integrated Circuit Cards Programming<br>Interfaces — Part 3: Application Interface                                  |
| [ISO24727-4] | ISO: ISO/IEC 24727-4: Identification Cards — Integrated Circuit Cards Programming<br>Interfaces — Part 4: Application programming interface (API) administration |
| [DSS]        | OASIS: Digital Signature Service Core Protocols, Elements, and Bindings                                                                                          |